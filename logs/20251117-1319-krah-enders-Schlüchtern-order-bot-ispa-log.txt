2025-11-17 13:47:13,487 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 13:47:13,494 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 13:47:29,596 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:47:39,974 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:47:55,708 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:48:20,522 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 13:48:31,578 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 13:48:33,930 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:48:35,008 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 13:48:35,010 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-17 13:48:37,363 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 83
2025-11-17 13:48:37,364 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 13:48:37,365 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:48:38,631 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:48:39,787 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:48:52,078 - ispa_next.appointments.models - DEBUG - Appointment Domenico Bruno MKK-B 197 WBAKS410X00H55021 ohne Termin.
2025-11-17 13:48:52,088 - ispa_next.appointments.models - DEBUG - Appointment Carsten Ihrig FD-CN 911 WBA6L71000FH84721 ohne Termin.
2025-11-17 13:48:52,095 - ispa_next.appointments.models - DEBUG - Appointment Nicole Jennifer Schwarzer FD-XX 1209 WBAJR71050WW63253 ohne Termin.
2025-11-17 13:48:52,101 - ispa_next.appointments.models - DEBUG - Appointment Firma Rhein-Main-Dachbeschichtungs G FD-DR 111 WBAJN91040CE25924 ohne Termin.
2025-11-17 13:48:52,137 - ispa_next.main - DEBUG - Found 15 out of 79 appointments to process (configured limit: 15).
2025-11-17 13:48:52,137 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 13:48:52,137 - ispa_next.main - DEBUG - All appointments: FD-MD 503, GN-MD 1234, SLÜ-M 6316, SLÜ-HI 105, SLÜ-TH 10 E, SLÜ-LF 47, SLÜ-X 313, SLÜ-IH 11, MKK-NL 108, FD-OH 108, FD-DA 1111, SLÜ-LD 207, MKK-KH 310, MKK-KX 57, SLÜ-SF 64
2025-11-17 13:48:52,140 - ispa_next.main - DEBUG - 



2025-11-17 13:48:52,141 - ispa_next.main - DEBUG - starting with process 1 (FD-MD 503) of 15
2025-11-17 13:48:52,145 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:48:53,239 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:48:54,369 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 13:48:54,370 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 83
2025-11-17 13:48:55,554 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:48:55,555 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:49:26,982 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:49:36,645 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:49:38,526 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:49:38,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:49:38,600 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:49:38,832 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:49:38,835 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:49:41,664 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:49:41,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:49:42,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:49:44,562 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:49:44,696 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:49:44,772 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:49:44,851 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:49:49,024 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:49:50,039 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:49:50,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:49:50,562 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:50:01,050 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:50:07,659 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:50:07,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:50:07,763 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:50:07,764 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:50:07,800 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:50:09,047 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:50:09,325 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:50:13,184 - ispa_next.functions - DEBUG - Updated appointment (AI00013579) customer contact data.
2025-11-17 13:50:14,111 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:50:14,112 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:50:14,965 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:50:14,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:50:15,623 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:50:19,245 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:50:19,245 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:50:19,248 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:50:19,248 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:50:19,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:50:19,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:50:23,961 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:50:23,966 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:50:23,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:50:24,034 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:50:24,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:50:24,865 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:50:24,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:50:25,668 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:50:25,669 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:50:27,647 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:50:27,649 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:50:28,716 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:50:28,721 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:50:28,723 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 13:50:28,725 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:50:28,726 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:50:28,727 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:50:28,728 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:50:28,730 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:50:28,730 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:50:28,732 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:50:28,734 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:50:29,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:50:30,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:50:54,671 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:50:54,677 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:50:54,678 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:50:54,679 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:50:57,184 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:50:57,185 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:50:57,188 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:50:59,699 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:50:59,701 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:50:59,702 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:51:00,160 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:51:00,210 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:51:03,510 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:51:03,513 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:51:03,514 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:51:04,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:51:04,553 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:51:04,682 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:51:11,401 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:51:15,222 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:51:19,091 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:51:19,093 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:51:19,093 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:51:19,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:51:19,568 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:51:19,570 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 13:51:19,590 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:51:22,427 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 13:51:22,432 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:51:22,821 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 13:51:22,822 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:51:25,695 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 13:51:25,696 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:51:26,550 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 13:51:26,558 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 13:51:26,567 - ispa_next.main - DEBUG - Found new Appointment: SLÜ-RG 118
2025-11-17 13:51:26,569 - ispa_next.main - DEBUG - 



2025-11-17 13:51:26,569 - ispa_next.main - DEBUG - starting with process 2 (SLÜ-RG 118) of 16
2025-11-17 13:51:26,572 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:51:27,692 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:51:28,914 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 13:51:28,915 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 13:51:30,323 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:51:30,325 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:51:55,386 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:52:04,666 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:52:05,895 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:52:05,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:05,971 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:52:06,196 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:52:06,198 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:52:09,201 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:52:09,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:10,019 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:52:12,025 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:52:12,130 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:52:12,210 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:52:12,297 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:52:16,524 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:52:17,528 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:52:17,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:17,982 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:30,045 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:52:37,204 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:52:37,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:37,267 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:52:37,269 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:52:37,321 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:52:38,608 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:52:38,820 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:52:42,901 - ispa_next.functions - DEBUG - Updated appointment (AI00013589) customer contact data.
2025-11-17 13:52:43,828 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:52:43,830 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:52:44,526 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:52:44,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:52:45,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:52:49,739 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:52:49,739 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:52:49,742 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:52:49,743 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:52:49,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:50,238 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:52:54,397 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:52:54,402 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:52:54,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:54,475 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:52:54,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:55,347 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:55,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:56,147 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:52:56,147 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:52:58,010 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:52:58,011 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:52:58,940 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:52:58,942 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:52:58,943 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 13:52:58,945 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:52:58,946 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:52:58,947 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:52:58,948 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:52:58,950 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:52:58,950 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:52:58,952 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:52:58,953 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:52:59,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:53:00,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:53:24,887 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:53:24,889 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:53:24,891 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:53:24,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:27,425 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:53:27,427 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:53:27,431 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:29,956 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:53:29,959 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:53:29,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:53:30,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:53:30,498 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:53:30,499 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:53:30,502 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:53:30,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:53:31,459 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:53:31,629 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:38,148 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:53:41,863 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:53:46,133 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:53:46,135 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:53:46,136 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:53:46,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:53:46,877 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:53:46,881 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 13:53:46,924 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:53:50,000 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 13:53:50,004 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:53:50,462 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 13:53:50,463 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:53:53,452 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 13:53:53,453 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:53:54,378 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 13:53:54,387 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 13:53:54,398 - ispa_next.main - DEBUG - 



2025-11-17 13:53:54,398 - ispa_next.main - DEBUG - starting with process 3 (GN-MD 1234) of 16
2025-11-17 13:53:54,401 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:53:55,505 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:53:56,461 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 13:53:56,462 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 13:53:57,813 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:53:57,815 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:54:24,739 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:54:33,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:54:33,597 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:54:33,712 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:54:34,956 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:54:34,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:54:35,019 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:54:35,219 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:54:35,222 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:54:38,191 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:54:38,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:54:39,281 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:54:41,283 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:54:41,436 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:54:44,725 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:54:44,795 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:54:44,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:54:46,028 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:54:57,161 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:54:58,165 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:54:58,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:54:58,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:11,671 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:55:18,657 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:55:18,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:18,737 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:55:18,737 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:55:18,768 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:55:20,014 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:55:21,207 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:55:21,435 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:55:25,754 - ispa_next.functions - DEBUG - Updated appointment (AI00013570) customer contact data.
2025-11-17 13:55:26,669 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:55:26,671 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:55:27,396 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:55:27,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:55:28,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:55:32,644 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:55:32,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:55:33,153 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:55:35,159 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:55:35,254 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:55:35,358 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:55:35,426 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:55:35,428 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:55:37,375 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:55:48,585 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:55:55,654 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:55:55,656 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:55:57,614 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:56:01,838 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:56:02,843 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:56:02,844 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:56:02,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:56:02,982 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:56:07,084 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:56:07,088 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:56:07,088 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 13:56:07,089 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:56:08,927 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:56:08,928 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:56:10,047 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:56:10,048 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:56:10,050 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 13:56:10,051 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:56:10,052 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:56:10,055 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:56:10,059 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:56:10,063 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:56:10,065 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:56:10,066 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:56:10,067 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:56:10,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:56:11,566 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:56:36,354 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:56:36,356 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:56:36,358 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:56:36,359 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:38,962 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:56:38,963 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:56:38,967 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:41,511 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:56:41,513 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:56:41,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:56:42,016 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:56:42,275 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:57,252 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:56:57,254 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:56:57,256 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:56:57,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:56:58,340 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:56:58,460 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:57:05,865 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:57:09,637 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:57:13,663 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:57:13,665 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:57:13,666 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:57:14,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:57:14,213 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:57:14,214 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 13:57:14,236 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:57:17,437 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 13:57:17,441 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:57:17,843 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 13:57:17,844 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:57:20,941 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 13:57:20,942 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:57:21,904 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 13:57:21,913 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 13:57:21,928 - ispa_next.main - DEBUG - 



2025-11-17 13:57:21,928 - ispa_next.main - DEBUG - starting with process 4 (SLÜ-M 6316) of 16
2025-11-17 13:57:21,932 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:57:23,053 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:57:24,288 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 13:57:24,289 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 13:57:25,691 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:57:25,692 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:57:52,461 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:58:02,470 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:58:05,814 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:58:05,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:05,925 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:58:06,111 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:58:06,114 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:58:08,936 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:58:08,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:58:09,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:58:11,847 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:58:11,981 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:58:12,076 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:58:12,174 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:58:16,394 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:58:17,399 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:58:17,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:17,915 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:28,556 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:58:35,781 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:58:35,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:35,875 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:58:35,876 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:58:36,006 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:58:37,313 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:58:37,517 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:58:41,661 - ispa_next.functions - DEBUG - Updated appointment (AI00013559) customer contact data.
2025-11-17 13:58:42,583 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:58:42,585 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:58:43,121 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:58:43,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:58:43,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:58:47,334 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:58:47,334 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:58:47,337 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:58:47,338 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:58:47,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:58:47,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:58:52,050 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:58:52,054 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:58:52,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:58:52,141 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:58:57,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:58,220 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:58,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:58:58,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:58:58,841 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:59:01,883 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:59:01,885 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:59:02,842 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:59:02,845 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:59:02,847 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 13:59:02,848 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:59:02,850 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:59:02,850 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:59:02,851 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:59:02,853 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:59:02,854 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:59:02,855 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:59:02,857 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:59:03,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:59:04,302 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:59:29,822 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:59:29,825 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:59:29,827 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:59:29,827 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:33,827 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:59:33,829 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:59:33,831 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:37,761 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:59:37,763 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:59:37,764 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:59:38,287 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:59:38,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:51,113 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:59:51,115 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:59:51,116 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:59:51,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:59:52,177 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:59:52,288 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:59,853 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:00:04,186 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:00:08,018 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:00:12,222 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:00:17,957 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:00:17,960 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:00:17,961 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:00:18,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:00:19,737 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:00:19,739 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:00:19,794 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:00:36,506 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 14:00:36,510 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:00:40,398 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 14:00:40,399 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:00:51,271 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 14:00:51,272 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:00:52,069 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 14:00:52,078 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 14:00:52,092 - ispa_next.main - DEBUG - 



2025-11-17 14:00:52,092 - ispa_next.main - DEBUG - starting with process 5 (SLÜ-HI 105) of 16
2025-11-17 14:00:52,096 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:00:53,248 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:00:54,168 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 14:00:54,169 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 14:00:55,924 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:00:55,925 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:01:25,217 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:01:35,025 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:35,136 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:01:35,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:01:36,594 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:01:36,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:36,668 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:01:36,924 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:01:36,928 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:01:39,831 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:01:39,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:01:41,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:01:43,280 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:01:43,557 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:01:46,761 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:01:46,827 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:01:46,829 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:01:48,106 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:01:59,635 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:02:00,641 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:02:00,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:01,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:11,987 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:02:19,331 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:02:19,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:19,394 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:02:19,394 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:02:19,433 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:02:20,603 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:02:21,860 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:02:22,130 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:02:24,961 - ispa_next.functions - DEBUG - Updated appointment (AU00007734) customer contact data.
2025-11-17 14:02:25,898 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:02:25,900 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:02:26,405 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:02:26,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:02:27,264 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:02:30,864 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:02:30,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:02:31,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:02:33,379 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:02:33,520 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:02:33,609 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:02:33,755 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:02:33,757 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:02:35,037 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:02:46,721 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:03:46,723 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:03:58,553 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:04:05,598 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:04:05,599 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:04:06,862 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:04:11,083 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:04:12,121 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:04:12,122 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:04:12,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:12,205 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:04:16,341 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:04:16,345 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:04:16,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:16,420 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:04:16,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:17,372 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:17,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:18,199 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:04:18,199 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:04:19,520 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:04:19,528 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:04:20,605 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:04:20,607 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:04:20,608 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:04:20,610 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:04:20,612 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:04:20,615 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:04:20,619 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:04:20,624 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:04:20,628 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:04:20,632 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:04:20,634 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:04:21,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:04:21,969 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:04:48,193 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:04:48,196 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:04:48,197 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:04:48,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:04:50,167 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:04:50,169 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:04:50,171 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:04:52,092 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:04:52,094 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:04:52,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:04:52,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:04:52,889 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:02,048 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:05:02,050 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:05:02,051 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:05:02,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:05:03,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:05:03,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:09,338 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:05:14,117 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:05:14,119 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:05:14,120 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:05:14,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:05:14,780 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:05:14,782 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:05:14,808 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:05:18,458 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 14:05:18,462 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:05:19,045 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 14:05:19,047 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:05:22,733 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 14:05:22,734 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:05:23,668 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 14:05:23,676 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 14:05:23,691 - ispa_next.main - DEBUG - 



2025-11-17 14:05:23,691 - ispa_next.main - DEBUG - starting with process 6 (SLÜ-TH 10 E) of 16
2025-11-17 14:05:23,696 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:05:24,915 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:05:26,127 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 14:05:26,129 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 14:05:27,796 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:05:27,798 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:05:56,796 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:06:06,282 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:07,528 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:06:07,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:07,615 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:06:07,794 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:06:07,796 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:06:10,613 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:06:10,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:06:11,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:06:13,733 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:06:13,836 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:06:13,976 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:06:14,042 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:06:18,235 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:06:19,239 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:06:19,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:19,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:31,421 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:06:31,436 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:06:38,930 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:06:38,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:39,025 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:06:39,026 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:06:39,068 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:06:40,225 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:06:40,476 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:06:43,613 - ispa_next.functions - DEBUG - Updated appointment (AM00012190) customer contact data.
2025-11-17 14:06:44,522 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:06:44,525 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:06:45,064 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:06:45,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:06:45,951 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:06:49,958 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 14:06:49,958 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:06:49,959 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:06:49,961 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:06:49,962 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:06:49,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:06:50,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:06:54,616 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:06:54,619 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:06:54,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:06:54,724 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:07:04,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:07:04,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:07:04,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:07:05,527 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:07:05,527 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:07:06,801 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:07:06,804 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:07:07,939 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:07:07,941 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:07:07,942 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:07:07,944 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:07:07,945 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:07:07,946 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:07:07,947 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:07:07,949 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:07:07,950 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:07:07,951 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:07:07,953 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:07:08,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:07:09,306 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:07:35,443 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:07:35,449 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:07:35,451 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:07:35,453 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:37,411 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:07:37,413 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:07:37,415 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:39,284 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:07:39,286 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:07:39,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:07:39,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:07:40,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:48,408 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:07:48,409 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:07:48,411 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:07:48,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:07:49,435 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:07:49,562 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:55,784 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:07:59,972 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:07:59,975 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:07:59,975 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:08:00,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:08:00,750 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:08:00,751 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:08:00,777 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:08:04,678 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 14:08:04,682 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:08:05,252 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 14:08:05,253 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:08:08,505 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 14:08:08,506 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:08:09,261 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 14:08:09,269 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 14:08:09,283 - ispa_next.main - DEBUG - 



2025-11-17 14:08:09,283 - ispa_next.main - DEBUG - starting with process 7 (SLÜ-LF 47) of 16
2025-11-17 14:08:09,287 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:08:10,549 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:08:11,744 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 14:08:11,745 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 14:08:13,228 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:08:13,240 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:08:43,902 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:08:52,904 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:08:59,697 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:08:59,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:59,761 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:08:59,940 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:08:59,943 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:09:02,818 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:09:02,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:09:04,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:09:06,121 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:09:06,216 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:09:06,329 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:09:06,392 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:09:06,393 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:13,425 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:09:24,315 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:09:31,654 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:09:31,656 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:38,507 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:09:42,733 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:09:43,738 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:09:43,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:44,241 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:53,755 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 14:10:01,780 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:10:01,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:01,853 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:10:01,853 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:10:01,958 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:10:02,077 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:10:03,327 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:10:03,608 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:10:08,145 - ispa_next.functions - DEBUG - Updated appointment (AI00013530) customer contact data.
2025-11-17 14:10:09,037 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:10:09,040 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:10:09,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:10:10,665 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:10:12,061 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:10:12,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:10:12,340 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:10:17,035 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:10:17,035 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:10:17,070 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:10:17,076 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:10:17,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:10:17,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:10:21,888 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:10:22,709 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:10:38,789 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:10:38,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:10:38,874 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:10:43,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:43,621 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:43,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:10:44,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:10:44,380 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:10:51,875 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:10:51,879 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:10:53,438 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:10:53,440 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:10:53,442 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:10:53,444 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:10:53,445 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:10:53,446 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:10:53,448 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:10:53,449 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:10:53,451 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:10:53,453 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:10:53,454 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:10:54,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:10:55,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:11:23,097 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:11:23,099 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:11:23,101 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:11:23,102 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:32,248 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:11:32,250 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:11:32,252 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:41,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:11:41,743 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:11:52,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:12:13,257 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:12:13,259 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:12:13,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:12:14,475 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:12:14,690 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:12:29,011 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:12:29,022 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:12:29,025 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:12:29,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:12:30,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:12:30,388 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:12:45,640 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:51,532 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:57,162 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:02,898 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:09,216 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:16,754 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:23,309 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:30,288 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:36,644 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:42,813 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:49,066 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:55,521 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:55,524 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:13:55,525 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:13:56,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:13:56,653 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:13:56,655 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:13:56,698 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:14:02,297 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 14:14:02,300 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:14:02,864 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 14:14:02,865 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:14:07,839 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 14:14:07,840 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:14:08,895 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 14:14:08,904 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 14:14:08,916 - ispa_next.main - DEBUG - 



2025-11-17 14:14:08,916 - ispa_next.main - DEBUG - starting with process 8 (SLÜ-X 313) of 16
2025-11-17 14:14:08,921 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:14:10,689 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:14:13,188 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 14:14:13,191 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 14:14:15,354 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:14:15,360 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:14:51,386 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:15:03,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:03,212 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:15:03,462 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:15:05,453 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:15:05,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:05,574 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:15:05,872 - ispa_next.functions - DEBUG - HU date already expired after 1 days.
2025-11-17 14:15:14,261 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:15:14,264 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:15:17,236 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:15:17,238 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:15:19,244 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:15:21,249 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:15:21,428 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:15:24,699 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:15:24,817 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:15:24,819 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:15:26,851 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:15:39,111 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:15:40,116 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:15:40,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:40,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:56,330 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:15:56,330 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:16:05,589 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:16:05,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:16:05,700 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:16:05,701 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:16:05,769 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:16:07,097 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:16:07,370 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:16:12,306 - ispa_next.functions - DEBUG - Updated appointment (AA00062825) customer contact data.
2025-11-17 14:16:13,245 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:16:13,247 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:16:15,108 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:16:15,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:16:16,369 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:16:20,044 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:16:20,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:16:20,552 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:16:22,559 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:16:22,711 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:16:22,881 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:16:23,010 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:16:23,011 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:16:25,014 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:16:36,385 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:16:44,541 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:16:44,542 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:16:48,932 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 14:16:52,224 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:16:57,200 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:16:58,223 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:16:58,224 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:16:58,224 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:16:58,384 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:17:02,541 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:17:03,442 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:17:14,019 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:17:14,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:14,169 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:17:24,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:24,646 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:24,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:25,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:17:25,571 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:17:27,511 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:17:27,524 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:17:29,634 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:17:29,635 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:17:29,640 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:17:29,642 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:17:29,647 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:17:29,649 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:17:29,651 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:17:29,652 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:17:29,653 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:17:29,654 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:17:29,657 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:17:30,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:17:31,452 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:18:01,784 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:18:01,787 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:18:01,789 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:18:01,789 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:04,475 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:18:04,477 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:18:04,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:07,310 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:18:07,312 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:18:07,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:18:08,180 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:18:08,454 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:18,340 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:18:18,342 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:18:18,345 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:18:18,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:18:19,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:18:19,854 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:28,865 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:18:34,832 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:18:40,452 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:18:40,454 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:18:40,455 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:18:41,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:18:41,337 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:18:41,339 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:18:41,366 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:18:47,108 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 14:18:47,112 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:18:47,804 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 14:18:47,806 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:18:52,339 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 14:18:52,340 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:18:53,623 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 14:18:53,634 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 14:18:53,649 - ispa_next.main - DEBUG - 



2025-11-17 14:18:53,649 - ispa_next.main - DEBUG - starting with process 9 (SLÜ-IH 11) of 16
2025-11-17 14:18:53,654 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:18:55,550 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:18:57,690 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 14:18:57,691 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 14:18:59,842 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:18:59,843 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:19:51,463 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:20:03,989 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:20:06,019 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:20:06,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:06,133 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:20:06,456 - ispa_next.functions - DEBUG - HU date soon to be invalid in 74 days.
2025-11-17 14:20:15,752 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:20:15,755 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:20:18,915 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:20:18,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:20:20,729 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:20:22,733 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:20:22,877 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:20:23,024 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:20:23,159 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:20:23,161 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:20:25,192 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:20:37,134 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:20:38,138 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:20:38,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:38,650 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:54,414 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:20:54,414 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:21:04,540 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:21:04,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:04,631 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:04,632 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:21:04,698 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:21:06,095 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:21:07,783 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:21:08,049 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:21:12,878 - ispa_next.functions - DEBUG - Updated appointment (AC00069344) customer contact data.
2025-11-17 14:21:13,825 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:21:13,828 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:21:15,278 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:21:15,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:21:16,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:21:20,354 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:21:20,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:21:20,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:21:22,835 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:21:22,997 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:21:23,176 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:21:23,343 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:21:23,345 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:25,487 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:21:37,328 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:22:37,330 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:22:48,602 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:22:56,311 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:22:56,313 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:22:58,390 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:23:02,641 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:23:03,648 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:23:03,649 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:23:03,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:23:03,776 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:23:08,008 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:23:08,013 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:23:08,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:23:08,142 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:23:08,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:23:09,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:23:09,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:23:09,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:23:09,960 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:23:11,925 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:23:11,926 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:23:13,323 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:23:13,327 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:23:13,331 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:23:13,333 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:23:13,335 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:23:13,336 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:23:13,337 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:23:13,338 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:23:13,340 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:23:13,341 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:23:13,343 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:23:14,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:23:15,071 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:23:44,219 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:23:44,221 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:23:44,223 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:23:44,223 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:46,897 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:23:46,899 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:23:46,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:49,604 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:23:49,607 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:23:49,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:23:50,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:23:50,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:59,975 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:23:59,977 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:23:59,979 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:24:00,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:24:01,302 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:24:01,511 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:10,192 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:24:15,956 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:24:15,959 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:24:15,961 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:24:16,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:24:17,034 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:24:17,036 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:24:17,066 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:24:22,308 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 14:24:22,311 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:24:22,818 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 14:24:22,819 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:24:26,944 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-17 14:24:26,945 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:24:28,190 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 14:24:28,200 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 14:24:28,211 - ispa_next.main - DEBUG - 



2025-11-17 14:24:28,211 - ispa_next.main - DEBUG - starting with process 10 (MKK-NL 108) of 16
2025-11-17 14:24:28,215 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:24:30,408 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:24:32,228 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 14:24:32,229 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-17 14:24:34,227 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:24:34,228 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:25:23,240 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:25:36,048 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:38,050 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:25:38,051 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:38,133 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:25:38,410 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:25:38,412 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:25:41,470 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:25:41,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:25:43,532 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:25:45,535 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:25:45,710 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:25:45,864 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:25:45,966 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:25:45,968 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:47,997 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:25:59,469 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:26:07,346 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:26:07,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:09,560 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:26:13,831 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:26:14,837 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:26:14,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:15,439 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:26,990 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 14:26:36,014 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:26:36,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:36,123 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:26:36,124 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:26:36,180 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:26:37,529 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:26:38,664 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:26:38,860 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:26:44,226 - ispa_next.functions - DEBUG - Updated appointment (AC00069339) customer contact data.
2025-11-17 14:26:45,145 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:26:45,192 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:26:46,548 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:26:46,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:26:47,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:26:52,620 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:26:52,620 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:26:52,709 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:26:52,711 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:26:52,767 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:26:53,872 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:26:58,040 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:26:59,206 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:27:10,796 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:27:10,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:27:10,982 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:27:11,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:11,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:11,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:27:12,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:27:12,839 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:27:15,450 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:27:15,452 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:27:17,063 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:27:17,065 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:27:17,067 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:27:17,068 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:27:17,071 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:27:17,073 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:27:17,077 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:27:17,081 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:27:17,092 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:27:17,096 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:27:17,098 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:27:17,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:27:19,014 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:27:48,275 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:27:48,278 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:27:48,280 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:27:48,280 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:27:51,646 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 14:27:56,514 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:27:56,574 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:27:56,584 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:00,323 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:28:00,325 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:28:00,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:28:01,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:28:01,492 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:11,552 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:28:11,554 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:28:11,556 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:28:12,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:28:13,022 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:28:13,239 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:23,654 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:28:32,409 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:28:38,634 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:28:45,246 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:28:45,249 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:28:45,250 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:28:46,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:28:46,301 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:28:46,302 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:28:46,327 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:28:52,221 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 14:28:52,224 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:28:52,844 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:28:52,845 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:28:57,356 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 14:28:57,357 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:28:58,566 - ispa_next.appointments.models - DEBUG - Appointment Norbert Döppenschmitt GN-D 2808 WBA11AV0X0FM48014 ohne Termin.
2025-11-17 14:28:58,576 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 14:28:58,588 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 14:28:58,601 - ispa_next.main - DEBUG - 



2025-11-17 14:28:58,601 - ispa_next.main - DEBUG - starting with process 11 (FD-OH 108) of 16
2025-11-17 14:28:58,607 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:29:00,539 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:29:02,413 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:29:02,414 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 14:29:04,746 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:29:04,748 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:29:48,923 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:30:01,750 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:30:08,692 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:30:08,693 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:08,781 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:30:09,084 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:30:09,087 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:30:12,381 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:30:12,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:30:14,389 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:30:16,394 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:30:16,530 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:30:16,736 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:30:16,851 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:30:16,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:30:24,178 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:30:36,299 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:30:37,304 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:30:37,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:37,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:53,260 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:30:53,260 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:31:02,500 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:31:02,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:02,625 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:31:02,626 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:31:02,673 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:31:04,160 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:31:04,427 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:31:08,437 - ispa_next.functions - DEBUG - Updated appointment (AA00062823) customer contact data.
2025-11-17 14:31:09,408 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:31:09,411 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:31:10,956 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:31:10,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:31:12,454 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:31:16,131 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:31:16,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:16,656 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:31:18,675 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:31:18,854 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:31:18,992 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:31:19,162 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:31:19,163 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:26,346 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:31:38,349 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:32:38,351 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:32:49,803 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:32:57,640 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:32:57,641 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:33:05,148 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:33:09,378 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:33:10,386 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:33:10,387 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:33:10,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:33:10,548 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:33:14,723 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:33:15,965 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:33:26,478 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:33:26,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:33:26,585 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:33:36,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:33:36,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:33:36,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:33:37,674 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:33:37,675 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:33:43,991 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:33:43,993 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:33:45,625 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:33:45,626 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:33:45,628 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:33:45,634 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:33:45,637 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:33:45,639 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:33:45,641 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:33:45,643 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:33:45,644 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:33:45,646 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:33:45,648 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:33:46,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:33:47,559 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:34:16,054 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:34:16,057 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:34:16,059 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:34:16,059 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:34:23,914 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:34:23,916 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:34:23,919 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:34:31,609 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:34:32,115 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:34:41,670 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:35:03,144 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:35:03,146 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:35:03,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:35:04,580 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:35:04,811 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:35:20,081 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:35:20,083 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:35:20,085 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:35:20,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:35:21,376 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:35:21,532 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:35:35,360 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:35:43,831 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:35:51,325 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:35:57,911 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:36:04,608 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:36:10,344 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:36:15,938 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:36:22,401 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:36:29,727 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:36:36,452 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:36:36,454 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:36:36,455 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:36:37,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:36:37,577 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:36:37,579 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:36:37,607 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:36:44,381 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 14:36:44,385 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:36:45,143 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:36:45,144 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:36:50,830 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 14:36:50,831 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:36:52,119 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 14:36:52,128 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 14:36:52,146 - ispa_next.main - DEBUG - Found new Appointment: GN-D 2808
2025-11-17 14:36:52,149 - ispa_next.main - DEBUG - 



2025-11-17 14:36:52,149 - ispa_next.main - DEBUG - starting with process 12 (GN-D 2808) of 17
2025-11-17 14:36:52,153 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:36:53,975 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:36:55,806 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:36:55,808 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 14:36:57,836 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:36:57,837 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:37:41,918 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:37:55,530 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:37:57,570 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:37:57,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:37:57,658 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:37:58,183 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:37:58,189 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:38:01,251 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:38:01,252 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:38:03,191 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:38:05,196 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:38:05,382 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:38:05,579 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:38:05,742 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:38:05,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:38:07,805 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:38:19,939 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:38:20,945 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:38:20,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:38:21,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:38:37,074 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:38:37,075 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:38:47,649 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:38:47,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:38:47,771 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:38:47,772 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:38:47,836 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:38:49,242 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:38:49,486 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:38:54,764 - ispa_next.functions - DEBUG - Updated appointment (AI00013603) customer contact data.
2025-11-17 14:38:55,750 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:38:55,757 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:38:57,724 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:38:57,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:38:59,274 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:39:02,939 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:39:02,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:39:03,454 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:39:05,457 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:39:05,674 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:39:05,875 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:39:06,002 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:39:06,003 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:39:08,021 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:39:19,663 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:40:19,669 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:40:31,557 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:40:42,559 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:40:54,166 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:41:04,373 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:41:05,380 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:41:05,381 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:41:05,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:41:05,494 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:41:09,687 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:41:09,691 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:41:09,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:41:09,794 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:41:10,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:41:10,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:41:10,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:41:11,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:41:11,507 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:41:13,377 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:41:13,380 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:41:14,543 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:41:14,544 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:41:14,545 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:41:14,546 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:41:14,548 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:41:14,549 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:41:14,550 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:41:14,551 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:41:14,552 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:41:14,554 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:41:14,556 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:41:15,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:41:16,345 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:41:45,394 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:41:45,397 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:41:45,399 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:41:45,399 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:41:48,063 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:41:48,065 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:41:48,070 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:41:50,734 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:41:50,736 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:41:50,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:41:51,745 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:41:51,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:42:02,044 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:42:02,046 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:42:02,048 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:42:02,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:42:03,367 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:42:03,581 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:42:14,234 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:42:20,340 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:42:26,882 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:42:26,884 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:42:26,885 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:42:27,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:42:27,661 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:42:27,662 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:42:27,693 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:42:32,849 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 14:42:32,853 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:42:33,593 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:42:33,594 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:42:39,271 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 14:42:39,271 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:42:40,431 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 14:42:40,441 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 14:42:40,451 - ispa_next.main - DEBUG - 



2025-11-17 14:42:40,452 - ispa_next.main - DEBUG - starting with process 13 (FD-DA 1111) of 17
2025-11-17 14:42:40,455 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:42:42,272 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:42:44,064 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:42:44,066 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 14:42:46,718 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-17 14:42:46,719 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:42:47,201 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 40, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 148, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-17 14:42:47,202 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 14:42:47,212 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:42:47,991 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:42:47,993 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-17 14:42:52,497 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 14:42:52,498 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:42:53,700 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 14:42:53,709 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 14:42:53,719 - ispa_next.main - DEBUG - 



2025-11-17 14:42:53,719 - ispa_next.main - DEBUG - starting with process 14 (SLÜ-LD 207) of 17
2025-11-17 14:42:53,723 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:42:55,539 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:42:57,422 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:42:57,424 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 14:42:59,667 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:42:59,668 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:43:42,626 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:43:56,701 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:44:02,923 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:44:02,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:03,043 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:44:03,468 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:44:03,471 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:44:06,775 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:44:06,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:44:08,687 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:44:10,696 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:44:10,837 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:44:10,950 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:44:11,050 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:44:11,051 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:44:17,528 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:44:29,960 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:44:30,965 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:44:30,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:31,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:37,760 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 14:44:37,764 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:44:37,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:37,853 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:44:37,855 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:44:37,963 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:44:39,271 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:44:39,472 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:44:43,466 - ispa_next.functions - DEBUG - Updated appointment (AA00062821) customer contact data.
2025-11-17 14:44:44,453 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:44:44,455 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:44:45,873 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:44:45,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:44:47,470 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:44:51,124 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:44:51,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:44:51,602 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:44:53,606 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:44:53,789 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:44:53,960 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:44:54,111 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:44:54,113 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:45:00,658 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:45:12,191 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:45:20,145 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:45:20,147 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:45:27,391 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:45:31,622 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:45:32,628 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:45:32,629 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:45:32,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:45:32,765 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:45:36,904 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:45:38,171 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:45:50,131 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:45:50,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:45:50,229 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:45:58,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:45:59,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:45:59,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:46:00,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:46:00,194 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:46:05,701 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:46:05,703 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:46:07,463 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:46:07,465 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:46:07,467 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:46:07,468 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:46:07,474 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:46:07,479 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:46:07,481 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:46:07,484 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:46:07,485 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:46:07,487 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:46:07,489 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:46:08,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:46:09,380 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:46:38,267 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:46:38,269 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:46:38,271 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:46:38,272 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:46:45,359 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:46:45,361 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:46:45,363 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:46:52,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:46:53,005 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:47:03,692 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:47:03,695 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:47:03,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:47:06,576 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:47:06,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:47:19,067 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:47:19,073 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:47:19,075 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:47:19,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:47:20,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:47:20,795 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:47:34,571 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:47:42,070 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:47:48,960 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:47:55,730 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:48:02,317 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:48:09,039 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:48:15,544 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:48:22,336 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:48:29,803 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:48:29,806 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:48:29,807 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:48:30,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:48:31,023 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:48:31,024 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:48:31,051 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:48:37,762 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 14:48:37,766 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:48:38,403 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:48:38,404 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:48:43,130 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 14:48:43,131 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:48:44,415 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 14:48:44,424 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 14:48:44,436 - ispa_next.main - DEBUG - 



2025-11-17 14:48:44,436 - ispa_next.main - DEBUG - starting with process 15 (MKK-KH 310) of 17
2025-11-17 14:48:44,440 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:48:47,048 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:48:48,829 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:48:48,831 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 14:48:50,956 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:48:50,958 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:49:28,884 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:49:40,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:49:41,088 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:49:41,271 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:49:42,465 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:49:42,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:49:42,557 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:49:43,008 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:49:43,011 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:49:46,019 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:49:46,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:49:48,221 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:49:50,227 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:49:50,410 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:49:53,700 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:49:53,793 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:49:53,794 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:49:55,177 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:50:07,233 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:50:08,239 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:50:08,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:08,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:22,710 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:50:22,710 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:50:31,778 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:50:31,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:31,870 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:50:31,871 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:50:31,936 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:50:33,238 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:50:34,586 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:50:35,403 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:50:40,873 - ispa_next.functions - DEBUG - Updated appointment (AC00069282) customer contact data.
2025-11-17 14:50:41,869 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:50:41,871 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:50:43,230 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:50:43,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:50:44,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:50:48,247 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:50:48,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:50:48,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:50:50,767 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:50:50,929 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:50:51,079 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:50:51,179 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:50:51,181 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:50:52,595 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:51:04,823 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:52:04,826 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:52:17,335 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:52:29,337 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:52:41,189 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:52:50,531 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:52:51,539 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:52:51,540 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:52:51,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:52:51,644 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:52:55,836 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:52:55,842 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:52:55,842 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 14:52:55,843 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:52:57,265 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:52:57,269 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:52:58,668 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:52:58,669 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:52:58,671 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:52:58,672 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:52:58,674 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:52:58,675 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:52:58,678 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:52:58,679 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:52:58,682 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:52:58,702 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:52:58,704 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:52:59,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:53:00,614 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:53:30,639 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:53:30,641 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:53:30,643 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:53:30,643 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:53:32,608 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:53:32,610 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:53:32,612 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:53:34,524 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:53:34,526 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:53:34,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:53:35,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:53:35,358 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:53:35,360 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:53:35,362 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:53:35,861 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:53:36,632 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:53:36,836 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:53:45,414 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:53:51,790 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:53:51,792 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:53:51,793 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:53:52,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:53:52,814 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:53:52,816 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:53:52,841 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:53:58,399 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 14:53:58,402 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:53:59,203 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:53:59,204 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:54:04,044 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 14:54:04,045 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:54:05,274 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 14:54:05,283 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 14:54:05,292 - ispa_next.main - DEBUG - 



2025-11-17 14:54:05,293 - ispa_next.main - DEBUG - starting with process 16 (MKK-KX 57) of 17
2025-11-17 14:54:05,297 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:54:07,230 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:54:09,075 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:54:09,077 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 14:54:11,382 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:54:11,383 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:55:06,322 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:55:19,738 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:55:25,396 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:55:25,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:25,508 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:55:25,861 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:55:25,864 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:55:28,927 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:55:28,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:55:30,680 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:55:32,696 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:55:32,880 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:55:33,010 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:55:33,181 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:55:33,182 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:55:38,942 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:55:50,674 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:55:58,727 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:55:58,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:56:06,019 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motoröl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 14:56:09,668 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:56:12,992 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:56:13,998 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:56:14,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:56:14,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:56:30,809 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:56:42,087 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:56:42,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:56:42,195 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:56:42,196 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:56:42,255 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:56:43,608 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:56:43,878 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:56:49,203 - ispa_next.functions - DEBUG - Updated appointment (AC00069277) customer contact data.
2025-11-17 14:56:50,202 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:56:50,206 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:56:52,618 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:56:52,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:56:54,233 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:56:57,867 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:56:57,868 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:56:57,871 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:56:57,872 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:56:57,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:56:58,406 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:57:02,646 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:57:03,818 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:57:15,685 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:57:15,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:57:15,769 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:57:16,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:57:16,666 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:57:16,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:57:17,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:57:17,507 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:57:22,544 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:57:22,547 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:57:24,814 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:57:24,816 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:57:24,818 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:57:24,820 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:57:24,823 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:57:24,825 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:57:24,827 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:57:24,830 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:57:24,832 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:57:24,835 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:57:24,865 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:57:25,683 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:57:26,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:57:55,917 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:57:55,921 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:57:55,924 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:57:55,925 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:58:02,315 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 14:58:14,133 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:58:14,332 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:58:14,371 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:58:21,223 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:58:21,225 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:58:21,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:58:22,346 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:58:22,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:58:43,939 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:58:43,942 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:58:43,944 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:58:44,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:58:45,536 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:58:45,735 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:58:58,807 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:59:08,016 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:59:14,180 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:59:23,445 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:59:30,249 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:59:36,915 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:59:43,514 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:59:50,622 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:59:50,624 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:59:50,625 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:59:51,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:59:51,767 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:59:51,768 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:59:51,800 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:59:58,242 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 14:59:58,246 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:59:59,022 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 14:59:59,024 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:00:04,168 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 15:00:04,169 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:00:05,411 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 15:00:05,421 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 15:00:05,432 - ispa_next.main - DEBUG - 



2025-11-17 15:00:05,432 - ispa_next.main - DEBUG - starting with process 17 (SLÜ-SF 64) of 17
2025-11-17 15:00:05,437 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:00:07,858 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:00:10,767 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 15:00:10,769 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 15:00:14,034 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:00:14,036 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:01:01,296 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:01:16,043 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:01:18,007 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:01:18,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:01:18,110 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:01:18,416 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:01:18,418 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:01:21,433 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:01:21,435 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:01:23,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:01:25,766 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:01:25,927 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:01:29,175 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:01:29,343 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:01:29,344 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:01:31,484 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:01:44,154 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:01:45,160 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:01:45,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:01:45,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:02:00,647 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:02:00,647 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:02:11,572 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:02:11,575 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:02:11,710 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:02:11,711 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:02:11,795 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:02:13,231 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:02:13,563 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:02:18,129 - ispa_next.functions - DEBUG - Updated appointment (AA00062820) customer contact data.
2025-11-17 15:02:19,190 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:02:19,192 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:02:20,423 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:02:20,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:02:22,021 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:02:26,134 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 15:02:26,135 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:02:26,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:02:26,741 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:02:28,746 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:02:28,888 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:02:29,045 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:02:29,147 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:02:29,148 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:02:31,364 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:02:43,941 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:03:43,943 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:03:55,724 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:04:03,596 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:04:03,598 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:04:05,744 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:04:09,957 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:04:10,964 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:04:10,965 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:04:10,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:04:11,119 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:04:15,280 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:04:15,284 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:04:15,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:04:15,375 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:04:23,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:04:24,583 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:04:24,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:04:25,575 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:04:25,575 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:04:27,650 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:04:27,658 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:04:29,436 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:04:29,438 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:04:29,439 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 15:04:29,441 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:04:29,442 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:04:29,444 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:04:29,445 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:04:29,446 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:04:29,447 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:04:29,449 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:04:29,450 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:04:30,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:04:31,537 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:05:01,476 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:05:01,480 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:05:01,481 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:05:01,482 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:04,305 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:05:04,307 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:05:04,312 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:07,081 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:05:07,083 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:05:07,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:05:08,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:05:08,277 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:15,452 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:05:15,454 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:05:15,456 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:05:16,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:05:17,035 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:05:17,438 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:27,180 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:05:33,725 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:05:33,728 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:05:33,728 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:05:34,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:05:34,548 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:05:34,550 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 15:05:34,580 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:05:42,145 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 15:05:42,149 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:05:42,768 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 15:05:42,770 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:05:47,535 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 15:05:47,536 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:05:49,723 - ispa_next.appointments.models - DEBUG - Appointment Simon Koerdt MTK-P 5555 WBA11BJ070CF89901 ohne Termin.
2025-11-17 15:05:49,732 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
