2025-11-12 10:00:31,746 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:00:31,783 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:00:44,686 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:00:57,167 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:01:12,902 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:01:45,872 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:01:57,246 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:02:01,224 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:02:02,121 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2234
2025-11-12 10:02:02,123 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 619
2025-11-12 10:02:04,386 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 433
2025-11-12 10:02:04,386 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:02:04,387 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:02:05,664 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:02:06,969 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:09,507 - ispa_next.appointments.models - DEBUG - Appointment Johann Resch LÖ-RL 1113 WBAVN11030VN23279 ohne Termin.
2025-11-12 10:03:09,536 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:03:09,615 - ispa_next.appointments.models - DEBUG - Appointment betaplan GmbH LÖ-BS 7119 WBA41CM0108E22810 ohne Termin.
2025-11-12 10:03:09,618 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:03:09,654 - ispa_next.appointments.models - DEBUG - Appointment Elektro Rütten GmbH LÖ-ER 3003 WBS61AY0X0FS27171 ohne Termin.
2025-11-12 10:03:09,685 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:03:09,703 - ispa_next.appointments.models - DEBUG - Appointment Martins Alves Miguel BL 161006 WMW51DK0102S61307 ohne Termin.
2025-11-12 10:03:09,708 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:03:09,745 - ispa_next.appointments.models - DEBUG - Appointment Nasim Gul BS 21650 WBAWX710000G77966 ohne Termin.
2025-11-12 10:03:09,790 - ispa_next.appointments.models - DEBUG - Appointment Werner Osterwalder BL 34340 WBA3T71020PW23796 ohne Termin.
2025-11-12 10:03:09,810 - ispa_next.appointments.models - DEBUG - Appointment Vahap Yilmaz LÖ-VY 23 WBAWZ510300M14799 ohne Termin.
2025-11-12 10:03:09,829 - ispa_next.appointments.models - DEBUG - Appointment Norbert Pogorzelski M-HV 2094E WBA41GV0X0CV22369 ohne Termin.
2025-11-12 10:03:09,847 - ispa_next.appointments.models - DEBUG - Appointment   WBAFF01060L211755 ohne Termin.
2025-11-12 10:03:09,872 - ispa_next.appointments.models - DEBUG - Appointment Walter Schwarz LÖ-WH 97 WBAVP51000VM67447 ohne Termin.
2025-11-12 10:03:09,892 - ispa_next.appointments.models - DEBUG - Appointment Dagmar Klipp BL 181288 WMWXR510102M31464 ohne Termin.
2025-11-12 10:03:09,911 - ispa_next.appointments.models - DEBUG - Appointment Perihan Hasserbetrci BS 31642 WBA11FL08RCR21472 ohne Termin.
2025-11-12 10:03:09,930 - ispa_next.appointments.models - DEBUG - Appointment Kevin Spettl LÖ-K 956 WBS3C91060P708776 ohne Termin.
2025-11-12 10:03:09,947 - ispa_next.appointments.models - DEBUG - Appointment Mady Wattiau DZ-892-BN WBAVP71090V210069 ohne Termin.
2025-11-12 10:03:09,990 - ispa_next.main - DEBUG - Found 15 out of 146 appointments to process (configured limit: 15).
2025-11-12 10:03:09,991 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-12 10:03:09,991 - ispa_next.main - DEBUG - Processing 11 already visited appointments (w/ RKR not callable).
2025-11-12 10:03:09,992 - ispa_next.main - DEBUG - All appointments: LÖ-IK 9781, LÖ-M6H, LÖ-AN 995, LÖ-AH 1030, LÖ-ZV 777, BL 190121, LÖ-G 6670, GP-708-TR, LÖ-EE 2122, LÖ-H 2406, LÖ-RP 112E, LÖ-AS 801, BS 14468, LÖ-DO 6666, LÖ-WR 836
2025-11-12 10:03:09,994 - ispa_next.main - DEBUG - 



2025-11-12 10:03:09,994 - ispa_next.main - DEBUG - starting with process 1 (LÖ-IK 9781) of 15
2025-11-12 10:03:09,999 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:03:11,007 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:03:12,137 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2234
2025-11-12 10:03:12,138 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 433
2025-11-12 10:03:13,493 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:03:13,495 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:46,984 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:03:47,057 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:03:47,063 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:03:47,431 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2234
2025-11-12 10:03:47,431 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:03:49,516 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 619
2025-11-12 10:03:49,517 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:50,408 - ispa_next.appointments.models - DEBUG - Appointment Johann Resch LÖ-RL 1113 WBAVN11030VN23279 ohne Termin.
2025-11-12 10:03:50,423 - ispa_next.appointments.models - DEBUG - Appointment Dirk Glaser LÖ-GV 150 WBA7K110607M04941 ohne Termin.
2025-11-12 10:03:50,435 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:03:50,442 - ispa_next.main - DEBUG - 



2025-11-12 10:03:50,442 - ispa_next.main - DEBUG - starting with process 2 (LÖ-M6H) of 15
2025-11-12 10:03:50,447 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:03:51,655 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:03:53,062 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2234
2025-11-12 10:03:53,063 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 619
2025-11-12 10:03:54,530 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:03:54,531 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:04:23,474 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:04:23,485 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:04:23,490 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:04:24,117 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2234
2025-11-12 10:04:24,119 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:04:26,492 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 619
2025-11-12 10:04:26,492 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:04:27,243 - ispa_next.appointments.models - DEBUG - Appointment Johann Resch LÖ-RL 1113 WBAVN11030VN23279 ohne Termin.
2025-11-12 10:04:27,252 - ispa_next.appointments.models - DEBUG - Appointment Dirk Glaser LÖ-GV 150 WBA7K110607M04941 ohne Termin.
2025-11-12 10:04:27,268 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:04:27,274 - ispa_next.main - DEBUG - 



2025-11-12 10:04:27,274 - ispa_next.main - DEBUG - starting with process 3 (LÖ-AN 995) of 15
2025-11-12 10:04:27,278 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:04:28,156 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:04:29,058 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2234
2025-11-12 10:04:29,059 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 619
2025-11-12 10:04:30,398 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:04:30,399 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:05:08,015 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:05:08,025 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:05:08,028 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:05:08,736 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2234
2025-11-12 10:05:08,738 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:05:11,301 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 619
2025-11-12 10:05:11,302 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:05:12,207 - ispa_next.appointments.models - DEBUG - Appointment Johann Resch LÖ-RL 1113 WBAVN11030VN23279 ohne Termin.
2025-11-12 10:05:12,218 - ispa_next.appointments.models - DEBUG - Appointment Dirk Glaser LÖ-GV 150 WBA7K110607M04941 ohne Termin.
2025-11-12 10:05:12,231 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:05:12,237 - ispa_next.main - DEBUG - 



2025-11-12 10:05:12,237 - ispa_next.main - DEBUG - starting with process 4 (LÖ-AH 1030) of 15
2025-11-12 10:05:12,242 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:05:13,541 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:05:14,838 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2234
2025-11-12 10:05:14,840 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 619
2025-11-12 10:05:16,178 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:05:16,180 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:05:41,844 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:05:51,833 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:05:59,159 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:05:59,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:05:59,241 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:05:59,428 - ispa_next.functions - DEBUG - HU date already expired after 148 days.
2025-11-12 10:06:07,015 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:06:07,018 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:06:09,871 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:06:09,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:06:10,713 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:06:12,717 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:06:12,823 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:06:12,948 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:06:13,032 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:06:13,032 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:06:20,523 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:06:28,945 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:06:29,954 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:06:29,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:30,442 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:42,852 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:06:50,905 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:06:50,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:51,024 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:06:51,024 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:06:51,071 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:06:51,189 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:06:52,525 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:06:52,810 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:06:55,091 - ispa_next.functions - DEBUG - Updated appointment (AW00006148) customer contact data.
2025-11-12 10:06:55,988 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:06:55,991 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:06:56,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:06:56,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:06:58,082 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:06:58,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:06:58,145 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:07:01,811 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:07:01,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:07:02,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:07:04,399 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:07:04,495 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:07:04,607 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:07:04,667 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:07:04,669 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:12,783 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:07:21,346 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:08:21,353 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:08:29,594 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:08:42,598 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:08:50,674 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:08:58,182 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 10:08:59,196 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:08:59,200 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:08:59,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:08:59,289 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:08:59,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:00,140 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:00,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:09:00,847 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:09:00,849 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:09:07,870 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:09:07,874 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:09:09,036 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:09:09,038 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:09:09,042 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:09:09,044 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:09:09,047 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:09:09,048 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:09:09,049 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:09:09,050 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:09:09,051 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:09:09,052 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:09:09,056 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:09:09,058 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:09:09,058 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:09:17,010 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:09:19,385 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:09:19,387 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:09:19,390 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:09:19,392 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:09:19,395 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:09:19,397 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:09:27,413 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:09:27,415 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:09:27,417 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:09:27,417 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:09:28,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:09:28,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:09:28,848 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:09:30,695 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:09:40,519 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:09:40,891 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:09:41,395 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:43,550 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2235
2025-11-12 10:09:43,550 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:09:46,416 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 619
2025-11-12 10:09:46,417 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:09:47,360 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:09:47,366 - ispa_next.main - DEBUG - Found new Appointment: LÖ-RL 1113
2025-11-12 10:09:47,366 - ispa_next.main - DEBUG - Found new Appointment: LÖ-GV 150
2025-11-12 10:09:47,368 - ispa_next.main - DEBUG - 



2025-11-12 10:09:47,368 - ispa_next.main - DEBUG - starting with process 5 (LÖ-RL 1113) of 17
2025-11-12 10:09:47,372 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:09:48,631 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:49,789 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2235
2025-11-12 10:09:49,790 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 619
2025-11-12 10:09:51,295 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:09:51,296 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:23,210 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:10:33,099 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:10:34,315 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:10:34,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:34,398 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:10:34,599 - ispa_next.functions - DEBUG - HU date already expired after 2457 days.
2025-11-12 10:10:41,694 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:10:41,697 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:10:44,489 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:10:44,490 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:10:45,453 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:10:47,458 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:10:53,329 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 10:10:59,892 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 10:11:00,898 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:11:00,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:01,404 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:07,568 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 10:11:07,572 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:11:07,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:07,662 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:11:07,663 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:11:07,699 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:11:07,814 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:11:09,228 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:11:09,446 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:11:11,567 - ispa_next.functions - DEBUG - Updated appointment (AB00091556) customer contact data.
2025-11-12 10:11:12,486 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:11:12,488 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:11:12,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:11:13,344 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:11:14,799 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:11:14,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:11:15,202 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:11:19,247 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:11:19,247 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:11:19,247 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:11:19,251 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:11:19,255 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:11:19,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:11:19,771 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:11:20,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:20,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:20,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:11:21,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:11:21,471 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:11:23,356 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:11:23,358 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:11:24,335 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:11:24,339 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:11:24,343 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-12 10:11:24,345 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:11:24,349 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:11:24,358 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:11:24,362 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:11:24,366 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:11:24,366 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:11:24,387 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:11:24,390 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:11:25,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:11:25,804 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:11:35,005 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:11:35,008 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:11:35,010 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:11:35,010 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:11:37,627 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:11:37,631 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:11:37,634 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:11:37,638 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:11:37,640 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:11:37,642 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:11:40,141 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:11:40,143 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:11:40,145 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:11:40,145 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:11:40,609 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:11:41,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:11:41,203 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:11:42,525 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:11:48,910 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:11:49,295 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:11:49,822 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:51,734 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2235
2025-11-12 10:11:51,736 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:54,047 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 618
2025-11-12 10:11:54,047 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:54,687 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:11:54,693 - ispa_next.main - DEBUG - 



2025-11-12 10:11:54,693 - ispa_next.main - DEBUG - starting with process 6 (LÖ-GV 150) of 17
2025-11-12 10:11:54,699 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:11:55,587 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:56,410 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2235
2025-11-12 10:11:56,411 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 618
2025-11-12 10:11:57,583 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:57,584 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:12:19,690 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:12:29,751 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:32,975 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:12:32,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:33,040 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:12:33,225 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:12:33,228 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:12:36,045 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:12:36,045 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:36,989 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:12:38,991 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:12:39,082 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:12:39,163 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:12:39,234 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:12:43,394 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:12:44,401 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:12:44,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:44,901 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:56,369 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:12:56,369 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:13:03,837 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:13:03,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:03,909 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:13:03,909 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:13:03,982 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:13:05,242 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:13:05,486 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:13:09,008 - ispa_next.functions - DEBUG - Updated appointment (AB00091557) customer contact data.
2025-11-12 10:13:09,922 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:13:09,926 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:13:10,688 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:13:10,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:13:11,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:13:15,896 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:13:15,896 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:13:15,900 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:13:15,907 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:13:15,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:13:16,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:13:25,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:26,302 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:26,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:13:26,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:13:26,986 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:13:30,632 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:13:30,634 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:13:31,692 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:13:31,693 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:13:31,695 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:13:31,697 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:13:31,699 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:13:31,699 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:13:31,701 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:13:31,701 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:13:31,703 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:13:31,705 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:13:31,709 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:13:31,711 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:13:31,713 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:35,678 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:13:38,128 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:13:38,132 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:13:38,135 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:13:38,138 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:13:38,140 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:13:38,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:42,099 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:13:42,102 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:13:42,105 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:13:42,106 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:13:43,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:13:43,726 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:13:43,728 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:13:45,559 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:13:53,359 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:13:53,731 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:13:54,165 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:13:56,186 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2235
2025-11-12 10:13:56,187 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:13:58,569 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 617
2025-11-12 10:13:58,570 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:13:59,394 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:13:59,400 - ispa_next.main - DEBUG - 



2025-11-12 10:13:59,400 - ispa_next.main - DEBUG - starting with process 7 (LÖ-ZV 777) of 17
2025-11-12 10:13:59,405 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:00,635 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:01,897 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2235
2025-11-12 10:14:01,899 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 617
2025-11-12 10:14:03,489 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:03,490 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:14:27,668 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:14:29,703 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:14:35,000 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:40,371 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:14:40,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:40,455 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:14:40,803 - ispa_next.functions - DEBUG - HU date already expired after 2482 days.
2025-11-12 10:14:45,026 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:14:45,030 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:14:47,905 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:14:47,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:14:48,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:14:50,850 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:14:50,958 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:14:51,043 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:14:51,108 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:14:53,236 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:14:54,242 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:14:54,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:54,733 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:10,532 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:15:14,126 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:15:14,128 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:14,239 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:15:14,239 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:15:14,276 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:15:15,492 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:15:16,865 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:15:17,103 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:15:18,708 - ispa_next.functions - DEBUG - Updated appointment (BA00005034) customer contact data.
2025-11-12 10:15:19,607 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:15:19,611 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:15:20,393 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:15:20,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:15:21,483 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:15:25,056 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:15:25,056 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:15:25,060 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:15:25,062 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:15:25,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:25,610 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:15:25,989 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:26,504 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:26,504 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:27,187 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:15:27,187 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:15:31,913 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:15:31,914 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:15:32,895 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:15:32,898 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:15:32,901 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:15:32,903 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:15:32,906 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:15:32,908 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:15:32,917 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:15:32,918 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:15:32,920 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:15:32,921 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:15:32,923 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:15:32,927 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:15:32,927 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:38,284 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:15:38,288 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:15:38,290 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:15:38,293 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:15:38,295 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:15:38,297 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:43,552 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:15:43,555 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:15:43,557 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:15:43,558 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:15:44,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:15:44,965 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:15:44,967 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:15:46,628 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:15:54,196 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:15:54,575 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 10:15:55,129 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:15:57,429 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2236
2025-11-12 10:15:57,431 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:15:59,979 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 617
2025-11-12 10:15:59,980 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:00,719 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:16:00,727 - ispa_next.main - DEBUG - 



2025-11-12 10:16:00,727 - ispa_next.main - DEBUG - starting with process 8 (BL 190121) of 17
2025-11-12 10:16:00,732 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:16:01,635 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:02,789 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2236
2025-11-12 10:16:02,791 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 617
2025-11-12 10:16:04,336 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:04,337 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:33,877 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:16:35,991 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:16:41,560 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:52,285 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:16:52,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:52,392 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:16:52,526 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:16:56,879 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:16:56,882 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:16:59,713 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:16:59,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:17:00,723 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:17:02,726 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:17:02,816 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:17:02,888 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:17:03,009 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:17:05,142 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:17:06,147 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:17:06,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:06,641 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:18,563 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:17:22,310 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:17:22,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:22,391 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:17:22,392 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:17:22,424 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:17:22,511 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:17:23,613 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:17:23,826 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:17:25,172 - ispa_next.functions - DEBUG - Updated appointment (AE00033504) customer contact data.
2025-11-12 10:17:26,270 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:17:26,276 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:17:26,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:17:27,042 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:17:28,009 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:17:28,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:17:28,085 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:17:31,678 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:17:31,680 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:17:31,682 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:17:31,686 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:17:31,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:17:32,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:17:32,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:33,231 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:33,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:17:33,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:17:33,927 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:17:43,524 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:17:43,528 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:17:44,863 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:17:44,865 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:17:44,870 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:17:44,872 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:17:44,874 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:17:44,876 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:17:44,878 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:17:44,880 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:17:44,880 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:17:44,882 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:17:44,886 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:17:44,889 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:17:44,889 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:17:55,747 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:17:58,432 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:17:58,436 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:17:58,442 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:17:58,448 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:17:58,456 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:17:58,471 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:09,311 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:18:09,326 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:18:09,333 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:18:09,333 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:18:10,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:18:10,964 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:18:10,966 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:18:12,637 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:18:20,852 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:18:21,237 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 10:18:21,836 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:18:23,817 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2236
2025-11-12 10:18:23,818 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:18:26,278 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 617
2025-11-12 10:18:26,281 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:18:27,005 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:18:27,011 - ispa_next.main - DEBUG - 



2025-11-12 10:18:27,012 - ispa_next.main - DEBUG - starting with process 9 (LÖ-G 6670) of 17
2025-11-12 10:18:27,016 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:18:27,940 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:18:28,819 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2236
2025-11-12 10:18:28,820 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 617
2025-11-12 10:18:30,129 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:18:30,131 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:19:03,019 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:19:04,644 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:19:09,307 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:15,288 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:19:15,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:15,377 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:19:15,524 - ispa_next.functions - DEBUG - HU date already expired after 1934 days.
2025-11-12 10:19:19,359 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:19:19,363 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:19:22,117 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:19:22,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:23,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:19:25,122 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:19:25,236 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:19:25,309 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:19:25,404 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:19:27,548 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:19:28,552 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:19:28,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:29,036 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:43,695 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:19:48,294 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:19:48,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:48,412 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:19:48,414 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:19:48,470 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:19:48,589 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:19:49,862 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:19:50,091 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:19:51,708 - ispa_next.functions - DEBUG - Updated appointment (AE00033475) customer contact data.
2025-11-12 10:19:52,614 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:19:52,617 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:19:52,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:19:53,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:19:54,981 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:19:54,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:19:55,065 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:19:58,647 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:19:58,647 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:19:58,651 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:19:58,656 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:19:58,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:59,167 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:19:59,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:20:00,083 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:20:00,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:20:00,824 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:20:00,825 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:20:06,224 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:20:06,226 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:20:07,400 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:20:07,402 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:20:07,404 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:20:07,406 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:20:07,408 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:20:07,410 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:20:07,412 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:20:07,412 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:20:07,414 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:20:07,416 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:20:07,420 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:20:07,422 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:20:07,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:20:13,469 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:20:13,471 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:20:13,475 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:20:13,477 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:20:13,481 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:20:13,483 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:20:19,480 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:20:19,484 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:20:19,486 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:20:19,486 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:20:20,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:20:20,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:20:20,938 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:20:22,478 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:20:29,185 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:20:29,583 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 10:20:30,161 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:32,302 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2237
2025-11-12 10:20:32,304 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:20:34,892 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 615
2025-11-12 10:20:34,893 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:20:35,669 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:20:35,675 - ispa_next.main - DEBUG - 



2025-11-12 10:20:35,675 - ispa_next.main - DEBUG - starting with process 10 (GP-708-TR) of 17
2025-11-12 10:20:35,678 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:20:36,661 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:37,628 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2237
2025-11-12 10:20:37,629 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 615
2025-11-12 10:20:38,861 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:20:38,862 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:05,760 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:21:07,818 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:21:13,034 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:19,018 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:21:19,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:19,081 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:21:19,390 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:21:23,508 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:21:23,513 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:21:26,318 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:21:26,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:21:27,417 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:21:29,423 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:21:29,519 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:21:29,636 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:21:29,697 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:21:33,890 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:21:34,895 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:21:34,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:35,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:48,136 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:21:52,829 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:21:52,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:52,896 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:21:52,897 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:21:52,941 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:21:54,206 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:21:54,409 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:21:55,972 - ispa_next.functions - DEBUG - Updated appointment (AL00012822) customer contact data.
2025-11-12 10:21:56,896 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:21:56,899 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:21:58,183 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:21:58,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:21:59,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:22:03,060 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:22:03,060 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:22:03,060 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:22:03,064 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:22:03,068 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:22:03,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:22:03,613 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:22:03,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:04,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:04,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:22:05,283 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:22:05,283 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:22:10,595 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:22:10,596 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:22:11,523 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:22:11,526 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:22:11,530 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:22:11,532 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:22:11,534 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:22:11,534 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:22:11,536 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:22:11,536 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:22:11,538 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:22:11,540 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:22:11,544 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:22:11,546 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:22:11,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:22:17,631 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:22:17,634 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:22:17,637 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:22:17,640 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:22:17,643 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:22:17,645 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:22:23,616 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:22:23,619 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:22:23,621 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:22:23,621 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:22:24,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:22:25,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:22:25,002 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:22:27,012 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:22:35,310 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:22:35,697 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 10:22:36,318 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:22:38,239 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2237
2025-11-12 10:22:38,241 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:22:40,887 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 614
2025-11-12 10:22:40,888 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:22:41,597 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:22:41,603 - ispa_next.main - DEBUG - 



2025-11-12 10:22:41,603 - ispa_next.main - DEBUG - starting with process 11 (LÖ-EE 2122) of 17
2025-11-12 10:22:41,606 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:22:42,582 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:22:43,687 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2237
2025-11-12 10:22:43,689 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 614
2025-11-12 10:22:45,251 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:22:45,253 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:23:18,609 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:23:20,404 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:23:25,015 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:26,894 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:23:26,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:26,984 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:23:27,166 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:23:27,169 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:23:29,842 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:23:29,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:31,467 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:23:33,471 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:23:33,574 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:23:33,639 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:23:33,727 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:23:37,919 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:23:38,926 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:23:38,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:39,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:50,681 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:23:54,824 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:23:54,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:54,894 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:23:54,895 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:23:54,942 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:23:56,244 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:23:56,457 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:23:58,063 - ispa_next.functions - DEBUG - Updated appointment (AD00049115) customer contact data.
2025-11-12 10:23:59,055 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:23:59,057 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:24:00,216 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:24:00,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:24:01,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:24:04,738 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:24:04,738 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:24:04,742 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:24:04,746 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:24:04,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:24:05,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:24:09,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:09,607 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:09,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:24:10,345 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:24:10,345 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:24:12,230 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:24:12,232 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:24:13,176 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:24:13,183 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:24:13,189 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:24:13,190 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:24:13,191 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:24:13,192 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:24:13,193 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:24:13,196 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:24:13,197 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:24:13,199 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:24:13,202 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:24:13,204 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:24:13,204 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:15,106 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:24:15,108 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:24:15,110 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:24:15,112 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:24:15,115 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:24:15,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:17,021 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:24:17,023 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:24:17,025 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:24:17,025 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:24:17,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:24:18,336 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:24:18,338 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:24:20,113 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:24:28,361 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:24:28,757 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 10:24:29,404 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:24:31,186 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2237
2025-11-12 10:24:31,188 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:24:34,355 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 613
2025-11-12 10:24:34,356 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:24:35,253 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:24:35,259 - ispa_next.main - DEBUG - 



2025-11-12 10:24:35,259 - ispa_next.main - DEBUG - starting with process 12 (LÖ-H 2406) of 17
2025-11-12 10:24:35,264 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:24:36,427 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:24:37,826 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2237
2025-11-12 10:24:37,827 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 613
2025-11-12 10:24:39,467 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:24:39,469 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:03,231 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:25:04,939 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:25:10,213 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:14,835 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:25:14,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:14,904 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:25:15,059 - ispa_next.functions - DEBUG - HU date already expired after 2450 days.
2025-11-12 10:25:18,853 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:25:18,856 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:25:21,494 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:25:21,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:25:23,226 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:25:25,229 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:25:25,328 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:25:25,441 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:25:25,542 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:25:27,671 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:25:28,676 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:25:28,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:29,209 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:43,795 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:25:48,126 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:25:48,128 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:48,222 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:25:48,223 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:25:48,264 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:25:48,387 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:25:49,486 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:25:50,665 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:25:51,046 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:25:52,729 - ispa_next.functions - DEBUG - Updated appointment (AK00014048) customer contact data.
2025-11-12 10:25:53,728 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:25:53,732 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:25:54,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:25:55,045 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:25:56,097 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:25:56,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:25:56,189 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:26:00,224 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:26:00,224 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:26:00,229 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:26:00,234 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:26:00,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:00,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:26:01,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:01,634 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:01,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:02,406 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:26:02,408 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:26:06,706 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:26:06,711 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:26:11,312 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:26:11,313 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:26:11,315 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:26:11,317 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:26:11,318 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:26:11,320 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:26:11,322 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:26:11,324 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:26:11,326 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:26:11,328 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:26:11,348 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:26:11,351 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:26:11,351 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:15,951 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:26:15,955 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:26:15,957 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:26:15,959 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:26:15,963 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:26:15,969 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:20,580 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:26:20,584 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:26:20,586 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:26:20,588 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:26:21,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:26:22,500 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:26:22,502 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:26:24,424 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:26:33,085 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:26:33,475 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 10:26:34,245 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:26:36,081 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2237
2025-11-12 10:26:36,082 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:26:39,376 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 613
2025-11-12 10:26:39,377 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:26:40,382 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:26:40,390 - ispa_next.main - DEBUG - 



2025-11-12 10:26:40,390 - ispa_next.main - DEBUG - starting with process 13 (LÖ-RP 112E) of 17
2025-11-12 10:26:40,394 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:26:41,679 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:26:42,963 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2237
2025-11-12 10:26:42,964 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 613
2025-11-12 10:26:44,452 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:26:44,453 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:27:19,396 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:27:21,407 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:27:26,617 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:27:30,569 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:27:30,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:30,662 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:27:30,871 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:27:30,875 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:27:33,827 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:27:33,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:27:35,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:27:37,094 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:27:37,221 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:27:37,315 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:27:37,383 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:27:41,575 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:27:42,580 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:27:42,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:43,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:51,887 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:27:55,590 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:27:55,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:55,714 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:27:55,714 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:27:55,789 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:27:57,070 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:27:58,203 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:27:58,432 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:28:00,348 - ispa_next.functions - DEBUG - Updated appointment (AA00108103) customer contact data.
2025-11-12 10:28:01,300 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:28:01,302 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:28:01,908 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:28:01,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:28:02,857 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:28:06,424 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:28:06,424 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:28:06,429 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:28:06,435 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:28:06,435 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:28:06,907 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:28:15,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:16,261 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:16,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:28:16,990 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:28:16,992 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:28:20,581 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:28:20,583 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:28:22,099 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:28:22,100 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:28:22,101 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:28:22,102 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:28:22,104 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:28:22,105 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:28:22,106 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:28:22,106 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:28:22,108 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:28:22,112 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:28:22,114 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:28:22,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:26,139 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:28:26,141 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:28:26,143 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:28:26,147 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:28:26,149 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:28:26,155 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:30,061 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:28:30,065 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:28:30,069 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:28:30,069 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:28:30,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:28:31,741 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:28:31,743 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:28:34,284 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:28:42,911 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:28:43,287 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 10:28:43,628 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:28:46,906 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2238
2025-11-12 10:28:46,908 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:28:49,873 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 614
2025-11-12 10:28:49,874 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:28:50,675 - ispa_next.appointments.models - DEBUG - Appointment Marina Ruf LÖ-MR 2300 WMWSV31090T269989 ohne Termin.
2025-11-12 10:28:50,688 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:28:50,694 - ispa_next.main - DEBUG - 



2025-11-12 10:28:50,694 - ispa_next.main - DEBUG - starting with process 14 (LÖ-AS 801) of 17
2025-11-12 10:28:50,699 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:28:52,152 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:28:53,484 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2238
2025-11-12 10:28:53,485 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 614
2025-11-12 10:28:55,011 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:28:55,012 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:29:30,181 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:29:32,150 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:29:37,560 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:41,589 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:29:41,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:41,701 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:29:41,882 - ispa_next.functions - DEBUG - HU date already expired after 2554 days.
2025-11-12 10:29:46,213 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:29:46,216 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:29:49,010 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:29:49,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:29:50,187 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:29:52,194 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:29:52,287 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:29:52,412 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:29:52,505 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:29:54,636 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:29:55,642 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:29:55,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:56,132 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:10,403 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:30:14,472 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:30:14,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:14,606 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:30:14,606 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:30:14,650 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:30:15,912 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:30:16,124 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:30:17,866 - ispa_next.functions - DEBUG - Updated appointment (AA00111686) customer contact data.
2025-11-12 10:30:18,819 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:30:18,821 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:30:19,660 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:30:19,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:30:21,096 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:30:25,074 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:30:25,074 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:30:25,078 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:30:25,091 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:30:25,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:30:25,596 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:30:25,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:26,467 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:26,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:30:27,083 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:30:27,083 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:30:30,684 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:30:30,686 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:30:32,714 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:30:32,716 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:30:32,718 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:30:32,719 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:30:32,721 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:30:32,723 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:30:32,725 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:30:32,727 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:30:32,729 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:30:32,731 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:30:32,737 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:30:32,739 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:30:32,740 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:36,619 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:30:36,622 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:30:36,624 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:30:36,626 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:30:36,629 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:30:36,629 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:40,547 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:30:40,550 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:30:40,553 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:30:40,554 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:30:41,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:30:42,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:30:42,219 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:30:44,174 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:30:51,418 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:30:51,786 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 10:30:52,605 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:30:54,272 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2238
2025-11-12 10:30:54,273 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:30:57,491 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 615
2025-11-12 10:30:57,492 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:30:58,438 - ispa_next.appointments.models - DEBUG - Appointment Marina Ruf LÖ-MR 2300 WMWSV31090T269989 ohne Termin.
2025-11-12 10:30:58,451 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:30:58,456 - ispa_next.main - DEBUG - 



2025-11-12 10:30:58,456 - ispa_next.main - DEBUG - starting with process 15 (BS 14468) of 17
2025-11-12 10:30:58,460 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:30:59,746 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:31:00,969 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2238
2025-11-12 10:31:00,970 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 615
2025-11-12 10:31:02,619 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:31:02,621 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:31:30,438 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:31:32,540 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:31:38,272 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:41,609 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:31:41,609 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:31:41,684 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:31:41,911 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:31:46,148 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:31:46,152 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:31:49,010 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:31:49,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:31:50,317 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:31:52,323 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:31:52,449 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:31:52,532 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:31:52,653 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:31:56,885 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:31:57,891 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:31:57,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:31:58,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:12,814 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:32:16,802 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:32:16,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:16,900 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:32:16,900 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:32:16,974 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:32:17,111 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:32:18,669 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:32:18,869 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:32:20,653 - ispa_next.functions - DEBUG - Updated appointment (AE00033697) customer contact data.
2025-11-12 10:32:21,672 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:32:21,674 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:32:22,269 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:32:23,191 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:32:24,227 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:32:24,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:32:24,294 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:32:28,354 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:32:28,354 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:32:28,354 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:32:28,358 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:32:28,363 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:32:28,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:32:28,847 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:32:29,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:29,731 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:29,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:32:30,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:32:30,521 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:32:33,638 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:32:33,640 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:32:34,781 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:32:34,783 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:32:34,783 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:32:34,785 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:32:34,787 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:32:34,787 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:32:34,787 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:32:34,789 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:32:34,790 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:32:34,791 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:32:34,795 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:32:34,797 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:32:34,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:32:38,079 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:32:38,083 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:32:38,085 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:32:38,087 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:32:38,090 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:32:38,092 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:32:41,449 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:32:41,453 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:32:41,455 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:32:41,456 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:32:42,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:32:42,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:32:42,990 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:32:44,874 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:32:53,213 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:32:53,597 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 10:32:54,287 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:32:57,308 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2238
2025-11-12 10:32:57,309 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:33:00,783 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 617
2025-11-12 10:33:00,784 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:33:01,878 - ispa_next.appointments.models - DEBUG - Appointment Waldshut-INTERN M-UC 1251A WMWYW310403L62460 ohne Termin.
2025-11-12 10:33:01,891 - ispa_next.appointments.models - DEBUG - Appointment Marina Ruf LÖ-MR 2300 WMWSV31090T269989 ohne Termin.
2025-11-12 10:33:01,904 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:33:01,909 - ispa_next.main - DEBUG - 



2025-11-12 10:33:01,909 - ispa_next.main - DEBUG - starting with process 16 (LÖ-DO 6666) of 17
2025-11-12 10:33:01,914 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:33:03,328 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:33:04,626 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2238
2025-11-12 10:33:04,628 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 617
2025-11-12 10:33:06,267 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:33:06,267 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:33:33,649 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:33:35,697 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:33:41,675 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:33:46,410 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:33:46,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:46,481 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:33:46,835 - ispa_next.functions - DEBUG - HU date already expired after 3248 days.
2025-11-12 10:33:51,004 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:33:51,008 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:33:53,830 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:33:53,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:33:55,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:33:57,548 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:33:57,648 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:33:57,731 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:33:57,836 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:33:57,838 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:02,673 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:34:11,453 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:34:12,458 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:34:12,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:34:12,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:34:25,544 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:34:29,499 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:34:29,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:34:29,562 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:34:29,562 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:34:29,652 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:34:29,798 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:34:30,980 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:34:32,129 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:34:32,453 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:34:34,241 - ispa_next.functions - DEBUG - Updated appointment (AC00064971) customer contact data.
2025-11-12 10:34:35,201 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:34:35,204 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:34:35,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:34:36,887 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:34:38,045 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:34:38,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:34:38,120 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:34:42,221 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:34:42,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:34:42,710 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:34:44,713 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:34:44,804 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:34:44,918 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:34:44,993 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:34:44,995 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:49,806 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:34:58,303 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:35:58,306 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:36:07,429 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:36:34,431 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:36:42,947 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:36:50,899 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 10:36:51,906 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:36:51,909 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:36:51,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:36:51,996 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:36:52,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:52,902 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:52,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:36:53,686 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:36:53,686 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:36:57,898 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:36:57,903 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:36:59,716 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:36:59,718 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:36:59,720 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:36:59,722 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:36:59,724 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:36:59,725 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:36:59,726 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:36:59,727 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:36:59,729 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:36:59,730 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:36:59,740 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:36:59,744 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:36:59,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:37:04,581 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:37:04,585 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:37:04,588 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:37:04,590 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:37:04,594 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:37:04,596 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:37:09,306 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:37:09,309 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:37:09,313 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:37:09,313 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:37:10,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:37:11,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:37:11,029 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:37:12,926 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:37:21,162 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:37:21,570 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 10:37:22,040 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:37:24,525 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2238
2025-11-12 10:37:24,526 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:37:27,795 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 616
2025-11-12 10:37:27,796 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:37:28,655 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:37:28,660 - ispa_next.main - DEBUG - Found new Appointment: M-UC 1251A
2025-11-12 10:37:28,660 - ispa_next.main - DEBUG - Found new Appointment: LÖ-MR 2300
2025-11-12 10:37:28,662 - ispa_next.main - DEBUG - 



2025-11-12 10:37:28,662 - ispa_next.main - DEBUG - starting with process 17 (M-UC 1251A) of 19
2025-11-12 10:37:28,666 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:37:29,864 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:37:31,246 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2238
2025-11-12 10:37:31,247 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 616
2025-11-12 10:37:32,835 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:37:32,837 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:38:08,731 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:38:17,634 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:20,978 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:38:20,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:21,055 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:38:21,229 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:38:21,232 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:38:24,113 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:38:24,115 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:25,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:38:27,319 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:38:27,439 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:38:27,561 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:38:27,654 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:38:31,818 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:38:32,824 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:38:32,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:33,288 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:48,528 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:38:56,486 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:38:56,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:56,590 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:38:56,590 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:38:56,656 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:38:56,793 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:38:57,896 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:38:59,158 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:38:59,488 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:39:01,378 - ispa_next.functions - DEBUG - Updated appointment (AB00091561) customer contact data.
2025-11-12 10:39:02,389 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:39:02,393 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:39:02,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:39:03,437 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:39:05,076 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:39:05,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:39:05,422 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:39:09,470 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:39:09,470 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:39:09,470 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:39:09,474 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:39:09,478 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:39:09,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:39:09,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:39:13,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:39:14,307 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:39:14,307 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:39:14,987 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:39:14,988 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:39:18,760 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:39:18,775 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:39:19,714 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:39:19,716 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:39:19,716 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:39:19,719 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:39:19,721 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:39:19,721 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:39:19,723 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:39:19,723 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:39:19,725 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:39:19,726 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:39:19,730 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:39:19,732 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:39:19,734 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:24,238 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:39:24,241 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:39:24,243 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:39:24,247 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:39:24,249 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:39:24,251 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:28,204 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:39:28,206 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:39:28,210 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:39:28,210 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:39:29,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:39:29,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:39:29,741 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:39:31,139 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:39:39,615 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:39:39,999 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 10:39:40,636 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:39:43,151 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2238
2025-11-12 10:39:43,151 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:39:45,973 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 613
2025-11-12 10:39:45,974 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:39:46,732 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:39:46,739 - ispa_next.main - DEBUG - 



2025-11-12 10:39:46,739 - ispa_next.main - DEBUG - starting with process 18 (LÖ-MR 2300) of 19
2025-11-12 10:39:46,743 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:39:47,721 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:39:48,700 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2238
2025-11-12 10:39:48,701 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 613
2025-11-12 10:39:50,281 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-12 10:39:50,282 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:39:50,624 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 42, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 146, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-12 10:39:50,624 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 10:39:50,629 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:39:51,130 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2238
2025-11-12 10:39:51,132 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-12 10:39:53,698 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 613
2025-11-12 10:39:53,699 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:39:54,721 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 10:39:54,726 - ispa_next.main - DEBUG - 



2025-11-12 10:39:54,726 - ispa_next.main - DEBUG - starting with process 19 (LÖ-WR 836) of 19
2025-11-12 10:39:54,730 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:39:56,033 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:39:57,318 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2238
2025-11-12 10:39:57,319 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 613
2025-11-12 10:39:59,034 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:39:59,036 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:40:27,632 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:40:29,435 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:40:34,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:40:42,896 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:40:42,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:40:42,988 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:40:43,252 - ispa_next.functions - DEBUG - HU date soon to be invalid in 8 days.
2025-11-12 10:40:47,658 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:40:47,660 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:40:50,538 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:40:50,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:40:51,609 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:40:53,612 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:40:53,722 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:40:53,806 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:40:53,871 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:40:53,873 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:02,200 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:41:10,617 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:41:11,621 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:41:11,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:12,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:23,452 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:41:27,593 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:41:27,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:27,686 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:27,689 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:41:27,720 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:41:27,840 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:41:28,975 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:41:29,203 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:41:30,832 - ispa_next.functions - DEBUG - Updated appointment (AC00064674) customer contact data.
2025-11-12 10:41:31,728 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:41:31,743 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:41:32,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:41:33,419 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:41:34,477 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:41:34,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:41:34,554 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:41:38,136 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:41:38,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:41:38,607 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:41:40,610 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:41:40,709 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:41:40,822 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:41:40,882 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:41:40,884 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:49,190 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:41:57,757 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:42:57,769 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:43:06,835 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:43:27,838 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:43:39,463 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 10:43:45,255 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:43:45,256 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:54,384 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:43:56,501 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:43:57,512 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:43:57,518 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:43:57,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:43:57,585 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:44:08,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:09,175 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:09,177 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:44:09,848 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:44:09,848 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:44:17,439 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:44:17,441 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:44:18,517 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:44:18,518 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:44:18,520 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:44:18,522 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:44:18,527 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 10:44:18,530 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:44:18,534 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:44:18,534 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:44:18,536 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:44:18,552 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 10:44:21,622 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:22,179 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:44:22,701 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:44:24,226 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:24,795 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:44:25,317 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:44:26,855 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:27,386 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:44:27,909 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:44:29,444 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:29,980 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:44:30,515 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:44:32,049 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:32,613 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:44:33,137 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:44:34,668 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:35,214 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:44:35,748 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:44:37,262 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:37,793 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:44:38,315 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:44:39,846 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:40,392 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:44:40,934 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:44:42,462 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:42,999 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:44:43,546 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:44:45,091 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:45,637 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:44:46,304 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:44:47,805 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:48,355 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:44:48,876 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:44:50,390 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:50,913 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:44:51,462 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:44:54,535 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:44:55,472 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 10:44:56,301 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:44:56,319 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:44:56,336 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:45:04,538 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:45:06,949 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:45:06,951 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:45:06,953 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:45:06,955 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:45:06,958 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:45:06,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:45:15,119 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:45:15,121 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:45:15,123 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:45:15,123 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:45:15,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:45:16,546 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:45:16,549 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:45:18,456 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:45:27,411 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:45:27,817 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 10:45:28,425 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:45:30,412 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2239
2025-11-12 10:45:30,414 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:45:33,702 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 613
2025-11-12 10:45:33,703 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:45:34,724 - ispa_next.appointments.models - DEBUG - Appointment Eric Schreiber GL-221-ER WBA21EA0407L73404 ohne Termin.
2025-11-12 10:45:34,760 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
