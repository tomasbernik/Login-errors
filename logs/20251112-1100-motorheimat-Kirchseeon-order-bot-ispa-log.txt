2025-11-12 11:00:34,335 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:00:34,344 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:00:47,718 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:00:58,299 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:01:13,827 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:01:38,119 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:01:49,693 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:01:53,096 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:01:53,866 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 957
2025-11-12 11:01:53,866 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 465
2025-11-12 11:01:55,812 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 410
2025-11-12 11:01:55,813 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:01:55,813 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:01:56,892 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:01:58,093 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:02:54,750 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:54,803 - ispa_next.appointments.models - DEBUG - Appointment Ratko Kos-Igel Herr M-E 5984 WBAJN31060B378248 ohne Termin.
2025-11-12 11:02:54,823 - ispa_next.appointments.models - DEBUG - Appointment Franz-Michael von Morenhoffen Herr M-VM 1945 WMW11GD0602W56385 ohne Termin.
2025-11-12 11:02:54,844 - ispa_next.appointments.models - DEBUG - Appointment Andreas Pletschacher Herr M-S 7268 WMW11GA0607N78892 ohne Termin.
2025-11-12 11:02:54,853 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:54,875 - ispa_next.appointments.models - DEBUG - Appointment ZEBE-Zeichenbüro Ebersberg Frau EBE-ZB 999 WMWJZ31040TP30810 ohne Termin.
2025-11-12 11:02:54,891 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:54,923 - ispa_next.appointments.models - DEBUG - Appointment Erich Pudelko Herr EBE-EP 11 WBA21EA0307N15581 ohne Termin.
2025-11-12 11:02:54,973 - ispa_next.appointments.models - DEBUG - Appointment Markus Deppe Herr M-MD 6407 WMWLV310802U83186 ohne Termin.
2025-11-12 11:02:54,992 - ispa_next.appointments.models - DEBUG - Appointment Petra Wichert Frau M-PW 2302 WBAUH31030E525919 ohne Termin.
2025-11-12 11:02:55,008 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Trepte Herr STA-GW 131 WBA2A51000V427342 ohne Termin.
2025-11-12 11:02:55,021 - ispa_next.appointments.models - DEBUG - Appointment Firma Open Text Software GmbH M-M 1684E WBA21GV030CW39508 ohne Termin.
2025-11-12 11:02:55,035 - ispa_next.appointments.models - DEBUG - Appointment Herbert Kuhn Herr M-KT 4350 WBAEJ11080AF78090 ohne Termin.
2025-11-12 11:02:55,049 - ispa_next.appointments.models - DEBUG - Appointment Firma curare - Verein zur Förderung EBE-C 204 WBA21EA0307L92610 ohne Termin.
2025-11-12 11:02:55,062 - ispa_next.appointments.models - DEBUG - Appointment Hans-Dieter Krill Herr M-DK 2695 WBA3U11040J871366 ohne Termin.
2025-11-12 11:02:55,076 - ispa_next.appointments.models - DEBUG - Appointment Aldin Hecimovic Herr EBE-AD 216 WBA2E510305G50482 ohne Termin.
2025-11-12 11:02:55,089 - ispa_next.appointments.models - DEBUG - Appointment Firma Global Concerts GmbH M-SZ 1171 WBA21EF0605018576 ohne Termin.
2025-11-12 11:02:55,107 - ispa_next.appointments.models - DEBUG - Appointment Brigitte Fertich Frau EBE-FJ 111 WBAXB31040DW54269 ohne Termin.
2025-11-12 11:02:55,120 - ispa_next.appointments.models - DEBUG - Appointment Daniela Felbrich Frau ED-JS 396 WBY8P210207F54741 ohne Termin.
2025-11-12 11:02:55,134 - ispa_next.appointments.models - DEBUG - Appointment Patrick Gaßler Herr TS-GP 2299 WBA4C31090G785518 ohne Termin.
2025-11-12 11:02:55,147 - ispa_next.appointments.models - DEBUG - Appointment Firma MT Treuhand München M-MN 48 WBSUJ010209G32986 ohne Termin.
2025-11-12 11:02:55,160 - ispa_next.main - DEBUG - Found 13 out of 57 appointments to process (configured limit: 15).
2025-11-12 11:02:55,161 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-12 11:02:55,161 - ispa_next.main - DEBUG - Processing 8 already visited appointments (w/ RKR not callable).
2025-11-12 11:02:55,161 - ispa_next.main - DEBUG - All appointments: EBE-GW 703, EBE-H 722E, EBE-HP 351, M-X 8740, EBE-XC 42, WS BJ 2015, EBE-FM 57, M-ZE 1903, WS-M 505, EBE-AS 109, M-MV 6001, EBE-XV 60, EBE-AU 51
2025-11-12 11:02:55,163 - ispa_next.main - DEBUG - 



2025-11-12 11:02:55,163 - ispa_next.main - DEBUG - starting with process 1 (EBE-GW 703) of 13
2025-11-12 11:02:55,167 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:02:56,208 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:57,335 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 957
2025-11-12 11:02:57,337 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 410
2025-11-12 11:02:58,559 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:02:58,561 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:03:20,395 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:03:29,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:29,838 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:30,000 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:03:32,573 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:03:32,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:32,645 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:32,825 - ispa_next.functions - DEBUG - HU date already expired after 210 days.
2025-11-12 11:03:39,357 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:03:39,360 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:03:39,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:39,424 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:49,018 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:03:49,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:03:49,884 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:03:51,886 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:03:57,800 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 11:04:03,899 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 11:04:04,904 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:04:04,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:05,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:15,378 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:04:15,378 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:04:21,254 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:04:21,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:21,363 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:04:21,363 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:04:21,404 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:04:21,501 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:04:22,599 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 11:04:23,790 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 11:04:24,057 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:04:27,404 - ispa_next.functions - DEBUG - Updated appointment (AJ00018162) customer contact data.
2025-11-12 11:04:28,309 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:04:28,311 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:04:28,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:04:29,181 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:04:30,623 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:04:30,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:04:30,739 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:04:34,321 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:04:34,321 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:04:34,325 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:04:34,325 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:04:34,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:34,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:04:38,938 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:04:38,942 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:04:38,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:39,042 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:04:39,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:39,908 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:39,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:40,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:04:40,590 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:04:43,051 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:04:43,053 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:04:44,280 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:04:44,282 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:04:44,282 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:04:44,284 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:04:44,285 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:04:44,287 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:04:44,293 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:04:44,295 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:04:44,299 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:04:44,301 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:04:44,303 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:04:44,305 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:04:44,307 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:04:44,309 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:04:44,309 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:46,801 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:04:46,802 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:04:46,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:49,367 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:04:49,367 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:04:49,370 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:51,885 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:04:51,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:04:52,513 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:04:52,547 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:04:52,549 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:55,098 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:05:05,880 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:05:06,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:05:06,912 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:05:07,062 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:31,516 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:05:35,466 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:05:39,305 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:05:39,307 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:05:39,307 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:05:39,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:05:39,822 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:05:39,824 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:05:41,202 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:05:49,332 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:05:49,712 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:05:49,959 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:05:51,884 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 957
2025-11-12 11:05:51,884 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:05:54,585 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 465
2025-11-12 11:05:54,586 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:05:55,360 - ispa_next.main - DEBUG - Found new Appointment: EBE-VC 55
2025-11-12 11:05:55,362 - ispa_next.main - DEBUG - 



2025-11-12 11:05:55,362 - ispa_next.main - DEBUG - starting with process 2 (EBE-VC 55) of 14
2025-11-12 11:05:55,365 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:05:56,568 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:05:57,449 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 957
2025-11-12 11:05:57,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 465
2025-11-12 11:05:58,565 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:05:58,566 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:06:28,171 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:06:37,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:37,663 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:06:37,844 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:06:43,798 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:06:43,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:43,862 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:06:44,060 - ispa_next.functions - DEBUG - HU date already expired after 150 days.
2025-11-12 11:06:50,334 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:06:50,336 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:06:50,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:50,420 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:07:00,073 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:07:00,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:07:01,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:07:03,191 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:07:03,296 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:07:03,395 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:07:03,539 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:07:03,539 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:07:14,962 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:07:19,155 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:07:19,157 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:07:23,388 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:07:24,395 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:07:24,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:24,962 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:36,361 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:07:43,394 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:07:43,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:43,489 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:07:43,491 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:07:43,552 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:07:44,839 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:07:45,054 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:07:48,955 - ispa_next.functions - DEBUG - Updated appointment (AJ00018168) customer contact data.
2025-11-12 11:07:49,903 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:07:49,905 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:07:50,802 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:07:50,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:07:51,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:07:55,768 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:07:55,768 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:07:55,768 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:07:55,772 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:07:55,772 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:07:55,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:07:56,324 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:08:00,453 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:08:01,030 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:08:16,388 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:08:16,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:08:16,535 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:08:20,062 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:20,615 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:20,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:08:21,494 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:08:21,495 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:08:27,454 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:08:27,456 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:08:29,006 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:08:29,011 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:08:29,014 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:08:29,018 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:08:29,020 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:08:29,022 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:08:29,024 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:08:29,025 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:08:29,026 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:08:29,028 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:08:29,029 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:08:29,030 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:08:29,034 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:08:29,035 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:08:29,036 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:35,829 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:08:35,831 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:08:35,834 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:42,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:08:42,610 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:08:53,051 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:08:53,051 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:08:53,053 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:59,863 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:08:59,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:09:00,964 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:09:01,201 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:15,260 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:09:15,266 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:22,060 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:09:36,781 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:43,656 - ispa_next.common.mail - INFO - Successfully sent an email to 4 recipients
2025-11-12 11:09:43,676 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:09:44,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:09:44,772 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:09:44,938 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:51,623 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:10:56,961 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:02,145 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:07,400 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:13,163 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:18,087 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:23,908 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:29,791 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:34,624 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:34,626 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:11:34,626 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:35,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:11:35,458 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:11:35,459 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:11:37,470 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:11:48,373 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 11:11:48,376 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:11:48,377 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:49,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:11:49,381 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:11:49,383 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:11:51,602 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-12 11:11:51,633 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:11:54,201 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:11:54,205 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:59,199 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 957
2025-11-12 11:11:59,199 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:12:03,282 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 465
2025-11-12 11:12:03,282 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:04,356 - ispa_next.main - DEBUG - 



2025-11-12 11:12:04,356 - ispa_next.main - DEBUG - starting with process 3 (EBE-H 722E) of 14
2025-11-12 11:12:04,360 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:12:06,069 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:12:07,864 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 957
2025-11-12 11:12:07,866 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 465
2025-11-12 11:12:10,068 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:12:10,072 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:40,615 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:12:52,451 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:58,500 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:12:58,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:58,606 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:58,983 - ispa_next.functions - DEBUG - HU date soon to be invalid in 3 days.
2025-11-12 11:13:08,283 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:13:08,287 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:13:08,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:08,372 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:13:11,769 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:13:11,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:12,861 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:13:14,865 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:13:15,024 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:13:15,175 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:13:15,262 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:13:19,464 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:13:20,470 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:13:20,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:21,013 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:34,420 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:13:34,420 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:13:43,864 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:13:43,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:43,997 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:13:43,999 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:13:44,099 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:13:45,651 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:13:46,937 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:13:47,147 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:13:51,283 - ispa_next.functions - DEBUG - Updated appointment (AJ00018161) customer contact data.
2025-11-12 11:13:52,182 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:13:52,184 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:13:53,144 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:13:53,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:13:54,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:13:58,720 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:13:58,720 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:13:58,724 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:13:58,724 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:13:58,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:59,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:14:03,620 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:14:04,765 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:14:15,172 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:14:15,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:14:15,320 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:14:18,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:14:19,392 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:14:19,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:14:20,321 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:14:20,322 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:14:26,678 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:14:26,680 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:14:27,957 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:14:27,958 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:14:27,960 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:14:27,961 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:14:27,963 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:14:27,964 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:14:27,984 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 11:14:27,986 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:14:27,990 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:14:27,992 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:14:27,994 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:14:27,996 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 11:14:30,948 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:14:31,505 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:14:32,435 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:14:33,007 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:14:33,547 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:14:34,489 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:14:35,061 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:14:35,611 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:14:36,528 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:14:37,141 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:14:37,743 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:14:38,704 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:14:39,307 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:14:39,854 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:14:40,785 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:14:41,370 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:14:41,924 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:14:42,889 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:14:43,466 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:14:43,996 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:14:44,909 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:14:45,497 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:14:46,028 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:14:47,450 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:14:48,041 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:14:48,573 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:14:49,491 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:14:50,866 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:14:51,820 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:14:52,605 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:14:52,638 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:14:52,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:14:58,721 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:14:58,723 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:14:58,724 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:04,775 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:15:04,775 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:15:04,777 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:11,268 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:15:11,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:15:12,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:15:12,288 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:21,188 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:15:21,197 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:27,259 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:15:42,462 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:15:42,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:15:43,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:15:43,737 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:44,118 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:16:49,476 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:16:54,510 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:16:59,883 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:05,374 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:11,168 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:16,877 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:22,949 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:22,952 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:17:22,953 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:17:23,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:17:24,056 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:17:24,058 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:17:26,789 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:17:36,293 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:17:36,675 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:17:37,501 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:17:41,028 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 958
2025-11-12 11:17:41,031 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:17:45,620 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 466
2025-11-12 11:17:45,621 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:17:46,779 - ispa_next.main - DEBUG - Found new Appointment: WM-R 257
2025-11-12 11:17:46,781 - ispa_next.main - DEBUG - 



2025-11-12 11:17:46,781 - ispa_next.main - DEBUG - starting with process 4 (WM-R 257) of 15
2025-11-12 11:17:46,785 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:17:48,437 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:17:50,179 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 958
2025-11-12 11:17:50,180 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 466
2025-11-12 11:17:52,316 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:17:52,317 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:28,256 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:18:38,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:38,937 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:18:39,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:40,355 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:18:40,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:40,431 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:18:40,698 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:18:40,700 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:18:40,702 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:40,793 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:18:52,007 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:18:52,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:53,540 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:18:55,544 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:18:55,698 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:18:55,835 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:18:55,976 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:18:55,977 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:19:04,868 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:19:05,873 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:19:05,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:06,421 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:18,940 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:19:18,940 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:19:27,643 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:19:27,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:27,742 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:27,744 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:19:27,790 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:19:27,938 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:19:29,247 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:19:29,476 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:19:33,565 - ispa_next.functions - DEBUG - Updated appointment (AJ00018170) customer contact data.
2025-11-12 11:19:34,466 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:19:34,472 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:19:34,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:19:35,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:19:37,584 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:19:37,586 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:19:37,706 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:19:41,312 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:41,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:41,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:19:43,854 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:19:44,002 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:19:44,117 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:19:44,214 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:19:44,214 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:19:53,046 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:20:53,049 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:21:01,683 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:21:28,684 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:21:37,541 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:21:47,555 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:21:48,564 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:21:48,565 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:21:48,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:48,653 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:21:52,835 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:21:52,839 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:21:52,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:52,953 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:21:56,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:57,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:57,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:57,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:21:57,789 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:21:59,118 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:21:59,120 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:22:00,965 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:22:00,979 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:22:00,982 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:22:00,984 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:22:00,985 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:22:00,986 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:22:00,988 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:22:00,989 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:22:00,990 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:22:00,992 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:22:00,993 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:22:00,993 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:22:00,997 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:22:00,999 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:22:01,001 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:02,360 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:22:02,361 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:22:02,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:03,579 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:22:03,579 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:22:03,582 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:04,911 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:22:04,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:22:05,955 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:22:06,043 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:22:06,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:07,294 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:22:21,104 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:22:21,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:22,135 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:22:22,613 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:35,940 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:35,943 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:22:35,944 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:36,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:36,958 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:22:36,960 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:22:39,494 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:22:59,827 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 11:22:59,829 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:22:59,829 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:23:00,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:23:00,881 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:23:00,882 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:23:03,266 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-12 11:23:03,297 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:23:06,123 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:23:06,127 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:09,655 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 959
2025-11-12 11:23:09,655 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:14,525 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 467
2025-11-12 11:23:14,526 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:15,796 - ispa_next.main - DEBUG - Found new Appointment: EBE-DH 60
2025-11-12 11:23:15,798 - ispa_next.main - DEBUG - 



2025-11-12 11:23:15,798 - ispa_next.main - DEBUG - starting with process 5 (EBE-DH 60) of 16
2025-11-12 11:23:15,803 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:23:17,500 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:19,250 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 959
2025-11-12 11:23:19,251 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 467
2025-11-12 11:23:21,452 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:21,453 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:49,950 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:24:01,401 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:03,311 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:24:03,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:03,418 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:24:03,757 - ispa_next.functions - DEBUG - HU date soon to be invalid in 35 days.
2025-11-12 11:24:12,685 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:24:12,688 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:24:12,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:12,823 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:24:25,393 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:24:25,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:26,786 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:28,789 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:24:36,815 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 11:24:46,022 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 11:24:47,027 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:24:47,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:47,767 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:01,520 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:25:01,520 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:25:09,120 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:25:09,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:09,207 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:09,207 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:25:09,272 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:25:09,396 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:25:10,810 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:25:11,043 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:25:15,814 - ispa_next.functions - DEBUG - Updated appointment (AJ00018171) customer contact data.
2025-11-12 11:25:16,755 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:25:16,758 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:25:17,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:25:18,037 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:25:19,862 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:25:19,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:25:19,943 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:25:23,993 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:25:23,995 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:25:23,995 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:25:23,997 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:25:23,998 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:25:23,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:24,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:25:28,720 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:25:28,726 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:25:28,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:28,820 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:25:29,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:29,710 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:29,712 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:30,567 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:25:30,568 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:25:32,497 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:25:32,508 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:25:34,182 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:25:34,183 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:25:34,188 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:25:34,190 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:25:34,192 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:25:34,196 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:25:34,198 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:25:34,200 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:25:34,200 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:25:34,202 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:25:34,204 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:25:34,206 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:25:34,210 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:25:34,212 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:25:34,212 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:36,184 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:25:36,186 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:25:36,191 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:38,126 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:25:38,126 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:25:38,128 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:40,109 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:25:40,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:25:41,098 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:25:41,224 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:44,701 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:25:44,703 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:46,572 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:25:58,639 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:25:59,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:25:59,618 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:25:59,807 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:18,944 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:26:25,013 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:26:25,015 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:26:25,017 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:26:25,882 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:26:25,990 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:26:25,992 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:26:28,249 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:26:37,889 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:26:38,274 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:26:38,727 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:26:42,907 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 959
2025-11-12 11:26:42,911 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:26:47,266 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 467
2025-11-12 11:26:47,267 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:26:48,452 - ispa_next.main - DEBUG - 



2025-11-12 11:26:48,453 - ispa_next.main - DEBUG - starting with process 6 (EBE-HP 351) of 16
2025-11-12 11:26:48,478 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:26:50,251 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:26:52,033 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 959
2025-11-12 11:26:52,034 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 467
2025-11-12 11:26:54,172 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:26:54,174 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:27:24,794 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:27:36,762 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:40,135 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:27:40,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:40,231 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:27:40,601 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:27:49,290 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:27:49,292 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:27:49,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:49,369 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:28:01,583 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:28:01,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:28:03,602 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:28:05,609 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:28:13,522 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 11:28:22,309 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 11:28:23,315 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:28:23,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:23,825 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:38,733 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:28:48,119 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:28:48,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:48,236 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:28:48,236 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:28:48,300 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:28:48,455 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:28:49,804 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 11:28:51,142 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 11:28:51,513 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:28:55,213 - ispa_next.functions - DEBUG - Updated appointment (AJ00017805) customer contact data.
2025-11-12 11:28:56,156 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:28:56,157 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:28:56,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:28:57,435 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:28:59,172 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:28:59,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:28:59,273 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:29:03,330 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:29:03,330 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:29:03,333 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:29:03,334 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:29:03,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:03,924 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:29:08,050 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:29:08,053 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:29:08,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:08,185 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:29:08,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:09,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:09,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:09,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:29:09,995 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:29:13,087 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:29:13,101 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:29:14,973 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:29:14,973 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:29:14,975 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:29:14,977 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:29:14,977 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:29:14,979 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:29:14,979 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:29:14,981 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:29:14,981 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:29:14,983 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:29:14,985 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:29:14,987 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:29:14,989 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:29:14,991 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:29:14,991 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:18,316 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:29:18,318 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:29:18,320 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:21,635 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:29:21,635 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:29:21,637 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:24,931 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:29:24,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:29:26,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:29:26,058 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:29:26,069 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:29,435 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:29:43,813 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:29:44,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:29:44,849 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:29:45,077 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:59,544 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:29:59,546 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:30:00,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:30:00,336 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:30:00,337 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:30:04,107 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:30:20,840 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:30:21,231 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:30:21,950 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:30:25,546 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 959
2025-11-12 11:30:25,548 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-12 11:30:29,990 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 467
2025-11-12 11:30:29,991 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:30:31,165 - ispa_next.main - DEBUG - 



2025-11-12 11:30:31,165 - ispa_next.main - DEBUG - starting with process 7 (M-X 8740) of 16
2025-11-12 11:30:31,173 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:30:32,793 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:30:34,869 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 959
2025-11-12 11:30:34,870 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 467
2025-11-12 11:30:37,058 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:30:37,059 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:04,762 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:31:17,374 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:19,313 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:31:19,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:19,387 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:31:19,680 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:31:19,682 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:31:19,683 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:19,783 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:31:37,829 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:31:37,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:38,198 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 11:31:38,954 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 11:31:38,973 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:31:38,975 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:40,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:31:40,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:31:40,878 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 11:31:40,909 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:31:44,126 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:31:44,129 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:47,397 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 960
2025-11-12 11:31:47,399 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:31:52,367 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 468
2025-11-12 11:31:52,367 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:53,516 - ispa_next.appointments.models - DEBUG - Appointment Gerhard Binder Herr M-ON 60 WBA7K310607K47908 ohne Termin.
2025-11-12 11:31:53,522 - ispa_next.main - DEBUG - 



2025-11-12 11:31:53,522 - ispa_next.main - DEBUG - starting with process 8 (EBE-XC 42) of 16
2025-11-12 11:31:53,526 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:55,206 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:56,965 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 960
2025-11-12 11:31:56,966 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 468
2025-11-12 11:31:59,077 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:31:59,079 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:32:25,145 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:32:37,545 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:38,819 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:32:38,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:38,924 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:32:39,256 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:32:39,262 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:32:39,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:39,358 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:32:58,537 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:32:58,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:32:58,869 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 11:32:59,206 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 11:32:59,224 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:32:59,226 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:33:00,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:33:01,092 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:33:01,092 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 11:33:01,120 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:33:03,635 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:33:03,639 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:33:07,895 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 960
2025-11-12 11:33:07,897 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:33:12,643 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 468
2025-11-12 11:33:12,643 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:33:13,713 - ispa_next.appointments.models - DEBUG - Appointment Gerhard Binder Herr M-ON 60 WBA7K310607K47908 ohne Termin.
2025-11-12 11:33:13,719 - ispa_next.main - DEBUG - 



2025-11-12 11:33:13,719 - ispa_next.main - DEBUG - starting with process 9 (WS BJ 2015) of 16
2025-11-12 11:33:13,722 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:33:15,344 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:33:16,581 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 960
2025-11-12 11:33:16,583 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 468
2025-11-12 11:33:18,427 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:33:18,429 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:33:52,056 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:33:52,066 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:33:52,072 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:33:52,749 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 960
2025-11-12 11:33:52,751 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:33:57,381 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 468
2025-11-12 11:33:57,382 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:33:58,809 - ispa_next.appointments.models - DEBUG - Appointment Gerhard Binder Herr M-ON 60 WBA7K310607K47908 ohne Termin.
2025-11-12 11:33:58,816 - ispa_next.main - DEBUG - 



2025-11-12 11:33:58,816 - ispa_next.main - DEBUG - starting with process 10 (EBE-FM 57) of 16
2025-11-12 11:33:58,819 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:34:00,410 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:34:02,163 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 960
2025-11-12 11:34:02,165 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 468
2025-11-12 11:34:04,318 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:34:04,320 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:34:35,951 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:34:38,565 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:34:44,582 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:34:47,147 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:34:47,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:47,238 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:34:47,553 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:34:53,228 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:34:53,232 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:34:53,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:53,351 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:34:56,721 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:34:56,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:34:58,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:35:00,223 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:35:00,401 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:35:00,536 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:35:00,638 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:35:04,829 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:35:05,833 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:35:05,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:06,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:20,526 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:35:20,526 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:35:26,012 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:35:26,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:26,116 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:35:26,117 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:35:26,187 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:35:27,577 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:35:28,833 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:35:29,116 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:35:31,721 - ispa_next.functions - DEBUG - Updated appointment (AB00084453) customer contact data.
2025-11-12 11:35:32,641 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:35:32,642 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:35:33,749 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:35:33,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:35:34,710 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:35:38,742 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:35:38,742 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:35:38,745 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:35:38,746 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:35:38,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:35:39,273 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:35:43,423 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:35:43,429 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:35:43,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:35:43,519 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:35:49,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:49,698 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:49,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:35:50,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:35:50,544 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:35:53,039 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:35:53,041 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:35:54,733 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:35:54,734 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:35:54,736 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:35:54,737 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:35:54,738 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:35:54,739 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:35:54,744 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:35:54,748 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:35:54,752 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:35:54,754 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:35:54,755 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:35:54,757 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:35:54,759 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:35:54,761 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:35:54,761 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:57,381 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:35:57,383 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:35:57,385 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:59,973 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:35:59,973 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:35:59,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:02,582 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:36:02,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:36:03,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:36:03,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:15,427 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:36:15,430 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:18,159 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:36:32,547 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:36:33,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:36:33,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:36:33,971 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:59,804 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:37:04,766 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:37:10,334 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:37:10,336 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:37:10,338 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:37:11,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:37:11,884 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:37:11,885 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:37:14,392 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:37:25,021 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:37:25,420 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 11:37:26,268 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:37:29,869 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 960
2025-11-12 11:37:29,871 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:37:34,622 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 468
2025-11-12 11:37:34,623 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:37:35,925 - ispa_next.main - DEBUG - Found new Appointment: M-ON 60
2025-11-12 11:37:35,927 - ispa_next.main - DEBUG - 



2025-11-12 11:37:35,927 - ispa_next.main - DEBUG - starting with process 11 (M-ON 60) of 17
2025-11-12 11:37:35,933 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:37:37,788 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:37:39,560 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 960
2025-11-12 11:37:39,562 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 468
2025-11-12 11:37:41,828 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:37:41,830 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:38:14,295 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:38:26,665 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:28,585 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:38:28,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:28,666 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:38:28,936 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:38:28,938 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:38:28,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:29,034 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:38:32,448 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:38:32,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:38:33,814 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:38:35,820 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:38:35,992 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:38:36,131 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:38:36,267 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:38:40,483 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:38:41,489 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:38:41,491 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:42,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:56,083 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:38:56,083 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:39:05,737 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:39:05,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:39:05,826 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:39:05,828 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:39:05,954 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:39:06,077 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:39:07,393 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:39:07,613 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:39:11,867 - ispa_next.functions - DEBUG - Updated appointment (AJ00018175) customer contact data.
2025-11-12 11:39:12,862 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:39:12,875 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:39:13,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:39:14,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:39:16,107 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:39:16,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:39:16,219 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:39:20,297 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:39:20,297 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:39:20,300 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:39:20,301 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:39:20,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:39:20,813 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:39:25,013 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:39:25,017 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:39:25,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:39:25,159 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:39:25,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:39:26,034 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:39:26,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:39:26,892 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:39:26,892 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:39:28,754 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:39:28,755 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:39:30,394 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:39:30,397 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:39:30,399 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:39:30,401 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:39:30,405 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:39:30,407 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:39:30,410 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:39:30,411 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:39:30,412 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:39:30,414 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:39:30,415 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:39:30,416 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:39:30,419 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:39:30,421 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:39:30,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:32,356 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:39:32,358 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:39:32,360 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:34,360 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:39:34,360 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:39:34,362 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:36,311 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:39:36,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:39:37,228 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:39:37,361 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:41,577 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:39:41,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:43,545 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:39:57,335 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:39:57,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:39:58,358 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:39:58,595 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:40:11,980 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:40:11,983 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:40:12,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:40:12,967 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:40:12,968 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:40:16,691 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:40:22,582 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:40:25,452 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 11:40:25,455 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:40:28,735 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 960
2025-11-12 11:40:28,737 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:40:33,513 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 468
2025-11-12 11:40:33,514 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:40:34,632 - ispa_next.main - DEBUG - 



2025-11-12 11:40:34,632 - ispa_next.main - DEBUG - starting with process 12 (M-ZE 1903) of 17
2025-11-12 11:40:34,636 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:40:36,204 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:40:37,804 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 960
2025-11-12 11:40:37,806 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 468
2025-11-12 11:40:40,029 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:40:40,031 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:41:27,362 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:41:30,004 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:41:36,234 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:38,234 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:41:38,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:38,347 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:41:38,702 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:41:38,706 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:41:38,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:38,827 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:41:42,265 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:41:42,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:44,028 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:41:46,030 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:41:46,191 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:41:46,306 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:41:46,409 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:41:50,607 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:41:51,612 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:41:51,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:52,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:06,500 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:42:06,502 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:42:12,326 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:42:12,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:12,441 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:42:12,441 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:42:12,518 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:42:13,822 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:42:14,091 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:42:16,251 - ispa_next.functions - DEBUG - Updated appointment (AE00032707) customer contact data.
2025-11-12 11:42:17,165 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:42:17,166 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:42:18,486 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:42:18,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:42:19,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:42:23,528 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:42:23,528 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:42:23,528 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:42:23,532 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:42:23,532 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:42:23,534 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:42:24,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:42:28,201 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:42:28,204 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:42:28,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:42:28,313 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:42:37,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:37,879 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:37,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:42:38,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:42:38,726 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:42:40,670 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:42:40,674 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:42:41,893 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:42:41,895 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:42:41,897 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:42:41,899 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:42:41,901 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:42:41,903 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:42:41,905 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:42:41,905 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:42:41,906 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:42:41,907 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:42:41,909 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:42:41,910 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:42:41,913 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:42:41,914 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:42:41,915 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:42:43,900 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:42:43,901 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:42:43,906 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:42:45,793 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:42:45,793 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:42:45,795 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:42:47,775 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:42:47,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:42:49,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:42:49,362 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:00,046 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:43:00,048 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:01,998 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:43:15,416 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:43:15,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:43:16,529 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:43:16,749 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:35,799 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:43:41,322 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:43:41,324 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:43:41,324 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:43:42,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:43:42,344 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:43:42,345 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:43:44,824 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:43:55,155 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:43:55,552 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 11:43:56,335 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:44:00,354 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 962
2025-11-12 11:44:00,354 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:44:05,695 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 469
2025-11-12 11:44:05,696 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:44:06,794 - ispa_next.appointments.models - DEBUG - Appointment Thomas Hoh Herr EBE-HO 220 WBA6X310605S21995 ohne Termin.
2025-11-12 11:44:06,802 - ispa_next.main - DEBUG - 



2025-11-12 11:44:06,802 - ispa_next.main - DEBUG - starting with process 13 (WS-M 505) of 17
2025-11-12 11:44:06,805 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:44:08,459 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:44:10,067 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 962
2025-11-12 11:44:10,068 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 469
2025-11-12 11:44:12,092 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:44:12,093 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:44:44,181 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:44:46,467 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:44:52,381 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:55,710 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:44:55,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:44:55,813 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:44:56,169 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:44:56,173 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:44:56,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:44:56,303 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:45:05,551 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:45:05,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:45:07,126 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:45:09,133 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:45:09,270 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:45:09,442 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:45:09,572 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:45:13,760 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:45:14,767 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:45:14,767 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:45:15,287 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:45:31,812 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:45:37,837 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:45:37,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:45:37,970 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:45:37,970 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:45:38,030 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:45:39,384 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:45:40,577 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:45:40,791 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:45:43,482 - ispa_next.functions - DEBUG - Updated appointment (AJ00017350) customer contact data.
2025-11-12 11:45:44,382 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:45:44,384 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:45:45,544 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:45:45,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:45:46,619 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:45:50,738 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:45:50,738 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:45:50,740 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:45:50,742 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:45:50,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:45:51,251 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:45:55,449 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:46:00,977 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:46:00,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:46:01,069 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:46:01,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:46:02,029 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:46:02,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:46:02,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:46:02,878 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:46:05,945 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:46:05,947 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:46:07,238 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:46:07,242 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:46:07,254 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:46:07,256 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:46:07,257 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:46:07,259 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:46:07,262 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:46:07,263 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:46:07,266 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:46:07,287 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:46:07,289 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:46:07,291 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:46:07,293 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:46:07,294 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:46:07,296 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:10,701 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:46:13,680 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:46:13,684 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:46:13,687 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:17,312 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:46:17,312 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:46:17,316 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:20,649 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:46:20,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:46:21,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:46:22,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:32,692 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:46:32,694 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:36,035 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:46:49,512 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:46:50,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:46:50,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:46:50,909 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:47:23,967 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:47:29,574 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:47:34,020 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:47:39,425 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:47:39,427 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:47:39,427 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:47:40,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:47:40,823 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:47:40,824 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:47:43,289 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:47:54,035 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:47:54,412 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 11:47:54,987 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:47:58,724 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 962
2025-11-12 11:47:58,726 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:48:03,625 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 469
2025-11-12 11:48:03,626 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:48:04,745 - ispa_next.appointments.models - DEBUG - Appointment Thomas Hoh Herr EBE-HO 220 WBA6X310605S21995 ohne Termin.
2025-11-12 11:48:04,758 - ispa_next.main - DEBUG - 



2025-11-12 11:48:04,758 - ispa_next.main - DEBUG - starting with process 14 (EBE-AS 109) of 17
2025-11-12 11:48:04,762 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:48:06,390 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:48:08,138 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 962
2025-11-12 11:48:08,140 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 469
2025-11-12 11:48:10,348 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:48:10,350 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:48:44,176 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:48:46,920 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:48:53,794 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:48:53,874 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:48:54,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:49:04,392 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:49:04,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:49:04,499 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:49:04,853 - ispa_next.functions - DEBUG - HU date already expired after 19 days.
2025-11-12 11:49:09,920 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:49:09,923 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:49:09,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:49:10,012 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:49:19,861 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:49:19,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:49:21,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:49:23,482 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:49:23,609 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:49:23,791 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:49:23,913 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:49:23,914 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:49:32,775 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:49:33,779 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:49:33,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:49:34,306 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:49:40,526 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 11:49:40,528 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:49:40,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:49:40,634 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:49:40,635 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:49:40,730 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:49:40,880 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:49:42,201 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 11:49:43,476 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 11:49:43,844 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:49:45,941 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:49:45,944 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:49:46,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:49:47,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:49:49,161 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:49:49,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:49:49,262 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:49:52,890 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:49:52,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:49:53,404 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:49:55,408 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:49:55,556 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:49:55,704 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:49:55,836 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:49:55,836 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:50:04,877 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:51:04,879 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:51:14,207 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:51:44,211 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:51:53,270 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:52:02,679 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:52:03,687 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:52:03,688 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:52:03,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:52:03,795 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:52:08,008 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:52:08,011 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:52:08,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:52:08,125 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:52:08,575 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:52:09,154 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:52:09,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:52:10,473 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:52:10,473 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:52:19,456 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:52:19,460 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:52:21,767 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 263, in run
    self._update_advice_list_content()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 40, in _update_advice_list_content
    self.containers[Container.ADVICE_LIST] = self.ui_helper.get_advice_list_content(self.base_element)
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 168, in get_advice_list_content
    cart_package_name = item.get_first_child().get_value()
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 346, in get_first_child
    found = m.get_first_child(
            ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 639, in get_first_child
    _raise_not_found_error()
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 630, in _raise_not_found_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'GetFirstChildElement' didn't return an Element pointer.


2025-11-12 11:52:21,788 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:52:21,790 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:52:22,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:52:23,801 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:52:23,802 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 11:52:23,828 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:52:30,152 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 11:52:30,156 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:52:30,881 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 963
2025-11-12 11:52:30,883 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:52:35,658 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 470
2025-11-12 11:52:35,658 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:52:36,746 - ispa_next.appointments.models - DEBUG - Appointment Georg Weber Herr M-JW 65 WBAVA71080VC22220 ohne Termin.
2025-11-12 11:52:36,754 - ispa_next.appointments.models - DEBUG - Appointment Thomas Hoh Herr EBE-HO 220 WBA6X310605S21995 ohne Termin.
2025-11-12 11:52:36,761 - ispa_next.main - DEBUG - 



2025-11-12 11:52:36,761 - ispa_next.main - DEBUG - starting with process 15 (M-MV 6001) of 17
2025-11-12 11:52:36,764 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:52:38,381 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:52:39,830 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 963
2025-11-12 11:52:39,831 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 470
2025-11-12 11:52:42,025 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:52:42,027 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:53:12,881 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:53:15,581 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:53:22,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:53:24,309 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:53:24,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:53:24,400 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:53:24,785 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:53:24,790 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:53:24,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:53:24,871 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:53:28,344 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:53:28,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:53:29,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:53:31,939 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:53:32,063 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:53:32,217 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:53:32,334 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:53:36,538 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:53:37,543 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:53:37,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:53:38,029 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:53:50,529 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:53:56,296 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:53:56,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:53:56,403 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:53:56,403 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:53:56,455 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:53:57,816 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:53:58,017 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:54:00,222 - ispa_next.functions - DEBUG - Updated appointment (AB00085497) customer contact data.
2025-11-12 11:54:01,142 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:54:01,144 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:54:02,953 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:54:02,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:54:03,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:54:07,575 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:54:07,577 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:54:07,579 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:54:07,579 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:54:07,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:54:08,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:54:12,224 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:54:12,230 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:54:12,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:54:12,322 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:54:18,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:54:18,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:54:18,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:54:19,631 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:54:19,632 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:54:21,685 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:54:21,687 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:54:23,824 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:54:23,826 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:54:23,831 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:54:23,833 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:54:23,837 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:54:23,841 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:54:23,845 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:54:23,871 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:54:23,873 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:54:23,874 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:54:23,875 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:54:23,877 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:54:23,880 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:54:23,882 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:54:23,883 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:54:25,786 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:54:25,788 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:54:25,790 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:54:27,748 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:54:27,748 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:54:27,750 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:54:29,769 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:54:29,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:54:30,987 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:54:31,258 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:54:46,421 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:54:46,423 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:54:48,325 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:55:02,788 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:55:03,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:55:03,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:55:04,211 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:55:23,923 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:55:28,968 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:55:28,970 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:55:28,970 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:55:29,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:55:29,923 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:55:29,923 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:55:32,242 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:55:43,319 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:55:43,688 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 11:55:44,476 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:55:48,309 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 963
2025-11-12 11:55:48,311 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:55:53,088 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 470
2025-11-12 11:55:53,089 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:55:54,159 - ispa_next.main - DEBUG - Found new Appointment: M-JW 65
2025-11-12 11:55:54,159 - ispa_next.main - DEBUG - Found new Appointment: EBE-HO 220
2025-11-12 11:55:54,160 - ispa_next.main - DEBUG - 



2025-11-12 11:55:54,160 - ispa_next.main - DEBUG - starting with process 16 (M-JW 65) of 19
2025-11-12 11:55:54,164 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:55:55,902 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:55:57,593 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 963
2025-11-12 11:55:57,595 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 470
2025-11-12 11:55:59,744 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:55:59,745 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:56:31,720 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:56:44,518 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:56:47,158 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:56:47,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:56:47,251 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:56:47,616 - ispa_next.functions - DEBUG - HU date already expired after 24 days.
2025-11-12 11:56:56,443 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:56:56,445 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:56:56,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:56:56,556 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:57:09,403 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:57:09,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:57:10,921 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:57:12,927 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:57:20,705 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 11:57:30,626 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 11:57:31,631 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:57:31,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:57:32,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:57:47,001 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:57:56,349 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:57:56,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:57:56,437 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:57:56,439 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:57:56,523 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:57:56,709 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:57:58,574 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:57:58,773 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:58:03,292 - ispa_next.functions - DEBUG - Updated appointment (AJ00018181) customer contact data.
2025-11-12 11:58:04,241 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:58:04,246 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:58:04,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:58:05,697 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:58:07,526 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:58:07,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:58:07,624 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:58:11,751 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:58:11,751 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:58:11,751 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:58:11,753 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:58:11,753 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:58:11,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:58:12,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:58:16,441 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:58:17,550 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:58:28,485 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:58:28,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:58:28,601 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:58:32,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:58:32,708 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:58:32,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:58:33,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:58:33,523 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:58:36,059 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:58:36,061 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:58:37,879 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:58:37,881 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:58:37,883 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:58:37,883 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:58:37,891 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:58:37,895 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:58:37,897 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:58:37,901 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:58:37,901 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:58:37,903 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:58:37,904 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:58:37,907 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:58:37,909 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:58:37,911 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:58:37,911 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:58:40,617 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:58:40,618 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:58:40,620 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:58:43,179 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:58:43,179 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:58:43,181 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:58:45,790 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:58:45,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:58:46,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:58:46,788 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:58:46,790 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:58:49,445 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:59:03,697 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:59:04,194 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:59:04,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:59:05,013 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:59:31,202 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:59:36,571 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:59:43,243 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:59:43,245 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:59:43,245 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:59:44,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:59:44,280 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:59:44,282 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:59:46,809 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:59:57,601 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:59:57,998 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 11:59:58,732 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:00:02,499 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 963
2025-11-12 12:00:02,501 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:00:07,521 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 470
2025-11-12 12:00:07,522 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:00:08,739 - ispa_next.main - DEBUG - 



2025-11-12 12:00:08,739 - ispa_next.main - DEBUG - starting with process 17 (EBE-HO 220) of 19
2025-11-12 12:00:08,743 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:00:10,221 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:00:11,834 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 963
2025-11-12 12:00:11,839 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 470
2025-11-12 12:00:14,408 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:00:14,410 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:00:48,281 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:01:01,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:01:06,076 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:01:06,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:01:06,225 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:01:06,566 - ispa_next.functions - DEBUG - HU date already expired after 25 days.
2025-11-12 12:01:16,261 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:01:16,264 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:01:16,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:01:16,371 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:01:29,996 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:01:29,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:01:31,620 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:01:33,623 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:01:33,771 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:01:33,916 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:01:33,997 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:01:38,253 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:01:39,259 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:01:39,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:01:39,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:01:55,630 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:02:06,701 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:02:06,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:02:06,803 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:02:06,804 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:02:06,905 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:02:08,281 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:02:08,532 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:02:13,220 - ispa_next.functions - DEBUG - Updated appointment (AJ00018178) customer contact data.
2025-11-12 12:02:14,169 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:02:14,177 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:02:16,402 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:02:16,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:02:17,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:02:22,043 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 12:02:22,043 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:02:22,043 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:02:22,046 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:02:22,047 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:02:22,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:02:22,578 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:02:26,784 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:02:28,033 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:02:39,359 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:02:39,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:02:39,525 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:02:39,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:02:40,491 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:02:40,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:02:41,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:02:41,403 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:02:45,795 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:02:45,798 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:02:47,209 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:02:47,211 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:02:47,213 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 12:02:47,213 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 12:02:47,215 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:02:47,217 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:02:47,219 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:02:47,219 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:02:47,221 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:02:47,223 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:02:47,223 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:02:47,225 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:02:47,227 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:02:47,231 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:02:47,233 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:02:52,196 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 12:02:55,619 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:02:55,711 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:02:55,717 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:03:00,771 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:03:00,771 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 12:03:00,773 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:03:05,573 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:03:05,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:03:06,825 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:03:07,038 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:03:18,505 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:03:18,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:03:23,522 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:03:38,631 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:03:39,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:03:39,786 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:03:39,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:04:28,226 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:04:34,644 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:04:40,209 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:04:46,031 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:04:51,638 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:04:57,727 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:04:57,731 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:04:57,732 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:04:58,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:04:58,583 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:04:58,585 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:05:00,620 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:05:10,364 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:05:10,746 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 12:05:11,750 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:05:15,717 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 963
2025-11-12 12:05:15,717 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:05:20,910 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 470
2025-11-12 12:05:20,911 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:05:22,129 - ispa_next.main - DEBUG - 



2025-11-12 12:05:22,129 - ispa_next.main - DEBUG - starting with process 18 (EBE-XV 60) of 19
2025-11-12 12:05:22,133 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:05:23,892 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:05:25,681 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 963
2025-11-12 12:05:25,683 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 470
2025-11-12 12:05:28,008 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:05:28,009 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:06:03,974 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:06:06,376 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:06:13,023 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:06:17,090 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:06:17,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:06:17,171 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:06:17,477 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:06:17,480 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:06:17,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:06:17,598 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:06:26,536 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:06:26,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:06:27,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:06:29,989 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:06:30,158 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:06:30,336 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:06:30,446 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:06:34,718 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:06:35,725 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:06:35,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:06:36,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:06:49,693 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:06:49,694 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:06:56,401 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:06:56,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:06:56,517 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:06:56,519 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:06:56,571 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:06:56,712 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:06:58,069 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:06:58,310 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:07:00,889 - ispa_next.functions - DEBUG - Updated appointment (AF00027213) customer contact data.
2025-11-12 12:07:01,840 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:07:01,850 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:07:02,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:07:04,185 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:07:05,571 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:07:05,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:07:05,694 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:07:09,289 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:07:09,289 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:07:09,293 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:07:09,293 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:07:09,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:07:09,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:07:13,998 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:07:14,002 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:07:14,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:07:14,111 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:07:14,491 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:07:15,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:07:15,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:07:15,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:07:15,957 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:07:19,677 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:07:19,679 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:07:21,531 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:07:21,533 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:07:21,535 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 12:07:21,535 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 12:07:21,537 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:07:21,537 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:07:21,540 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:07:21,540 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:07:21,542 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:07:21,543 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:07:21,544 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:07:21,546 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:07:21,548 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:07:21,550 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:07:21,552 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:07:25,660 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:07:25,660 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:07:25,664 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:07:29,749 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:07:29,749 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 12:07:29,750 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:07:33,746 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:07:33,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:07:34,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:07:35,200 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:07:46,585 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:07:46,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:07:50,781 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:08:05,838 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:08:06,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:08:07,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:08:07,395 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:08:48,774 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:08:54,408 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:09:00,158 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:09:05,718 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:09:12,323 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:09:12,325 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:09:12,327 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:09:13,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:09:13,380 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:09:13,381 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:09:15,940 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:09:27,209 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:09:27,588 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 12:09:28,627 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:09:32,608 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 963
2025-11-12 12:09:32,610 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:09:37,756 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 470
2025-11-12 12:09:37,756 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:09:39,006 - ispa_next.main - DEBUG - 



2025-11-12 12:09:39,006 - ispa_next.main - DEBUG - starting with process 19 (EBE-AU 51) of 19
2025-11-12 12:09:39,011 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:09:40,688 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:09:42,164 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 963
2025-11-12 12:09:42,165 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 470
2025-11-12 12:09:44,282 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:09:44,284 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:10:18,664 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:10:21,253 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:10:27,680 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:10:32,372 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:10:32,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:10:32,472 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:10:32,715 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:10:32,717 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:10:32,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:10:32,812 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:10:36,158 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:10:36,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:10:37,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:10:39,769 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:10:39,958 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:10:40,124 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:10:40,251 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:10:44,465 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:10:45,491 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:10:45,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:10:46,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:10:59,643 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:10:59,643 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:11:06,030 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:11:06,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:06,164 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:11:06,164 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:11:06,239 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:11:07,588 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:11:07,796 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:11:10,500 - ispa_next.functions - DEBUG - Updated appointment (AZ00004184) customer contact data.
2025-11-12 12:11:11,496 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:11:11,502 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:11:13,624 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:11:13,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:11:14,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:11:18,474 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:11:18,474 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:11:18,478 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:11:18,478 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:11:18,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:11:19,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:11:23,279 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:11:23,283 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:11:23,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:11:23,377 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:11:32,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:32,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:32,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:11:33,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:11:33,879 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:11:38,217 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:11:38,218 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:11:39,912 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:11:39,914 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:11:39,918 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 12:11:39,922 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 12:11:39,923 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:11:39,925 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:11:39,927 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:11:39,929 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:11:39,931 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:11:39,933 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:11:39,936 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:11:39,938 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:11:39,940 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:11:39,941 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:11:44,811 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 12:11:47,767 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:11:47,767 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:11:47,772 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:11:52,836 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:11:52,836 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 12:11:52,837 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:11:57,566 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:11:57,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:11:58,713 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:11:58,940 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:12:11,023 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:12:11,027 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:12:15,897 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:12:30,368 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:12:30,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:12:31,701 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:12:31,906 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:13:19,919 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:13:25,630 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:13:31,825 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:13:38,198 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:13:43,981 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:13:50,780 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:13:50,784 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:13:50,784 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:13:51,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:13:51,826 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:13:51,827 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:13:54,171 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:14:05,428 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:14:05,807 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 12:14:06,616 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:14:10,509 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 963
2025-11-12 12:14:10,511 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:14:14,948 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 470
2025-11-12 12:14:14,949 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
