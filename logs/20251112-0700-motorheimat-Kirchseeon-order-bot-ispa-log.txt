2025-11-12 07:00:36,605 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 07:00:36,611 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 07:00:48,397 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:01:02,105 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:01:17,602 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:01:43,919 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 07:01:55,469 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 07:01:58,887 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:02:00,004 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:02:00,005 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 07:02:02,286 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 431
2025-11-12 07:02:02,287 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 07:02:02,287 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:02:03,340 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:02:04,384 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:03:10,827 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:03:10,841 - ispa_next.appointments.models - DEBUG - Appointment Ratko Kos-Igel Herr M-E 5984 WBAJN31060B378248 ohne Termin.
2025-11-12 07:03:10,864 - ispa_next.appointments.models - DEBUG - Appointment Franz-Michael von Morenhoffen Herr M-VM 1945 WMW11GD0602W56385 ohne Termin.
2025-11-12 07:03:10,890 - ispa_next.appointments.models - DEBUG - Appointment Andreas Pletschacher Herr M-S 7268 WMW11GA0607N78892 ohne Termin.
2025-11-12 07:03:10,898 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:03:10,916 - ispa_next.appointments.models - DEBUG - Appointment ZEBE-Zeichenbüro Ebersberg Frau EBE-ZB 999 WMWJZ31040TP30810 ohne Termin.
2025-11-12 07:03:10,933 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:03:10,952 - ispa_next.appointments.models - DEBUG - Appointment Erich Pudelko Herr EBE-EP 11 WBA21EA0307N15581 ohne Termin.
2025-11-12 07:03:11,001 - ispa_next.appointments.models - DEBUG - Appointment Markus Deppe Herr M-MD 6407 WMWLV310802U83186 ohne Termin.
2025-11-12 07:03:11,022 - ispa_next.appointments.models - DEBUG - Appointment Petra Wichert Frau M-PW 2302 WBAUH31030E525919 ohne Termin.
2025-11-12 07:03:11,034 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Trepte Herr STA-GW 131 WBA2A51000V427342 ohne Termin.
2025-11-12 07:03:11,070 - ispa_next.appointments.models - DEBUG - Appointment Firma Open Text Software GmbH M-M 1684E WBA21GV030CW39508 ohne Termin.
2025-11-12 07:03:11,082 - ispa_next.appointments.models - DEBUG - Appointment Herbert Kuhn Herr M-KT 4350 WBAEJ11080AF78090 ohne Termin.
2025-11-12 07:03:11,093 - ispa_next.appointments.models - DEBUG - Appointment Firma curare - Verein zur Förderung EBE-C 204 WBA21EA0307L92610 ohne Termin.
2025-11-12 07:03:11,105 - ispa_next.appointments.models - DEBUG - Appointment Hans-Dieter Krill Herr M-DK 2695 WBA3U11040J871366 ohne Termin.
2025-11-12 07:03:11,116 - ispa_next.appointments.models - DEBUG - Appointment Aldin Hecimovic Herr EBE-AD 216 WBA2E510305G50482 ohne Termin.
2025-11-12 07:03:11,126 - ispa_next.appointments.models - DEBUG - Appointment Firma Global Concerts GmbH M-SZ 1171 WBA21EF0605018576 ohne Termin.
2025-11-12 07:03:11,137 - ispa_next.appointments.models - DEBUG - Appointment Brigitte Fertich Frau EBE-FJ 111 WBAXB31040DW54269 ohne Termin.
2025-11-12 07:03:11,148 - ispa_next.appointments.models - DEBUG - Appointment Daniela Felbrich Frau ED-JS 396 WBY8P210207F54741 ohne Termin.
2025-11-12 07:03:11,160 - ispa_next.appointments.models - DEBUG - Appointment Patrick Gaßler Herr TS-GP 2299 WBA4C31090G785518 ohne Termin.
2025-11-12 07:03:11,171 - ispa_next.appointments.models - DEBUG - Appointment Firma MT Treuhand München M-MN 48 WBSUJ010209G32986 ohne Termin.
2025-11-12 07:03:11,184 - ispa_next.main - DEBUG - Found 12 out of 60 appointments to process (configured limit: 15).
2025-11-12 07:03:11,185 - ispa_next.main - DEBUG - Processing 2 fresh appointments.
2025-11-12 07:03:11,185 - ispa_next.main - DEBUG - Processing 10 already visited appointments (w/ RKR not callable).
2025-11-12 07:03:11,185 - ispa_next.main - DEBUG - All appointments: M-X 8740, EBE-XC 42, WS BJ 2015, EBE-FM 57, M-ZE 1903, WS-M 505, EBE-AS 109, EBE-LR 240, M-MV 6001, EBE-HB 18, EBE-XV 60, EBE-AU 51
2025-11-12 07:03:11,187 - ispa_next.main - DEBUG - 



2025-11-12 07:03:11,187 - ispa_next.main - DEBUG - starting with process 1 (M-X 8740) of 12
2025-11-12 07:03:11,191 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:03:11,905 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:03:12,691 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:03:12,691 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 431
2025-11-12 07:03:13,687 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:03:13,688 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:03:34,250 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:03:42,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:03:44,348 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:03:44,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:03:44,410 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:03:44,575 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:03:44,578 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:03:44,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:03:44,640 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:03:58,253 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:03:58,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:03:58,468 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 07:03:59,241 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 07:03:59,259 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:03:59,259 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:03:59,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:04:00,669 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:04:00,670 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 07:04:00,691 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 07:04:02,510 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 07:04:02,512 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:04:03,691 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:04:03,692 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:04:06,180 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 07:04:06,181 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:04:06,846 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 07:04:06,852 - ispa_next.main - DEBUG - 



2025-11-12 07:04:06,852 - ispa_next.main - DEBUG - starting with process 2 (EBE-XC 42) of 12
2025-11-12 07:04:06,855 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:04:07,681 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:04:08,776 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:04:08,777 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 07:04:10,022 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:04:10,024 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:04:27,542 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:04:36,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:04:37,699 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:04:37,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:04:37,776 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:04:38,014 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:04:38,016 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:04:38,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:04:38,123 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:04:51,941 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:04:51,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:04:52,187 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 07:04:52,496 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 07:04:52,510 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:04:52,510 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:04:53,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:04:53,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:04:53,823 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 07:04:53,840 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 07:04:55,983 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 07:04:55,986 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:04:57,604 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:04:57,605 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:05:00,046 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 07:05:00,047 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:05:00,943 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 07:05:00,947 - ispa_next.main - DEBUG - 



2025-11-12 07:05:00,947 - ispa_next.main - DEBUG - starting with process 3 (WS BJ 2015) of 12
2025-11-12 07:05:00,951 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:05:02,129 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:05:02,985 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:05:02,987 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 07:05:04,141 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:05:04,143 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:05:42,451 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:05:42,462 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 07:05:42,466 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:05:42,824 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:05:42,824 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:05:45,191 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 07:05:45,191 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:05:45,968 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 07:05:45,972 - ispa_next.main - DEBUG - 



2025-11-12 07:05:45,972 - ispa_next.main - DEBUG - starting with process 4 (EBE-FM 57) of 12
2025-11-12 07:05:45,975 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:05:47,613 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:05:48,840 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:05:48,841 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 07:05:50,184 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:05:50,185 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:06:23,460 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:06:25,393 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:06:30,403 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:06:33,014 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:06:33,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:06:33,111 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:06:33,312 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 07:06:36,711 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:06:36,713 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:06:36,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:06:36,780 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:06:39,786 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:06:39,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:06:40,871 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:06:42,874 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:06:42,971 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:06:43,091 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:06:43,156 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:06:47,341 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:06:48,347 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:06:48,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:06:48,877 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:07:00,027 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:07:00,027 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:07:03,852 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:07:03,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:07:03,943 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:07:03,945 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:07:03,991 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:07:05,181 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:07:06,375 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:07:06,700 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:07:08,405 - ispa_next.functions - DEBUG - Updated appointment (AB00084453) customer contact data.
2025-11-12 07:07:09,305 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:07:09,308 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:07:09,893 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:07:09,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:07:10,537 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:07:14,525 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:07:14,525 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:07:14,529 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:07:14,529 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:07:14,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:07:15,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:07:19,182 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:07:19,186 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:07:19,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:07:19,278 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:07:24,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:07:25,356 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:07:25,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:07:26,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:07:26,119 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:07:28,519 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:07:28,521 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:07:29,860 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:07:29,860 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:07:29,864 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:07:29,866 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:07:29,868 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:07:29,868 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:07:29,870 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:07:29,872 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:07:29,876 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:07:29,889 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:07:29,892 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:07:29,893 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:07:29,898 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:07:29,900 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:07:29,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:07:32,435 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:07:32,437 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:07:32,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:07:35,015 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:07:35,015 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:07:35,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:07:37,601 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:07:37,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:07:38,340 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:07:38,685 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:07:49,841 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:07:49,843 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:07:52,487 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:08:03,872 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:08:04,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:08:04,979 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:08:05,113 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:08:29,647 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:08:33,272 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:08:37,429 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:08:37,431 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:08:37,431 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:08:38,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:08:38,148 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:08:38,148 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:08:39,955 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:08:48,736 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:08:49,127 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 07:08:49,654 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:08:51,072 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:08:51,074 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:08:53,686 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 07:08:53,687 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:08:54,474 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 07:08:54,478 - ispa_next.main - DEBUG - 



2025-11-12 07:08:54,478 - ispa_next.main - DEBUG - starting with process 5 (M-ZE 1903) of 12
2025-11-12 07:08:54,482 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:08:55,585 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:08:56,455 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:08:56,456 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 07:08:57,609 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:08:57,611 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:09:28,331 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:09:30,013 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:09:34,397 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:09:36,266 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:09:36,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:09:36,352 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:09:36,625 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:09:36,628 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:09:36,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:09:36,735 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:09:39,803 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:09:39,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:09:40,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:09:42,910 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:09:43,003 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:09:43,120 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:09:43,187 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:09:47,402 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:09:48,408 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:09:48,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:09:49,014 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:09:59,609 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:09:59,609 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:10:02,758 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:10:02,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:10:02,840 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:10:02,841 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:10:02,899 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:10:04,093 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:10:04,304 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:10:05,989 - ispa_next.functions - DEBUG - Updated appointment (AE00032707) customer contact data.
2025-11-12 07:10:06,899 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:10:06,902 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:10:07,671 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:10:07,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:10:08,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:10:12,448 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 07:10:12,449 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:10:12,449 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:10:12,452 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:10:12,456 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:10:12,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:10:12,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:10:17,088 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:10:17,092 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:10:17,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:10:17,151 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:10:26,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:10:26,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:10:26,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:10:27,417 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:10:27,419 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:10:29,314 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:10:29,320 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:10:30,417 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:10:30,419 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:10:30,421 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:10:30,421 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:10:30,423 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:10:30,423 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:10:30,425 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:10:30,427 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:10:30,427 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:10:30,429 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:10:30,431 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:10:30,433 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:10:30,435 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:10:30,437 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:10:30,438 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:10:32,338 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:10:32,340 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:10:32,344 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:10:34,199 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:10:34,200 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:10:34,202 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:10:36,165 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:10:36,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:10:36,814 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:10:37,034 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:10:47,482 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:10:47,484 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:10:49,419 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:11:00,046 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:11:00,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:11:01,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:11:01,142 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:11:18,561 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:11:22,430 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:11:22,434 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:11:22,434 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:11:23,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:11:23,110 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:11:23,112 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:11:24,700 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:11:31,670 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:11:32,051 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 07:11:32,581 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:11:34,771 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:11:34,773 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:11:37,577 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 07:11:37,578 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:11:38,361 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 07:11:38,365 - ispa_next.main - DEBUG - 



2025-11-12 07:11:38,365 - ispa_next.main - DEBUG - starting with process 6 (WS-M 505) of 12
2025-11-12 07:11:38,368 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:11:39,463 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:11:40,443 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:11:40,444 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 07:11:41,805 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:11:41,807 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:12:03,816 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:12:05,260 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:12:09,656 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:12:12,895 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:12:12,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:12,966 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:12:13,326 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:12:13,328 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:12:13,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:13,400 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:12:19,932 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:12:19,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:12:21,173 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:12:23,178 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:12:23,290 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:12:23,417 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:12:23,491 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:12:27,682 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:12:28,687 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:12:28,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:29,142 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:42,112 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:12:45,853 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:12:45,856 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:45,961 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:12:45,961 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:12:45,993 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:12:47,240 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:12:48,403 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:12:48,628 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:12:50,308 - ispa_next.functions - DEBUG - Updated appointment (AJ00017350) customer contact data.
2025-11-12 07:12:51,210 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:12:51,211 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:12:51,830 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:12:51,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:12:52,596 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:12:56,608 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:12:56,608 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:12:56,612 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:12:56,614 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:12:56,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:12:57,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:13:01,400 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:13:04,886 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:13:04,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:13:04,952 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:13:05,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:13:05,825 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:13:05,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:13:06,478 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:13:06,478 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:13:09,483 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:13:09,485 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:13:10,329 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:13:10,330 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:13:10,332 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:13:10,332 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:13:10,334 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:13:10,335 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:13:10,336 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:13:10,337 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:13:10,338 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:13:10,339 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:13:10,340 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:13:10,342 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:13:10,345 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:13:10,347 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:13:10,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:13:13,624 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 07:13:16,018 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:13:16,020 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:13:16,022 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:13:19,294 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:13:19,294 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:13:19,296 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:13:22,523 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:13:22,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:13:23,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:13:23,654 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:13:34,270 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:13:34,274 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:13:37,534 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:13:49,080 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:13:49,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:13:50,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:13:50,214 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:14:21,194 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:14:25,110 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:14:28,626 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:14:32,370 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:14:32,372 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:14:32,374 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:14:32,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:14:33,048 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:14:33,048 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:14:34,751 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:14:41,495 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:14:41,893 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 07:14:42,196 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:14:44,569 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:14:44,571 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:14:47,330 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 07:14:47,331 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:14:48,131 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 07:14:48,134 - ispa_next.main - DEBUG - 



2025-11-12 07:14:48,135 - ispa_next.main - DEBUG - starting with process 7 (EBE-AS 109) of 12
2025-11-12 07:14:48,138 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:14:49,039 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:14:49,899 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:14:49,900 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 07:14:51,032 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:14:51,033 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:15:23,417 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:15:24,949 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:15:29,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:29,872 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:15:29,987 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:15:39,937 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:15:39,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:40,007 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:15:40,194 - ispa_next.functions - DEBUG - HU date already expired after 19 days.
2025-11-12 07:15:43,565 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:15:43,567 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:15:43,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:43,633 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:15:49,549 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:15:49,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:15:50,554 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:15:52,557 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:15:52,668 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:15:52,743 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:15:52,831 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:15:52,831 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:16:01,192 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:16:02,197 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:16:02,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:16:02,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:16:08,854 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 07:16:08,859 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:16:08,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:16:08,983 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:16:08,984 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:16:09,027 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:16:09,132 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:16:10,309 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 07:16:11,488 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 07:16:11,783 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:16:13,590 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:16:13,592 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:16:13,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:16:14,546 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:16:15,682 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:16:15,683 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:16:15,747 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:16:19,343 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:16:19,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:16:19,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:16:21,888 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:16:22,000 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:16:22,108 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:16:22,177 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:16:22,177 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:16:30,821 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:17:30,824 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:17:39,176 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:18:24,177 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:18:32,376 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:18:38,908 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 07:18:39,915 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:18:39,915 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:18:39,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:18:40,013 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:18:44,146 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:18:44,149 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:18:44,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:18:44,281 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:18:44,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:45,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:45,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:18:45,984 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:18:45,984 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:18:54,787 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:18:54,789 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:18:56,602 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 263, in run
    self._update_advice_list_content()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 40, in _update_advice_list_content
    self.containers[Container.ADVICE_LIST] = self.ui_helper.get_advice_list_content(self.base_element)
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 168, in get_advice_list_content
    cart_package_name = item.get_first_child().get_value()
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 346, in get_first_child
    found = m.get_first_child(
            ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 639, in get_first_child
    _raise_not_found_error()
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 630, in _raise_not_found_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'GetFirstChildElement' didn't return an Element pointer.


2025-11-12 07:18:56,616 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:18:56,620 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:18:57,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:18:58,075 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:18:58,075 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 07:18:58,103 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 07:19:00,783 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 07:19:00,787 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:19:01,672 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:19:01,674 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:19:04,404 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 07:19:04,404 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:19:05,238 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 07:19:05,241 - ispa_next.main - DEBUG - 



2025-11-12 07:19:05,242 - ispa_next.main - DEBUG - starting with process 8 (EBE-LR 240) of 12
2025-11-12 07:19:05,246 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:19:06,374 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:19:07,642 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:19:07,644 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 07:19:08,965 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:19:08,966 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:19:39,816 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:19:41,769 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:19:46,732 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:19:52,824 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:19:52,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:19:52,897 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:19:53,100 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 07:19:56,704 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:19:56,706 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:19:56,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:19:56,771 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:19:59,633 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:19:59,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:20:00,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:20:02,640 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:20:02,751 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:20:02,856 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:20:02,921 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:20:07,113 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:20:08,120 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:20:08,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:08,673 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:18,750 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:20:21,913 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:20:21,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:21,979 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:20:21,981 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:20:22,038 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:20:23,236 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:20:24,399 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:20:24,624 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:20:26,421 - ispa_next.functions - DEBUG - Updated appointment (AJ00017405) customer contact data.
2025-11-12 07:20:27,360 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:20:27,362 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:20:28,163 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:20:28,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:20:28,924 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:20:33,071 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:20:33,071 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:20:33,075 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:20:33,077 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:20:33,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:20:33,597 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:20:37,757 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:20:40,745 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:20:40,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:20:40,814 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:20:44,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:44,800 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:44,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:20:45,465 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:20:45,465 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:20:50,783 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:20:50,787 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:20:51,748 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:20:51,750 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:20:51,752 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:20:51,754 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:20:51,755 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:20:51,755 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:20:51,757 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:20:51,759 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:20:51,759 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:20:51,761 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:20:51,761 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:20:51,763 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:20:51,765 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:20:51,765 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:20:51,767 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:20:57,796 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 07:20:59,742 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:20:59,742 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:20:59,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:05,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:21:05,755 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:21:16,277 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:21:16,277 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:21:16,279 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:22,244 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:21:22,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:21:22,955 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:21:23,100 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:32,883 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:21:32,883 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:38,870 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:21:50,989 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:21:51,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:21:51,980 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:21:52,146 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:22:51,378 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:22:56,320 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:23:01,167 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:23:05,612 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:23:10,479 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:23:14,491 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:23:18,707 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:23:23,335 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:23:23,337 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:23:23,337 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:23:23,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:23:24,024 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:23:24,026 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:23:25,630 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:23:33,453 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:23:33,856 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 07:23:35,059 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:23:36,170 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:23:36,172 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:23:38,909 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 07:23:38,911 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:23:39,762 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 07:23:39,766 - ispa_next.main - DEBUG - 



2025-11-12 07:23:39,766 - ispa_next.main - DEBUG - starting with process 9 (M-MV 6001) of 12
2025-11-12 07:23:39,769 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:23:40,962 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:23:42,113 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:23:42,115 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 07:23:43,610 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:23:43,611 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:24:10,126 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:24:11,509 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:24:16,122 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:18,034 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:24:18,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:18,102 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:24:18,300 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:24:18,302 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:24:18,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:18,363 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:24:21,378 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:24:21,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:24:22,615 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:24:24,621 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:24:24,741 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:24:24,856 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:24:24,924 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:24:29,081 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:24:30,087 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:24:30,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:30,672 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:39,867 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:24:43,799 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:24:43,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:43,885 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:24:43,886 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:24:43,973 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:24:45,178 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:24:45,414 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:24:47,200 - ispa_next.functions - DEBUG - Updated appointment (AB00085497) customer contact data.
2025-11-12 07:24:48,108 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:24:48,110 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:24:48,893 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:24:48,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:24:49,631 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:24:53,213 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:24:53,213 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:24:53,217 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:24:53,217 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:24:53,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:24:53,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:24:57,834 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:24:57,837 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:24:57,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:24:57,928 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:25:03,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:04,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:04,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:25:04,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:25:04,778 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:25:06,697 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:25:06,699 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:25:08,560 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:25:08,562 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:25:08,564 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:25:08,566 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:25:08,566 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:25:08,568 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:25:08,568 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:25:08,570 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:25:08,572 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:25:08,574 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:25:08,574 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:25:08,576 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:25:08,580 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:25:08,582 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:25:08,582 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:10,558 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:25:10,559 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:25:10,563 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:12,493 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:25:12,494 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:25:12,498 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:14,414 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:25:14,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:25:15,318 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:25:15,589 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:29,911 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:25:29,913 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:31,866 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:25:43,274 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:25:43,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:25:44,389 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:25:44,601 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:02,288 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:26:05,778 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:26:05,779 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:26:05,780 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:26:06,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:26:06,286 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:26:06,286 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:26:07,723 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:26:14,828 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:26:15,203 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 07:26:15,932 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:26:17,047 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:26:17,049 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:26:19,954 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 07:26:19,954 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:26:20,777 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 07:26:20,782 - ispa_next.main - DEBUG - 



2025-11-12 07:26:20,782 - ispa_next.main - DEBUG - starting with process 10 (EBE-HB 18) of 12
2025-11-12 07:26:20,785 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:26:21,946 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:26:22,927 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:26:22,928 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 07:26:24,121 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:26:24,123 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:26:46,816 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:26:48,167 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:26:52,548 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:55,823 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:26:55,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:55,928 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:26:56,142 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:26:56,145 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:26:56,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:56,264 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:27:02,823 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:27:02,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:27:03,887 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:27:05,889 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:27:05,985 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:27:06,080 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:27:06,135 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:27:06,135 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:27:14,315 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:27:15,320 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:27:15,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:27:15,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:27:26,202 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:27:26,202 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:27:29,617 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:27:29,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:27:29,699 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:27:29,700 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:27:29,745 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:27:29,897 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:27:31,114 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:27:31,335 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:27:33,233 - ispa_next.functions - DEBUG - Updated appointment (AJ00017849) customer contact data.
2025-11-12 07:27:34,168 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:27:34,170 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:27:34,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:27:35,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:27:36,105 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:27:36,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:27:36,170 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:27:39,740 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:27:39,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:27:40,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:27:42,261 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:27:42,371 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:27:42,487 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:27:42,582 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:27:42,584 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:27:50,903 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:28:50,905 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:28:59,352 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:29:47,353 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:29:55,775 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:30:03,393 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 07:30:04,398 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:30:04,398 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:30:04,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:04,493 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:30:08,608 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:30:12,459 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:30:12,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:12,545 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:30:12,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:13,409 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:13,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:14,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:30:14,121 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:30:17,169 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:30:17,171 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:30:18,555 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:30:18,556 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:30:18,559 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:30:18,561 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:30:18,563 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:30:18,564 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:30:18,565 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:30:18,566 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:30:18,567 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:30:18,568 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:30:18,569 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:30:18,569 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:30:18,573 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:30:18,573 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:30:18,575 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:21,899 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:30:21,901 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:30:21,903 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:25,115 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:25,187 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:30:34,860 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:47,460 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:30:47,460 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:30:47,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:50,749 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:30:50,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:30:51,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:30:51,562 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:56,950 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:30:56,951 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:00,224 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:31:09,272 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:31:09,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:31:10,247 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:31:10,423 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:42,080 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:31:47,730 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:31:52,167 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:31:57,020 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:31:57,022 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:31:57,022 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:31:57,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:31:57,751 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:31:57,753 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:31:59,656 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:32:05,951 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:32:06,351 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 07:32:07,394 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:32:08,419 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:32:08,421 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:32:10,808 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 07:32:10,808 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:32:11,604 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 07:32:11,608 - ispa_next.main - DEBUG - 



2025-11-12 07:32:11,608 - ispa_next.main - DEBUG - starting with process 11 (EBE-XV 60) of 12
2025-11-12 07:32:11,612 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:32:12,836 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:32:14,009 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:32:14,011 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 07:32:15,226 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:32:15,227 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:32:39,620 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:32:41,232 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:32:46,599 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:32:49,941 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:32:49,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:32:50,059 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:32:50,205 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:32:50,209 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:32:50,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:32:50,358 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:32:56,935 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:32:56,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:32:57,969 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:32:59,972 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:33:00,128 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:33:00,285 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:33:00,350 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:33:04,553 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:33:05,558 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:33:05,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:06,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:17,491 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:33:17,491 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:33:20,830 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:33:20,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:20,925 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:33:20,928 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:33:20,970 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:33:21,076 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:33:22,223 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:33:22,449 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:33:24,639 - ispa_next.functions - DEBUG - Updated appointment (AF00027213) customer contact data.
2025-11-12 07:33:25,572 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:33:25,573 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:33:25,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:33:26,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:33:27,379 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:33:27,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:33:27,512 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:33:31,176 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:33:31,177 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:33:31,179 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:33:31,180 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:33:31,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:33:31,719 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:33:35,824 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:33:35,828 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:33:35,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:33:35,927 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:33:36,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:36,746 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:36,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:33:37,401 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:33:37,402 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:33:40,491 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:33:40,494 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:33:41,817 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:33:41,818 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:33:41,819 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:33:41,821 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:33:41,822 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:33:41,823 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:33:41,824 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:33:41,825 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:33:41,826 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:33:41,826 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:33:41,828 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:33:41,830 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:33:41,833 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:33:41,834 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:33:41,835 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:45,125 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:33:45,127 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:33:45,129 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:48,372 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:33:48,372 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:33:48,373 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:51,594 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:33:51,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:33:52,415 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:33:52,703 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:03,157 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:34:03,158 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:06,423 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:34:16,307 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:34:16,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:34:17,278 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:34:17,381 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:48,713 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:34:52,464 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:34:56,413 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:00,533 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:00,536 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:35:00,537 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:35:00,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:35:00,991 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:35:00,991 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:35:02,320 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:35:08,230 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:35:08,601 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 07:35:09,237 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:35:11,232 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:35:11,233 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:35:14,110 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 07:35:14,112 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:35:15,034 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 07:35:15,039 - ispa_next.main - DEBUG - 



2025-11-12 07:35:15,039 - ispa_next.main - DEBUG - starting with process 12 (EBE-AU 51) of 12
2025-11-12 07:35:15,044 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:35:16,170 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:35:17,319 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:35:17,320 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 07:35:19,361 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:35:19,362 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:35:41,727 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:35:43,629 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:35:47,918 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:52,522 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:35:52,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:52,592 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:35:52,813 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:35:52,815 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:35:52,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:52,972 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:35:55,906 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:35:55,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:35:56,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:35:58,987 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:35:59,080 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:35:59,166 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:35:59,257 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:36:03,416 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:36:04,422 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:36:04,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:05,254 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:17,049 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:36:17,050 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:36:20,796 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:36:20,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:20,888 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:36:20,888 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:36:20,920 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:36:22,164 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:36:22,366 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:36:24,750 - ispa_next.functions - DEBUG - Updated appointment (AZ00004184) customer contact data.
2025-11-12 07:36:25,672 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:36:25,674 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:36:26,489 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:36:26,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:36:27,289 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:36:30,863 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:36:30,863 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:36:30,878 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:36:30,880 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:36:30,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:31,404 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:36:35,543 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:36:35,548 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:36:35,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:35,673 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:36:44,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:44,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:44,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:45,585 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:36:45,585 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:36:49,898 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:36:49,900 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:36:51,297 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:36:51,299 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:36:51,306 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:36:51,308 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:36:51,311 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:36:51,312 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:36:51,314 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:36:51,314 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:36:51,316 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:36:51,326 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:36:51,327 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:36:51,332 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:36:51,334 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:36:51,335 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:56,054 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 07:36:58,135 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:36:58,139 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:36:58,148 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:03,069 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:37:03,069 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:37:03,071 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:07,671 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:37:07,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:37:08,440 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:37:08,647 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:20,475 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:37:20,476 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:25,152 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:37:36,268 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:37:36,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:37:37,351 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:37:37,565 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:23,150 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:27,617 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:31,478 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:35,620 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:38,907 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:44,174 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:44,176 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:38:44,177 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:38:44,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:38:45,073 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:38:45,073 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:38:46,572 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:38:54,158 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:38:54,567 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 07:38:55,294 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:38:56,531 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 998
2025-11-12 07:38:56,532 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:38:59,409 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 07:38:59,410 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:39:00,086 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
