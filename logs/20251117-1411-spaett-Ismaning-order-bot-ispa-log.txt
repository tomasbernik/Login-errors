2025-11-17 14:18:30,564 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 14:18:30,570 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 14:18:39,709 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:18:49,998 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:19:05,548 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:19:29,936 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 14:19:43,084 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 14:19:45,907 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:19:47,275 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 810
2025-11-17 14:19:47,276 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 409
2025-11-17 14:19:49,206 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 398
2025-11-17 14:19:49,207 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 14:19:49,208 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:19:50,068 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:19:51,001 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:20:51,185 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,187 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,187 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,254 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,276 - ispa_next.appointments.models - DEBUG - Appointment Bayram Sahin M-S 2289 WBA6X510405S02325 ohne Termin.
2025-11-17 14:20:51,286 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,306 - ispa_next.appointments.models - DEBUG - Appointment Thomas Löb M-L 5621 WBA8H71010A040968 ohne Termin.
2025-11-17 14:20:51,321 - ispa_next.appointments.models - DEBUG - Appointment Antonio Cavar ED-AC 1986 WBA6L31020FJ84465 ohne Termin.
2025-11-17 14:20:51,325 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,341 - ispa_next.appointments.models - DEBUG - Appointment Rebecca Hurst FS-RA 602 WMW31DH0902V63832 ohne Termin.
2025-11-17 14:20:51,346 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,347 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,348 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,362 - ispa_next.appointments.models - DEBUG - Appointment Alexander Schulz M-S 7319 WBA61EE0605Y49885 ohne Termin.
2025-11-17 14:20:51,377 - ispa_next.appointments.models - DEBUG - Appointment Firma NEO - Professional Solutions GmbH M-N 917 WBS31AZ000CM52265 ohne Termin.
2025-11-17 14:20:51,391 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,404 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,404 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,427 - ispa_next.appointments.models - DEBUG - Appointment Faton Halilaj M-DF 1991 WBA6L51030FJ39031 ohne Termin.
2025-11-17 14:20:51,449 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,466 - ispa_next.appointments.models - DEBUG - Appointment Martin Lamprecht  WBA7K310807P56396 ohne Termin.
2025-11-17 14:20:51,475 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,492 - ispa_next.appointments.models - DEBUG - Appointment Josef Deimel M-LW 90 WBATX35040NC13555 ohne Termin.
2025-11-17 14:20:51,506 - ispa_next.appointments.models - DEBUG - Appointment Firma Panavia Aircraft GmbH FS-PA 85E WBA65GP040N362472 ohne Termin.
2025-11-17 14:20:51,524 - ispa_next.appointments.models - DEBUG - Appointment Meisterbetrieb Thomas Patitz  WBA21GW060CU43030 ohne Termin.
2025-11-17 14:20:51,537 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Hanika M-WH 6500 WBA4K31030BG88527 ohne Termin.
2025-11-17 14:20:51,552 - ispa_next.appointments.models - DEBUG - Appointment Nina Bernreuther M-NN 369 WMWLV310502L56279 ohne Termin.
2025-11-17 14:20:51,553 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,574 - ispa_next.appointments.models - DEBUG - Appointment Ladislav Kilisek M-JO 1742 WBA2A310207A62139 ohne Termin.
2025-11-17 14:20:51,589 - ispa_next.appointments.models - DEBUG - Appointment Ihor Karnakov M-KA 5871E WBA6N31070FM27147 ohne Termin.
2025-11-17 14:20:51,610 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke AG M-NP 3316 WMW21GA0407S97954 ohne Termin.
2025-11-17 14:20:51,637 - ispa_next.appointments.models - DEBUG - Appointment Ibrahim Yazar M-YA 29 WBA6V710005P54227 ohne Termin.
2025-11-17 14:20:51,651 - ispa_next.appointments.models - DEBUG - Appointment Mehmet Erkek M-E 2228 WBACV01050LK56174 ohne Termin.
2025-11-17 14:20:51,665 - ispa_next.appointments.models - DEBUG - Appointment Mehmet Erkek M-E 2228 WBACV01050LK56174 ohne Termin.
2025-11-17 14:20:51,680 - ispa_next.appointments.models - DEBUG - Appointment Joachim Schubert M-JS 2161 WBA51AB0105U16063 ohne Termin.
2025-11-17 14:20:51,698 - ispa_next.appointments.models - DEBUG - Appointment Imer Jakupi M-LJ 1824 WBA11DY090FK02746 ohne Termin.
2025-11-17 14:20:51,714 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Wydra M-W 5397 WBAJC91010B280060 ohne Termin.
2025-11-17 14:20:51,727 - ispa_next.appointments.models - DEBUG - Appointment   WBABS51040EW00681 ohne Termin.
2025-11-17 14:20:51,740 - ispa_next.appointments.models - DEBUG - Appointment Erwin Jaksch M-EJ 69 WBABG11010ER37920 ohne Termin.
2025-11-17 14:20:51,757 - ispa_next.appointments.models - DEBUG - Appointment Eduard Grimm M-EG 3011 WBS1H91060V916418 ohne Termin.
2025-11-17 14:20:51,770 - ispa_next.appointments.models - DEBUG - Appointment Tarik Sahin M-X 3330 WBAJK51000BJ13877 ohne Termin.
2025-11-17 14:20:51,789 - ispa_next.appointments.models - DEBUG - Appointment Firma ACTRON AG ED-AG 444 WBA5R11080FN22370 ohne Termin.
2025-11-17 14:20:51,803 - ispa_next.appointments.models - DEBUG - Appointment Anja Goetzke M-AG 565 WBAJU810409L17973 ohne Termin.
2025-11-17 14:20:51,824 - ispa_next.appointments.models - DEBUG - Appointment Marco Hübl  WBA21EN0009X29619 ohne Termin.
2025-11-17 14:20:51,844 - ispa_next.appointments.models - DEBUG - Appointment Narayanaswamy Anand M-SN 554 WMWLV710302L69958 ohne Termin.
2025-11-17 14:20:51,861 - ispa_next.appointments.models - DEBUG - Appointment Soria-Vanessa Neumann FS-N 347 WBA2H71010VA14727 ohne Termin.
2025-11-17 14:20:51,861 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:20:51,876 - ispa_next.appointments.models - DEBUG - Appointment Firma ProSiebenSat.1 Media SE M-P 7308 E WBA21EF0405Z47312 ohne Termin.
2025-11-17 14:20:51,912 - ispa_next.main - DEBUG - Found 20 out of 175 appointments to process (configured limit: 20).
2025-11-17 14:20:51,912 - ispa_next.main - DEBUG - Processing 20 fresh appointments.
2025-11-17 14:20:51,912 - ispa_next.main - DEBUG - All appointments: M-AW 2608, M-K 1636, M-XM 6099E , PF-DN 2121, M-NC 1407, EBE-B 5739, M-S 9974 E, KEIN KENNZEICHEN, M-M 8234, M-NN 369, M-OO 348, M-H 8611E, KA-RA 185, STA-UZ 888, M-J 2479, M-WO 697, M-BG 7775, FS-XX 555, M-RB 3900, M-H 8898
2025-11-17 14:20:51,915 - ispa_next.main - DEBUG - 



2025-11-17 14:20:51,915 - ispa_next.main - DEBUG - starting with process 1 (M-AW 2608) of 20
2025-11-17 14:20:51,921 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:20:53,128 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:20:54,113 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 810
2025-11-17 14:20:54,115 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 398
2025-11-17 14:20:55,359 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:20:55,361 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:21:24,811 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:21:34,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:34,918 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:35,109 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:36,346 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:21:36,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:36,497 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:36,675 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:21:36,679 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:21:39,511 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:21:39,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:21:40,512 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:21:42,516 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:21:42,622 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:21:45,847 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:21:45,926 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:21:45,926 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:21:57,129 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:21:58,134 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:21:58,134 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:58,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:11,568 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:22:18,853 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:22:18,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:18,932 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:22:18,933 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:22:18,963 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:22:19,066 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:22:20,094 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 14:22:21,242 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 14:22:21,543 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:22:24,635 - ispa_next.functions - DEBUG - Updated appointment (AA00023762) customer contact data.
2025-11-17 14:22:25,556 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:22:25,559 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:22:25,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:22:26,290 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:22:27,745 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:22:27,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:22:27,869 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:22:32,345 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:22:32,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:32,867 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:22:34,870 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:22:34,957 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:22:35,061 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:22:35,134 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:22:35,134 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:22:46,328 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:23:46,330 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:23:57,836 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:24:24,839 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:24:36,281 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:24:46,721 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:24:47,729 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:24:47,733 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:24:47,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:24:47,822 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:24:51,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:52,368 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:52,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:24:53,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:24:53,013 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:24:54,908 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:24:54,912 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:24:56,291 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:24:56,292 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:24:56,294 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:24:56,295 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:24:56,296 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:24:56,297 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:24:56,298 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:24:56,299 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:24:56,300 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:24:56,301 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:24:56,305 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:24:56,307 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:24:56,308 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:58,271 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:24:58,274 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:24:58,276 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:00,211 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:25:00,213 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:25:00,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:25:00,966 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:25:01,016 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:25:01,020 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:02,879 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:25:13,730 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:25:14,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:25:14,691 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:25:14,835 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:32,720 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:25:36,928 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:25:36,932 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:25:36,933 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:25:37,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:25:37,727 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:25:37,730 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:25:39,576 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:25:48,732 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:25:49,145 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 14:25:49,490 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:25:51,128 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:25:51,130 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:25:53,945 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 14:25:53,945 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:25:54,736 - ispa_next.main - DEBUG - 



2025-11-17 14:25:54,736 - ispa_next.main - DEBUG - starting with process 2 (M-K 1636) of 20
2025-11-17 14:25:54,741 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:25:55,877 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:25:56,964 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:25:56,965 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 14:25:58,396 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:25:58,397 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:26:12,010 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 14:26:12,096 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 14:26:12,102 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:26:12,723 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:26:12,724 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:26:15,590 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 14:26:15,591 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:26:16,552 - ispa_next.main - DEBUG - 



2025-11-17 14:26:16,552 - ispa_next.main - DEBUG - starting with process 3 (M-XM 6099E ) of 20
2025-11-17 14:26:16,572 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:26:17,580 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:26:18,517 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:26:18,518 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 14:26:19,718 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:26:19,725 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:26:30,489 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 14:26:30,497 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 14:26:30,502 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:26:30,953 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:26:30,955 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:26:32,928 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 14:26:32,928 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:26:33,570 - ispa_next.main - DEBUG - 



2025-11-17 14:26:33,570 - ispa_next.main - DEBUG - starting with process 4 (PF-DN 2121) of 20
2025-11-17 14:26:33,576 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:26:34,478 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:26:35,283 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:26:35,284 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 14:26:36,421 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:26:36,422 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:26:47,607 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 14:26:47,617 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 14:26:47,622 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:26:48,140 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:26:48,142 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:26:50,687 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 14:26:50,687 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:26:51,552 - ispa_next.main - DEBUG - 



2025-11-17 14:26:51,552 - ispa_next.main - DEBUG - starting with process 5 (M-NC 1407) of 20
2025-11-17 14:26:51,557 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:26:52,853 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:26:54,071 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:26:54,072 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 14:26:55,406 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:26:55,407 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:27:07,168 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 14:27:07,177 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 14:27:07,183 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:27:07,592 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:27:07,594 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:27:09,992 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 14:27:09,993 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:27:10,851 - ispa_next.main - DEBUG - 



2025-11-17 14:27:10,851 - ispa_next.main - DEBUG - starting with process 6 (EBE-B 5739) of 20
2025-11-17 14:27:10,855 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:27:12,071 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:27:13,201 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:27:13,203 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 14:27:14,702 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:27:14,703 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:27:36,925 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:27:46,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:27:47,961 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:27:47,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:48,093 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:27:48,305 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:27:48,309 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:27:51,188 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:27:51,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:27:51,387 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 14:27:51,705 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 14:27:51,721 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:27:51,722 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:27:52,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:27:52,849 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:27:52,851 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:27:52,878 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:27:54,694 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 14:27:54,698 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:27:55,887 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:27:55,888 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:27:58,747 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 14:27:58,748 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:27:59,774 - ispa_next.main - DEBUG - 



2025-11-17 14:27:59,774 - ispa_next.main - DEBUG - starting with process 7 (M-S 9974 E) of 20
2025-11-17 14:27:59,779 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:28:01,054 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:28:01,884 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:28:01,885 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 14:28:02,964 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:28:02,965 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:28:25,612 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:28:35,391 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:37,323 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:28:37,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:37,392 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:28:37,573 - ispa_next.functions - DEBUG - HU date soon to be invalid in 77 days.
2025-11-17 14:28:43,570 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:28:43,573 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:28:46,321 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:28:46,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:28:46,530 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 14:28:46,872 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 14:28:46,886 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:28:46,887 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:28:47,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:28:48,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:28:48,029 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:28:48,060 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:28:49,649 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 14:28:49,653 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:28:51,168 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:28:51,169 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:28:53,318 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 14:28:53,318 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:28:53,976 - ispa_next.main - DEBUG - 



2025-11-17 14:28:53,976 - ispa_next.main - DEBUG - starting with process 8 (KEIN KENNZEICHEN) of 20
2025-11-17 14:28:53,982 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:28:54,854 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:28:55,638 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:28:55,639 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 14:28:56,973 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:28:56,975 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:29:08,511 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 14:29:08,520 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 14:29:08,525 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:29:09,102 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:29:09,103 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:29:11,488 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 14:29:11,489 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:29:12,442 - ispa_next.main - DEBUG - 



2025-11-17 14:29:12,442 - ispa_next.main - DEBUG - starting with process 9 (M-M 8234) of 20
2025-11-17 14:29:12,451 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:29:13,642 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:29:14,702 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:29:14,703 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 14:29:16,135 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:29:16,136 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:29:44,355 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:29:53,751 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:29:55,658 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:29:55,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:29:55,729 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:29:55,890 - ispa_next.functions - DEBUG - HU date soon to be invalid in 11 days.
2025-11-17 14:30:02,231 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:30:02,237 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:30:05,102 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:30:05,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:30:06,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:30:08,201 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:30:08,298 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:30:11,489 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:30:11,547 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:30:11,548 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:30:22,936 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:30:23,944 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:30:23,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:24,475 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:35,170 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:30:42,355 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:30:42,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:42,464 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:30:42,464 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:30:42,502 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:30:42,594 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:30:43,750 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:30:43,976 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:30:46,825 - ispa_next.functions - DEBUG - Updated appointment (AB00017536) customer contact data.
2025-11-17 14:30:47,748 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:30:47,751 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:30:47,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:30:48,568 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:30:50,088 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:30:50,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:30:50,154 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:30:53,749 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:30:53,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:30:54,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:30:56,259 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:30:56,379 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:30:56,516 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:30:56,603 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:30:56,604 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:31:08,128 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:32:08,131 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:32:19,547 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:32:26,697 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:32:26,698 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:32:30,933 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:32:31,940 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:32:31,944 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:32:31,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:32:32,067 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:32:32,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:32:33,030 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:32:33,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:32:33,697 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:32:33,698 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:32:35,617 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:32:35,620 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:32:36,907 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:32:36,910 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:32:36,913 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:32:36,915 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:32:36,916 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:32:36,917 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:32:36,918 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:32:36,919 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:32:36,920 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:32:36,921 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:32:36,925 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:32:36,928 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:32:36,928 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:38,788 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:32:38,791 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:32:38,793 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:40,697 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:32:40,700 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:32:40,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:32:41,331 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:32:41,516 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:49,903 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:32:49,908 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:51,815 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:33:03,349 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:33:03,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:33:04,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:33:04,577 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:33:22,856 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:33:26,937 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:33:26,941 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:33:26,942 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:33:27,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:33:27,582 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:33:27,585 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:33:29,300 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:33:37,860 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:33:38,236 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 14:33:38,643 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:33:39,592 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:33:39,593 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:33:41,966 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 14:33:41,967 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:33:42,660 - ispa_next.main - DEBUG - 



2025-11-17 14:33:42,660 - ispa_next.main - DEBUG - starting with process 10 (M-NN 369) of 20
2025-11-17 14:33:42,667 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:33:43,479 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:33:44,300 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:33:44,301 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 14:33:45,486 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:33:45,488 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:34:20,411 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:34:29,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:34:29,117 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:34:29,229 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:34:30,468 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:34:30,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:34:30,531 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:34:30,714 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:34:30,716 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:34:33,460 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:34:33,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:34:34,527 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:34:36,533 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:34:36,651 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:34:39,879 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:34:39,943 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:34:39,944 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:34:51,268 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:34:52,273 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:34:52,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:34:52,847 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:35:06,661 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:35:14,239 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:35:14,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:35:14,313 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:35:14,314 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:35:14,370 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:35:14,494 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:35:15,721 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:35:15,947 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:35:20,171 - ispa_next.functions - DEBUG - Updated appointment (AA00022850) customer contact data.
2025-11-17 14:35:21,084 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:35:21,090 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:35:21,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:35:22,034 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:35:23,456 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:35:23,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:35:23,522 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:35:27,992 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:35:27,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:35:28,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:35:30,479 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:35:30,577 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:35:30,679 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:35:30,748 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:35:30,748 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:35:42,194 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:36:42,196 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:36:53,022 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:37:00,502 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:37:00,502 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:37:04,646 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:37:05,654 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:37:05,657 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:37:05,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:37:05,727 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:37:09,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:37:10,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:37:10,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:37:10,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:37:10,798 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:37:12,701 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:37:12,703 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:37:13,918 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:37:13,919 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:37:13,920 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:37:13,921 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:37:13,923 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:37:13,923 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:37:13,924 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:37:13,925 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:37:13,926 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:37:13,927 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:37:13,931 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:37:13,934 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:37:13,934 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:37:15,829 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:37:15,832 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:37:15,834 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:37:17,684 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:37:17,686 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:37:17,687 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:37:18,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:37:18,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:37:31,871 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:37:31,876 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:37:33,845 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:37:45,075 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:37:45,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:37:46,091 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:37:46,222 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:38:04,364 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:38:08,920 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:38:08,924 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:38:08,924 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:38:09,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:38:09,524 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:38:09,527 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:38:10,862 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:38:17,009 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:38:17,388 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 14:38:17,695 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:38:19,446 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:38:19,447 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:38:21,551 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 14:38:21,551 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:38:22,289 - ispa_next.main - DEBUG - 



2025-11-17 14:38:22,289 - ispa_next.main - DEBUG - starting with process 11 (M-OO 348) of 20
2025-11-17 14:38:22,294 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:38:23,397 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:38:24,605 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:38:24,607 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 14:38:26,009 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:38:26,010 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:38:57,962 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:39:07,819 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:39:09,704 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:39:09,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:39:09,791 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:39:09,962 - ispa_next.functions - DEBUG - HU date already expired after 110 days.
2025-11-17 14:39:16,669 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:39:16,672 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:39:19,412 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:39:19,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:39:20,372 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:39:22,375 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:39:22,476 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:39:25,666 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:39:25,723 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:39:25,723 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:39:37,002 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:39:38,008 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:39:38,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:39:38,499 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:39:50,607 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:39:57,902 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:39:57,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:39:57,975 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:39:57,976 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:39:58,049 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:39:58,155 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:39:59,334 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:39:59,548 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:40:02,710 - ispa_next.functions - DEBUG - Updated appointment (AA00022848) customer contact data.
2025-11-17 14:40:03,642 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:40:03,645 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:40:03,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:40:04,528 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:40:06,023 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:40:06,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:40:06,107 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:40:09,681 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:40:09,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:40:10,152 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:40:12,156 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:40:12,254 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:40:12,342 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:40:12,405 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:40:12,405 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:40:23,908 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:41:23,911 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:41:35,346 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:41:58,349 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:42:09,374 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:42:16,342 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:42:17,349 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:42:17,352 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:42:17,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:42:17,512 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:42:17,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:18,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:18,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:42:19,153 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:42:19,153 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:42:21,056 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:42:21,061 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:42:22,448 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:42:22,449 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:42:22,451 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:42:22,452 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:42:22,453 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:42:22,454 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:42:22,455 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:42:22,457 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:42:22,458 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:42:22,460 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:42:22,470 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:42:22,473 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:42:22,474 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:42:24,330 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:42:24,333 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:42:24,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:42:26,255 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:42:26,258 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:42:26,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:42:27,030 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:42:27,067 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:42:27,070 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:42:28,975 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:42:39,850 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:42:40,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:42:40,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:42:40,883 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:42:59,274 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:43:03,872 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:43:03,875 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:43:03,876 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:43:04,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:43:04,508 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:43:04,511 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:43:06,283 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:43:14,309 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:43:14,706 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 14:43:15,051 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:43:16,135 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:43:16,137 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:43:18,799 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 14:43:18,800 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:43:19,453 - ispa_next.main - DEBUG - 



2025-11-17 14:43:19,453 - ispa_next.main - DEBUG - starting with process 12 (M-H 8611E) of 20
2025-11-17 14:43:19,458 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:43:20,351 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:43:21,194 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:43:21,196 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 14:43:22,466 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:43:22,467 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:43:58,162 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:44:08,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:08,141 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:44:08,349 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:44:10,319 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:44:10,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:10,429 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:44:10,674 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:44:10,678 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:44:13,532 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:44:13,534 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:44:14,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:44:16,867 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:44:16,981 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:44:20,219 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:44:20,289 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:44:20,290 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:44:31,792 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:44:32,798 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:44:32,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:33,329 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:42,244 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 14:44:49,815 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:44:49,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:49,931 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:44:49,931 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:44:50,262 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:44:51,543 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:44:51,754 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:44:55,795 - ispa_next.functions - DEBUG - Updated appointment (AC00016446) customer contact data.
2025-11-17 14:44:56,772 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:44:56,776 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:44:57,573 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:44:57,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:44:58,383 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:45:02,387 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 14:45:02,388 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:45:02,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:45:03,061 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:45:05,064 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:45:05,189 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:45:05,306 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:45:05,395 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:45:05,395 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:45:16,884 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:46:16,886 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:46:28,417 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:46:58,424 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:47:09,521 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:47:16,610 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:47:17,631 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:47:17,636 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:47:17,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:47:17,706 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:47:23,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:47:23,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:47:23,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:47:24,554 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:47:24,555 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:47:26,476 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:47:26,477 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:47:27,548 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:47:27,549 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:47:27,556 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:47:27,558 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:47:27,561 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:47:27,564 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:47:27,565 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:47:27,566 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:47:27,567 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:47:27,569 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:47:27,572 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:47:27,576 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:47:27,577 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:47:29,481 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:47:29,484 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:47:29,486 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:47:31,461 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:47:31,463 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:47:31,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:47:32,191 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:47:32,237 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:47:32,263 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:47:34,124 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:47:44,836 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:47:45,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:47:46,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:47:46,231 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:48:04,399 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:48:08,961 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:48:08,965 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:48:08,966 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:48:09,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:48:09,673 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:48:09,675 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:48:11,685 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:48:19,491 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:48:19,891 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 14:48:20,146 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:48:21,092 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:48:21,093 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:48:23,517 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 14:48:23,517 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:48:24,193 - ispa_next.main - DEBUG - 



2025-11-17 14:48:24,194 - ispa_next.main - DEBUG - starting with process 13 (KA-RA 185) of 20
2025-11-17 14:48:24,222 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:48:25,084 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:48:25,973 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:48:25,974 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 14:48:27,131 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:48:27,132 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:48:58,031 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:49:07,526 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:49:11,532 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:49:11,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:49:11,627 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:49:11,764 - ispa_next.functions - DEBUG - HU date already expired after 118 days.
2025-11-17 14:49:18,953 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:49:18,957 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:49:21,795 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:49:21,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:49:23,302 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:49:25,310 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:49:25,437 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:49:25,521 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:49:25,649 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:49:25,649 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:49:37,259 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:49:38,268 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:49:38,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:49:38,752 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:49:50,721 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:49:58,891 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:49:58,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:49:58,971 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:49:58,972 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:49:59,008 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:50:00,232 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:50:01,360 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:50:01,600 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:50:04,912 - ispa_next.functions - DEBUG - Updated appointment (AH00009556) customer contact data.
2025-11-17 14:50:05,834 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:50:05,838 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:50:06,700 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:50:06,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:50:07,575 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:50:11,649 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:50:11,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:50:12,153 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:50:14,155 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:50:14,286 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:50:14,389 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:50:14,478 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:50:14,478 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:50:25,718 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:50:32,835 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:50:32,836 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:50:37,045 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:50:38,053 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:50:38,057 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:50:38,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:50:38,126 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:50:38,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:39,050 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:39,051 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:50:39,762 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:50:39,762 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:50:43,457 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:50:43,461 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:50:44,437 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:50:44,439 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:50:44,440 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:50:44,441 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:50:44,443 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:50:44,444 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:50:44,446 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:50:44,447 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:50:44,448 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:50:44,449 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:50:44,453 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:50:44,457 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:50:44,457 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:50:48,488 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:50:48,491 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:50:48,495 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:50:52,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:50:52,579 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:51:02,009 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:51:16,150 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:51:16,153 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:51:16,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:51:17,092 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:51:17,323 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:51:28,425 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:51:28,436 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:51:32,370 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:51:44,172 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:51:44,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:51:45,266 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:51:45,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:52:24,286 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:52:30,373 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:52:30,374 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:52:31,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:52:31,107 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:52:31,109 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:52:34,622 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:52:43,177 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:52:43,569 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 14:52:44,343 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:52:45,568 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 812
2025-11-17 14:52:45,570 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:52:48,537 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 14:52:48,538 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:52:49,435 - ispa_next.main - DEBUG - 



2025-11-17 14:52:49,435 - ispa_next.main - DEBUG - starting with process 14 (STA-UZ 888) of 20
2025-11-17 14:52:49,445 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:52:50,548 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:52:51,751 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 812
2025-11-17 14:52:51,753 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 14:52:53,754 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:52:53,756 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:53:30,098 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:53:39,715 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:53:41,602 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:53:41,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:53:41,702 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:53:41,887 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:53:41,890 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:53:44,672 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:53:44,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:53:45,901 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:53:47,904 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:53:48,022 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:53:51,280 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:53:51,344 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:53:51,345 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:54:02,895 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:54:03,901 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:54:03,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:54:04,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:54:16,111 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:54:16,111 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:54:23,755 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:54:23,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:54:23,859 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:54:23,860 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:54:23,895 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:54:25,196 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:54:25,406 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:54:28,641 - ispa_next.functions - DEBUG - Updated appointment (AH00009553) customer contact data.
2025-11-17 14:54:29,574 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:54:29,645 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:54:30,241 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:54:30,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:54:30,987 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:54:35,490 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:54:35,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:54:36,508 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:54:38,513 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:54:38,659 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:54:38,792 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:54:38,889 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:54:38,890 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:54:50,354 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:55:50,356 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:56:02,081 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:56:31,084 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:56:42,636 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:56:50,950 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:56:51,973 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:56:51,976 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:56:51,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:56:52,107 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:57:00,072 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:57:00,566 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:57:00,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:57:01,439 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:57:01,440 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:57:03,885 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:57:03,889 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:57:04,956 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:57:04,960 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:57:04,962 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:57:04,964 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:57:04,967 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:57:04,968 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:57:04,969 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:57:04,971 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:57:04,972 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:57:04,973 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:57:04,977 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:57:04,980 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:57:04,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:57:07,603 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:57:07,605 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:57:07,607 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:57:10,178 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:57:10,181 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:57:10,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:57:10,896 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:57:10,937 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:57:10,939 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:57:13,499 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:57:23,434 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:57:23,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:57:24,576 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:57:24,729 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:57:49,974 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:57:54,064 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:57:58,392 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:57:58,395 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:57:58,396 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:57:59,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:57:59,150 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:57:59,153 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:58:01,207 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:58:09,288 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:58:09,662 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 14:58:10,140 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:58:11,479 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:58:11,481 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:58:14,597 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 14:58:14,598 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:58:15,377 - ispa_next.main - DEBUG - 



2025-11-17 14:58:15,377 - ispa_next.main - DEBUG - starting with process 15 (M-J 2479) of 20
2025-11-17 14:58:15,383 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:58:16,570 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:58:17,781 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 811
2025-11-17 14:58:17,783 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 14:58:19,320 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:58:19,321 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:58:59,897 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:59:09,388 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:59:11,308 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:59:11,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:59:11,386 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:59:11,568 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:59:11,572 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:59:14,384 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:59:14,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:59:15,554 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:59:17,557 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:59:17,693 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:59:20,900 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:59:20,979 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:59:20,980 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:59:32,652 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:59:33,659 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:59:33,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:59:34,153 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:59:45,235 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:59:52,863 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:59:52,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:59:52,932 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:59:52,933 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:59:52,977 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:59:54,224 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:59:54,434 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:59:57,683 - ispa_next.functions - DEBUG - Updated appointment (AE00013806) customer contact data.
2025-11-17 14:59:58,664 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:59:58,667 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:59:59,576 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:59:59,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:00:00,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:00:04,981 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:00:05,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:00:05,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:00:07,590 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:00:07,750 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:00:07,876 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:00:07,977 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:00:07,978 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:00:20,153 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:01:20,154 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:01:31,754 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:02:00,756 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:02:13,178 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 15:02:22,165 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 15:02:23,172 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:02:23,176 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:02:23,177 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:02:23,276 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:02:27,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:02:28,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:02:28,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:02:28,698 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:02:28,699 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:02:31,204 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:02:31,214 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:02:32,377 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:02:32,379 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:02:32,380 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:02:32,382 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:02:32,383 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:02:32,385 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:02:32,386 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:02:32,388 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:02:32,394 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:02:32,412 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:02:32,418 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:02:32,422 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:02:32,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:02:35,035 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:02:35,039 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:02:35,040 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:02:37,780 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:02:37,783 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:02:37,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:02:38,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:02:38,690 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:02:38,693 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:02:41,316 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:02:51,500 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:02:51,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:02:52,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:02:52,691 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:03:17,586 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:03:21,536 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:03:25,832 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:03:25,836 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:03:25,836 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:03:26,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:03:26,442 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:03:26,445 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:03:28,045 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:03:35,373 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:03:35,753 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 15:03:36,186 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:03:37,510 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 813
2025-11-17 15:03:37,512 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:03:40,573 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 409
2025-11-17 15:03:40,574 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:03:41,449 - ispa_next.main - DEBUG - 



2025-11-17 15:03:41,449 - ispa_next.main - DEBUG - starting with process 16 (M-WO 697) of 20
2025-11-17 15:03:41,455 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:03:42,716 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:03:43,928 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 813
2025-11-17 15:03:43,930 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 409
2025-11-17 15:03:45,561 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:03:45,563 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:04:28,048 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:04:37,841 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:04:39,848 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:04:39,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:04:39,960 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:04:40,196 - ispa_next.functions - DEBUG - HU date already expired after 20 days.
2025-11-17 15:04:47,848 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:04:47,853 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:04:50,708 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:04:50,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:04:52,162 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:04:54,167 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:04:54,305 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:04:57,514 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:04:57,605 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:04:57,605 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:05:09,058 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:05:10,063 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:05:10,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:05:10,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:05:25,070 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:05:32,862 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:05:32,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:05:32,931 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:05:32,932 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:05:33,054 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:05:33,161 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:05:34,974 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:05:35,218 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:05:38,622 - ispa_next.functions - DEBUG - Updated appointment (AE00013803) customer contact data.
2025-11-17 15:05:39,535 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:05:39,627 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:05:39,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:05:40,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:05:42,263 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:05:42,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:05:42,329 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:05:45,919 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:05:45,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:05:46,409 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:05:48,412 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:05:48,511 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:05:48,633 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:05:48,691 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:05:48,692 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:06:00,247 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:07:00,250 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:07:11,616 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:07:28,619 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:07:40,377 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 15:07:47,952 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 15:07:48,959 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:07:48,963 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:07:48,964 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:07:49,078 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:07:49,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:07:49,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:07:49,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:07:50,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:07:50,725 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:07:52,653 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:07:52,654 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:07:54,041 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:07:54,044 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:07:54,049 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:07:54,053 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:07:54,057 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:07:54,059 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:07:54,060 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:07:54,062 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:07:54,063 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:07:54,065 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:07:54,070 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:07:54,072 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:07:54,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:56,030 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:07:56,033 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:07:56,035 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:57,959 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:07:57,962 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:07:57,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:07:58,874 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:07:58,918 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:07:58,924 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:08:00,856 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:08:11,214 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:08:11,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:08:12,196 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:08:12,316 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:08:30,546 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:08:35,325 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:08:35,328 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:08:35,329 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:08:36,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:08:36,147 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:08:36,149 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:08:38,125 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:08:46,701 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:08:47,125 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 15:08:47,770 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:08:49,271 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 813
2025-11-17 15:08:49,273 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:08:52,862 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 15:08:52,864 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:08:53,797 - ispa_next.main - DEBUG - 



2025-11-17 15:08:53,797 - ispa_next.main - DEBUG - starting with process 17 (M-BG 7775) of 20
2025-11-17 15:08:53,802 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:08:55,099 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:08:56,402 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 813
2025-11-17 15:08:56,404 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 15:08:58,355 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:08:58,356 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:09:31,602 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:09:42,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:09:49,752 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:09:49,753 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:09:49,845 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:09:50,045 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:09:50,050 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:09:53,120 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:09:53,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:09:54,586 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:09:56,591 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:09:56,713 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:09:59,970 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 15:10:07,284 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 15:10:08,291 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:10:08,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:10:08,765 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:10:21,638 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:10:21,638 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:10:29,862 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:10:29,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:10:29,954 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:10:29,956 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:10:30,025 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:10:31,314 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:10:32,538 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:10:32,763 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:10:36,075 - ispa_next.functions - DEBUG - Updated appointment (AE00013802) customer contact data.
2025-11-17 15:10:37,125 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:10:37,130 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:10:38,200 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:10:38,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:10:39,261 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:10:42,823 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:10:42,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:10:43,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:10:45,340 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:10:45,467 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:10:45,568 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:10:45,648 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:10:45,648 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:10:57,468 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:11:57,471 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:12:09,019 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:12:32,021 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:12:44,114 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 15:12:53,197 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 15:12:54,252 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:12:54,258 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:12:54,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:54,329 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:12:54,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:55,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:55,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:56,076 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:12:56,077 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:13:02,740 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:13:02,742 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:13:04,054 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:13:04,055 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:13:04,057 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:13:04,058 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:13:04,059 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:13:04,060 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:13:04,061 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:13:04,062 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:13:04,063 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:13:04,065 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:13:04,068 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:13:04,072 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:13:04,072 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:13:11,474 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 15:13:14,534 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:13:14,556 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:13:14,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:13:22,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:13:22,536 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:13:31,688 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:13:50,137 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:13:50,140 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:13:50,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:13:51,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:13:51,130 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:13:51,135 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:13:58,809 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:14:11,338 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:14:11,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:14:12,304 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:14:12,513 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:15:26,418 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:15:31,967 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:15:37,334 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:15:42,365 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:15:47,367 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:15:53,676 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:15:53,676 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:15:54,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:15:54,363 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:15:54,365 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:15:57,628 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:16:05,575 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:16:05,963 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 15:16:07,497 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:16:08,266 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 813
2025-11-17 15:16:08,267 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:16:11,168 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 15:16:11,169 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:16:11,908 - ispa_next.main - DEBUG - 



2025-11-17 15:16:11,908 - ispa_next.main - DEBUG - starting with process 18 (FS-XX 555) of 20
2025-11-17 15:16:11,913 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:16:12,874 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:16:13,895 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 813
2025-11-17 15:16:13,896 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 15:16:15,427 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:16:15,428 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:16:44,373 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:16:55,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:16:57,811 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:16:57,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:57,889 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:16:58,112 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:16:58,116 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:17:00,977 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:17:00,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:17:01,883 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:17:03,886 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:17:03,962 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_cbs_table
2025-11-17 15:17:04,968 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:17:04,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:05,467 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:19,112 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:17:27,822 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:17:27,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:27,924 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:27,925 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:17:27,961 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:17:28,087 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:17:29,379 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:17:29,620 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:17:31,625 - ispa_next.functions - DEBUG - Updated appointment (AE00013800) customer contact data.
2025-11-17 15:17:32,582 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:17:32,587 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:17:32,716 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:17:33,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:17:35,442 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:17:35,446 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:17:35,519 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:17:39,100 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:17:39,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:17:39,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:17:41,582 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:17:41,700 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_cbs_table
2025-11-17 15:17:42,707 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:17:42,712 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:17:42,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:17:42,782 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:17:47,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:47,622 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:47,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:17:48,435 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:17:48,436 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:17:51,006 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:17:51,020 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:17:52,244 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:17:52,245 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:17:52,247 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:17:52,248 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:17:52,250 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:17:52,251 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:17:52,252 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:17:52,253 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:17:52,255 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:17:52,260 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:17:52,266 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:17:52,270 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:17:52,270 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:17:54,896 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:17:54,899 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:17:54,902 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:17:57,551 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:17:57,555 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:17:57,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:17:58,297 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:17:58,343 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:17:58,346 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:18:01,003 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:18:12,207 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:18:12,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:18:13,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:18:13,394 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:18:39,171 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:18:44,339 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:18:49,452 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:18:49,455 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:18:49,455 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:18:50,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:18:50,175 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:18:50,178 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:18:52,414 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:19:00,049 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:19:00,430 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 15:19:00,833 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:19:02,286 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 813
2025-11-17 15:19:02,287 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:19:05,207 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 15:19:05,208 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:19:05,907 - ispa_next.main - DEBUG - 



2025-11-17 15:19:05,907 - ispa_next.main - DEBUG - starting with process 19 (M-RB 3900) of 20
2025-11-17 15:19:05,913 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:19:07,709 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:19:08,957 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 813
2025-11-17 15:19:08,958 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 15:19:10,423 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-17 15:19:10,424 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:19:10,639 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 40, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 148, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-17 15:19:10,639 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-17 15:19:10,643 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:19:11,230 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 813
2025-11-17 15:19:11,231 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-17 15:19:13,948 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 15:19:13,949 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:19:14,617 - ispa_next.main - DEBUG - 



2025-11-17 15:19:14,617 - ispa_next.main - DEBUG - starting with process 20 (M-H 8898) of 20
2025-11-17 15:19:14,621 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:19:15,569 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:19:16,520 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 813
2025-11-17 15:19:16,521 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 15:19:17,930 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:19:17,931 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:19:56,031 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:20:06,776 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:08,764 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:20:08,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:20:08,863 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:20:09,153 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:20:09,157 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:20:11,901 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:20:11,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:20:13,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:20:15,320 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:20:15,475 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:20:18,675 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:20:18,754 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:20:18,754 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:20:30,759 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:20:31,764 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:20:31,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:20:32,277 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:20:47,109 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:20:55,211 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:20:55,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:20:55,280 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:20:55,281 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:20:55,314 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:20:55,457 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:20:56,725 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:20:56,961 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:21:01,164 - ispa_next.functions - DEBUG - Updated appointment (AE00013796) customer contact data.
2025-11-17 15:21:02,099 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:21:02,102 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:21:02,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:21:03,477 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:21:05,094 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:21:05,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:21:05,159 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:21:08,723 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:21:08,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:21:09,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:21:11,206 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:21:11,350 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:21:11,446 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:21:11,531 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:21:11,531 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:21:23,390 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:22:23,398 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:22:35,593 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:22:56,596 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:23:08,527 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 15:23:17,149 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 15:23:18,157 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:23:18,160 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:23:18,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:23:18,265 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:23:18,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:19,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:19,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:23:19,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:23:19,883 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:23:21,755 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:23:21,761 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:23:23,277 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:23:23,279 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:23:23,280 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:23:23,281 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:23:23,283 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:23:23,290 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:23:23,292 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:23:23,296 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:23:23,299 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:23:23,300 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:23:23,305 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:23:23,308 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:23:23,309 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:23:25,296 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:23:25,300 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:23:25,302 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:23:27,235 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:23:27,238 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:23:27,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:23:28,145 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:23:28,230 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:23:28,232 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:23:30,209 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:23:41,696 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:23:42,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:23:42,794 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:23:42,935 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:24:01,548 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:24:06,615 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:24:06,619 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:24:06,620 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:24:07,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:24:07,465 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:24:07,468 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:24:09,478 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:24:18,129 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:24:18,521 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-17 15:24:19,126 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:24:20,554 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 813
2025-11-17 15:24:20,554 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:24:23,442 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 15:24:23,443 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
