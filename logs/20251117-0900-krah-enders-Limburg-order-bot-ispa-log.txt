2025-11-17 09:14:37,736 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 09:14:37,761 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 09:14:45,378 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:14:56,787 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:15:12,649 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:17:11,175 - ispa_next.app_start.main - DEBUG - Operation already took 107.14 seconds (more than 80 seconds)
2025-11-17 09:17:13,241 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_2qpz7f0h_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_2qpz7f0h', 'txt']
2025-11-17 09:17:13,500 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:17:13,504 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:17:13,504 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:19:12,476 - ispa_next.app_start.main - DEBUG - Operation already took 106.70 seconds (more than 80 seconds)
2025-11-17 09:19:14,581 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_q9qa8wzg_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_q9qa8wzg', 'txt']
2025-11-17 09:19:14,809 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:19:14,814 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:19:21,766 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 09:19:29,595 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:19:40,852 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:19:56,287 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:21:54,348 - ispa_next.app_start.main - DEBUG - Operation already took 107.03 seconds (more than 80 seconds)
2025-11-17 09:21:56,456 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_4xvc6p_o_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_4xvc6p_o', 'txt']
2025-11-17 09:21:56,728 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:21:56,732 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:21:56,733 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:23:55,241 - ispa_next.app_start.main - DEBUG - Operation already took 106.14 seconds (more than 80 seconds)
2025-11-17 09:23:57,295 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_m0z5p55q_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_m0z5p55q', 'txt']
2025-11-17 09:23:57,537 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:23:57,543 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:24:04,488 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 09:24:12,414 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:24:22,877 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:24:38,390 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:26:36,393 - ispa_next.app_start.main - DEBUG - Operation already took 106.96 seconds (more than 80 seconds)
2025-11-17 09:26:38,451 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_fvi9glog_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_fvi9glog', 'txt']
2025-11-17 09:26:38,687 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:26:38,692 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:26:38,692 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:28:37,679 - ispa_next.app_start.main - DEBUG - Operation already took 106.72 seconds (more than 80 seconds)
2025-11-17 09:28:39,795 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_cx0cwwfn_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_cx0cwwfn', 'txt']
2025-11-17 09:28:40,036 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:28:40,041 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:28:46,903 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-17 09:28:56,193 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:29:06,510 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:29:22,052 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:31:20,673 - ispa_next.app_start.main - DEBUG - Operation already took 107.56 seconds (more than 80 seconds)
2025-11-17 09:31:22,761 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_7j7vofp__input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\727652b2525c37ab\\tess_7j7vofp_', 'txt']
2025-11-17 09:31:23,032 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:31:23,036 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:31:23,037 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:31:47,690 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 09:31:58,587 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 09:32:01,110 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:32:02,278 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 532
2025-11-17 09:32:02,280 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 145
2025-11-17 09:32:04,448 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 115
2025-11-17 09:32:04,449 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 09:32:04,450 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:32:05,310 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:32:06,090 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:32:19,460 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:32:19,466 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:32:19,466 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:32:19,467 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:32:19,467 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:32:19,467 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:32:19,480 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:32:19,508 - ispa_next.main - DEBUG - Found 9 out of 49 appointments to process (configured limit: 15).
2025-11-17 09:32:19,508 - ispa_next.main - DEBUG - Processing 9 fresh appointments.
2025-11-17 09:32:19,508 - ispa_next.main - DEBUG - All appointments: GOA-AS 14, LM-VT 42, LM-PJ 77, LM-CJ 15, LM-MZ 821, LM-CH 650, LM-S 556 E, WW-LR 23 E, ENS-MP-48
2025-11-17 09:32:19,511 - ispa_next.main - DEBUG - 



2025-11-17 09:32:19,511 - ispa_next.main - DEBUG - starting with process 1 (GOA-AS 14) of 9
2025-11-17 09:32:19,516 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:32:20,671 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:32:21,872 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 532
2025-11-17 09:32:21,874 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 115
2025-11-17 09:32:23,269 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:32:23,271 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:32:48,540 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:32:58,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:32:58,620 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:32:58,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:33:00,682 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:33:00,683 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:00,780 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:33:00,946 - ispa_next.functions - DEBUG - HU date soon to be invalid in 87 days.
2025-11-17 09:33:07,606 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:33:07,609 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:33:07,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:07,671 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:33:10,726 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:33:10,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:33:11,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:33:13,659 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:33:13,775 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:33:17,008 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:33:17,082 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:33:17,082 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:33:28,356 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:33:29,360 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:33:29,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:29,865 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:40,458 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:33:47,572 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:33:47,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:47,670 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:33:47,677 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:33:47,712 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:33:48,990 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:33:49,195 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:33:53,056 - ispa_next.functions - DEBUG - Updated appointment (AB00018812) customer contact data.
2025-11-17 09:33:53,960 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:33:53,962 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:33:54,673 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:33:54,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:33:55,370 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:33:58,970 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:33:58,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:33:59,459 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:34:01,462 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:34:01,580 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:34:01,670 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:34:01,854 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:34:01,855 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:34:13,516 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:34:20,629 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:34:20,630 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:34:24,811 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:34:25,817 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:34:25,818 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:34:25,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:34:25,907 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:34:30,029 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:34:30,034 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:34:30,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:34:30,105 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:34:39,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:34:40,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:34:40,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:34:40,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:34:40,766 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:34:42,594 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:34:42,599 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:34:43,594 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:34:43,598 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:34:43,602 - ispa_next.package_manager.main - DEBUG - Cannot place FAHRZEUGWÄSCHE BASIS: active placement guards
2025-11-17 09:34:43,604 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug Innenraum saugen: active placement guards
2025-11-17 09:34:43,606 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:34:43,607 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:34:43,609 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 09:34:43,610 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:34:43,611 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:34:43,612 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:34:43,615 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:34:43,616 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:34:43,618 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:34:43,621 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:34:43,622 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:34:43,623 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:45,521 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:34:45,523 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:34:45,524 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:47,383 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:34:47,385 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:34:47,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:34:48,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:34:48,195 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:57,201 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:34:57,202 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:59,106 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:35:10,506 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:35:10,989 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:35:11,462 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:35:11,577 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:16,728 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:35:16,730 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:35:16,731 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:35:17,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:35:17,476 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:35:17,477 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:35:19,239 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:35:29,820 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:35:30,207 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 09:35:30,776 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:35:31,447 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-17 09:35:31,448 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:35:34,460 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 09:35:34,461 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:35:35,221 - ispa_next.appointments.models - DEBUG - Appointment Firma K. Dörflinger Gesellschaft für EMS-KD 911 WBA41EU0709T58033 ohne Termin.
2025-11-17 09:35:35,229 - ispa_next.appointments.models - DEBUG - Appointment Firma Autohaus Krah + Enders FD-LI 32 E WBY71HH000CW21184 ohne Termin.
2025-11-17 09:35:35,238 - ispa_next.appointments.models - DEBUG - Appointment Andreas Kunz LM-A 379 WBAJN71060CD14635 ohne Termin.
2025-11-17 09:35:35,247 - ispa_next.main - DEBUG - 



2025-11-17 09:35:35,247 - ispa_next.main - DEBUG - starting with process 2 (LM-VT 42) of 9
2025-11-17 09:35:35,250 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:35:36,132 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:35:37,388 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-17 09:35:37,389 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 09:35:38,655 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:35:38,656 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:35:59,984 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:36:09,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:36:09,228 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:36:09,362 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:36:10,589 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:36:10,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:36:10,652 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:36:10,832 - ispa_next.functions - DEBUG - HU date soon to be invalid in 88 days.
2025-11-17 09:36:17,500 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:36:17,503 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:36:17,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:36:17,625 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:36:20,633 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:36:20,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:36:21,628 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:36:23,633 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:36:23,761 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:36:26,993 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:36:27,050 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:36:27,050 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:36:38,334 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:36:39,353 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:36:39,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:36:39,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:36:50,769 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:36:58,559 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:36:58,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:36:58,638 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:36:58,638 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:36:58,681 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:36:59,965 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:37:00,207 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:37:04,221 - ispa_next.functions - DEBUG - Updated appointment (AB00018811) customer contact data.
2025-11-17 09:37:05,145 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:37:05,147 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:37:05,752 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:37:05,753 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:37:06,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:37:10,861 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:37:10,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:37:11,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:37:13,373 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:37:13,472 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:37:13,624 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:37:13,717 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:37:13,717 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:37:24,699 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:37:31,594 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:37:31,594 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:37:35,777 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:37:36,783 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:37:36,784 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:37:36,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:37:36,852 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:37:40,965 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:37:40,969 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:37:40,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:37:41,041 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:37:46,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:37:47,115 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:37:47,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:37:47,781 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:37:47,783 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:37:49,062 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:37:49,066 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:37:50,292 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:37:50,293 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:37:50,296 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart), Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 09:37:50,298 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:37:50,300 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 09:37:50,302 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:37:50,304 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:37:50,306 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:37:50,310 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:37:50,316 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:37:50,320 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:37:50,324 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:37:51,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:37:51,766 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:38:05,212 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:38:05,214 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:38:05,216 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:38:05,216 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:38:07,124 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:38:07,125 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:38:07,130 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:38:09,032 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:38:09,033 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:38:09,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:38:09,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:38:09,778 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:38:18,811 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:38:18,814 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:38:20,700 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:38:31,034 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:38:31,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:38:32,096 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:38:32,261 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:38:39,301 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:38:43,449 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:38:43,451 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:38:43,452 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:38:44,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:38:44,194 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:38:44,196 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:38:46,023 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:38:53,198 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:38:53,579 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 09:38:54,364 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:38:54,928 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-17 09:38:54,929 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:38:57,702 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 09:38:57,703 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:38:58,469 - ispa_next.appointments.models - DEBUG - Appointment Firma Autohaus Krah + Enders FD-LI 32 E WBY71HH000CW21184 ohne Termin.
2025-11-17 09:38:58,477 - ispa_next.appointments.models - DEBUG - Appointment Andreas Kunz LM-A 379 WBAJN71060CD14635 ohne Termin.
2025-11-17 09:38:58,483 - ispa_next.main - DEBUG - Found new Appointment: EMS-KD 911
2025-11-17 09:38:58,485 - ispa_next.main - DEBUG - 



2025-11-17 09:38:58,485 - ispa_next.main - DEBUG - starting with process 3 (EMS-KD 911) of 10
2025-11-17 09:38:58,488 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:38:59,309 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:39:00,400 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-17 09:39:00,402 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 09:39:01,778 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:39:01,779 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:39:29,499 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:39:39,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:39:39,560 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:39:39,703 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:39:42,321 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:39:42,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:39:42,415 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:39:42,646 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:39:42,648 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:39:42,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:39:42,733 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:39:45,914 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:39:45,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:39:47,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:39:49,056 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:39:49,167 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:39:52,390 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:39:52,457 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:39:52,457 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:40:03,887 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:40:04,891 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:40:04,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:40:05,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:40:14,249 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 09:40:21,903 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:40:21,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:40:21,976 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:40:21,977 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:40:22,026 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:40:23,284 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:40:23,531 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:40:27,473 - ispa_next.functions - DEBUG - Updated appointment (AJ00001580) customer contact data.
2025-11-17 09:40:28,431 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:40:28,432 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:40:29,126 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:40:29,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:40:29,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:40:33,466 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:40:33,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:40:33,962 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:40:35,965 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:40:36,071 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:40:36,198 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:40:36,281 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:40:36,281 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:40:47,501 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:41:47,504 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:41:58,876 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:42:29,879 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:42:41,108 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 09:42:49,004 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 09:42:50,011 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:42:50,012 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:42:50,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:42:50,075 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:42:54,244 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:42:54,247 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:42:54,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:42:54,305 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:42:59,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:43:00,446 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:43:00,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:43:01,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:43:01,172 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:43:03,555 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:43:03,570 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:43:04,713 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:43:04,714 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:43:04,721 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart), Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 09:43:04,723 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:43:04,731 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 09:43:04,735 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:43:04,737 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:43:04,741 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:43:04,743 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:43:04,756 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:43:04,761 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:43:04,765 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:43:05,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:43:06,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:43:08,483 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:43:08,486 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:43:08,487 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:43:08,488 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:43:11,042 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:43:11,043 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:43:11,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:43:13,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:43:14,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:43:22,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:43:35,205 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:43:35,207 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:43:35,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:43:35,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:43:35,918 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:43:35,920 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:43:38,458 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:43:48,707 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:43:49,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:43:49,667 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:43:49,803 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:43:56,314 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:44:01,276 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:44:06,849 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:44:06,850 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:44:07,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:44:07,650 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:44:07,652 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:44:10,822 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:44:17,919 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:44:18,295 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 09:44:19,330 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:44:19,897 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-17 09:44:19,898 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:44:23,066 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 09:44:23,067 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:44:23,898 - ispa_next.appointments.models - DEBUG - Appointment Firma Autohaus Krah + Enders FD-LI 32 E WBY71HH000CW21184 ohne Termin.
2025-11-17 09:44:23,907 - ispa_next.appointments.models - DEBUG - Appointment Andreas Kunz LM-A 379 WBAJN71060CD14635 ohne Termin.
2025-11-17 09:44:23,915 - ispa_next.main - DEBUG - 



2025-11-17 09:44:23,915 - ispa_next.main - DEBUG - starting with process 4 (LM-PJ 77) of 10
2025-11-17 09:44:23,918 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:44:25,143 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:44:26,388 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-17 09:44:26,390 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 09:44:27,960 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:44:27,961 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:44:58,441 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:45:08,025 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:08,100 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:45:08,275 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:45:10,183 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:45:10,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:10,265 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:45:10,502 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:45:10,505 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:45:10,506 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:10,603 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:45:13,625 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:45:13,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:45:14,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:45:16,701 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:45:16,865 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:45:20,066 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:45:20,124 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:45:20,124 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:45:31,426 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:45:32,431 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:45:32,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:32,913 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:43,212 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:45:49,798 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:45:49,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:49,863 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:45:49,864 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:45:49,893 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:45:51,046 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:45:52,177 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:45:52,390 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:45:56,121 - ispa_next.functions - DEBUG - Updated appointment (AB00018804) customer contact data.
2025-11-17 09:45:57,054 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:45:57,056 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:45:57,921 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:45:57,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:45:58,790 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:46:02,401 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:46:02,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:46:02,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:46:04,917 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:46:05,034 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:46:05,114 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:46:05,237 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:46:05,238 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:46:15,978 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:46:23,201 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:46:23,202 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:46:27,397 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:46:28,403 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:46:28,403 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:46:28,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:46:28,474 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:46:32,618 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:46:32,622 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:46:32,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:46:32,689 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:46:37,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:46:38,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:46:38,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:46:38,709 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:46:38,711 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:46:40,589 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:46:40,593 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:46:41,816 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:46:41,817 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:46:41,819 - ispa_next.package_manager.main - DEBUG - Cannot place FAHRZEUGWÄSCHE BASIS: active placement guards
2025-11-17 09:46:41,820 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug Innenraum saugen: active placement guards
2025-11-17 09:46:41,821 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:46:41,822 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:46:41,824 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 09:46:41,826 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:46:41,827 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:46:41,828 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:46:41,829 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:46:41,830 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:46:41,832 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:46:41,835 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:46:41,836 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:46:41,837 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:46:43,786 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:46:43,788 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:46:43,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:46:45,693 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:46:45,696 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:46:45,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:46:46,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:46:46,495 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:46:51,267 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:46:51,268 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:46:53,148 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:47:04,168 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:47:04,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:47:05,169 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:47:05,341 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:47:10,806 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:47:10,808 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:47:10,808 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:47:11,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:47:11,494 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:47:11,495 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:47:13,392 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:47:21,217 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:47:21,606 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 09:47:22,225 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:47:22,864 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-17 09:47:22,866 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:47:26,064 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 09:47:26,065 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:47:26,803 - ispa_next.appointments.models - DEBUG - Appointment Firma Autohaus Krah + Enders FD-LI 32 E WBY71HH000CW21184 ohne Termin.
2025-11-17 09:47:26,814 - ispa_next.appointments.models - DEBUG - Appointment Andreas Kunz LM-A 379 WBAJN71060CD14635 ohne Termin.
2025-11-17 09:47:26,823 - ispa_next.main - DEBUG - 



2025-11-17 09:47:26,823 - ispa_next.main - DEBUG - starting with process 5 (LM-CJ 15) of 10
2025-11-17 09:47:26,827 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:47:28,052 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:47:29,313 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-17 09:47:29,317 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 09:47:30,666 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:47:30,673 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:47:50,733 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:47:59,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:48:00,051 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:48:00,282 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:48:01,517 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:48:01,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:48:01,633 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:48:01,816 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:48:01,819 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:48:01,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:48:01,914 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:48:05,131 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:48:05,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:48:06,098 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:48:08,100 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:48:08,227 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:48:11,414 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:48:11,470 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:48:11,471 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:48:22,724 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:48:23,730 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:48:23,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:48:24,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:48:35,399 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:48:42,503 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:48:42,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:48:42,600 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:48:42,602 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:48:42,640 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:48:42,749 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:48:43,989 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:48:44,216 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:48:48,066 - ispa_next.functions - DEBUG - Updated appointment (AC00019285) customer contact data.
2025-11-17 09:48:48,951 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:48:48,952 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:48:49,051 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:48:49,697 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:48:51,170 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:48:51,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:48:51,252 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:48:54,837 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:48:54,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:48:55,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:48:57,355 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:48:57,457 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:48:57,545 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:48:57,603 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:48:57,604 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:49:08,590 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:50:08,591 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:50:19,633 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:50:26,887 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:50:26,888 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:50:31,084 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:50:32,100 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:50:32,101 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:50:32,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:50:32,211 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:50:36,336 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:50:36,340 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:50:36,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:50:36,423 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:50:43,717 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:50:44,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:50:44,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:50:44,879 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:50:44,880 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:50:49,589 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:50:49,592 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:50:50,905 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:50:50,908 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:50:50,910 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart), Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 09:50:50,912 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:50:50,914 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 09:50:50,915 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:50:50,916 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:50:50,917 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:50:50,919 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:50:50,920 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:50:50,922 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:50:50,924 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:50:51,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:50:52,295 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:51:05,550 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:51:05,552 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:51:05,553 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:51:05,554 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:51:11,585 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:51:11,586 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:51:11,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:51:17,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:51:18,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:51:28,076 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:51:28,077 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:51:28,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:51:28,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:51:29,014 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:51:50,364 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:51:50,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:51:56,306 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:52:08,026 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:52:14,114 - ispa_next.common.mail - INFO - Successfully sent an email to 3 recipients
2025-11-17 09:52:14,118 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:52:14,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:52:15,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:52:15,175 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:52:27,061 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:52:31,032 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:52:36,069 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:52:41,871 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:52:41,872 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:52:42,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:52:42,628 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:52:42,629 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:52:45,830 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:52:54,368 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:52:54,761 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 09:52:55,942 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:52:56,611 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 535
2025-11-17 09:52:56,612 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:52:59,742 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 148
2025-11-17 09:52:59,742 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:53:00,579 - ispa_next.appointments.models - DEBUG - Appointment Firma Autohaus Krah + Enders FD-LI 32 E WBY71HH000CW21184 ohne Termin.
2025-11-17 09:53:00,586 - ispa_next.appointments.models - DEBUG - Appointment Andreas Kunz LM-A 379 WBAJN71060CD14635 ohne Termin.
2025-11-17 09:53:00,590 - ispa_next.main - DEBUG - Found new Appointment: EU-CC 664 E
2025-11-17 09:53:00,592 - ispa_next.main - DEBUG - 



2025-11-17 09:53:00,592 - ispa_next.main - DEBUG - starting with process 6 (EU-CC 664 E) of 11
2025-11-17 09:53:00,595 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:53:01,814 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:53:03,005 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 535
2025-11-17 09:53:03,007 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 148
2025-11-17 09:53:04,398 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:53:04,399 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:53:25,103 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:53:35,169 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:53:39,115 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:53:39,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:53:39,241 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:53:39,423 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:53:39,426 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:53:39,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:53:39,522 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:53:42,598 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:53:42,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:53:43,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:53:45,365 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:53:45,463 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:53:45,545 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:53:45,644 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:53:49,832 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:53:50,847 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:53:50,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:53:51,356 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:04,885 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 09:54:12,739 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:54:12,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:12,828 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:54:12,828 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:54:12,864 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:54:12,984 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:54:14,208 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:54:14,455 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:54:18,235 - ispa_next.functions - DEBUG - Updated appointment (AB00018827) customer contact data.
2025-11-17 09:54:19,144 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:54:19,145 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:54:19,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:54:19,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:54:21,169 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:54:21,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:54:21,230 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:54:25,682 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:54:25,682 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:54:25,685 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:54:25,704 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:54:25,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:54:26,214 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:54:30,308 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:54:30,313 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:54:30,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:54:30,407 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:54:36,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:36,579 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:36,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:54:37,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:54:37,233 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:54:40,794 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:54:40,796 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:54:42,378 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:54:42,379 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:54:42,381 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart), Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 09:54:42,382 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:54:42,385 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 09:54:42,386 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 09:54:42,387 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:54:42,389 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:54:42,390 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:54:42,392 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:54:42,393 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:54:43,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:54:43,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:54:57,136 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:54:57,137 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 09:54:59,659 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:55:00,217 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 09:55:01,172 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:55:01,727 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:55:02,280 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 09:55:03,625 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:55:04,195 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:55:04,727 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 09:55:05,663 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:55:06,224 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:55:06,783 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 09:55:07,756 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:55:08,312 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:55:08,833 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 09:55:09,763 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:55:10,318 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:55:10,852 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 09:55:11,767 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:55:13,074 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:55:13,983 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:55:14,566 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:55:15,483 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:55:16,031 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:55:16,995 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:55:17,578 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:55:17,589 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:55:17,591 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:55:21,585 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:55:21,586 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:55:21,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:55:25,456 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:55:25,457 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:55:25,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:55:25,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:55:26,109 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:55:39,301 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:55:39,356 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:55:43,390 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:55:54,170 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:55:54,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:55:55,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:55:55,250 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:56:03,479 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:56:07,440 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:56:13,418 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:56:18,134 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:56:18,149 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:56:18,150 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:56:18,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:56:18,979 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:56:18,981 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:56:20,734 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:56:28,199 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:56:28,572 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 09:56:29,674 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:56:30,426 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-17 09:56:30,428 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:56:33,541 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 150
2025-11-17 09:56:33,542 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:56:34,324 - ispa_next.appointments.models - DEBUG - Appointment Firma Autohaus Krah + Enders FD-LI 32 E WBY71HH000CW21184 ohne Termin.
2025-11-17 09:56:34,331 - ispa_next.appointments.models - DEBUG - Appointment Andreas Kunz LM-A 379 WBAJN71060CD14635 ohne Termin.
2025-11-17 09:56:34,335 - ispa_next.main - DEBUG - Found new Appointment: LM-MO 64E
2025-11-17 09:56:34,337 - ispa_next.main - DEBUG - 



2025-11-17 09:56:34,337 - ispa_next.main - DEBUG - starting with process 7 (LM-MO 64E) of 12
2025-11-17 09:56:34,339 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:56:35,468 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:56:36,511 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-17 09:56:36,513 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 150
2025-11-17 09:56:38,265 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:56:38,267 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:57:01,074 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:57:11,066 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:57:14,322 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:57:14,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:57:14,405 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:57:14,608 - ispa_next.functions - DEBUG - HU date already expired after 125 days.
2025-11-17 09:57:21,065 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:57:21,067 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:57:21,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:57:21,124 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:57:24,219 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:57:24,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:57:25,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:57:27,239 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:57:27,352 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:57:30,584 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:57:30,655 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:57:30,656 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:57:42,262 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:57:43,265 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:57:43,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:57:43,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:57:55,384 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:58:03,481 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:58:03,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:58:03,600 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:58:03,601 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:58:03,648 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:58:04,886 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:58:06,083 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:58:06,299 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:58:10,292 - ispa_next.functions - DEBUG - Updated appointment (AB00018830) customer contact data.
2025-11-17 09:58:11,200 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:58:11,202 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:58:12,311 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:58:12,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:58:13,056 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:58:16,647 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:58:16,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:58:17,177 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:58:19,179 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:58:19,283 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:58:19,379 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:58:19,440 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:58:19,440 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:58:30,381 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 09:58:37,673 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:58:37,673 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:58:39,832 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:58:40,847 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:58:40,848 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:58:40,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:58:40,922 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:58:45,050 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:58:45,792 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 09:59:00,308 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:59:00,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:59:00,473 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:59:04,724 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 09:59:11,853 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 09:59:11,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:59:12,573 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:59:12,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:59:13,418 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:59:13,420 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:59:16,509 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:59:16,511 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:59:17,897 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:59:17,902 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:59:17,906 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart), Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart), Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 09:59:17,908 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:59:17,911 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 09:59:17,913 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:59:17,914 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:59:17,915 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:59:17,918 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:59:17,919 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:59:17,921 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:59:17,923 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:59:18,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:59:19,513 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:00:17,271 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:00:17,275 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 10:00:25,848 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:00:25,865 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:00:25,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:00:31,426 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:00:31,428 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:00:31,430 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:00:36,989 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:00:36,991 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:00:36,992 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:00:37,473 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:00:37,570 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:00:37,572 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:00:43,022 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:00:58,711 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:00:59,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:00:59,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:00:59,988 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:01:11,384 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:01:17,795 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:01:26,009 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:01:26,010 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:01:26,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:01:26,989 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:01:26,990 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:01:31,095 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:01:45,988 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 10:01:45,989 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:01:45,990 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:01:47,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:01:47,380 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:01:47,381 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:01:50,079 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 10:01:50,120 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:01:54,260 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:01:54,264 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:01:55,041 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-17 10:01:55,043 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:01:59,017 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 151
2025-11-17 10:01:59,018 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:02:00,268 - ispa_next.appointments.models - DEBUG - Appointment Firma Autohaus Krah + Enders FD-LI 32 E WBY71HH000CW21184 ohne Termin.
2025-11-17 10:02:00,281 - ispa_next.appointments.models - DEBUG - Appointment Andreas Kunz LM-A 379 WBAJN71060CD14635 ohne Termin.
2025-11-17 10:02:00,285 - ispa_next.main - DEBUG - Found new Appointment: LM-FW 342
2025-11-17 10:02:00,287 - ispa_next.main - DEBUG - 



2025-11-17 10:02:00,288 - ispa_next.main - DEBUG - starting with process 8 (LM-FW 342) of 13
2025-11-17 10:02:00,292 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:02:02,027 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:02:03,517 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-17 10:02:03,519 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 151
2025-11-17 10:02:05,237 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:02:05,238 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:02:35,824 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:02:47,465 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:02:48,694 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:02:48,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:02:48,796 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:02:49,130 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:02:49,133 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:02:49,134 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:02:49,221 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:03:00,235 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:03:00,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:03:01,733 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:03:03,737 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:03:03,906 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:03:07,164 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:03:07,269 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:03:11,530 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:03:12,540 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:03:12,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:13,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:27,793 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:03:36,781 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:03:36,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:36,864 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:03:36,865 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:03:36,915 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:03:37,072 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:03:38,355 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:03:38,605 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:03:42,704 - ispa_next.functions - DEBUG - Updated appointment (AB00018831) customer contact data.
2025-11-17 10:03:43,621 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:03:43,637 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:03:43,882 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:03:44,934 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:03:46,541 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:03:46,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:03:46,637 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:03:50,364 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:03:50,364 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:03:50,368 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:03:50,369 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:03:50,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:03:50,915 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:03:55,175 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:03:55,180 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:03:55,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:03:55,283 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:03:55,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:56,171 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:56,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:03:56,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:03:56,912 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:03:58,352 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:03:58,356 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:03:59,886 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:03:59,888 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:03:59,891 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart), Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:03:59,901 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:03:59,905 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 10:03:59,907 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:03:59,908 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:03:59,909 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:03:59,911 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:03:59,912 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:03:59,914 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:03:59,916 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:04:00,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:04:01,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:04:15,952 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:04:15,954 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:04:15,956 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:04:15,957 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:17,968 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:04:17,971 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:04:17,974 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:19,912 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:04:19,914 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:04:19,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:04:20,618 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:04:20,910 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:30,115 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:04:30,118 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:32,118 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:04:47,888 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:04:48,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:04:49,046 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:04:49,318 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:56,672 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:05:02,329 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:05:02,332 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:05:02,332 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:05:03,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:05:03,437 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:05:03,438 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:05:06,133 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:05:16,829 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:05:17,239 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:05:19,381 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:05:20,865 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-17 10:05:20,867 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:05:25,514 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 150
2025-11-17 10:05:25,515 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:05:27,303 - ispa_next.appointments.models - DEBUG - Appointment Andreas Kunz LM-A 379 WBAJN71060CD14635 ohne Termin.
2025-11-17 10:05:27,309 - ispa_next.main - DEBUG - 



2025-11-17 10:05:27,309 - ispa_next.main - DEBUG - starting with process 9 (LM-MZ 821) of 13
2025-11-17 10:05:27,313 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:05:28,984 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:05:30,402 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-17 10:05:30,404 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 150
2025-11-17 10:05:32,131 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:05:32,132 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:05:58,994 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:06:10,482 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:11,698 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:06:11,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:11,792 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:06:12,101 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:06:12,103 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:06:12,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:12,192 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:06:15,475 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:06:15,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:17,005 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:06:19,010 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:06:19,167 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:06:22,457 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:06:22,593 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:06:26,860 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:06:27,864 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:06:27,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:28,367 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:43,436 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:06:53,496 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:06:53,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:53,633 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:06:53,634 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:06:53,683 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:06:53,862 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:06:55,243 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:06:55,467 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:06:59,091 - ispa_next.functions - DEBUG - Updated appointment (AB00018790) customer contact data.
2025-11-17 10:07:00,026 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:07:00,031 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:07:00,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:07:01,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:07:03,411 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:07:03,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:07:03,580 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:07:08,131 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:07:08,131 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:07:08,185 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:07:08,186 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:07:08,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:07:08,689 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:07:12,904 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:07:12,910 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:07:12,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:07:13,029 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:07:22,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:22,804 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:22,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:07:23,565 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:07:23,566 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:07:24,861 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:07:24,863 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:07:26,704 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:07:26,706 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:07:26,708 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart), Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:07:26,711 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:07:26,715 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 10:07:26,722 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:07:26,724 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:07:26,727 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:07:26,732 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:07:26,734 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:07:26,747 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:07:26,750 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:07:27,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:07:28,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:07:43,048 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:07:43,049 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:07:43,051 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:07:43,051 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:45,034 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:07:45,036 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:07:45,038 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:46,978 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:07:46,980 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:07:46,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:07:47,641 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:07:47,881 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:56,392 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:07:56,394 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:58,409 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:08:12,381 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:08:12,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:08:13,466 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:08:13,685 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:23,157 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:08:28,680 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:08:28,682 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:08:28,683 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:08:29,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:08:29,715 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:08:29,716 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:08:32,269 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:08:43,232 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:08:43,638 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:08:45,935 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:46,777 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-17 10:08:46,778 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:51,053 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 150
2025-11-17 10:08:51,054 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:52,284 - ispa_next.appointments.models - DEBUG - Appointment Andreas Kunz LM-A 379 WBAJN71060CD14635 ohne Termin.
2025-11-17 10:08:52,288 - ispa_next.main - DEBUG - 



2025-11-17 10:08:52,289 - ispa_next.main - DEBUG - starting with process 10 (LM-CH 650) of 13
2025-11-17 10:08:52,293 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:08:54,182 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:55,968 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-17 10:08:55,970 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 150
2025-11-17 10:08:58,088 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:58,090 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:30,578 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:09:44,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:49,588 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:09:49,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:49,700 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:09:50,068 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:09:50,071 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:09:50,072 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:50,201 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:09:53,742 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:09:53,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:09:55,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:09:57,748 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:09:57,905 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:10:01,187 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:10:01,300 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:10:01,301 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:10:13,644 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:10:14,650 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:10:14,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:15,180 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:29,380 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:10:39,816 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:10:39,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:39,916 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:39,917 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:10:40,011 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:10:41,419 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:10:41,665 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:10:45,824 - ispa_next.functions - DEBUG - Updated appointment (AF00004756) customer contact data.
2025-11-17 10:10:46,802 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:10:46,804 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:10:48,211 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:10:48,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:10:49,325 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:10:53,893 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:10:53,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:54,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:10:56,479 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:10:56,674 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:10:56,855 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:10:56,984 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:10:56,985 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:11:09,647 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:12:09,650 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:12:21,662 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:12:30,665 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:12:43,267 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:12:54,050 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:12:55,056 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:12:55,057 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:12:55,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:12:55,150 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:12:59,323 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:13:00,291 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:13:12,146 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:13:12,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:12,241 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:13:22,053 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 10:13:29,138 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:13:29,194 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:29,879 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:29,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:30,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:13:30,773 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:13:35,605 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:13:35,608 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:13:37,235 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:13:37,238 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:13:37,241 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart), Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart), Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:13:37,243 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:13:37,246 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 10:13:37,247 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:13:37,248 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:13:37,250 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:13:37,253 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:13:37,254 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:13:37,257 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:13:37,259 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:13:38,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:13:38,984 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:14:17,341 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-17 10:14:17,463 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:14:17,466 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:14:18,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:14:19,738 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:14:19,739 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:14:19,763 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:14:24,999 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 10:14:25,003 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:14:25,619 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-17 10:14:25,621 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:14:29,900 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-17 10:14:29,901 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:14:31,119 - ispa_next.appointments.models - DEBUG - Appointment Andreas Kunz LM-A 379 WBAJN71060CD14635 ohne Termin.
2025-11-17 10:14:31,127 - ispa_next.main - DEBUG - 



2025-11-17 10:14:31,127 - ispa_next.main - DEBUG - starting with process 11 (LM-S 556 E) of 13
2025-11-17 10:14:31,130 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:14:32,422 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:14:34,197 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-17 10:14:34,198 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-17 10:14:36,340 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:14:36,341 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:15:12,750 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:15:25,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:26,112 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:26,410 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:27,684 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:15:27,684 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:27,769 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:28,170 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:15:28,172 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:15:28,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:28,279 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:31,858 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:15:31,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:15:33,582 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:15:35,586 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:15:35,750 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:15:39,028 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:15:39,136 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:15:39,137 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:15:51,716 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:15:52,720 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:15:52,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:53,288 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:08,651 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:16:20,054 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:16:20,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:20,168 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:16:20,169 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:16:20,225 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:16:21,565 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:16:22,852 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:16:23,141 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:16:28,181 - ispa_next.functions - DEBUG - Updated appointment (AC00019265) customer contact data.
2025-11-17 10:16:29,192 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:16:29,194 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:16:30,614 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:16:30,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:16:31,719 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:16:36,780 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:16:36,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:37,448 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:39,452 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:16:39,603 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:16:39,745 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:16:39,856 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:16:39,856 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:16:51,199 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:16:58,806 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:16:58,806 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:17:03,040 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:17:04,046 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:17:04,046 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:17:04,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:17:04,196 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:17:08,321 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:17:08,325 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:17:08,325 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 10:17:08,326 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:17:09,683 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:17:09,685 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:17:11,192 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:17:11,193 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:17:11,196 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart), Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:17:11,197 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:17:11,202 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 10:17:11,205 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:17:11,208 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:17:11,210 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:17:11,214 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:17:11,215 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:17:11,217 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:17:11,218 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:17:11,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:17:12,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:17:27,668 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:17:27,671 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:17:27,672 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:17:27,673 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:29,699 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:17:29,700 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:17:29,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:31,668 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:17:31,670 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:17:31,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:17:32,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:17:32,796 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:48,698 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:17:48,709 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:50,726 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:18:04,805 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:18:05,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:18:06,180 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:18:06,435 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:13,893 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:18:20,098 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:18:20,100 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:18:20,101 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:18:21,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:18:21,225 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:18:21,226 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:18:23,972 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:18:35,843 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:18:36,248 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 10:18:38,315 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:18:39,191 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 536
2025-11-17 10:18:39,193 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:18:43,661 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 145
2025-11-17 10:18:43,662 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:18:44,667 - ispa_next.main - DEBUG - 



2025-11-17 10:18:44,667 - ispa_next.main - DEBUG - starting with process 12 (WW-LR 23 E) of 13
2025-11-17 10:18:44,671 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:18:46,186 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:18:47,587 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 536
2025-11-17 10:18:47,589 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 145
2025-11-17 10:18:49,689 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:18:49,691 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:19:28,514 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:19:39,794 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:39,868 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:19:40,113 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:42,051 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:19:42,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:42,147 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:19:42,456 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:19:42,459 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:19:42,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:42,617 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:19:46,259 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:19:46,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:47,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:19:49,991 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:19:50,129 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:19:53,381 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:19:53,474 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:19:53,474 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:20:05,289 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:20:06,294 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:20:06,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:06,814 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:21,060 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:20:31,298 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:20:31,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:31,403 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:20:31,404 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:20:31,448 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:20:33,271 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:20:34,601 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:20:34,818 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:20:39,406 - ispa_next.functions - DEBUG - Updated appointment (AB00018754) customer contact data.
2025-11-17 10:20:40,374 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:20:40,375 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:20:41,473 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:20:41,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:20:42,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:20:46,041 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:20:46,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:46,549 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:48,553 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:20:48,765 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:20:49,590 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:20:49,721 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:20:49,722 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:21:01,028 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:21:08,562 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:21:08,563 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:21:14,851 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:21:23,467 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:21:24,473 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:21:24,474 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:21:24,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:24,590 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:21:28,793 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:21:28,798 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:21:28,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:28,899 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:21:39,054 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 10:21:48,246 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:21:48,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:49,152 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:49,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:49,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:21:49,979 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:21:51,946 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:21:51,957 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:21:53,084 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:21:53,085 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:21:53,087 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart), Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart), Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:21:53,089 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:21:53,091 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 10:21:53,092 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:21:53,093 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:21:53,094 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:21:53,096 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:21:53,097 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:21:53,099 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:21:53,101 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:21:53,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:21:54,648 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:22:33,322 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-17 10:22:33,352 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:22:33,353 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:22:34,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:22:35,913 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:22:35,914 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:22:35,970 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:22:41,126 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 10:22:41,129 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:22:42,050 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 536
2025-11-17 10:22:42,052 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:22:47,104 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 144
2025-11-17 10:22:47,105 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:22:48,069 - ispa_next.main - DEBUG - 



2025-11-17 10:22:48,069 - ispa_next.main - DEBUG - starting with process 13 (ENS-MP-48) of 13
2025-11-17 10:22:48,073 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:22:49,451 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:22:51,242 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 536
2025-11-17 10:22:51,244 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 144
2025-11-17 10:22:53,524 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:22:53,526 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:23:33,238 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 10:23:33,257 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 10:23:33,262 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:23:34,034 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 536
2025-11-17 10:23:34,035 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:23:38,150 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 144
2025-11-17 10:23:38,151 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
