2025-11-17 11:00:37,148 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 11:00:37,159 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 11:00:50,561 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:01:04,318 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:01:20,045 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:03:18,788 - ispa_next.app_start.main - DEBUG - Operation already took 107.41 seconds (more than 80 seconds)
2025-11-17 11:03:20,851 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_ytg2hlaa_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_ytg2hlaa', 'txt']
2025-11-17 11:03:21,148 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 11:03:21,153 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 11:03:21,154 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:05:21,085 - ispa_next.app_start.main - DEBUG - Operation already took 107.43 seconds (more than 80 seconds)
2025-11-17 11:05:23,162 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess__5893far_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess__5893far', 'txt']
2025-11-17 11:05:23,402 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 11:05:23,408 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 11:05:31,708 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 11:05:40,068 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:05:51,209 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:06:06,710 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:08:06,077 - ispa_next.app_start.main - DEBUG - Operation already took 108.26 seconds (more than 80 seconds)
2025-11-17 11:08:08,191 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_110dt5n4_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_110dt5n4', 'txt']
2025-11-17 11:08:08,420 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 11:08:08,425 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 11:08:08,425 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:10:08,183 - ispa_next.app_start.main - DEBUG - Operation already took 107.33 seconds (more than 80 seconds)
2025-11-17 11:10:10,252 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_419vlkk9_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_419vlkk9', 'txt']
2025-11-17 11:10:10,488 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 11:10:10,492 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 11:10:18,345 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 11:10:29,002 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:10:39,569 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:10:55,326 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:12:53,986 - ispa_next.app_start.main - DEBUG - Operation already took 107.57 seconds (more than 80 seconds)
2025-11-17 11:12:56,064 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_88uipwk7_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_88uipwk7', 'txt']
2025-11-17 11:12:56,283 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 11:12:56,288 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 11:12:56,288 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:14:55,948 - ispa_next.app_start.main - DEBUG - Operation already took 107.28 seconds (more than 80 seconds)
2025-11-17 11:14:58,031 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_8rb7lyxa_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_8rb7lyxa', 'txt']
2025-11-17 11:14:58,278 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 11:14:58,282 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 11:15:07,417 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-17 11:15:16,999 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:15:27,454 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:15:42,979 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:17:41,470 - ispa_next.app_start.main - DEBUG - Operation already took 107.28 seconds (more than 80 seconds)
2025-11-17 11:17:43,562 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_k65x6_1j_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_k65x6_1j', 'txt']
2025-11-17 11:17:43,794 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 11:17:43,798 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 11:17:43,798 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:19:43,603 - ispa_next.app_start.main - DEBUG - Operation already took 107.39 seconds (more than 80 seconds)
2025-11-17 11:19:45,686 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_zjyqpwri_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\be31943ab1f0a22f\\tess_zjyqpwri', 'txt']
2025-11-17 11:19:45,941 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 11:19:45,946 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 11:19:53,343 - ispa_next.main - DEBUG - ISPA Next attempt (5 / 5)
2025-11-17 11:20:00,072 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:20:11,006 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:20:26,621 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:20:50,346 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 11:21:07,819 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 11:21:10,557 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:21:11,693 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 598
2025-11-17 11:21:11,695 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 323
2025-11-17 11:21:14,016 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 140
2025-11-17 11:21:14,017 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 11:21:14,017 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:21:15,135 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:21:16,291 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:21:36,505 - ispa_next.appointments.models - DEBUG - Appointment Mariya Aleksandrovna OS-UA 81 WBA4C11010G273031 ohne Termin.
2025-11-17 11:21:36,517 - ispa_next.appointments.models - DEBUG - Appointment Öezlem Cicek HF-OZ 84 WBA31AX010FP86133 ohne Termin.
2025-11-17 11:21:36,529 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-17 11:21:36,541 - ispa_next.appointments.models - DEBUG - Appointment Karlheinz Böttger HF-EK 2016 WBA2X71000V366813 ohne Termin.
2025-11-17 11:21:36,547 - ispa_next.main - DEBUG - Found 6 out of 23 appointments to process (configured limit: 15).
2025-11-17 11:21:36,547 - ispa_next.main - DEBUG - Processing 6 fresh appointments.
2025-11-17 11:21:36,547 - ispa_next.main - DEBUG - All appointments: HF-AA 1114, HF-DB 921E, HF-XE 555E, HF-LF 3030, HF-SV 1503, HF-X 1020
2025-11-17 11:21:36,550 - ispa_next.main - DEBUG - 



2025-11-17 11:21:36,550 - ispa_next.main - DEBUG - starting with process 1 (HF-AA 1114) of 6
2025-11-17 11:21:36,561 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:21:37,649 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:21:38,481 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 598
2025-11-17 11:21:38,482 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 140
2025-11-17 11:21:39,654 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:21:39,655 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:22:09,713 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:22:19,708 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:22:21,623 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:22:21,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:22:21,705 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:22:22,042 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:22:22,045 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:22:22,045 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:22:22,157 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:22:25,396 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:22:25,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:22:26,450 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:22:28,455 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:22:28,626 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:22:31,855 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:22:31,934 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:22:36,133 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:22:37,142 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:22:37,143 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:22:37,658 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:22:50,571 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:22:57,799 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:22:57,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:22:57,871 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:22:57,879 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:22:57,969 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:22:59,224 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:23:00,344 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:23:00,595 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:23:03,707 - ispa_next.functions - DEBUG - Updated appointment (AA00044740) customer contact data.
2025-11-17 11:23:04,607 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:23:04,608 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:23:05,224 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:23:05,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:23:05,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:23:09,452 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:23:09,453 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:23:09,456 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:23:09,459 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:23:09,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:23:09,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:23:15,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:16,180 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:16,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:23:17,001 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:23:17,002 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:23:18,889 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:23:18,895 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:23:19,921 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:23:19,927 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:23:19,935 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:23:19,940 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart)}
2025-11-17 11:23:19,944 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:23:19,946 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:23:19,947 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:23:19,949 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:23:19,967 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:23:19,971 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:23:19,974 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:23:19,976 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:23:45,735 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:23:45,737 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:23:45,738 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:23:45,745 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:48,402 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:23:51,218 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:23:51,227 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:23:51,234 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:54,101 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:23:54,102 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:23:54,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:23:54,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:23:54,833 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:23:54,837 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:57,409 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:23:57,410 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:23:57,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:23:58,404 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:23:58,670 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:05,239 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:24:09,843 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:24:15,913 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:24:15,913 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:24:16,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:24:16,696 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:24:16,698 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:24:19,694 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:24:29,204 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:24:29,604 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 11:24:29,979 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:24:30,777 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-17 11:24:30,778 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:24:33,530 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 323
2025-11-17 11:24:33,531 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:24:34,446 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 11:24:34,454 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 11:24:34,465 - ispa_next.main - DEBUG - 



2025-11-17 11:24:34,465 - ispa_next.main - DEBUG - starting with process 2 (HF-DB 921E) of 6
2025-11-17 11:24:34,474 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:24:35,664 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:24:36,904 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-17 11:24:36,905 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 323
2025-11-17 11:24:38,385 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:24:38,387 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:25:05,012 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:25:13,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:25:13,811 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:25:13,969 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:25:15,201 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:25:15,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:25:15,284 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:25:15,496 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:25:15,499 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:25:15,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:25:15,598 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:25:18,818 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:25:18,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:25:19,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:25:21,999 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:25:22,114 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:25:25,374 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:25:25,440 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:25:25,441 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:25:36,680 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:25:37,684 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:25:37,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:25:38,175 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:25:49,387 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:25:56,678 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:25:56,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:25:56,792 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:25:56,793 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:25:56,857 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:25:58,040 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:25:59,136 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:25:59,341 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:26:02,543 - ispa_next.functions - DEBUG - Updated appointment (AA00044735) customer contact data.
2025-11-17 11:26:03,470 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:26:03,472 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:26:04,042 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:26:04,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:26:04,759 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:26:08,770 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:26:08,770 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:26:08,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:26:09,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:26:11,286 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:26:11,487 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:26:11,606 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:26:11,680 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:26:11,681 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:26:23,046 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:27:23,049 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:27:34,211 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:28:05,213 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:28:16,601 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:28:24,123 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:28:24,123 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:28:28,296 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:28:29,310 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:28:29,313 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:28:29,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:28:29,397 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:28:39,012 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 11:28:50,531 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 11:28:50,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:28:51,266 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:28:51,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:28:51,991 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:28:51,992 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:28:53,911 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:28:53,913 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:28:55,028 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:28:55,029 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:28:55,031 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:28:55,033 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:28:55,034 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-17 11:28:55,035 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:28:55,037 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 11:28:55,038 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:28:55,040 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:28:55,042 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:28:55,044 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:28:55,045 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:29:15,012 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:29:15,014 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 11:29:17,043 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:29:17,586 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 11:29:18,555 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:29:19,104 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:29:19,647 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 11:29:21,072 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:29:21,633 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:29:22,168 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 11:29:23,090 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:29:24,123 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:29:25,067 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:29:25,509 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 11:29:31,309 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:29:31,311 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:29:31,312 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:29:33,239 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:29:33,241 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:29:33,243 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:29:35,219 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:29:35,220 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:29:35,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:29:36,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:29:36,411 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:29:47,244 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:29:47,246 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:29:49,245 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:29:49,246 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:29:49,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:29:50,313 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:29:50,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:29:56,258 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:30:01,125 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:30:06,129 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:30:06,129 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:30:06,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:30:06,712 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:30:06,713 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:30:09,245 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:30:17,654 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:30:18,031 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 11:30:18,391 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:30:19,303 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-17 11:30:19,304 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:30:21,917 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 323
2025-11-17 11:30:21,918 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:30:22,588 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 11:30:22,595 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 11:30:22,598 - ispa_next.main - DEBUG - 



2025-11-17 11:30:22,598 - ispa_next.main - DEBUG - starting with process 3 (HF-XE 555E) of 6
2025-11-17 11:30:22,601 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:30:23,474 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:30:24,367 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-17 11:30:24,368 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 323
2025-11-17 11:30:25,528 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:30:25,529 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:30:59,508 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:31:09,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:09,600 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:31:09,752 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:12,342 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:31:12,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:12,426 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:31:12,675 - ispa_next.functions - DEBUG - HU date already expired after 264 days.
2025-11-17 11:31:19,835 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:31:19,837 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:31:19,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:19,917 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:31:22,961 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:31:22,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:31:24,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:31:26,068 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:31:26,181 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:31:29,379 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:31:29,464 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:31:29,465 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:31:40,664 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:31:41,667 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:31:41,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:42,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:55,494 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:32:03,323 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:32:03,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:32:03,412 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:32:03,413 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:32:03,460 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:32:03,631 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:32:04,853 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 11:32:06,030 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 11:32:06,337 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:32:08,984 - ispa_next.functions - DEBUG - Updated appointment (AA00044729) customer contact data.
2025-11-17 11:32:09,938 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:32:09,940 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:32:10,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:32:11,104 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:32:12,625 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:32:12,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:32:12,697 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:32:16,324 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:32:16,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:32:16,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:32:18,863 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:32:19,009 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:32:19,102 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:32:19,182 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:32:19,183 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:32:29,931 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:32:36,883 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:32:36,884 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:32:41,066 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:32:42,072 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:32:42,075 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:32:42,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:32:42,165 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:32:45,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:32:46,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:32:46,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:32:46,908 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:32:46,909 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:32:50,559 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:32:50,561 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:32:51,530 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:32:51,532 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:32:51,537 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:32:51,538 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:32:51,540 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:32:51,548 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:32:51,559 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 11:32:51,567 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:32:51,570 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:32:51,574 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:32:51,581 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:32:51,585 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 11:32:53,626 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:32:54,184 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 11:32:55,153 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:32:55,714 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:32:56,236 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 11:32:57,165 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:32:57,770 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:32:58,291 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 11:32:59,202 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:32:59,774 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:33:00,310 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 11:33:01,270 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:33:01,835 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:33:02,374 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 11:33:03,840 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:33:04,990 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:33:05,972 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:33:06,399 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:33:06,401 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:33:06,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:09,773 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:33:09,774 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:33:09,776 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:13,011 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:33:13,013 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:33:13,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:33:13,805 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:33:14,009 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:21,614 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:33:21,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:24,931 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:33:24,933 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:33:25,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:33:25,929 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:33:26,105 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:33,501 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:33:37,678 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:33:41,420 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:33:45,501 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:33:45,503 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:33:45,504 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:33:46,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:33:46,160 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:33:46,161 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:33:48,066 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:33:56,369 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:33:56,748 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 11:33:57,507 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:33:58,133 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-17 11:33:58,134 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:34:01,194 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 323
2025-11-17 11:34:01,195 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:34:02,074 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 11:34:02,080 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 11:34:02,084 - ispa_next.main - DEBUG - 



2025-11-17 11:34:02,084 - ispa_next.main - DEBUG - starting with process 4 (HF-LF 3030) of 6
2025-11-17 11:34:02,087 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:34:03,255 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:34:04,589 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-17 11:34:04,591 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 323
2025-11-17 11:34:06,057 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:34:06,059 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:34:36,081 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:34:45,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:34:53,082 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:34:53,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:53,193 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:34:53,406 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:34:53,408 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:34:53,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:53,517 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:34:56,632 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:34:56,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:34:58,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:35:00,032 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:35:00,148 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:35:03,392 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:35:03,506 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:35:03,507 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:35:14,852 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:35:15,855 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:35:15,856 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:35:16,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:35:27,189 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:35:27,189 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:35:34,370 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:35:34,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:35:34,444 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:35:34,445 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:35:34,498 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:35:35,748 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:35:36,887 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:35:37,111 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:35:40,300 - ispa_next.functions - DEBUG - Updated appointment (AA00044696) customer contact data.
2025-11-17 11:35:41,246 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:35:41,249 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:35:42,095 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:35:42,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:35:42,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:35:46,446 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:35:46,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:35:46,954 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:35:48,959 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:35:49,096 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:35:49,434 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:35:49,513 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:35:49,513 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:36:00,384 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 11:36:07,611 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:36:07,611 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:36:11,876 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:36:12,903 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:36:12,907 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:36:12,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:36:12,990 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:36:22,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:36:23,507 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:36:23,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:36:24,180 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:36:24,181 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:36:31,215 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:36:31,217 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:36:32,247 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:36:32,248 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:36:32,250 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:36:32,251 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:36:32,251 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:36:32,252 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:36:32,254 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:36:32,255 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:36:32,256 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:36:32,262 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:36:32,265 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:36:32,269 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:36:32,274 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:36:32,276 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:36:32,276 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:36:40,322 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:36:40,323 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:36:40,331 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:36:48,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:36:48,434 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:36:57,007 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:37:15,010 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:37:15,012 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:37:15,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:37:15,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:37:16,025 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:37:37,165 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:37:37,169 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:37:45,221 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:37:45,222 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:37:45,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:37:46,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:37:46,402 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:37:55,883 - ispa_next.common.utils - DEBUG - Attempt 1/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:37:55,884 - ispa_next.common.utils - DEBUG - Attempt 1/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 1.0s
2025-11-17 11:37:58,330 - ispa_next.common.utils - DEBUG - Attempt 2/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:37:58,330 - ispa_next.common.utils - DEBUG - Attempt 2/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 2.0s
2025-11-17 11:38:01,701 - ispa_next.common.utils - DEBUG - Attempt 3/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:38:01,702 - ispa_next.common.utils - DEBUG - Attempt 3/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 4.0s
2025-11-17 11:38:07,113 - ispa_next.common.utils - DEBUG - Attempt 4/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:38:07,113 - ispa_next.common.utils - DEBUG - Attempt 4/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 8.0s
2025-11-17 11:38:16,483 - ispa_next.common.utils - DEBUG - Attempt 5/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:38:16,483 - ispa_next.common.utils - DEBUG - Attempt 5/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 16.0s
2025-11-17 11:38:33,915 - ispa_next.common.utils - DEBUG - Attempt 6/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:38:34,635 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 126, in process_appointment
    f.check_cart_packages_for_parts_service_and_parts_availability(app, appointment, state)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\functions.py", line 390, in check_cart_packages_for_parts_service_and_parts_availability
    retry_ui_action(open_job_details_view, condition=job_details_view_exists, base_delay=1.0)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\utils.py", line 254, in retry_ui_action
    raise RetryUiActionError(f"UI action failed after {max_attempts} attempts: Condition never satisfied")
ispa_next.exceptions.RetryUiActionError: UI action failed after 6 attempts: Condition never satisfied

2025-11-17 11:38:34,741 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:38:34,742 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:38:35,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:38:35,568 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:38:35,569 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:38:35,590 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:38:39,041 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 11:38:39,044 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:38:39,536 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-17 11:38:39,536 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:38:42,257 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 323
2025-11-17 11:38:42,258 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:38:43,089 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 11:38:43,096 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 11:38:43,099 - ispa_next.main - DEBUG - 



2025-11-17 11:38:43,099 - ispa_next.main - DEBUG - starting with process 5 (HF-SV 1503) of 6
2025-11-17 11:38:43,102 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:38:44,209 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:38:45,310 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-17 11:38:45,311 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 323
2025-11-17 11:38:46,744 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:38:46,745 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:39:15,715 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:39:25,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:39:29,288 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:39:29,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:29,378 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:39:29,705 - ispa_next.functions - DEBUG - HU date already expired after 1397 days.
2025-11-17 11:39:36,776 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:39:36,778 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:39:36,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:36,845 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:39:47,318 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:39:47,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:39:48,626 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:39:50,631 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:39:50,737 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:39:53,992 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:39:54,100 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:39:54,101 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:40:05,729 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:40:06,732 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:40:06,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:07,238 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:18,085 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:40:24,828 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:40:24,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:24,971 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:40:24,971 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:40:25,032 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:40:26,340 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:40:27,753 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:40:27,992 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:40:31,384 - ispa_next.functions - DEBUG - Updated appointment (AA00044695) customer contact data.
2025-11-17 11:40:32,317 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:40:32,319 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:40:33,081 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:40:33,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:40:33,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:40:37,381 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:40:37,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:40:37,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:40:39,868 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:40:39,977 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:40:40,082 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:40:40,156 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:40:40,156 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:40:51,597 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:41:51,599 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:42:02,423 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:42:09,702 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:42:09,702 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:42:13,872 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:42:14,899 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:42:14,903 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:42:14,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:42:14,999 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:42:15,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:42:16,086 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:42:16,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:42:16,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:42:16,764 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:42:19,781 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:42:19,783 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:42:21,063 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:42:21,064 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:42:21,066 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:42:21,071 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:42:21,074 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:42:21,077 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:42:21,080 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:42:21,082 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:42:21,084 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:42:21,086 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:42:21,087 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:42:21,089 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:42:21,092 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:42:21,093 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:42:21,094 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:42:24,465 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:42:26,802 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:42:26,804 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:42:26,806 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:42:30,100 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:42:30,101 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:42:30,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:42:31,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:42:31,256 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:42:41,267 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:42:41,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:42:44,639 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:42:44,640 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:42:45,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:42:45,732 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:42:45,861 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:42:53,421 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:43:00,501 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:43:05,156 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:43:09,146 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:43:09,148 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:43:09,149 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:43:09,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:43:09,743 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:43:09,745 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:43:11,302 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:43:19,257 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:43:19,647 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 11:43:20,228 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:43:21,085 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-17 11:43:21,087 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:43:24,274 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 323
2025-11-17 11:43:24,275 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:43:25,089 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 11:43:25,096 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 11:43:25,099 - ispa_next.main - DEBUG - 



2025-11-17 11:43:25,099 - ispa_next.main - DEBUG - starting with process 6 (HF-X 1020) of 6
2025-11-17 11:43:25,101 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:43:26,374 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:43:27,486 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-17 11:43:27,487 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 323
2025-11-17 11:43:28,835 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:43:28,837 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:44:07,525 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:44:17,820 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:44:25,906 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:44:25,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:44:25,999 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:44:26,198 - ispa_next.functions - DEBUG - HU date already expired after 78 days.
2025-11-17 11:44:34,016 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:44:34,018 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:44:34,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:44:34,085 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:44:44,438 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:44:44,440 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:44:45,711 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:44:47,714 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:44:47,832 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:44:51,049 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:44:51,124 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:44:51,124 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:45:02,456 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:45:03,461 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:45:03,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:45:03,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:45:19,222 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:45:27,399 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:45:27,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:45:27,471 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:45:27,472 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:45:27,565 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:45:28,815 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:45:29,937 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 11:45:31,150 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 11:45:31,488 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:45:34,237 - ispa_next.functions - DEBUG - Updated appointment (AA00044542) customer contact data.
2025-11-17 11:45:35,432 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:45:35,433 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:45:36,153 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:45:36,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:45:36,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:45:40,966 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:45:40,967 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:45:40,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:45:41,451 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:45:43,455 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:45:43,595 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:45:43,677 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:45:43,780 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:45:43,780 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:45:55,345 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:46:55,348 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:47:06,901 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:47:07,904 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:47:19,115 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 11:47:26,833 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:47:26,834 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:47:29,027 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:47:30,035 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:47:30,038 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:47:30,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:47:30,154 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:47:30,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:47:31,074 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:47:31,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:47:31,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:47:31,833 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:47:40,221 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:47:40,223 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:47:41,234 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:47:41,236 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:47:41,238 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart), Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=from_aw_package, target=cart)}
2025-11-17 11:47:41,239 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:47:41,240 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:47:41,242 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:47:41,243 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:47:41,245 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:47:41,246 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:47:41,248 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:47:41,249 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:48:40,189 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:48:40,190 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:48:40,192 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:48:40,193 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:48:51,398 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:48:57,747 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:48:57,750 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:48:57,859 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:49:08,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:49:08,912 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:49:19,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:49:40,292 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:49:40,293 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:49:40,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:49:41,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:49:41,157 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:49:54,171 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:49:54,172 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:50:04,983 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:50:04,984 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:50:05,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:50:05,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:50:06,187 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:50:18,516 - ispa_next.common.utils - DEBUG - Attempt 1/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:50:18,516 - ispa_next.common.utils - DEBUG - Attempt 1/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 1.0s
2025-11-17 11:50:20,993 - ispa_next.common.utils - DEBUG - Attempt 2/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:50:20,994 - ispa_next.common.utils - DEBUG - Attempt 2/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 2.0s
2025-11-17 11:50:24,469 - ispa_next.common.utils - DEBUG - Attempt 3/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:50:24,469 - ispa_next.common.utils - DEBUG - Attempt 3/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 4.0s
2025-11-17 11:50:29,881 - ispa_next.common.utils - DEBUG - Attempt 4/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:50:29,881 - ispa_next.common.utils - DEBUG - Attempt 4/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 8.0s
2025-11-17 11:50:39,247 - ispa_next.common.utils - DEBUG - Attempt 5/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:50:39,247 - ispa_next.common.utils - DEBUG - Attempt 5/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 16.0s
2025-11-17 11:50:56,794 - ispa_next.common.utils - DEBUG - Attempt 6/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:50:57,084 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 126, in process_appointment
    f.check_cart_packages_for_parts_service_and_parts_availability(app, appointment, state)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\functions.py", line 390, in check_cart_packages_for_parts_service_and_parts_availability
    retry_ui_action(open_job_details_view, condition=job_details_view_exists, base_delay=1.0)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\utils.py", line 254, in retry_ui_action
    raise RetryUiActionError(f"UI action failed after {max_attempts} attempts: Condition never satisfied")
ispa_next.exceptions.RetryUiActionError: UI action failed after 6 attempts: Condition never satisfied

2025-11-17 11:50:57,099 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:50:57,099 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:50:57,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:50:57,948 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:50:57,949 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:50:57,972 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:51:01,212 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 11:51:01,215 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:51:01,559 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 601
2025-11-17 11:51:01,560 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:51:04,053 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 324
2025-11-17 11:51:04,054 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:51:04,924 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 11:51:04,931 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
