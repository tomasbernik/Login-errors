2025-11-12 11:00:36,729 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:00:36,736 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:00:51,612 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:01:05,535 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:01:21,198 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:03:19,446 - ispa_next.app_start.main - DEBUG - Operation already took 106.67 seconds (more than 80 seconds)
2025-11-12 11:03:21,533 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3be65ec3b3eae297\\tess_zbs3_ahc_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3be65ec3b3eae297\\tess_zbs3_ahc', 'txt']
2025-11-12 11:03:21,846 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 11:03:21,850 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 11:03:21,851 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:05:20,995 - ispa_next.app_start.main - DEBUG - Operation already took 106.84 seconds (more than 80 seconds)
2025-11-12 11:05:23,094 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3be65ec3b3eae297\\tess_70z4nuvc_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3be65ec3b3eae297\\tess_70z4nuvc', 'txt']
2025-11-12 11:05:23,351 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 11:05:23,366 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 11:05:31,459 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 11:05:39,911 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:05:50,795 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:06:06,380 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:06:54,007 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:07:09,429 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:07:12,377 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:13,457 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:07:13,459 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 283
2025-11-12 11:07:15,703 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 139
2025-11-12 11:07:15,704 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:07:15,704 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:07:16,726 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:07:17,842 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:07:37,733 - ispa_next.appointments.models - DEBUG - Appointment Nehad Djika DU-XH 11 WBAJC31000D030956 ohne Termin.
2025-11-12 11:07:37,748 - ispa_next.appointments.models - DEBUG - Appointment Ammar Saidavey DU-ZD 555 WBATB410209D95081 ohne Termin.
2025-11-12 11:07:37,761 - ispa_next.appointments.models - DEBUG - Appointment Dilara Demir DU-QM 40 WBA5R11030AK33636 ohne Termin.
2025-11-12 11:07:37,769 - ispa_next.appointments.models - DEBUG - Appointment Firma Effizienz-Agentur NRW MH-EF 51 WBA31BL000WY01751 ohne Termin.
2025-11-12 11:07:37,782 - ispa_next.appointments.models - DEBUG - Appointment Firma Goldmann KFZ DU-OO 2 WBA31DZ010FJ99431 ohne Termin.
2025-11-12 11:07:37,790 - ispa_next.appointments.models - DEBUG - Appointment Alexandre Magno Rezende ME-AP 7810 WBA35BG0X0N050338 ohne Termin.
2025-11-12 11:07:37,798 - ispa_next.appointments.models - DEBUG - Appointment Ali Sarmand DU-SI 48 WBA11DW010CD72865 ohne Termin.
2025-11-12 11:07:37,806 - ispa_next.appointments.models - DEBUG - Appointment Ilta Prokschi DU-AE 1621 WBAJN110X0BK38238 ohne Termin.
2025-11-12 11:07:37,813 - ispa_next.appointments.models - DEBUG - Appointment Emre Kara DU-EK 280 WBA5F31040FH73684 ohne Termin.
2025-11-12 11:07:37,837 - ispa_next.appointments.models - DEBUG - Appointment Bernd Markus Wallhorn DU-W 172 WBAHF11010WW28262 ohne Termin.
2025-11-12 11:07:37,850 - ispa_next.appointments.models - DEBUG - Appointment Roman Vertkin MO-VV 6880 WBA6L31030FK09194 ohne Termin.
2025-11-12 11:07:37,859 - ispa_next.appointments.models - DEBUG - Appointment Melanie Anni Anneliese Kaminsk DU-UH 1217 WBA6K310X0FJ11363 ohne Termin.
2025-11-12 11:07:37,866 - ispa_next.appointments.models - DEBUG - Appointment Sebastian Czwalinna KLE-CB 278 WBA6L51040FJ39992 ohne Termin.
2025-11-12 11:07:37,880 - ispa_next.appointments.models - DEBUG - Appointment Devinder Singh DU-LR 1805 WBA4M910609F16559 ohne Termin.
2025-11-12 11:07:37,891 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Fischer DUJF 2602 WBAJT31020CE34043 ohne Termin.
2025-11-12 11:07:37,898 - ispa_next.appointments.models - DEBUG - Appointment Bernd Maas DU-BB 5560 WBATY51040LE76512 ohne Termin.
2025-11-12 11:07:37,905 - ispa_next.appointments.models - DEBUG - Appointment Mustafa Karamalak DU-C 5067 WBA5F31060FH59429 ohne Termin.
2025-11-12 11:07:37,912 - ispa_next.appointments.models - DEBUG - Appointment Thorsten Hübner MO-AT 238 WBA31DZ050FK27506 ohne Termin.
2025-11-12 11:07:37,920 - ispa_next.appointments.models - DEBUG - Appointment Can Arslanboga DU-CQ 46 WBAJM91020BE38406 ohne Termin.
2025-11-12 11:07:37,928 - ispa_next.appointments.models - DEBUG - Appointment Günther Wagner DU-G 66 WBA5R11040FH35321 ohne Termin.
2025-11-12 11:07:37,937 - ispa_next.appointments.models - DEBUG - Appointment Marianne Gerharz DU-DM 199 WBA5F31030FJ87992 ohne Termin.
2025-11-12 11:07:37,965 - ispa_next.appointments.models - DEBUG - Appointment Hareen Bagehany OB-T 1810 WBAJF31040WW51838 ohne Termin.
2025-11-12 11:07:37,972 - ispa_next.appointments.models - DEBUG - Appointment Rafael Kossok D-K 4001 WBA5V31000FH40118 ohne Termin.
2025-11-12 11:07:37,978 - ispa_next.appointments.models - DEBUG - Appointment Andrea Heringloh DU-AH 184 WBAHF11080WW34771 ohne Termin.
2025-11-12 11:07:37,985 - ispa_next.appointments.models - DEBUG - Appointment Michael Anton Castelijn MO-MC 1221 WBAJP31040BT94572 ohne Termin.
2025-11-12 11:07:37,991 - ispa_next.appointments.models - DEBUG - Appointment Markus Gundermann DU-GU 666 WBAJM71030B068259 ohne Termin.
2025-11-12 11:07:37,998 - ispa_next.appointments.models - DEBUG - Appointment Sönke Nils Hoffmann DU-SN 2906 WBAJT31010BV43614 ohne Termin.
2025-11-12 11:07:38,004 - ispa_next.appointments.models - DEBUG - Appointment Frank Flechsig WES-FF 71 WBAJP51090BU52820 ohne Termin.
2025-11-12 11:07:38,010 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Alfons Bartelt DU-RH 124 WBA11DW040CD91149 ohne Termin.
2025-11-12 11:07:38,018 - ispa_next.appointments.models - DEBUG - Appointment Helmut Karl Rainer DU-HR 2804 WBAUZ35080N008140 ohne Termin.
2025-11-12 11:07:38,027 - ispa_next.appointments.models - DEBUG - Appointment Heinz Rainer Jung DU-RJ 2311 WBAUZ35090N012133 ohne Termin.
2025-11-12 11:07:38,033 - ispa_next.appointments.models - DEBUG - Appointment Ramiz Dolicanin DU-SD 2712 WBAJE310X0B169899 ohne Termin.
2025-11-12 11:07:38,039 - ispa_next.appointments.models - DEBUG - Appointment Beate Corona DU-B 396 WBA1V71070V832349 ohne Termin.
2025-11-12 11:07:38,047 - ispa_next.appointments.models - DEBUG - Appointment Katharina Overdreef MO-K 1709 WBATY15060ND79772 ohne Termin.
2025-11-12 11:07:38,053 - ispa_next.appointments.models - DEBUG - Appointment Jörg Lemmin  WBY61EF0905457502 ohne Termin.
2025-11-12 11:07:38,060 - ispa_next.appointments.models - DEBUG - Appointment Firma Alders Electronic GmbH  WBY61EF0905451862 ohne Termin.
2025-11-12 11:07:38,070 - ispa_next.appointments.models - DEBUG - Appointment Firma Shimadzu Europa GmbH DU-SH 7700 WBA85BZ050N296538 ohne Termin.
2025-11-12 11:07:38,077 - ispa_next.appointments.models - DEBUG - Appointment Ibrahim Tizniti K-IT 1605 WBA8H91090A720533 ohne Termin.
2025-11-12 11:07:38,085 - ispa_next.appointments.models - DEBUG - Appointment Firma Netzwerk Aussenwirtschaft GmbH NE-DG 4441 WBATY55020N120555 ohne Termin.
2025-11-12 11:07:38,095 - ispa_next.main - DEBUG - Found 14 out of 20 appointments to process (configured limit: 15).
2025-11-12 11:07:38,095 - ispa_next.main - DEBUG - Processing 9 fresh appointments.
2025-11-12 11:07:38,096 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 11:07:38,096 - ispa_next.main - DEBUG - All appointments: D-UP 458, DU-K 9705, DU-LM 3820, DU-YA 501, DU-MM 9492, DU-VG 91, DU-CA 35, KLE-GA 313, DU-ES 550 E, DU-F 7412, DU-EF 3450, DU-WH 3678, MH-PI 88, DU-S 425
2025-11-12 11:07:38,097 - ispa_next.main - DEBUG - 



2025-11-12 11:07:38,098 - ispa_next.main - DEBUG - starting with process 1 (D-UP 458) of 14
2025-11-12 11:07:38,100 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:07:38,972 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:39,918 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:07:39,920 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 139
2025-11-12 11:07:41,185 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:07:41,186 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:05,718 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:08:14,780 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:17,312 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:08:17,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:17,415 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:08:17,574 - ispa_next.functions - DEBUG - HU date already expired after 19 days.
2025-11-12 11:08:23,684 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:08:23,687 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:08:23,687 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:23,777 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:08:32,613 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:08:32,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:08:33,698 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:08:35,700 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:08:35,829 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:08:35,911 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:08:36,012 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:08:40,198 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:08:41,202 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:08:41,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:41,661 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:52,183 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:08:59,189 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:08:59,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:59,282 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:08:59,282 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:08:59,375 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:09:00,641 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:09:01,700 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:09:01,955 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:09:05,637 - ispa_next.functions - DEBUG - Updated appointment (AB00016449) customer contact data.
2025-11-12 11:09:06,537 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:09:06,538 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:09:07,030 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:09:07,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:09:07,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:09:11,798 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:09:11,798 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:09:11,798 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:09:11,800 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:09:11,801 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:09:11,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:09:12,350 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:09:16,481 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:09:17,313 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:09:27,243 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:09:27,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:09:27,346 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:09:31,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:32,159 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:32,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:09:33,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:09:33,033 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:09:35,532 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:09:35,534 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:09:36,939 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:09:36,941 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:09:36,944 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:09:36,945 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:09:36,948 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:09:36,951 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:09:36,951 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:09:36,971 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:09:36,972 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:09:36,974 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:09:36,978 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:09:36,979 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:09:36,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:39,521 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:09:39,522 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:09:39,525 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:42,191 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:09:42,193 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:09:42,194 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:09:43,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:09:43,865 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:03,347 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:10:03,350 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:05,942 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:10:20,394 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:10:20,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:10:21,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:10:21,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:29,221 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:10:34,271 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:10:39,895 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:10:39,897 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:10:39,898 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:10:40,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:10:40,915 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:10:40,916 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:10:43,319 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:10:55,141 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:10:55,534 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:10:56,062 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:58,120 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:10:58,122 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:02,197 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-12 11:11:02,198 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:03,226 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:11:03,233 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:11:03,239 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:11:03,241 - ispa_next.main - DEBUG - Found new Appointment: RE-AP 600E
2025-11-12 11:11:03,242 - ispa_next.main - DEBUG - 



2025-11-12 11:11:03,242 - ispa_next.main - DEBUG - starting with process 2 (RE-AP 600E) of 15
2025-11-12 11:11:03,245 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:04,650 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:06,129 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:11:06,131 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:11:08,187 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:08,189 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:33,255 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:11:44,325 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:46,228 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:11:46,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:46,310 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:11:46,586 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:11:46,588 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:11:46,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:46,674 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:11:49,858 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:11:49,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:11:50,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:11:52,883 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:11:53,009 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:11:56,249 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:11:56,354 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:12:00,602 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:12:01,607 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:12:01,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:02,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:17,475 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:12:25,269 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:12:25,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:25,379 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:25,380 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:12:25,420 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:12:26,660 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:12:26,904 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:12:30,900 - ispa_next.functions - DEBUG - Updated appointment (AB00016451) customer contact data.
2025-11-12 11:12:31,849 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:12:31,850 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:12:32,829 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:12:32,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:12:33,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:12:38,418 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:12:38,418 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:12:38,423 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:12:38,424 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:12:38,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:38,962 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:43,134 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:12:43,154 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:12:43,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:43,241 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:12:48,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:49,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:49,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:50,172 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:50,173 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:12:52,617 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:12:52,619 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:12:53,868 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:12:53,870 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:12:53,872 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:12:53,873 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:12:53,875 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 11:12:53,876 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:12:53,878 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:12:53,879 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:12:53,881 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:12:53,882 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 11:12:56,049 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:12:56,609 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:12:58,103 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:12:58,701 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:12:59,259 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:13:00,187 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:13:00,796 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:13:01,339 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:13:02,276 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:13:03,478 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:13:04,423 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:13:04,976 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:13:05,000 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:13:05,002 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:07,101 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:13:07,102 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:13:07,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:09,048 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:13:09,049 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:13:09,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:13:10,013 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:13:10,346 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:25,732 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:13:25,735 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:27,831 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:13:40,986 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:13:41,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:13:42,118 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:13:42,320 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:48,980 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:13:54,404 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:13:54,406 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:13:54,407 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:55,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:13:55,332 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:13:55,333 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:13:57,447 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:14:05,815 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:14:06,190 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:14:06,586 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:09,028 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:14:09,029 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:13,692 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-12 11:14:13,693 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:14,907 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:14:14,917 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:14:14,924 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:14:14,928 - ispa_next.main - DEBUG - 



2025-11-12 11:14:14,928 - ispa_next.main - DEBUG - starting with process 3 (DU-K 9705) of 15
2025-11-12 11:14:14,931 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:16,761 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:18,720 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:14:18,722 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:14:20,859 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:20,861 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:55,094 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:14:55,201 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:14:55,206 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:55,773 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:14:55,774 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:59,713 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-12 11:14:59,713 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:01,078 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:15:01,091 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:15:01,101 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:15:01,103 - ispa_next.main - DEBUG - 



2025-11-12 11:15:01,103 - ispa_next.main - DEBUG - starting with process 4 (DU-LM 3820) of 15
2025-11-12 11:15:01,106 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:15:02,911 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:04,437 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:15:04,439 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:15:07,719 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:07,720 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:42,449 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:15:42,460 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:15:42,463 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:43,250 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:15:43,252 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:47,561 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-12 11:15:47,562 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:48,764 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:15:48,776 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:15:48,783 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:15:48,786 - ispa_next.main - DEBUG - 



2025-11-12 11:15:48,786 - ispa_next.main - DEBUG - starting with process 5 (DU-YA 501) of 15
2025-11-12 11:15:48,789 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:15:50,616 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:52,433 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:15:52,435 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:15:54,514 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:54,516 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:28,874 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:16:28,885 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:16:28,889 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:29,585 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:16:29,586 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:33,417 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-12 11:16:33,417 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:34,372 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:16:34,380 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:16:34,386 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:16:34,388 - ispa_next.main - DEBUG - 



2025-11-12 11:16:34,388 - ispa_next.main - DEBUG - starting with process 6 (DU-MM 9492) of 15
2025-11-12 11:16:34,391 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:16:35,759 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:37,149 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:16:37,151 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:16:39,213 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:39,215 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:17:12,032 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:17:12,043 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:17:12,046 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:17:12,748 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:17:12,750 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:17:16,920 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-12 11:17:16,921 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:17:18,068 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:17:18,076 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:17:18,083 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:17:18,086 - ispa_next.main - DEBUG - 



2025-11-12 11:17:18,086 - ispa_next.main - DEBUG - starting with process 7 (DU-VG 91) of 15
2025-11-12 11:17:18,089 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:17:19,815 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:17:21,465 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:17:21,467 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:17:23,253 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:17:23,254 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:17:59,918 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:17:59,930 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:17:59,937 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:00,714 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:18:00,716 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:05,065 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-12 11:18:05,066 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:06,329 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:18:06,339 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:18:06,346 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:18:06,348 - ispa_next.main - DEBUG - 



2025-11-12 11:18:06,348 - ispa_next.main - DEBUG - starting with process 8 (DU-CA 35) of 15
2025-11-12 11:18:06,351 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:08,174 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:10,022 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:18:10,024 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:18:11,924 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:11,929 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:42,949 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:18:42,957 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:18:42,962 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:43,649 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:18:43,651 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:47,841 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-12 11:18:47,842 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:49,015 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:18:49,023 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:18:49,031 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:18:49,034 - ispa_next.main - DEBUG - 



2025-11-12 11:18:49,034 - ispa_next.main - DEBUG - starting with process 9 (KLE-GA 313) of 15
2025-11-12 11:18:49,037 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:50,522 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:51,829 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:18:51,830 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:18:53,562 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:53,568 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:26,821 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:19:26,834 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:19:26,838 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:19:27,526 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:19:27,528 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:19:31,652 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-12 11:19:31,653 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:32,800 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:19:32,808 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:19:32,815 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:19:32,818 - ispa_next.main - DEBUG - 



2025-11-12 11:19:32,818 - ispa_next.main - DEBUG - starting with process 10 (DU-ES 550 E) of 15
2025-11-12 11:19:32,821 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:19:34,648 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:19:36,249 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:19:36,250 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:19:38,224 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:19:38,226 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:20:13,029 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:20:13,039 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 11:20:13,042 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:20:13,805 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:20:13,807 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:20:17,807 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-12 11:20:17,808 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:20:18,962 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:20:18,969 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:20:18,975 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:20:18,978 - ispa_next.main - DEBUG - 



2025-11-12 11:20:18,978 - ispa_next.main - DEBUG - starting with process 11 (DU-F 7412) of 15
2025-11-12 11:20:18,982 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:20:20,816 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:20:22,694 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:20:22,696 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:20:24,699 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:20:24,702 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:20:54,182 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:20:56,699 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:21:02,708 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:03,996 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:21:03,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:04,092 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:21:04,505 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:21:04,508 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:21:04,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:04,635 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:21:12,928 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:21:12,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:14,193 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:21:16,198 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:21:16,394 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:21:16,526 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:21:16,664 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:21:20,848 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:21:21,853 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:21:21,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:22,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:36,299 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:21:41,506 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:21:41,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:41,617 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:21:41,618 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:21:41,672 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:21:43,034 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:21:44,259 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:21:44,540 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:21:46,490 - ispa_next.functions - DEBUG - Updated appointment (AD00012015) customer contact data.
2025-11-12 11:21:47,457 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:21:47,461 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:21:48,801 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:21:48,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:21:49,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:21:53,449 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:21:53,449 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:21:53,452 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:21:53,452 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:21:53,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:53,962 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:21:58,129 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:21:58,133 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:21:58,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:58,242 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:22:02,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:02,987 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:02,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:03,797 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:22:03,798 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:22:05,153 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:22:05,155 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:22:06,448 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:22:06,453 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:22:06,456 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:22:06,459 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:22:06,461 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:22:06,462 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:22:06,463 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:22:06,465 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:22:06,466 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:22:06,468 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:22:06,470 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:22:06,472 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:22:06,472 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:07,686 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:22:07,687 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:22:07,689 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:08,919 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:22:08,935 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:22:08,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:22:09,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:22:10,170 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:18,721 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:22:18,724 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:19,969 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:22:33,892 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:22:34,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:34,985 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:22:35,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:41,327 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:41,329 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:22:41,329 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:42,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:42,241 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:22:42,242 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:22:44,673 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:22:54,314 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:22:54,686 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 11:22:55,348 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:00,659 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:23:00,660 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:05,317 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-12 11:23:05,318 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:06,346 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:23:06,361 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:23:06,367 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:23:06,370 - ispa_next.main - DEBUG - 



2025-11-12 11:23:06,370 - ispa_next.main - DEBUG - starting with process 12 (DU-EF 3450) of 15
2025-11-12 11:23:06,373 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:23:07,719 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:09,205 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:23:09,207 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:23:11,286 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:11,288 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:42,907 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:23:45,699 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:23:51,511 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:56,897 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:23:56,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:57,022 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:57,399 - ispa_next.functions - DEBUG - HU date soon to be invalid in 48 days.
2025-11-12 11:24:03,220 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:24:03,223 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:24:03,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:03,318 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:24:11,340 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:24:11,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:12,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:14,575 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:24:14,725 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:24:14,885 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:24:15,021 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:24:17,191 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:24:18,197 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:24:18,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:18,716 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:32,719 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:24:38,467 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:24:38,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:38,596 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:24:38,597 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:24:38,645 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:24:38,879 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:24:40,164 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 11:24:41,436 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 11:24:41,819 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:24:43,902 - ispa_next.functions - DEBUG - Updated appointment (AD00011934) customer contact data.
2025-11-12 11:24:44,837 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:24:44,839 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:24:45,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:24:46,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:24:47,631 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:24:47,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:24:47,724 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:24:51,384 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:24:51,384 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:24:51,388 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:24:51,389 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:24:51,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:51,900 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:56,128 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:25:01,059 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:25:01,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:01,164 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:25:01,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:02,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:02,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:02,901 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:25:02,902 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:25:07,865 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:25:07,867 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:25:09,591 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:25:09,592 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:25:09,594 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:25:09,596 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:25:09,597 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:25:09,599 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:25:09,600 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:25:09,602 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:25:09,607 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:25:09,610 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:25:09,614 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:25:09,615 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:25:09,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:14,987 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:25:18,797 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:25:18,802 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:25:18,829 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:25,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:25,847 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:25:40,531 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:25:40,533 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:25:40,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:25:42,252 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:25:42,490 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:59,088 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:25:59,090 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:04,487 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:26:19,572 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:26:20,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:26:20,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:26:20,936 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:31,657 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:26:37,007 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:26:41,208 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:26:41,209 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:26:42,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:26:42,149 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:26:42,150 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:26:45,998 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:26:58,036 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:26:58,433 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 11:27:01,072 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:27:01,808 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:27:01,809 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:27:06,191 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 281
2025-11-12 11:27:06,192 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:27:07,201 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:27:07,209 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:27:07,215 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:27:07,221 - ispa_next.appointments.models - DEBUG - Appointment Firma Hager Pharma GmbH DU-HP 106E WBY61EF0205Y15376 ohne Termin.
2025-11-12 11:27:07,223 - ispa_next.main - DEBUG - 



2025-11-12 11:27:07,223 - ispa_next.main - DEBUG - starting with process 13 (DU-WH 3678) of 15
2025-11-12 11:27:07,226 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:27:08,880 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:27:10,372 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 11:27:10,374 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 281
2025-11-12 11:27:12,116 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:27:12,119 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:27:42,869 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:27:45,848 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:27:51,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:52,996 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:27:52,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:53,073 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:27:53,348 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:27:53,351 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:27:53,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:53,470 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:27:56,633 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:27:56,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:27:58,190 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:28:00,194 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:28:00,329 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:28:00,450 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:28:00,536 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:28:00,538 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:01,838 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:28:10,922 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:28:11,928 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:28:11,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:12,454 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:26,461 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:28:31,540 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:28:31,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:31,660 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:28:31,661 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:28:31,811 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:28:33,186 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:28:34,420 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:28:34,632 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:28:36,705 - ispa_next.functions - DEBUG - Updated appointment (AB00016366) customer contact data.
2025-11-12 11:28:37,630 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:28:37,632 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:28:39,081 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:28:39,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:28:40,039 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:28:43,663 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:28:43,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:28:44,168 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:28:46,171 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:28:46,297 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:28:46,430 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:28:46,539 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:28:46,540 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:47,829 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:28:56,696 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:29:56,698 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:30:05,453 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:30:43,456 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:30:52,123 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:31:01,798 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:31:02,805 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:31:02,805 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:31:02,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:02,893 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:31:07,109 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:31:07,115 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:31:07,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:07,212 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:31:16,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:17,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:17,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:18,459 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:31:18,460 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:31:19,799 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:31:19,801 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:31:21,469 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:31:21,470 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:31:21,472 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:31:21,475 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:31:21,480 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:31:21,483 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:31:21,485 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:31:21,487 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:31:21,488 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:31:21,489 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:31:21,492 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:31:21,494 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:31:21,495 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:22,732 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:31:22,734 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:31:22,736 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:23,991 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:31:23,992 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:31:23,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:31:25,050 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:31:25,119 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:31:25,144 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:26,394 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:31:38,369 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:31:38,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:31:39,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:31:39,622 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:46,058 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:46,060 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:31:46,060 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:46,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:31:46,887 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:31:46,888 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:31:48,857 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:31:58,458 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:31:58,836 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 11:31:59,385 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:32:01,413 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 11:32:01,414 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:32:05,538 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-12 11:32:05,539 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:32:06,533 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:32:06,546 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:32:06,552 - ispa_next.appointments.models - DEBUG - Appointment Firma Stryker GmbH & Co. KG  WBA31BN070CR23943 ohne Termin.
2025-11-12 11:32:06,554 - ispa_next.main - DEBUG - Found new Appointment: DU-EH 1314
2025-11-12 11:32:06,555 - ispa_next.main - DEBUG - 



2025-11-12 11:32:06,555 - ispa_next.main - DEBUG - starting with process 14 (DU-EH 1314) of 16
2025-11-12 11:32:06,558 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:32:07,935 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:32:09,436 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 11:32:09,437 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:32:11,505 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:32:11,507 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:32:39,147 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:32:50,484 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:51,707 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:32:51,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:51,799 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:32:52,028 - ispa_next.functions - DEBUG - HU date already expired after 142 days.
2025-11-12 11:33:00,015 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:33:00,021 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:33:00,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:00,100 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:33:12,300 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:33:12,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:33:13,586 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:33:15,590 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:33:23,203 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 11:33:32,170 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 11:33:33,175 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:33:33,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:33,678 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:46,747 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:33:55,652 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:33:55,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:55,754 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:33:55,755 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:33:55,835 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:33:55,970 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:33:57,158 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 11:33:58,369 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 11:33:58,752 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:34:02,358 - ispa_next.functions - DEBUG - Updated appointment (AB00016453) customer contact data.
2025-11-12 11:34:03,275 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:34:03,279 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:34:03,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:34:04,906 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:34:06,653 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:34:06,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:34:06,781 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:34:10,861 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:34:10,861 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:34:10,861 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:34:10,864 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:34:10,865 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:34:10,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:34:11,386 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:34:15,535 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:34:16,534 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:34:25,117 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:34:25,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:34:25,215 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:34:25,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:26,165 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:26,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:34:26,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:34:26,978 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:34:28,834 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:34:28,836 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:34:30,084 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:34:30,085 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:34:30,087 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:34:30,088 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:34:30,089 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:34:30,091 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:34:30,092 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:34:30,093 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:34:30,095 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:34:30,096 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:34:30,117 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:34:30,119 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:34:30,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:34:32,047 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:34:32,048 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:34:32,051 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:34:34,056 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:34:34,057 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:34:34,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:34:35,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:34:35,241 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:34:43,018 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:34:43,020 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:34:44,959 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:34:57,122 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:34:57,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:34:58,263 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:34:58,491 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:05,699 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:35:12,103 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:35:12,104 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:35:12,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:35:13,074 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:35:13,075 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:35:16,714 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:35:27,343 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:35:27,742 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 11:35:28,433 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:35:30,813 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 11:35:30,815 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:35:35,408 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 283
2025-11-12 11:35:35,408 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:35:37,275 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 11:35:37,282 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:35:37,291 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:35:37,294 - ispa_next.main - DEBUG - 



2025-11-12 11:35:37,294 - ispa_next.main - DEBUG - starting with process 15 (MH-PI 88) of 16
2025-11-12 11:35:37,298 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:35:39,105 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:35:40,605 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 11:35:40,606 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 283
2025-11-12 11:35:42,667 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:35:42,669 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:36:25,161 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:36:27,753 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:36:33,927 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:36,649 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:36:36,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:36,734 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:36:37,105 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:36:37,111 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:36:37,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:37,231 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:36:46,106 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:36:46,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:36:47,534 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:36:49,541 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:36:49,664 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:36:49,850 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:36:49,961 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:36:54,185 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:36:55,190 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:36:55,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:55,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:37:06,981 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:37:12,157 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:37:12,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:37:12,266 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:37:12,267 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:37:12,331 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:37:13,680 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:37:13,913 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:37:16,424 - ispa_next.functions - DEBUG - Updated appointment (AD00011951) customer contact data.
2025-11-12 11:37:17,342 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:37:17,344 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:37:18,282 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:37:18,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:37:19,273 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:37:22,878 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:37:22,878 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:37:22,881 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:37:22,882 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:37:22,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:37:23,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:37:27,590 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:37:32,562 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:37:32,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:37:32,666 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:37:33,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:37:33,579 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:37:33,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:37:34,493 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:37:34,494 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:37:37,069 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:37:37,074 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:37:38,597 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:37:38,599 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:37:38,601 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:37:38,603 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:37:38,606 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:37:38,607 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:37:38,608 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:37:38,609 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:37:38,610 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:37:38,612 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:37:38,614 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:37:38,615 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:37:38,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:37:41,261 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:37:41,262 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:37:41,264 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:37:43,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:37:43,986 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:37:56,499 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:37:56,500 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:37:56,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:37:57,630 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:37:57,904 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:07,715 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:38:07,716 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:10,369 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:38:22,580 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:38:23,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:38:23,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:38:23,894 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:31,225 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:38:36,929 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:38:41,431 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:38:41,432 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:38:42,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:38:42,446 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:38:42,447 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:38:46,200 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:38:56,525 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:38:56,896 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 11:38:59,774 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:39:00,718 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 11:39:00,722 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:39:05,168 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 283
2025-11-12 11:39:05,168 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:39:06,204 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 11:39:06,212 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:39:06,220 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 11:39:06,223 - ispa_next.main - DEBUG - 



2025-11-12 11:39:06,223 - ispa_next.main - DEBUG - starting with process 16 (DU-S 425) of 16
2025-11-12 11:39:06,227 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:39:08,019 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:39:09,765 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 11:39:09,766 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 283
2025-11-12 11:39:11,826 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:39:11,827 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:39:42,390 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:39:45,055 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:39:51,713 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:55,770 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:39:55,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:39:55,861 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:39:56,242 - ispa_next.functions - DEBUG - HU date already expired after 19 days.
2025-11-12 11:40:01,932 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:40:01,935 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:40:01,936 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:02,014 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:40:05,542 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:40:05,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:40:07,548 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:40:09,551 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:40:09,689 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:40:09,834 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:40:09,957 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:40:12,089 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:40:13,102 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:40:13,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:13,592 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:27,445 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:40:33,230 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:40:33,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:33,312 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:40:33,313 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:40:33,377 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:40:34,679 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:40:34,888 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:40:36,987 - ispa_next.functions - DEBUG - Updated appointment (AB00016421) customer contact data.
2025-11-12 11:40:37,896 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:40:37,898 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:40:39,149 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:40:39,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:40:40,377 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:40:44,789 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:40:44,789 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:40:44,789 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:40:44,792 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:40:44,793 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:40:44,794 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:40:45,290 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:40:49,463 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:40:54,320 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:40:54,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:40:54,411 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:41:03,986 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 11:41:15,769 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-12 11:41:22,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:23,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:23,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:23,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:41:23,950 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:41:27,595 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:41:27,597 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:41:28,804 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:41:28,805 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:41:28,807 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:41:28,808 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:41:28,809 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:41:28,810 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:41:28,811 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:41:28,814 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:41:28,816 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:41:28,820 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:41:28,824 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:41:28,825 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:41:28,826 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:32,910 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:41:32,911 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:41:32,915 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:36,872 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:41:36,873 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:41:36,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:41:37,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:41:38,072 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:44,984 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:41:44,986 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:49,388 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:42:03,901 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:42:04,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:42:05,019 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:42:05,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:42:14,810 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:42:20,053 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:42:25,792 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:42:30,289 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:42:30,290 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:42:31,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:42:31,398 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:42:31,399 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:42:35,350 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:42:46,636 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:42:47,050 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 11:42:49,322 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:42:50,204 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 11:42:50,205 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:42:54,700 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 283
2025-11-12 11:42:54,701 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:42:55,648 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 11:42:55,655 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 11:42:55,662 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
