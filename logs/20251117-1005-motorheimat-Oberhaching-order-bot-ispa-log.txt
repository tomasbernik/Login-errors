2025-11-17 10:33:47,508 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:33:47,517 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:33:55,348 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:34:07,412 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:34:23,003 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:34:48,993 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:35:04,677 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:35:07,018 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:35:07,585 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 762
2025-11-17 10:35:07,587 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 12
2025-11-17 10:35:08,823 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 5
2025-11-17 10:35:08,824 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:35:08,824 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:35:09,236 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:35:09,722 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:35:10,130 - ispa_next.main - DEBUG - Found 4 out of 5 appointments to process (configured limit: 15).
2025-11-17 10:35:10,130 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-17 10:35:10,130 - ispa_next.main - DEBUG - All appointments: M-L 9800, M-X 9821, A-FW 769, M-MI18E
2025-11-17 10:35:10,132 - ispa_next.main - DEBUG - 



2025-11-17 10:35:10,132 - ispa_next.main - DEBUG - starting with process 1 (M-L 9800) of 4
2025-11-17 10:35:10,137 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:35:10,651 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:35:11,119 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 762
2025-11-17 10:35:11,120 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 5
2025-11-17 10:35:12,118 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:35:12,119 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:35:39,398 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:35:48,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:48,117 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:35:48,253 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:35:49,537 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:35:49,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:49,609 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:35:49,850 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:35:49,852 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:35:49,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:49,956 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:35:53,166 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:35:53,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:35:54,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:35:56,233 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:35:56,409 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:35:59,696 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:35:59,790 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:35:59,790 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:36:10,724 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:36:11,726 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:36:11,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:12,224 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:25,693 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:36:32,850 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:36:32,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:32,943 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:36:32,943 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:36:32,988 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:36:34,201 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:36:34,494 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:36:38,492 - ispa_next.functions - DEBUG - Updated appointment (AJ00018561) customer contact data.
2025-11-17 10:36:39,388 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:36:39,396 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:36:40,212 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:36:40,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:36:40,990 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:36:45,457 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:36:45,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:36:46,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:36:48,012 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:36:48,128 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:36:48,222 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:36:48,301 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:36:48,301 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:36:59,692 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:37:06,711 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:37:06,712 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:37:10,860 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:37:11,891 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:37:11,892 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:37:11,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:11,955 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:37:16,082 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:37:16,096 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:37:16,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:16,163 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:37:25,244 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 10:37:28,993 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:37:28,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:29,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:29,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:30,261 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:37:30,261 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:37:32,731 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:37:32,733 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:37:33,672 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:37:33,674 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:37:33,674 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:37:33,676 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:37:33,678 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-17 10:37:33,684 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:37:33,700 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 10:37:33,704 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:37:33,706 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:37:33,706 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:37:33,708 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:37:33,710 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:37:53,305 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:37:53,305 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:37:55,222 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:37:55,750 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:37:56,687 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:37:57,241 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:37:57,784 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:37:58,706 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:37:59,264 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:37:59,797 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:38:01,241 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:38:01,797 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:38:02,325 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:38:03,261 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:38:04,330 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:38:05,298 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:38:05,738 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 10:38:10,571 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:38:10,572 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:38:10,573 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:13,156 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:38:13,157 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:38:13,159 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:15,700 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:38:15,700 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 10:38:15,702 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:18,248 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:38:18,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:38:18,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:38:19,119 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:34,003 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:38:34,003 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:36,591 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:38:47,918 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:38:48,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:38:48,901 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:38:49,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:39:13,632 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:17,329 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:21,804 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:21,805 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:39:21,806 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:22,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:39:22,346 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:39:22,350 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:39:23,914 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:39:33,356 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:39:33,729 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:39:33,961 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:35,069 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 763
2025-11-17 10:39:35,070 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:37,200 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 12
2025-11-17 10:39:37,201 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:39:37,871 - ispa_next.appointments.models - DEBUG - Appointment Tina Waske von Reppert M-VR 21 WBA4M910509D07779 ohne Termin.
2025-11-17 10:39:37,883 - ispa_next.main - DEBUG - Found new Appointment: TÖL-TH 193
2025-11-17 10:39:37,885 - ispa_next.main - DEBUG - 



2025-11-17 10:39:37,885 - ispa_next.main - DEBUG - starting with process 2 (TÖL-TH 193) of 5
2025-11-17 10:39:37,888 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:38,574 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:39,349 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 763
2025-11-17 10:39:39,351 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 12
2025-11-17 10:39:40,594 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:40,595 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:40:14,473 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:40:23,800 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:40:24,985 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:40:24,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:25,054 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:40:25,249 - ispa_next.functions - DEBUG - HU date already expired after 2 days.
2025-11-17 10:40:31,919 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:40:31,921 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:40:31,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:32,002 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:40:41,980 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:40:41,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:40:42,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:40:44,799 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:40:44,904 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:40:44,986 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:40:45,043 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:40:49,170 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:40:50,173 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:40:50,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:50,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:01,191 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:41:08,269 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:41:08,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:08,355 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:41:08,357 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:41:08,388 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:41:08,484 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:41:09,642 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:41:09,913 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:41:13,820 - ispa_next.functions - DEBUG - Updated appointment (AJ00018576) customer contact data.
2025-11-17 10:41:14,729 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:41:14,730 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:41:14,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:41:15,564 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:41:16,729 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:41:16,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:41:16,790 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:41:20,395 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:41:20,395 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:41:20,397 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:41:20,399 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:41:20,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:20,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:41:25,013 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:41:25,017 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:41:25,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:25,104 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:41:25,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:26,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:26,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:26,651 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:41:26,651 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:41:27,960 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:41:27,964 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:41:29,218 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:41:29,220 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:41:29,222 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:41:29,224 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:41:29,226 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:41:29,226 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:41:29,230 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:41:29,232 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:41:29,234 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:41:29,236 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:41:29,238 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:41:29,246 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:41:29,250 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:41:29,253 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:41:29,253 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:30,425 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:41:30,427 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:41:30,429 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:31,586 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:41:31,586 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 10:41:31,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:32,788 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:41:32,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:41:33,380 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:41:33,592 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:41,532 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:41:41,534 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:42,732 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:41:53,605 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:41:54,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:41:54,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:41:54,699 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:05,930 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:05,932 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:42:05,932 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:42:06,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:42:06,390 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:42:06,390 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:42:07,944 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:42:14,567 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:42:14,985 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:42:15,537 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:42:16,467 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 764
2025-11-17 10:42:16,471 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:42:18,410 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 12
2025-11-17 10:42:18,411 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:42:19,206 - ispa_next.appointments.models - DEBUG - Appointment Tina Waske von Reppert M-VR 21 WBA4M910509D07779 ohne Termin.
2025-11-17 10:42:19,215 - ispa_next.main - DEBUG - 



2025-11-17 10:42:19,216 - ispa_next.main - DEBUG - starting with process 3 (M-X 9821) of 5
2025-11-17 10:42:19,218 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:42:20,066 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:42:20,927 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 764
2025-11-17 10:42:20,928 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 12
2025-11-17 10:42:22,254 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:42:22,256 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:42:49,961 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:43:00,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:00,262 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:43:00,445 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:05,826 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:43:05,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:05,925 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:43:06,127 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:43:06,129 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:43:06,130 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:06,222 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:43:15,330 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:43:15,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:43:16,406 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:43:18,409 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:43:24,046 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:43:30,832 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:43:31,835 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:43:31,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:32,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:42,305 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:43:42,306 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:43:49,231 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:43:49,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:49,314 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:43:49,314 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:43:49,356 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:43:49,448 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:43:50,612 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:43:50,845 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:43:54,934 - ispa_next.functions - DEBUG - Updated appointment (AJ00018565) customer contact data.
2025-11-17 10:43:55,853 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:43:55,855 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:43:55,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:43:56,723 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:43:57,853 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:43:57,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:43:57,944 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:44:01,920 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:44:01,920 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:44:01,922 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:44:01,922 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:44:01,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:02,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:44:06,575 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:44:06,579 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:44:06,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:06,649 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:44:07,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:07,500 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:07,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:08,180 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:44:08,182 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:44:12,917 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:44:12,925 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:44:14,725 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:44:14,725 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:44:14,727 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:44:14,729 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:44:14,729 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:44:14,731 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:44:14,735 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:44:14,743 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:44:14,747 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:44:14,751 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:44:14,755 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:44:14,757 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:44:14,759 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:44:14,759 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:44:14,759 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:20,116 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:44:20,116 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:44:20,118 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:25,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:25,437 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:44:37,001 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:44:37,001 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 10:44:37,015 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:42,298 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:44:42,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:44:42,955 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:44:42,987 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:44:42,993 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:48,292 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:44:58,923 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:44:59,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:44:59,895 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:44:59,994 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:45:21,302 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:45:21,304 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:45:21,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:45:21,821 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:45:21,821 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:45:24,316 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:45:31,508 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:45:31,881 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:45:32,929 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:45:33,600 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 765
2025-11-17 10:45:33,602 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:45:35,775 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 13
2025-11-17 10:45:35,775 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:45:36,595 - ispa_next.appointments.models - DEBUG - Appointment Tina Waske von Reppert M-VR 21 WBA4M910509D07779 ohne Termin.
2025-11-17 10:45:36,602 - ispa_next.main - DEBUG - Found new Appointment: M-D 7490
2025-11-17 10:45:36,603 - ispa_next.main - DEBUG - 



2025-11-17 10:45:36,603 - ispa_next.main - DEBUG - starting with process 4 (M-D 7490) of 6
2025-11-17 10:45:36,606 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:45:37,335 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:45:38,094 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 765
2025-11-17 10:45:38,095 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 13
2025-11-17 10:45:39,117 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:45:39,118 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:46:15,008 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:46:24,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:46:25,983 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:46:25,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:26,065 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:46:26,338 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:46:26,340 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:46:26,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:26,425 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:46:29,555 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:46:29,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:46:30,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:46:32,511 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:46:32,619 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:46:35,838 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:46:42,241 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 10:46:43,243 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:46:43,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:43,717 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:56,336 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:47:03,573 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:47:03,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:03,642 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:47:03,642 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:47:03,697 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:47:04,946 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:47:06,367 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:47:06,604 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:47:10,093 - ispa_next.functions - DEBUG - Updated appointment (BD00009451) customer contact data.
2025-11-17 10:47:11,009 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:47:11,009 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:47:11,779 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:47:11,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:47:12,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:47:16,919 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:47:16,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:17,547 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:47:19,551 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:47:19,658 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:47:19,757 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:47:19,824 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:47:24,011 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:47:25,018 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:47:25,018 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:47:25,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:25,110 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:47:29,213 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:47:29,219 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:47:29,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:29,321 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:47:35,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:35,841 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:35,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:36,562 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:47:36,562 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:47:39,075 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:47:39,077 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:47:40,034 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:47:40,034 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:47:40,036 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:47:40,038 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart)}
2025-11-17 10:47:40,038 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:47:40,040 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:47:40,040 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:47:40,042 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:47:40,042 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:47:40,044 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:47:40,045 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:47:40,046 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:48:05,518 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:48:05,518 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:48:05,520 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:48:05,520 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:08,839 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:48:08,841 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:48:08,841 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:12,120 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:48:12,120 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 10:48:12,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:15,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:48:15,404 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:48:23,505 - ispa_next.functions - DEBUG - added beide Bremsscheiben hinten to advice_list
2025-11-17 10:48:23,993 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:48:23,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:48:24,926 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:48:24,955 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:48:24,957 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:28,192 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:48:38,572 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:48:39,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:48:39,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:48:39,763 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:58,648 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:48:58,648 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:48:59,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:48:59,146 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:48:59,147 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:49:01,593 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:49:07,906 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:49:08,286 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:49:09,254 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:49:09,741 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-17 10:49:09,743 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:49:11,539 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 13
2025-11-17 10:49:11,540 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:49:12,214 - ispa_next.appointments.models - DEBUG - Appointment Firma NGS Global Europe M-LL 3550 WBACV610509B42176 ohne Termin.
2025-11-17 10:49:12,222 - ispa_next.appointments.models - DEBUG - Appointment Tina Waske von Reppert M-VR 21 WBA4M910509D07779 ohne Termin.
2025-11-17 10:49:12,230 - ispa_next.main - DEBUG - 



2025-11-17 10:49:12,231 - ispa_next.main - DEBUG - starting with process 5 (A-FW 769) of 6
2025-11-17 10:49:12,235 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:49:12,925 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:49:13,582 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-17 10:49:13,583 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 13
2025-11-17 10:49:14,661 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:49:14,667 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:49:42,814 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:49:52,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:49:56,504 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:49:56,504 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:56,579 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:49:56,821 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:50:03,199 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:50:03,202 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:50:03,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:03,268 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:06,381 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:50:06,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:07,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:50:09,871 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:50:09,995 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:50:13,225 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:50:13,345 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:50:15,446 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:50:16,450 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:50:16,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:16,924 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:28,197 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:50:28,197 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:50:34,281 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:50:34,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:34,370 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:34,370 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:50:34,404 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:50:35,909 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:50:36,167 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:50:38,945 - ispa_next.functions - DEBUG - Updated appointment (AC00062736) customer contact data.
2025-11-17 10:50:39,880 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:50:39,881 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:50:40,442 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:50:40,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:50:41,053 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:50:45,597 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:50:45,597 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:50:45,692 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:50:45,810 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:50:45,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:46,332 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:50:50,448 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:50:51,255 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:51:06,805 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:51:06,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:07,020 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:51:10,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:11,024 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:11,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:11,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:51:11,791 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:51:16,071 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:51:16,073 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:51:17,500 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:51:17,502 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:51:17,502 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:51:17,504 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:51:17,505 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:51:17,505 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:51:17,508 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:51:17,509 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:51:17,510 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:51:17,512 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:51:17,513 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:51:17,521 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:51:17,525 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:51:17,526 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:51:17,527 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:22,315 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:51:22,317 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:51:22,319 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:26,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:27,119 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:51:37,246 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:53,285 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:51:53,285 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 10:51:53,287 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:58,050 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:51:58,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:51:58,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:51:58,865 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:51:58,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:52:03,511 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:52:17,428 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:52:17,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:52:18,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:52:18,712 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:52:59,771 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:52:59,771 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:53:00,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:53:00,963 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:53:00,965 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:53:04,863 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:53:16,053 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:53:16,440 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:53:17,937 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:53:18,710 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-17 10:53:18,712 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:53:21,062 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 13
2025-11-17 10:53:21,063 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:53:21,908 - ispa_next.appointments.models - DEBUG - Appointment Firma NGS Global Europe M-LL 3550 WBACV610509B42176 ohne Termin.
2025-11-17 10:53:21,914 - ispa_next.appointments.models - DEBUG - Appointment Tina Waske von Reppert M-VR 21 WBA4M910509D07779 ohne Termin.
2025-11-17 10:53:21,920 - ispa_next.main - DEBUG - 



2025-11-17 10:53:21,920 - ispa_next.main - DEBUG - starting with process 6 (M-MI18E) of 6
2025-11-17 10:53:21,924 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:53:22,911 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:53:24,349 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-17 10:53:24,351 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 13
2025-11-17 10:53:26,199 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:53:26,201 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:54:09,899 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:54:22,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:25,463 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:54:25,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:54:25,590 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:54:25,949 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:54:25,951 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:54:25,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:54:26,044 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:54:29,510 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:54:29,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:54:30,849 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:54:32,852 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:54:33,015 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:54:33,184 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:54:33,273 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:54:33,273 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:54:45,153 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:54:46,158 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:54:46,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:54:46,691 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:01,767 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:55:12,339 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:55:12,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:12,431 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:12,431 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:55:12,540 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:55:13,815 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:55:14,043 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:55:17,556 - ispa_next.functions - DEBUG - Updated appointment (BD00009449) customer contact data.
2025-11-17 10:55:18,474 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:55:18,483 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:55:19,899 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:55:19,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:55:20,766 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:55:24,357 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:55:24,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:55:24,922 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:55:26,927 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:55:27,063 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:55:27,232 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:55:27,353 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:55:27,353 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:55:38,717 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:56:38,720 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:56:49,732 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:56:57,385 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:56:57,385 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:57:01,567 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:57:02,574 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:57:02,576 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:57:02,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:57:02,671 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:57:06,817 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:57:07,588 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:57:19,985 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:57:19,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:57:20,166 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:57:25,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:57:26,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:57:26,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:57:27,208 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:57:27,210 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:57:30,912 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:57:30,914 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:57:32,029 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:57:32,030 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:57:32,031 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:57:32,033 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:57:32,034 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:57:32,035 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:57:32,037 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 10:57:32,039 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:57:32,040 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:57:32,041 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:57:32,053 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:57:32,057 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:57:34,534 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:57:35,095 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:57:36,030 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:57:36,600 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:57:37,140 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:57:38,730 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:57:39,325 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:57:39,892 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:57:40,820 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:57:41,388 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:57:41,925 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:57:42,887 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:57:43,462 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:57:43,992 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:57:45,373 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:57:46,601 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:57:47,557 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:57:48,239 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:57:48,251 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:57:48,253 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:51,636 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:57:51,637 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:57:51,643 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:54,923 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:57:54,923 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 10:57:54,925 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:58,259 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:57:58,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:57:59,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:57:59,478 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:07,930 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:58:07,934 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:11,248 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:58:25,766 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:58:26,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:58:26,887 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:58:27,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:59,825 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:59:04,939 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:59:10,693 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:59:16,994 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:59:16,995 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:59:16,996 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:59:17,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:59:17,975 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:59:17,977 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:59:20,233 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:59:29,757 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:59:30,124 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:59:30,564 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:59:31,819 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 767
2025-11-17 10:59:31,819 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:59:34,465 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 15
2025-11-17 10:59:34,466 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:59:35,320 - ispa_next.appointments.models - DEBUG - Appointment Kaya Selhan M-WX 8699 WBA6L71020FH69301 ohne Termin.
2025-11-17 10:59:35,327 - ispa_next.appointments.models - DEBUG - Appointment Tina Waske von Reppert M-VR 21 WBA4M910509D07779 ohne Termin.
2025-11-17 10:59:35,333 - ispa_next.main - DEBUG - Found new Appointment: M-LL 3550
2025-11-17 10:59:35,334 - ispa_next.main - DEBUG - 



2025-11-17 10:59:35,334 - ispa_next.main - DEBUG - starting with process 7 (M-LL 3550) of 7
2025-11-17 10:59:35,337 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:59:36,666 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:59:38,002 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 767
2025-11-17 10:59:38,004 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 15
2025-11-17 10:59:39,805 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:59:39,807 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:00:27,949 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:00:38,839 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:00:42,078 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:00:42,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:00:42,202 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:00:42,508 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:00:42,510 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:00:42,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:00:42,607 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:00:55,598 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:00:55,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:00:57,188 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:00:59,194 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:00:59,366 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:00:59,564 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:00:59,715 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:01:03,944 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:01:04,951 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:01:04,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:01:05,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:01:19,937 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:01:19,937 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:01:29,910 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:01:29,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:01:30,006 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:01:30,007 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:01:30,088 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:01:31,439 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:01:32,802 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:01:33,092 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:01:37,576 - ispa_next.functions - DEBUG - Updated appointment (AJ00018585) customer contact data.
2025-11-17 11:01:38,507 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:01:38,521 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:01:40,184 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:01:40,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:01:41,167 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:01:44,792 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:01:44,792 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:01:44,794 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:01:44,794 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:01:44,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:01:45,299 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:01:49,505 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:01:50,682 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:02:02,019 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:02:02,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:02:02,135 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:02:02,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:02:03,039 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:02:03,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:02:03,921 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:02:03,923 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:02:07,151 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:02:07,153 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:02:08,601 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:02:08,602 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:02:08,605 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:02:08,609 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:02:08,613 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:02:08,615 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:02:08,619 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:02:08,621 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:02:08,621 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:02:08,623 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:02:08,625 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:02:08,626 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:02:08,628 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:02:08,629 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:02:08,630 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:02:12,105 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:02:12,105 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:02:12,111 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:02:15,512 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:02:15,512 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:02:15,516 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:02:18,941 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:02:18,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:02:19,965 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:02:20,027 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:02:20,029 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:02:23,419 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:02:36,164 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:02:36,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:02:37,160 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:02:37,338 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:09,755 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:03:14,784 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:03:19,487 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:03:24,866 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:03:24,868 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:03:24,868 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:03:25,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:03:25,665 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:03:25,665 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:03:27,605 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:03:38,467 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:03:38,841 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 11:03:40,254 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:03:41,259 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 770
2025-11-17 11:03:41,261 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:03:45,201 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 18
2025-11-17 11:03:45,202 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:03:46,481 - ispa_next.appointments.models - DEBUG - Appointment Werner Carstens M-RO 738 WBAJP31060BT93035 ohne Termin.
2025-11-17 11:03:46,491 - ispa_next.appointments.models - DEBUG - Appointment Tanja Elisabeth Kimmich M-TK 409 WBAVJ910909B37035 ohne Termin.
2025-11-17 11:03:46,516 - ispa_next.appointments.models - DEBUG - Appointment Firma Montana Energiesysteme M-E 5878E WBA31GV070CU50168 ohne Termin.
2025-11-17 11:03:46,526 - ispa_next.appointments.models - DEBUG - Appointment Tina Waske von Reppert M-VR 21 WBA4M910509D07779 ohne Termin.
2025-11-17 11:03:46,529 - ispa_next.main - DEBUG - Found new Appointment: M-WX 8699
2025-11-17 11:03:46,530 - ispa_next.main - DEBUG - 



2025-11-17 11:03:46,530 - ispa_next.main - DEBUG - starting with process 8 (M-WX 8699) of 8
2025-11-17 11:03:46,534 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:03:48,248 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:03:50,051 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 770
2025-11-17 11:03:50,056 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 18
2025-11-17 11:03:51,944 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:03:51,945 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:04:30,609 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:04:41,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:43,154 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:04:43,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:43,241 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:04:43,533 - ispa_next.functions - DEBUG - HU date already expired after 246 days.
2025-11-17 11:04:51,960 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:04:51,962 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:04:51,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:52,050 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:05:03,535 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:05:03,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:05:05,093 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:05:07,097 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:05:07,223 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:05:10,540 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:05:10,670 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:05:10,670 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:05:22,792 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:05:23,795 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:05:23,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:05:24,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:05:38,563 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:05:38,563 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:05:48,042 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:05:48,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:05:48,177 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:05:48,178 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:05:48,253 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:05:49,530 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:05:49,770 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:05:52,661 - ispa_next.functions - DEBUG - Updated appointment (AJ00018590) customer contact data.
2025-11-17 11:05:53,583 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:05:53,599 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:05:54,877 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:05:54,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:05:56,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:06:00,072 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:06:00,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:06:00,553 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:06:02,557 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:06:02,673 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:06:02,801 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:06:02,945 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:06:02,945 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:06:14,956 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 11:06:22,734 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:06:22,734 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:06:26,971 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:06:27,976 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:06:27,978 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:06:27,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:06:28,100 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:06:32,252 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:06:32,256 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:06:32,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:06:32,364 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:06:32,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:33,278 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:33,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:06:34,115 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:06:34,117 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:06:35,447 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:06:35,453 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:06:36,973 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:06:36,974 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:06:36,976 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:06:36,981 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:06:36,984 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:06:36,987 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:06:36,993 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:06:36,995 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:06:36,995 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:06:36,999 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:06:37,000 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:06:37,004 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:06:37,006 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:06:37,007 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:06:37,009 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:38,280 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:06:38,281 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:06:38,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:39,522 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:06:39,522 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:06:39,524 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:40,846 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:06:40,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:06:42,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:06:42,329 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:50,928 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:06:50,928 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:52,192 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:07:05,206 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:07:05,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:07:06,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:07:06,627 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:07:19,744 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:07:19,746 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:07:19,746 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:07:20,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:07:20,500 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:07:20,500 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:07:22,324 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:07:31,839 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:07:32,216 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 11:07:33,265 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:07:34,230 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 770
2025-11-17 11:07:34,230 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:07:38,734 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 18
2025-11-17 11:07:38,735 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:07:39,980 - ispa_next.appointments.models - DEBUG - Appointment Werner Carstens M-RO 738 WBAJP31060BT93035 ohne Termin.
2025-11-17 11:07:39,990 - ispa_next.appointments.models - DEBUG - Appointment Tanja Elisabeth Kimmich M-TK 409 WBAVJ910909B37035 ohne Termin.
2025-11-17 11:07:40,002 - ispa_next.appointments.models - DEBUG - Appointment Firma Montana Energiesysteme M-E 5878E WBA31GV070CU50168 ohne Termin.
2025-11-17 11:07:40,013 - ispa_next.appointments.models - DEBUG - Appointment Tina Waske von Reppert M-VR 21 WBA4M910509D07779 ohne Termin.
