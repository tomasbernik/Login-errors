2025-11-12 09:08:26,494 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 09:08:26,537 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 09:08:41,746 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:08:58,080 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:09:16,286 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:09:50,813 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 09:10:08,504 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 09:10:12,201 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:10:13,654 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:10:13,655 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-12 09:10:16,767 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 09:10:16,768 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 09:10:16,768 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:10:18,250 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:10:19,732 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:11:23,050 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment AIR LIQUIDE Deutschland GmbH D-S-0-099/24-00420 WBA11BZ0309V09489, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='D-S-0-099/24-00420', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-12 09:11:23,074 - ispa_next.appointments.models - DEBUG - Appointment Kapellmann und Partner Rechtsanwaelte mbB D-AE 2222 WBAHF51080WW33367 ohne Termin.
2025-11-12 09:11:23,096 - ispa_next.appointments.models - DEBUG - Appointment Zhong Zhao NE-ZZ 668 WBAJT9100KBJ24904 ohne Termin.
2025-11-12 09:11:23,133 - ispa_next.appointments.models - DEBUG - Appointment Maersk Deutschland HH-M 3071E WBA81CY060FN31767 ohne Termin.
2025-11-12 09:11:23,151 - ispa_next.appointments.models - DEBUG - Appointment Weinmann Ulrich D-UW 19 WBAUZ35030NE17326 ohne Termin.
2025-11-12 09:11:23,166 - ispa_next.appointments.models - DEBUG - Appointment Shikoku Kakoki Europe GmbH D-SK 1601 WBA21FZ000FU12151 ohne Termin.
2025-11-12 09:11:23,198 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Esser D-FL 495 WBAUZ35030N020597 ohne Termin.
2025-11-12 09:11:23,211 - ispa_next.appointments.models - DEBUG - Appointment Armin Händeler D-AA 93 WBAHF11000WW66520 ohne Termin.
2025-11-12 09:11:23,223 - ispa_next.appointments.models - DEBUG - Appointment Tolga Erol NE-TE 1490 WBA5R11070AE79396 ohne Termin.
2025-11-12 09:11:23,355 - ispa_next.main - DEBUG - Found 15 out of 86 appointments to process (configured limit: 15).
2025-11-12 09:11:23,356 - ispa_next.main - DEBUG - Processing 10 fresh appointments.
2025-11-12 09:11:23,357 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 09:11:23,357 - ispa_next.main - DEBUG - All appointments: NE-CC 106, D-A 1427, NE-KO 73, D-QQ200, NE-TP72, NE FK333E, F-HT 2012, NEAH187, NE HP 110E, D-MK-7692E, DKJ1628, D-PE 8787, D-KS-266, BM -K 7709, KR-AD 1408
2025-11-12 09:11:23,359 - ispa_next.main - DEBUG - 



2025-11-12 09:11:23,359 - ispa_next.main - DEBUG - starting with process 1 (NE-CC 106) of 15
2025-11-12 09:11:23,364 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:11:24,852 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:11:26,399 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:11:26,400 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 09:11:28,396 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:11:28,398 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:12:06,841 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:12:18,633 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:12:21,380 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:12:21,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:21,481 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:12:21,788 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:12:21,793 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:12:24,739 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:12:24,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:12:26,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:12:28,014 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:12:28,249 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:12:28,352 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:12:28,475 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:12:32,707 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:12:33,716 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:12:33,717 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:34,279 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:49,158 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:12:57,861 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:12:57,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:58,031 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:12:58,032 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:12:58,119 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:12:59,467 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:13:01,332 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:13:01,775 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:13:04,457 - ispa_next.functions - DEBUG - Updated appointment (AB00031664) customer contact data.
2025-11-12 09:13:05,421 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:13:05,424 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:13:06,618 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:13:06,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:13:07,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:13:12,126 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:13:12,127 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:13:12,132 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:13:12,138 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:13:12,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:13:12,671 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:13:21,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:13:22,303 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:13:22,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:13:23,110 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:13:23,113 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:13:25,739 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:13:25,742 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:13:27,131 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:13:27,132 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:13:27,136 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:13:27,137 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 09:13:27,138 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:13:27,140 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:13:27,141 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:13:27,142 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:13:27,145 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:13:27,146 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:13:27,149 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:13:27,151 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 09:13:28,015 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 09:13:28,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 09:13:38,166 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 09:13:38,169 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:13:38,171 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:13:38,172 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:13:41,456 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:13:41,460 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:13:41,463 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:13:45,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:13:45,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:13:55,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:14:09,720 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:14:09,724 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:14:09,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:14:10,620 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:14:10,874 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:14:20,105 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:14:20,108 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:14:23,566 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:14:37,467 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:14:38,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:14:38,594 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:14:38,769 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:15:11,212 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:15:17,805 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:15:23,139 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:15:28,883 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:15:36,213 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:15:36,214 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:15:37,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:15:37,131 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:15:37,135 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:15:42,318 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:15:54,751 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:15:55,122 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 09:15:57,144 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:15:57,854 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:15:57,856 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:16:01,645 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-12 09:16:01,646 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:16:02,916 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:16:02,944 - ispa_next.main - DEBUG - 



2025-11-12 09:16:02,944 - ispa_next.main - DEBUG - starting with process 2 (D-A 1427) of 15
2025-11-12 09:16:02,950 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:16:04,392 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:16:06,066 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:16:06,067 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-12 09:16:08,341 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:16:08,343 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:16:48,315 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:16:59,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:16:59,993 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:17:00,186 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:17:03,545 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:17:03,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:03,707 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:17:04,041 - ispa_next.functions - DEBUG - HU date already expired after 68 days.
2025-11-12 09:17:12,827 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:17:12,832 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:17:15,786 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:17:15,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:17:17,163 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:17:19,168 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:17:19,320 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:17:22,618 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:17:22,739 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:17:22,741 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:17:26,284 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:17:35,042 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:17:36,046 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:17:36,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:37,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:52,108 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:17:52,108 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:18:00,921 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:18:00,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:18:01,063 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:18:01,064 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:18:01,144 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:18:01,293 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:18:03,268 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:18:03,648 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:18:07,242 - ispa_next.functions - DEBUG - Updated appointment (AB00031663) customer contact data.
2025-11-12 09:18:08,226 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:18:08,230 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:18:08,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:18:09,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:18:11,067 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:18:11,068 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:18:11,484 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:18:15,133 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:18:15,134 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:18:15,654 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:18:17,656 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:18:17,837 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:18:17,999 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:18:18,080 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:18:18,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:18:22,345 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:18:31,176 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:19:31,179 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:19:43,102 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 09:19:48,602 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:19:48,604 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:19:55,162 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Abgasuntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 09:19:58,591 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 09:20:00,598 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:20:03,200 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:20:04,207 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:20:04,211 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:20:04,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:20:04,355 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:20:04,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:20:05,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:20:05,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:20:06,233 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:20:06,234 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:20:10,131 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:20:10,138 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:20:11,983 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:20:11,985 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:20:11,989 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:20:11,992 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 09:20:11,995 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:20:12,000 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:20:12,002 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:20:12,003 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:20:12,006 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:20:12,007 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:20:12,010 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:20:12,012 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 09:20:12,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 09:20:13,818 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 09:20:23,497 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 09:20:23,520 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:20:23,524 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:20:23,525 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:28,208 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 09:20:31,420 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:20:31,424 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:20:31,432 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:36,299 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:20:36,303 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:20:36,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:20:37,018 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:20:37,300 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:48,505 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:20:48,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:53,277 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:21:07,182 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:21:07,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:21:08,335 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:21:08,562 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:21:54,786 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:22:00,399 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:22:05,234 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:22:11,420 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:22:16,363 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:22:22,556 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:22:22,559 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:22:22,560 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:22:23,394 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:22:23,506 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:22:23,510 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:22:26,073 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:22:39,413 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:22:39,829 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 09:22:41,192 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:22:42,033 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:22:42,034 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:45,718 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-12 09:22:45,719 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:46,723 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:22:46,737 - ispa_next.main - DEBUG - 



2025-11-12 09:22:46,737 - ispa_next.main - DEBUG - starting with process 3 (NE-KO 73) of 15
2025-11-12 09:22:46,743 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:22:48,238 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:22:49,868 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:22:49,869 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-12 09:22:51,710 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:51,712 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:23:30,033 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:23:41,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:41,706 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:23:41,999 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:43,270 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:23:43,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:43,443 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:23:43,848 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:23:43,851 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:23:46,748 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:23:46,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:48,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:50,221 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:23:50,379 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:23:53,668 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:23:53,803 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:23:53,804 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:55,155 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:24:03,996 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:24:05,001 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:24:05,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:24:05,519 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:24:22,338 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:24:32,041 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:24:32,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:24:32,215 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:24:32,217 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:24:32,309 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:24:33,794 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:24:34,188 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:24:38,315 - ispa_next.functions - DEBUG - Updated appointment (AB00031661) customer contact data.
2025-11-12 09:24:39,301 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:24:39,305 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:24:40,258 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:24:40,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:24:41,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:24:44,726 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:24:44,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:24:45,256 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:24:47,259 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:24:47,436 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:24:47,600 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:24:47,692 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:24:47,694 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:49,099 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:24:57,769 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:25:57,773 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:26:06,364 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:26:30,367 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:26:39,294 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 09:26:48,505 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 09:26:49,524 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:26:49,530 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:26:49,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:26:49,660 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:26:55,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:55,855 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:55,856 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:26:56,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:26:56,868 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:26:58,473 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:26:58,475 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:26:59,849 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:26:59,851 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:26:59,854 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:26:59,855 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 09:26:59,856 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:26:59,858 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:26:59,859 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:26:59,861 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:26:59,863 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:26:59,864 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:26:59,867 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:26:59,868 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 09:27:00,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 09:27:01,469 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 09:27:11,092 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 09:27:11,110 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:27:11,114 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:27:11,115 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:13,126 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:27:13,129 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:27:13,132 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:15,182 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:27:15,185 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:27:15,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:27:15,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:27:15,829 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:27:15,832 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:17,807 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:27:32,993 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:27:33,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:27:34,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:27:34,435 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:54,100 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:27:59,832 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:27:59,834 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:27:59,835 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:28:00,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:28:00,764 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:28:00,768 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:28:03,242 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:28:13,598 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:28:13,996 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 09:28:15,422 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:28:16,158 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:28:16,159 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:28:19,871 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-12 09:28:19,872 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:28:21,015 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:28:21,024 - ispa_next.main - DEBUG - 



2025-11-12 09:28:21,024 - ispa_next.main - DEBUG - starting with process 4 (D-QQ200) of 15
2025-11-12 09:28:21,028 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:28:22,599 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:28:24,320 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:28:24,321 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-12 09:28:26,267 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:28:26,269 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:29:00,539 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:29:00,659 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 09:29:00,666 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:29:01,411 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:29:01,412 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:29:04,993 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-12 09:29:04,994 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:29:06,026 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:29:06,038 - ispa_next.main - DEBUG - 



2025-11-12 09:29:06,038 - ispa_next.main - DEBUG - starting with process 5 (NE-TP72) of 15
2025-11-12 09:29:06,042 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:29:07,586 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:29:09,255 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:29:09,256 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-12 09:29:11,079 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:29:11,081 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:29:48,822 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:29:48,832 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 09:29:48,837 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:29:49,465 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:29:49,466 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:29:53,145 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-12 09:29:53,146 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:29:54,258 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:29:54,267 - ispa_next.main - DEBUG - 



2025-11-12 09:29:54,267 - ispa_next.main - DEBUG - starting with process 6 (NE FK333E) of 15
2025-11-12 09:29:54,271 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:29:55,785 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:29:57,554 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:29:57,555 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-12 09:29:59,340 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:29:59,341 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:30:37,425 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:30:37,436 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 09:30:37,441 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:30:38,238 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:30:38,240 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:30:41,891 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-12 09:30:41,891 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:30:43,047 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:30:43,056 - ispa_next.main - DEBUG - 



2025-11-12 09:30:43,056 - ispa_next.main - DEBUG - starting with process 7 (F-HT 2012) of 15
2025-11-12 09:30:43,060 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:30:44,574 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:30:46,368 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:30:46,370 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-12 09:30:48,075 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:30:48,076 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:31:23,701 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:31:23,717 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 09:31:23,724 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:24,344 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:31:24,345 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:28,293 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-12 09:31:28,294 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:31:29,322 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:31:29,343 - ispa_next.main - DEBUG - 



2025-11-12 09:31:29,343 - ispa_next.main - DEBUG - starting with process 8 (NEAH187) of 15
2025-11-12 09:31:29,382 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:31:30,870 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:32,612 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:31:32,613 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-12 09:31:34,345 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:34,347 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:32:14,116 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:32:14,129 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 09:32:14,133 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:32:14,781 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:32:14,782 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:32:18,337 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-12 09:32:18,338 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:32:19,496 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:32:19,513 - ispa_next.main - DEBUG - 



2025-11-12 09:32:19,513 - ispa_next.main - DEBUG - starting with process 9 (NE HP 110E) of 15
2025-11-12 09:32:19,526 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:32:21,045 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:32:23,149 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:32:23,150 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-12 09:32:25,005 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:32:25,006 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:03,458 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:33:03,469 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 09:33:03,474 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:33:04,030 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:33:04,031 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:33:07,593 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-12 09:33:07,594 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:08,674 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:33:08,684 - ispa_next.main - DEBUG - 



2025-11-12 09:33:08,684 - ispa_next.main - DEBUG - starting with process 10 (D-MK-7692E) of 15
2025-11-12 09:33:08,688 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:33:10,244 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:33:12,163 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:33:12,165 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-12 09:33:13,894 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:33:13,895 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:54,377 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:33:54,388 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 09:33:54,392 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:33:54,989 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:33:54,990 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:33:58,661 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-12 09:33:58,662 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:59,771 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:33:59,779 - ispa_next.main - DEBUG - 



2025-11-12 09:33:59,780 - ispa_next.main - DEBUG - starting with process 11 (DKJ1628) of 15
2025-11-12 09:33:59,783 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:34:01,354 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:34:03,037 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:34:03,039 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-12 09:34:05,016 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:34:05,018 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:34:42,458 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:34:42,469 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 09:34:42,473 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:34:43,129 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:34:43,130 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:34:47,008 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-12 09:34:47,009 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:34:48,148 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:34:48,161 - ispa_next.main - DEBUG - 



2025-11-12 09:34:48,161 - ispa_next.main - DEBUG - starting with process 12 (D-PE 8787) of 15
2025-11-12 09:34:48,166 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:34:49,734 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:34:51,786 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 850
2025-11-12 09:34:51,789 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-12 09:34:53,731 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:34:53,733 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:35:25,318 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:35:28,184 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:35:34,192 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:36,825 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:35:36,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:37,051 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:35:37,363 - ispa_next.functions - DEBUG - HU date already expired after 111 days.
2025-11-12 09:35:43,149 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:35:43,154 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:35:46,030 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:35:46,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:35:47,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:35:49,236 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:35:49,400 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:35:49,503 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:35:49,607 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:35:53,855 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:35:54,861 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:35:54,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:55,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:13,245 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:36:18,796 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:36:18,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:18,995 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:36:18,996 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:36:19,094 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:36:19,312 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:36:21,212 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:36:21,563 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:36:23,877 - ispa_next.functions - DEBUG - Updated appointment (AB00031135) customer contact data.
2025-11-12 09:36:24,845 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:36:24,848 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:36:25,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:36:26,037 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:36:27,252 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:36:27,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:36:27,409 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:36:31,500 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:36:31,500 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:36:31,505 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:36:31,511 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:36:31,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:36:32,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:36:32,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:33,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:33,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:36:34,129 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:36:34,132 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:36:36,744 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:36:36,746 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:36:38,227 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:36:38,229 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:36:38,231 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:36:38,232 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:36:38,233 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:36:38,236 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:36:38,237 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:36:38,238 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:36:38,241 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:36:38,242 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:36:38,245 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:36:38,250 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:36:38,253 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:36:38,254 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:41,082 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:36:41,086 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:36:41,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:43,864 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:36:43,867 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:36:43,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:36:44,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:36:45,119 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:55,503 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:36:55,507 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:58,302 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:37:12,423 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:37:12,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:37:13,460 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:37:13,656 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:37:39,562 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:37:44,965 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:37:50,898 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:37:50,903 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:37:50,904 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:37:51,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:37:51,832 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:37:51,835 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:37:54,201 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:38:04,894 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:38:05,331 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 09:38:06,580 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:38:07,524 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 852
2025-11-12 09:38:07,526 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:38:11,570 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 431
2025-11-12 09:38:11,571 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:38:12,637 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 09:38:12,660 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:38:12,672 - ispa_next.main - DEBUG - Found new Appointment: 8D14274
2025-11-12 09:38:12,678 - ispa_next.main - DEBUG - 



2025-11-12 09:38:12,678 - ispa_next.main - DEBUG - starting with process 13 (8D14274) of 16
2025-11-12 09:38:12,688 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:38:14,182 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:38:15,896 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 852
2025-11-12 09:38:15,898 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 431
2025-11-12 09:38:18,035 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:38:18,037 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:39:00,958 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:39:13,154 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:39:17,863 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:39:17,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:18,003 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:39:18,250 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:39:18,253 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:39:21,165 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:39:21,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:39:22,559 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:39:24,562 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:39:24,753 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:39:28,034 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:39:28,180 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:39:32,448 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:39:33,453 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:39:33,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:34,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:51,804 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:40:01,456 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:40:01,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:01,610 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:40:01,611 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:40:01,746 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:40:03,317 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:40:03,733 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:40:06,759 - ispa_next.functions - DEBUG - Updated appointment (AB00031665) customer contact data.
2025-11-12 09:40:07,709 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:40:07,715 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:40:08,794 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:40:08,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:40:09,937 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:40:13,537 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:40:13,537 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:40:13,541 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:40:13,545 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:40:13,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:14,053 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:40:23,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:24,267 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:24,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:25,073 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:40:25,075 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:40:29,473 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:40:29,476 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:40:30,655 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:40:30,656 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:40:30,659 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:40:30,660 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 09:40:30,662 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:40:30,664 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:40:30,665 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:40:30,666 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:40:30,669 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:40:30,670 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:40:30,672 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:40:30,674 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 09:40:31,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 09:40:32,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 09:40:42,348 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 09:40:42,351 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:40:42,353 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:40:42,354 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:47,833 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:40:47,836 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:40:47,840 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:53,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:53,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:41:03,376 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:20,142 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:41:20,144 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:41:20,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:41:21,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:41:21,482 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:34,385 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:41:34,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:39,942 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:41:54,725 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:41:55,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:41:55,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:41:56,176 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:42:49,311 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:42:56,735 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:03,026 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:09,065 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:15,141 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:20,464 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:28,894 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:36,391 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:43:36,392 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:43:37,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:43:37,389 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:43:37,392 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:43:43,019 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:43:54,433 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:43:54,807 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 09:43:56,987 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:43:57,989 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 852
2025-11-12 09:43:57,990 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:44:02,005 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 430
2025-11-12 09:44:02,006 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:44:03,140 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 09:44:03,161 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:44:03,173 - ispa_next.main - DEBUG - 



2025-11-12 09:44:03,173 - ispa_next.main - DEBUG - starting with process 14 (D-KS-266) of 16
2025-11-12 09:44:03,178 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:44:04,751 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:44:06,418 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 852
2025-11-12 09:44:06,420 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 430
2025-11-12 09:44:08,374 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:44:08,375 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:44:45,891 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:44:45,907 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 09:44:45,917 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:44:46,638 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 852
2025-11-12 09:44:46,640 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:44:50,723 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 430
2025-11-12 09:44:50,724 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:44:51,787 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 09:44:51,807 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:44:51,816 - ispa_next.main - DEBUG - 



2025-11-12 09:44:51,816 - ispa_next.main - DEBUG - starting with process 15 (BM -K 7709) of 16
2025-11-12 09:44:51,820 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:44:53,456 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:44:55,254 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 852
2025-11-12 09:44:55,256 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 430
2025-11-12 09:44:57,203 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:44:57,204 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:45:37,045 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:45:37,055 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 09:45:37,061 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:45:37,661 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 852
2025-11-12 09:45:37,662 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:45:41,160 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 430
2025-11-12 09:45:41,161 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:45:42,696 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 09:45:42,738 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
2025-11-12 09:45:42,750 - ispa_next.main - DEBUG - 



2025-11-12 09:45:42,750 - ispa_next.main - DEBUG - starting with process 16 (KR-AD 1408) of 16
2025-11-12 09:45:42,755 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:45:44,321 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:45:46,124 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 852
2025-11-12 09:45:46,125 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 430
2025-11-12 09:45:48,030 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:45:48,031 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:46:19,444 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:46:22,282 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:46:28,220 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:46:30,238 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:46:30,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:30,354 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:46:30,590 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 09:46:36,212 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:46:36,217 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:46:39,087 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:46:39,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:46:40,456 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:46:42,459 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:46:42,626 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:46:42,747 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:46:42,826 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:46:47,078 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:46:48,091 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:46:48,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:48,706 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:02,309 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:47:07,718 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:47:07,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:07,897 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:47:07,898 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:47:08,005 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:47:09,463 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:47:09,827 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:47:12,392 - ispa_next.functions - DEBUG - Updated appointment (AB00031302) customer contact data.
2025-11-12 09:47:13,417 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:47:13,419 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:47:14,347 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:47:14,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:47:15,416 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:47:19,036 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:47:19,036 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:47:19,040 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:47:19,044 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:47:19,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:47:19,618 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:47:25,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:25,754 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:25,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:47:26,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:47:26,544 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:47:28,585 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:47:28,587 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:47:30,119 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:47:30,120 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:47:30,123 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:47:30,124 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:47:30,126 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:47:30,129 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:47:30,130 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:47:30,131 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:47:30,134 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:47:30,135 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:47:30,137 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:47:30,142 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:47:30,145 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:47:30,146 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:32,214 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:47:32,216 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:47:32,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:34,386 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:47:34,390 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:47:34,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:47:35,343 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:47:35,513 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:47,878 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:47:47,880 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:50,023 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:48:04,118 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:48:04,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:48:05,214 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:48:05,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:48:25,479 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:48:31,329 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:48:31,332 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:48:31,333 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:48:32,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:48:32,274 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:48:32,278 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:48:34,635 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:48:45,372 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:48:45,767 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 09:48:47,188 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:48:48,163 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 852
2025-11-12 09:48:48,164 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:48:52,175 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 430
2025-11-12 09:48:52,176 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:48:53,194 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 09:48:53,216 - ispa_next.appointments.models - DEBUG - Appointment Rebekka Willings-Eitelwein D-E 796 WBAJP31060BT92094 ohne Termin.
