2025-11-12 13:01:25,204 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 13:01:25,211 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 13:01:35,289 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:01:48,461 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:02:04,784 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:04:09,012 - ispa_next.app_start.main - DEBUG - Operation already took 112.60 seconds (more than 80 seconds)
2025-11-12 13:04:11,109 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4f6ed0e2f152e998\\tess_6v4dl5q1_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4f6ed0e2f152e998\\tess_6v4dl5q1', 'txt']
2025-11-12 13:04:11,450 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:04:11,455 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:04:11,456 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:06:17,140 - ispa_next.app_start.main - DEBUG - Operation already took 113.03 seconds (more than 80 seconds)
2025-11-12 13:06:19,226 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4f6ed0e2f152e998\\tess_9f5ag7yu_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4f6ed0e2f152e998\\tess_9f5ag7yu', 'txt']
2025-11-12 13:06:19,549 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:06:19,555 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:06:23,670 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 13:06:36,387 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:06:47,506 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:07:03,771 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:09:07,736 - ispa_next.app_start.main - DEBUG - Operation already took 112.77 seconds (more than 80 seconds)
2025-11-12 13:09:09,832 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4f6ed0e2f152e998\\tess_wchdvr8x_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4f6ed0e2f152e998\\tess_wchdvr8x', 'txt']
2025-11-12 13:09:10,253 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:09:10,258 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:09:10,258 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:11:15,590 - ispa_next.app_start.main - DEBUG - Operation already took 112.80 seconds (more than 80 seconds)
2025-11-12 13:11:17,697 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4f6ed0e2f152e998\\tess_bxsy6u5y_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4f6ed0e2f152e998\\tess_bxsy6u5y', 'txt']
2025-11-12 13:11:18,142 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:11:18,150 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:11:22,250 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 13:11:32,267 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:11:43,835 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:12:00,020 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:12:24,270 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 13:12:43,424 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 13:12:48,170 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:12:50,015 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1023
2025-11-12 13:12:50,016 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 96
2025-11-12 13:12:53,494 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 74
2025-11-12 13:12:53,495 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 13:12:53,495 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:12:55,164 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:12:56,773 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:13:12,604 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:13:12,606 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:13:12,623 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:13:12,630 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:13:12,655 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:13:12,656 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:13:12,694 - ispa_next.main - DEBUG - Found 11 out of 68 appointments to process (configured limit: 15).
2025-11-12 13:13:12,695 - ispa_next.main - DEBUG - Processing 11 fresh appointments.
2025-11-12 13:13:12,696 - ispa_next.main - DEBUG - Processing 0 already visited appointments (w/ RKR not callable).
2025-11-12 13:13:12,696 - ispa_next.main - DEBUG - All appointments: HG-DH 347, F-LY 36E, HG-VS 666E, TF-RR 232E, HG LY 772, HG-UG 2207, F-S 1330, BLB-TK 76, FB-D 1387, HN IW996, F GF 195
2025-11-12 13:13:12,699 - ispa_next.main - DEBUG - 



2025-11-12 13:13:12,699 - ispa_next.main - DEBUG - starting with process 1 (HG-DH 347) of 11
2025-11-12 13:13:12,703 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:13:14,445 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:13:16,081 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1023
2025-11-12 13:13:16,083 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 74
2025-11-12 13:13:18,695 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:13:18,697 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:13:59,145 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:14:12,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:14:12,245 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:14:12,471 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:15,325 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:14:15,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:14:15,572 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:14:16,036 - ispa_next.functions - DEBUG - HU date already expired after 651 days.
2025-11-12 13:14:26,151 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:14:26,156 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:14:29,099 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:14:29,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:14:30,665 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:14:32,668 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:14:32,819 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:14:32,984 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:14:33,075 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:14:33,079 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:36,152 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:14:45,981 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:14:46,987 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:14:46,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:14:47,560 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:15:01,959 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:15:13,358 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:15:13,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:15:13,556 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:15:13,557 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:15:13,689 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:15:15,260 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:15:15,768 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:15:20,460 - ispa_next.functions - DEBUG - Updated appointment (AB00036718) customer contact data.
2025-11-12 13:15:21,411 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:15:21,414 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:15:22,637 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:15:22,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:15:23,562 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:15:27,205 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:15:27,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:15:28,407 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:15:30,417 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:15:30,628 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:15:30,805 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:15:30,896 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:15:30,897 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:15:34,018 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:15:43,419 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:16:43,421 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:16:52,630 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:16:59,634 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:17:08,865 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:17:20,158 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 13:17:21,166 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:17:21,167 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:17:21,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:17:21,262 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:17:25,455 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:17:25,460 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:17:25,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:17:25,696 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:17:29,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:17:30,195 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:17:30,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:17:30,994 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:17:30,995 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:17:33,657 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:17:33,660 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:17:34,990 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:17:34,992 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:17:34,994 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:17:34,995 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:17:34,997 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:17:34,998 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:17:35,000 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:17:35,002 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:17:35,003 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:17:35,005 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:17:35,010 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:17:35,012 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:17:35,013 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:17:37,930 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 13:17:41,853 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:17:41,857 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:17:41,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:17:44,844 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:17:44,848 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:17:44,851 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:17:44,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:17:47,666 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:18:07,546 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:18:08,394 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:18:09,184 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:18:09,495 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:18:18,392 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:18:27,232 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:18:27,233 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:18:28,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:18:28,450 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:18:28,452 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:18:38,654 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:18:53,447 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:18:53,867 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 13:18:54,765 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:18:56,623 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1024
2025-11-12 13:18:56,624 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:19:00,814 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 97
2025-11-12 13:19:00,815 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:19:02,241 - ispa_next.appointments.models - DEBUG - Appointment Pascal Franke HG-PF 540 WBA71BM000CG74343 ohne Termin.
2025-11-12 13:19:02,256 - ispa_next.appointments.models - DEBUG - Appointment Helmut Wolfgang Lindstaedt Dr. HG-CZ 232 WBA5R11020AE78379 ohne Termin.
2025-11-12 13:19:02,268 - ispa_next.main - DEBUG - 



2025-11-12 13:19:02,268 - ispa_next.main - DEBUG - starting with process 2 (F-LY 36E) of 11
2025-11-12 13:19:02,274 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:19:04,107 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:19:06,063 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1024
2025-11-12 13:19:06,064 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 97
2025-11-12 13:19:08,570 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:19:08,572 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:19:41,365 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:19:53,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:53,883 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:19:54,267 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:19:55,648 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:19:55,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:55,791 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:19:56,113 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:19:56,119 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:19:59,232 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:19:59,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:20:00,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:20:03,039 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:20:03,207 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:20:06,500 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:20:06,733 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:20:06,735 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:20:08,190 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:20:17,384 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:20:18,388 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:20:18,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:18,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:32,987 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:20:43,675 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:20:43,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:43,916 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:20:43,917 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:20:44,008 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:20:45,766 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:20:47,419 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:20:47,876 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:20:51,429 - ispa_next.functions - DEBUG - Updated appointment (AB00036717) customer contact data.
2025-11-12 13:20:52,370 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:20:52,375 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:20:53,796 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:20:53,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:20:54,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:20:58,582 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:20:58,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:20:59,140 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:21:01,143 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:21:01,315 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:21:01,476 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:21:01,627 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:21:01,629 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:21:03,030 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:21:12,174 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:22:12,177 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:22:24,263 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:22:29,577 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:22:29,578 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:22:31,758 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:22:36,045 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:22:37,053 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:22:37,054 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:22:37,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:22:37,253 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:22:41,439 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:22:41,444 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:22:41,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:22:41,638 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:22:47,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:22:48,058 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:22:48,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:22:49,226 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:22:49,227 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:22:51,449 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:22:51,452 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:22:52,622 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:22:52,625 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:22:52,627 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:22:52,630 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:22:52,635 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 13:22:52,638 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:22:52,641 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:22:52,642 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:22:52,644 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:22:52,646 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 13:22:54,980 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:22:55,539 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:22:56,505 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 13:22:57,112 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:22:57,653 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:22:59,175 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 13:23:00,625 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:23:01,621 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 13:23:02,186 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:23:02,208 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:23:02,210 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:23:03,988 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:23:03,994 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:23:03,996 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:23:05,502 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:23:05,505 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:23:05,515 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:23:05,519 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:23:06,974 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:23:25,626 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:23:26,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:23:27,350 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:23:27,681 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:23:35,726 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:23:44,627 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:23:44,628 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:23:45,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:23:45,697 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:23:45,700 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:23:56,144 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:24:10,144 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:24:10,572 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 13:24:11,531 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:24:13,412 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1025
2025-11-12 13:24:13,414 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:24:17,720 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 97
2025-11-12 13:24:17,721 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:24:18,860 - ispa_next.appointments.models - DEBUG - Appointment Pascal Franke HG-PF 540 WBA71BM000CG74343 ohne Termin.
2025-11-12 13:24:18,873 - ispa_next.appointments.models - DEBUG - Appointment Helmut Wolfgang Lindstaedt Dr. HG-CZ 232 WBA5R11020AE78379 ohne Termin.
2025-11-12 13:24:18,879 - ispa_next.main - DEBUG - 



2025-11-12 13:24:18,879 - ispa_next.main - DEBUG - starting with process 3 (HG-VS 666E) of 11
2025-11-12 13:24:18,883 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:24:20,831 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:24:22,612 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1025
2025-11-12 13:24:22,613 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 97
2025-11-12 13:24:25,015 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:24:25,017 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:25:02,469 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:25:15,673 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:25:19,978 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:25:19,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:20,072 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:25:20,370 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:25:30,968 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:25:30,973 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:25:33,992 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:25:33,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:25:35,587 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:25:37,590 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:25:37,745 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:25:37,909 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:25:38,082 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:25:40,379 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:25:41,387 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:25:41,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:41,917 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:47,229 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 13:25:47,235 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:25:47,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:47,314 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:25:47,316 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:25:47,492 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:25:49,073 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:25:49,734 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:25:52,519 - ispa_next.functions - DEBUG - Updated appointment (AB00036706) customer contact data.
2025-11-12 13:25:53,724 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:25:53,726 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:25:55,119 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:25:55,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:25:56,207 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:25:59,829 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:25:59,829 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:25:59,837 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:25:59,838 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:25:59,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:00,456 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:26:04,627 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 13:26:10,878 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:26:10,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:11,055 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:26:16,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:17,499 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:17,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:18,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:26:18,636 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:26:22,789 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:26:22,791 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:26:24,304 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:26:24,305 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:26:24,307 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:26:24,309 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:26:24,311 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:26:24,313 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:26:24,314 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:26:24,316 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:26:24,318 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:26:24,324 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:26:24,330 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:26:24,333 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:26:24,334 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:29,289 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:26:29,293 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:26:29,296 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:34,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:34,322 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:26:45,735 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:02,185 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:27:02,187 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:27:02,189 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:27:02,191 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:06,475 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-12 13:27:18,268 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:27:39,189 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:27:40,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:27:41,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:27:41,399 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:52,244 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:28:01,202 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:28:01,203 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:28:02,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:28:02,416 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:28:02,418 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:28:12,947 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:28:26,837 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:28:27,260 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 13:28:29,175 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:28:30,723 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1025
2025-11-12 13:28:30,724 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:28:35,203 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 97
2025-11-12 13:28:35,204 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:28:36,577 - ispa_next.appointments.models - DEBUG - Appointment Pascal Franke HG-PF 540 WBA71BM000CG74343 ohne Termin.
2025-11-12 13:28:36,589 - ispa_next.appointments.models - DEBUG - Appointment Helmut Wolfgang Lindstaedt Dr. HG-CZ 232 WBA5R11020AE78379 ohne Termin.
2025-11-12 13:28:36,595 - ispa_next.main - DEBUG - 



2025-11-12 13:28:36,595 - ispa_next.main - DEBUG - starting with process 4 (TF-RR 232E) of 11
2025-11-12 13:28:36,602 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:28:38,524 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:28:40,468 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1025
2025-11-12 13:28:40,470 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 97
2025-11-12 13:28:42,895 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:28:42,897 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:29:17,855 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:29:31,565 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:32,859 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:29:32,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:33,003 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:29:33,306 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:29:43,436 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:29:43,441 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:29:46,318 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:29:46,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:29:48,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:29:50,156 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:29:50,374 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:29:50,481 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:29:50,638 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:29:54,915 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:29:55,923 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:29:55,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:56,468 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:10,179 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:30:10,205 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:30:20,894 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:30:20,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:21,011 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:30:21,012 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:30:21,069 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:30:22,800 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:30:23,300 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:30:26,001 - ispa_next.functions - DEBUG - Updated appointment (AB00036712) customer contact data.
2025-11-12 13:30:27,017 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:30:27,030 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:30:28,546 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:30:28,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:30:29,772 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:30:34,583 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:30:34,584 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:30:34,642 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:30:34,643 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:30:34,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:35,264 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:30:39,775 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:30:39,781 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:30:39,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:39,885 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:30:48,828 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 13:30:55,858 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 13:30:55,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:56,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:56,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:57,971 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:30:57,973 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:30:59,586 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:30:59,594 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:31:01,566 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:31:01,570 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:31:01,578 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-12 13:31:01,582 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:31:01,584 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:31:01,585 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:31:01,587 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:31:01,589 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:31:01,590 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:31:01,594 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:31:01,596 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:31:50,354 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:31:50,356 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-12 13:32:02,036 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:32:02,047 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:32:02,053 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:05,418 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:32:05,421 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:32:05,425 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:08,394 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:32:08,406 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:32:08,411 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:32:08,415 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:11,355 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:32:30,307 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:32:31,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:32:31,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:32:32,163 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:41,947 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:32:51,913 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:32:51,914 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:32:52,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:32:53,072 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:32:53,075 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:33:03,188 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:33:16,826 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:33:17,319 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 13:33:18,264 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:21,418 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1026
2025-11-12 13:33:21,420 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:25,994 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-12 13:33:25,995 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:33:27,330 - ispa_next.appointments.models - DEBUG - Appointment Jutta Junker HG-JU 143 WMWXU910502N22372 ohne Termin.
2025-11-12 13:33:27,386 - ispa_next.appointments.models - DEBUG - Appointment Pascal Franke HG-PF 540 WBA71BM000CG74343 ohne Termin.
2025-11-12 13:33:27,396 - ispa_next.appointments.models - DEBUG - Appointment Helmut Wolfgang Lindstaedt Dr. HG-CZ 232 WBA5R11020AE78379 ohne Termin.
2025-11-12 13:33:27,401 - ispa_next.main - DEBUG - 



2025-11-12 13:33:27,402 - ispa_next.main - DEBUG - starting with process 5 (HG LY 772) of 11
2025-11-12 13:33:27,405 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:33:29,205 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:31,093 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1026
2025-11-12 13:33:31,094 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-12 13:33:33,812 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:33,813 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:34:18,238 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:34:18,354 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 13:34:18,361 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:34:19,302 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1026
2025-11-12 13:34:19,303 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:34:24,016 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-12 13:34:24,018 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:34:25,275 - ispa_next.appointments.models - DEBUG - Appointment Jutta Junker HG-JU 143 WMWXU910502N22372 ohne Termin.
2025-11-12 13:34:25,292 - ispa_next.appointments.models - DEBUG - Appointment Pascal Franke HG-PF 540 WBA71BM000CG74343 ohne Termin.
2025-11-12 13:34:25,307 - ispa_next.appointments.models - DEBUG - Appointment Helmut Wolfgang Lindstaedt Dr. HG-CZ 232 WBA5R11020AE78379 ohne Termin.
2025-11-12 13:34:25,315 - ispa_next.main - DEBUG - 



2025-11-12 13:34:25,315 - ispa_next.main - DEBUG - starting with process 6 (HG-UG 2207) of 11
2025-11-12 13:34:25,321 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:34:27,252 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:34:29,377 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1026
2025-11-12 13:34:29,379 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-12 13:34:32,062 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:34:32,064 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:35:14,288 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:35:28,571 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:33,551 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:35:33,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:33,706 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:35:34,068 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:35:44,891 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:35:44,895 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:35:47,828 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:35:47,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:35:49,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:35:51,814 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:35:51,976 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:35:52,196 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:35:52,290 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:35:56,593 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:35:57,599 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:35:57,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:58,150 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:03,396 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 13:36:03,403 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:36:03,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:03,503 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:36:03,504 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:36:03,630 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:36:05,454 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:36:05,957 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:36:09,814 - ispa_next.functions - DEBUG - Updated appointment (AH00014312) customer contact data.
2025-11-12 13:36:10,994 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:36:10,998 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:36:12,373 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:36:12,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:36:13,698 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:36:17,735 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:36:17,735 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:36:17,741 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:36:17,742 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:36:17,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:36:18,383 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:36:22,557 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 13:36:23,739 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 13:36:46,567 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:36:46,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:36:46,770 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:36:52,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:53,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:53,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:36:55,172 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:36:55,173 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:37:00,058 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:37:00,067 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:37:04,024 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:37:04,027 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:37:04,035 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:37:04,038 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:37:04,042 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:37:04,051 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:37:04,053 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:37:04,055 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:37:04,056 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:37:04,058 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:37:04,069 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:37:04,073 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:37:04,077 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:09,649 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 13:37:15,716 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:37:15,907 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:37:16,129 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:21,343 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:37:21,350 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:37:21,354 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:37:21,377 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:26,813 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:38:05,249 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:38:06,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:38:08,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:38:08,775 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:38:24,492 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:38:42,534 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:38:42,535 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:38:44,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:38:44,894 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:38:44,898 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:38:59,637 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:39:23,950 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:39:24,466 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 13:39:26,089 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:39:30,141 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1026
2025-11-12 13:39:30,144 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:39:37,911 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-12 13:39:37,912 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:39:39,866 - ispa_next.appointments.models - DEBUG - Appointment Pascal Franke HG-PF 540 WBA71BM000CG74343 ohne Termin.
2025-11-12 13:39:39,876 - ispa_next.appointments.models - DEBUG - Appointment Helmut Wolfgang Lindstaedt Dr. HG-CZ 232 WBA5R11020AE78379 ohne Termin.
2025-11-12 13:39:39,881 - ispa_next.main - DEBUG - 



2025-11-12 13:39:39,881 - ispa_next.main - DEBUG - starting with process 7 (F-S 1330) of 11
2025-11-12 13:39:39,885 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:39:43,277 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:39:47,378 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1026
2025-11-12 13:39:47,381 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-12 13:39:51,627 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:39:51,629 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:40:51,003 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:41:12,647 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:17,707 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:41:17,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:17,903 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:41:18,647 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:41:35,594 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:41:35,599 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:41:39,037 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:41:39,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:41:41,790 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:41:43,794 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:41:44,081 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:41:44,446 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:41:44,663 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:41:49,045 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:41:50,055 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:41:50,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:50,669 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:59,974 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 13:41:59,979 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:41:59,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:42:00,182 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:42:00,184 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:42:00,329 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:42:02,071 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:42:03,989 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:42:04,474 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:42:07,214 - ispa_next.functions - DEBUG - Updated appointment (AH00014304) customer contact data.
2025-11-12 13:42:08,548 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:42:08,552 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:42:10,964 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:42:10,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:42:12,815 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:42:16,517 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:42:16,517 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:42:16,536 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:42:16,538 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:42:16,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:42:17,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:42:22,234 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 13:42:24,412 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 13:42:43,323 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:42:43,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:42:43,505 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:42:54,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:42:55,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:42:55,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:42:56,654 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:42:56,655 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:43:01,649 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:43:01,655 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:43:04,326 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:43:04,343 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:43:04,347 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:43:04,348 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:43:04,351 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:43:04,352 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:43:04,353 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:43:04,355 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:43:04,362 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:43:04,364 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:43:04,406 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:43:04,427 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:43:04,429 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:43:09,987 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 13:43:16,237 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:43:16,241 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:43:16,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:43:21,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:43:22,150 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:43:32,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:43:55,747 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:43:55,750 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:43:55,752 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:43:55,754 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:01,517 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-12 13:44:17,876 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:44:52,040 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:44:53,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:44:54,883 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:44:55,473 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:45:12,547 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:45:28,939 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:45:28,940 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:45:31,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:45:31,269 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:45:31,273 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:45:46,113 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:46:12,758 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:46:13,293 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 13:46:17,121 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:46:19,154 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1026
2025-11-12 13:46:19,156 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:46:27,164 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-12 13:46:27,165 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:46:29,370 - ispa_next.appointments.models - DEBUG - Appointment Pascal Franke HG-PF 540 WBA71BM000CG74343 ohne Termin.
2025-11-12 13:46:29,380 - ispa_next.appointments.models - DEBUG - Appointment Helmut Wolfgang Lindstaedt Dr. HG-CZ 232 WBA5R11020AE78379 ohne Termin.
2025-11-12 13:46:29,385 - ispa_next.main - DEBUG - 



2025-11-12 13:46:29,385 - ispa_next.main - DEBUG - starting with process 8 (BLB-TK 76) of 11
2025-11-12 13:46:29,390 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:46:32,729 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:46:36,764 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1026
2025-11-12 13:46:36,767 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-12 13:46:40,837 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:46:40,839 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:47:42,750 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:48:05,221 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:48:10,441 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:48:10,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:48:10,659 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:48:11,235 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:48:11,238 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:48:11,464 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:48:23,054 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:48:26,921 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:48:26,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:48:29,802 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:48:31,807 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:48:32,022 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:48:32,353 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:48:32,599 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:48:35,528 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:48:36,534 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:48:36,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:48:37,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:48:43,683 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 13:48:43,691 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:48:43,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:48:44,179 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:48:44,180 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:48:44,292 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:48:46,117 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:48:46,501 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:48:51,596 - ispa_next.functions - DEBUG - Updated appointment (AH00014303) customer contact data.
2025-11-12 13:48:52,695 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:48:52,764 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:48:55,170 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:48:55,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:48:57,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:49:00,793 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:49:00,793 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:49:00,799 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:49:00,800 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:49:00,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:49:01,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:49:06,209 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 13:49:09,019 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 13:49:28,074 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:49:28,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:49:28,269 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:49:37,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:38,576 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:38,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:49:39,785 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:49:39,785 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:49:44,669 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:49:44,672 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:49:47,126 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:49:47,137 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:49:47,141 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:49:47,143 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:49:47,145 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:49:47,147 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:49:47,148 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:49:47,150 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:49:47,151 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:49:47,152 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:49:47,158 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:49:47,161 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:49:47,162 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:52,664 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:49:52,667 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:49:52,670 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:58,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:49:58,381 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:50:11,179 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:50:11,181 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:50:11,183 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:50:11,186 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:50:16,575 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-12 13:50:32,966 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:51:09,588 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:51:10,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:51:12,598 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:51:13,125 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:51:29,182 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:51:44,903 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:51:44,905 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:51:47,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:51:47,243 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:51:47,250 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:52:02,446 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:52:27,828 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:52:28,259 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 13:52:30,308 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:52:34,587 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1028
2025-11-12 13:52:34,589 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:52:42,492 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 99
2025-11-12 13:52:42,493 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:52:44,703 - ispa_next.appointments.models - DEBUG - Appointment Pascal Franke HG-PF 540 WBA71BM000CG74343 ohne Termin.
2025-11-12 13:52:44,712 - ispa_next.main - DEBUG - 



2025-11-12 13:52:44,712 - ispa_next.main - DEBUG - starting with process 9 (FB-D 1387) of 11
2025-11-12 13:52:44,718 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:52:48,475 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:52:52,299 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1028
2025-11-12 13:52:52,301 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 99
2025-11-12 13:52:56,793 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:52:56,796 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:54:02,381 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:54:24,828 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:54:30,857 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:54:30,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:54:31,038 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:54:31,851 - ispa_next.functions - DEBUG - HU date already expired after 347 days.
2025-11-12 13:54:51,432 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:54:51,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:54:51,593 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:55:05,009 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:55:08,876 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:55:08,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:55:11,381 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:55:13,384 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:55:13,710 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:55:17,166 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:55:17,466 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:55:17,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:55:23,858 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:55:35,358 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:55:36,365 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:55:36,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:55:37,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:56:02,847 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:56:22,699 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:56:22,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:56:22,831 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:56:22,832 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:56:22,945 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:56:24,819 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:56:25,231 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:56:28,921 - ispa_next.functions - DEBUG - Updated appointment (AB00036619) customer contact data.
2025-11-12 13:56:30,328 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:56:30,358 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:56:33,435 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:56:33,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:56:35,591 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:56:39,229 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:56:39,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:56:39,816 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:56:41,819 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:56:42,163 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:56:42,454 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:56:42,810 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:56:42,817 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:56:49,090 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:57:00,922 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 13:57:08,064 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:57:08,070 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:57:14,758 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:57:19,180 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:57:20,192 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:57:20,193 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:57:20,194 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:57:20,539 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:57:24,898 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:57:24,905 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:57:24,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:57:25,098 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:57:25,621 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:57:26,433 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:57:26,435 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:57:27,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:57:27,858 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:57:29,795 - ispa_next.package_manager.helper - DEBUG - couldn't retrieve pakage name in cart
2025-11-12 13:57:30,244 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 262, in run
    self._update_cart_content()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 36, in _update_cart_content
    self.containers[Container.CART] = self.ui_helper.get_cart_content(self.base_element)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 140, in get_cart_content
    element=item,
            ^^^^
UnboundLocalError: cannot access local variable 'cart_package_name' where it is not associated with a value

2025-11-12 13:57:30,271 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:57:30,272 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:57:32,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:57:34,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:57:34,204 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 13:57:34,240 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 13:57:43,580 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 13:57:43,586 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:57:45,242 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1028
2025-11-12 13:57:45,244 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:57:53,164 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-12 13:57:53,165 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:57:55,415 - ispa_next.appointments.models - DEBUG - Appointment Pascal Franke HG-PF 540 WBA71BM000CG74343 ohne Termin.
2025-11-12 13:57:55,422 - ispa_next.main - DEBUG - 



2025-11-12 13:57:55,422 - ispa_next.main - DEBUG - starting with process 10 (HN IW996) of 11
2025-11-12 13:57:55,426 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:57:58,770 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:58:02,972 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1028
2025-11-12 13:58:02,974 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-12 13:58:07,351 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:58:07,353 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:59:06,378 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:59:06,391 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 13:59:06,396 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:59:08,055 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1028
2025-11-12 13:59:08,057 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:59:15,618 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-12 13:59:15,619 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:59:17,704 - ispa_next.appointments.models - DEBUG - Appointment Pascal Franke HG-PF 540 WBA71BM000CG74343 ohne Termin.
2025-11-12 13:59:17,712 - ispa_next.main - DEBUG - 



2025-11-12 13:59:17,712 - ispa_next.main - DEBUG - starting with process 11 (F GF 195) of 11
2025-11-12 13:59:17,719 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:59:21,095 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:59:25,119 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1028
2025-11-12 13:59:25,122 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-12 13:59:29,630 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:59:29,632 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:00:23,639 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 14:00:23,652 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 14:00:23,656 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:00:25,412 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1028
2025-11-12 14:00:25,414 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:00:32,565 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-12 14:00:32,567 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:00:34,766 - ispa_next.appointments.models - DEBUG - Appointment Pascal Franke HG-PF 540 WBA71BM000CG74343 ohne Termin.
