2025-11-17 14:07:34,558 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 14:07:34,564 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 14:07:44,309 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:07:54,463 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:08:10,034 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:08:35,964 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 14:08:53,082 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 14:08:56,376 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:08:57,555 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 479
2025-11-17 14:08:57,555 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 140
2025-11-17 14:08:59,493 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 68
2025-11-17 14:08:59,494 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 14:08:59,495 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:09:00,649 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:09:01,496 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:09:11,169 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:09:11,177 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:09:11,211 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Hirsch LIP-B 8307 WBAJM71090B068525 ohne Termin.
2025-11-17 14:09:11,219 - ispa_next.appointments.models - DEBUG - Appointment Janecke Möbeltechnik GmbH LIP-L 179 E WBY21HH050CU09424 ohne Termin.
2025-11-17 14:09:11,222 - ispa_next.main - DEBUG - Found 2 out of 13 appointments to process (configured limit: 15).
2025-11-17 14:09:11,222 - ispa_next.main - DEBUG - Processing 2 fresh appointments.
2025-11-17 14:09:11,222 - ispa_next.main - DEBUG - All appointments: LIP-S 5030, LIP-AK 706
2025-11-17 14:09:11,224 - ispa_next.main - DEBUG - 



2025-11-17 14:09:11,225 - ispa_next.main - DEBUG - starting with process 1 (LIP-S 5030) of 2
2025-11-17 14:09:11,229 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:09:12,487 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:09:13,765 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 479
2025-11-17 14:09:13,766 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 68
2025-11-17 14:09:15,226 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:09:15,227 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:09:44,722 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:09:53,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:53,666 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:09:53,883 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:55,176 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:09:55,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:55,242 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:09:55,550 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:09:55,554 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:09:55,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:55,790 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:09:58,954 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:09:58,956 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:10:00,131 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:10:02,134 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:10:02,241 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:10:05,513 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:10:05,568 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:10:05,570 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:10:16,657 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:10:17,662 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:10:17,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:18,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:28,146 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 14:10:34,928 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:10:34,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:35,024 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:10:35,026 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:10:35,063 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:10:36,339 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:10:36,573 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:10:39,906 - ispa_next.functions - DEBUG - Updated appointment (AA00044767) customer contact data.
2025-11-17 14:10:40,829 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:10:40,830 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:10:41,389 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:10:41,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:10:42,086 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:10:46,968 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:10:46,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:10:47,480 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:10:49,483 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:10:49,584 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:10:49,675 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:10:49,781 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:10:49,781 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:11:01,135 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:11:08,231 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:11:08,231 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:11:12,458 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:11:13,468 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:11:13,471 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:11:13,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:11:13,547 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:11:22,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:22,831 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:22,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:11:23,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:11:23,532 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:11:25,425 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:11:25,430 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:11:26,384 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:11:26,386 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:11:26,388 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:11:26,388 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:11:26,390 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:11:26,391 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:11:26,392 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:11:26,394 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:11:26,394 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:11:26,396 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:11:26,398 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:11:26,399 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:11:26,402 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:11:26,402 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:11:26,404 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:28,333 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:11:28,335 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:11:28,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:30,222 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:11:30,222 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:11:30,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:11:30,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:11:31,042 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:35,115 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:11:35,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:37,014 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:11:37,017 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:11:37,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:11:37,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:11:38,134 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:43,582 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:11:47,132 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:11:47,134 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:11:47,134 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:11:47,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:11:47,641 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:11:47,642 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:11:49,149 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:11:58,202 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:11:58,577 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 14:11:59,185 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:11:59,778 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 479
2025-11-17 14:11:59,779 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:12:02,861 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 140
2025-11-17 14:12:02,861 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:12:03,806 - ispa_next.main - DEBUG - 



2025-11-17 14:12:03,806 - ispa_next.main - DEBUG - starting with process 2 (LIP-AK 706) of 2
2025-11-17 14:12:03,809 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:12:04,924 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:12:06,058 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 479
2025-11-17 14:12:06,059 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 140
2025-11-17 14:12:07,349 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:12:07,351 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:12:19,234 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 14:12:19,321 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 14:12:19,324 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:12:19,837 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 479
2025-11-17 14:12:19,839 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:12:22,117 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 140
2025-11-17 14:12:22,118 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
