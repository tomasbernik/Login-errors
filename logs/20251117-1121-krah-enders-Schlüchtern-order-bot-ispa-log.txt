2025-11-17 11:49:37,878 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 11:49:37,887 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 11:49:47,985 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:49:58,593 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:50:14,402 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:50:38,209 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 11:50:53,342 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 11:50:55,884 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:50:57,111 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 247
2025-11-17 11:50:57,113 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 145
2025-11-17 11:50:59,164 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 82
2025-11-17 11:50:59,165 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 11:50:59,165 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:51:00,316 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:51:01,570 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:51:14,702 - ispa_next.appointments.models - DEBUG - Appointment Domenico Bruno MKK-B 197 WBAKS410X00H55021 ohne Termin.
2025-11-17 11:51:14,711 - ispa_next.appointments.models - DEBUG - Appointment Carsten Ihrig FD-CN 911 WBA6L71000FH84721 ohne Termin.
2025-11-17 11:51:14,719 - ispa_next.appointments.models - DEBUG - Appointment Nicole Jennifer Schwarzer FD-XX 1209 WBAJR71050WW63253 ohne Termin.
2025-11-17 11:51:14,726 - ispa_next.appointments.models - DEBUG - Appointment Firma Rhein-Main-Dachbeschichtungs G FD-DR 111 WBAJN91040CE25924 ohne Termin.
2025-11-17 11:51:14,754 - ispa_next.main - DEBUG - Found 15 out of 78 appointments to process (configured limit: 15).
2025-11-17 11:51:14,754 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 11:51:14,754 - ispa_next.main - DEBUG - All appointments: SLÜ-M 6316, SLÜ-HI 105, SLÜ-TH 10 E, SLÜ-LF 47, SLÜ-X 313, SLÜ-IH 11, MKK-NL 108, FD-OH 108, FD-DA 1111, SLÜ-LD 207, MKK-KH 310, MKK-KX 57, SLÜ-SF 64, MKK-JS 407, FD-LL 99
2025-11-17 11:51:14,757 - ispa_next.main - DEBUG - 



2025-11-17 11:51:14,757 - ispa_next.main - DEBUG - starting with process 1 (SLÜ-M 6316) of 15
2025-11-17 11:51:14,762 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:51:15,938 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:51:17,093 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 247
2025-11-17 11:51:17,094 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 82
2025-11-17 11:51:18,454 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:51:18,457 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:52:01,438 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:52:10,873 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:52:14,140 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:52:14,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:52:14,224 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:52:14,374 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:52:14,377 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:52:17,111 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:52:17,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:52:17,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:52:19,933 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:52:20,053 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:52:20,169 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:52:20,248 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:52:24,426 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:52:25,432 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:52:25,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:52:25,917 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:52:37,427 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:52:44,057 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:52:44,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:52:44,156 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:52:44,157 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:52:44,223 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:52:45,510 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:52:45,747 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:52:49,846 - ispa_next.functions - DEBUG - Updated appointment (AI00013559) customer contact data.
2025-11-17 11:52:50,761 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:52:50,763 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:52:51,460 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:52:51,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:52:52,162 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:52:55,834 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:52:55,834 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:52:55,840 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:52:55,841 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:52:55,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:52:56,383 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:53:00,550 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:53:00,555 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:53:00,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:53:00,640 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:53:06,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:53:06,800 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:53:06,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:53:07,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:53:07,540 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:53:10,636 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:53:10,638 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:53:11,536 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:53:11,538 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:53:11,540 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 11:53:11,541 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:53:11,543 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:53:11,544 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:53:11,545 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:53:11,547 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:53:11,548 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:53:11,550 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:53:11,554 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:53:12,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:53:12,976 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:53:37,728 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:53:37,731 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:53:37,732 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:53:37,733 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:53:41,724 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:53:41,725 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:53:41,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:53:45,635 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:53:45,637 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:53:45,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:53:46,158 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:53:46,434 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:53:59,288 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:53:59,289 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:53:59,291 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:53:59,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:54:00,313 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:54:00,534 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:54:08,547 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:54:12,802 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:54:16,510 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:54:20,300 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:54:24,524 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:54:24,526 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:54:24,527 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:54:25,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:54:25,243 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:54:25,245 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:54:25,271 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:54:28,537 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 11:54:28,541 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:54:29,048 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 247
2025-11-17 11:54:29,049 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:54:32,262 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 145
2025-11-17 11:54:32,263 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:54:33,108 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 11:54:33,120 - ispa_next.appointments.models - DEBUG - Appointment Jessica Hohmann FD-JH 53 WBA1R510807D23287 ohne Termin.
2025-11-17 11:54:33,126 - ispa_next.main - DEBUG - 



2025-11-17 11:54:33,126 - ispa_next.main - DEBUG - starting with process 2 (SLÜ-HI 105) of 15
2025-11-17 11:54:33,130 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:54:34,461 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:54:35,711 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 247
2025-11-17 11:54:35,712 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 145
2025-11-17 11:54:37,012 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:54:37,013 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:55:04,070 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:55:12,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:13,021 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:55:13,225 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:55:14,474 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:55:14,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:14,562 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:55:14,729 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:55:14,732 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:55:17,541 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:55:17,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:55:18,624 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:55:20,628 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:55:20,751 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:55:23,987 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:55:24,100 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:55:24,102 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:55:25,300 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:55:36,584 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:55:37,595 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:55:37,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:38,136 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:49,134 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:55:56,344 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:55:56,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:56,439 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:55:56,440 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:55:56,533 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:55:57,824 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:55:59,089 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:55:59,310 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:56:02,169 - ispa_next.functions - DEBUG - Updated appointment (AU00007734) customer contact data.
2025-11-17 11:56:03,055 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:56:03,057 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:56:03,828 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:56:03,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:56:04,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:56:08,145 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:56:08,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:56:08,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:56:10,660 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:56:10,782 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:56:10,949 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:56:11,045 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:56:11,047 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:56:12,315 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:56:23,783 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:57:23,786 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:57:35,081 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:57:42,013 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:57:42,014 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:57:43,238 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:57:47,424 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:57:48,443 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:57:48,445 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:57:48,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:57:48,522 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:57:52,674 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:57:52,679 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:57:52,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:57:52,760 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:57:53,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:57:53,683 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:57:53,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:57:54,462 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:57:54,462 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:57:55,755 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:57:55,757 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:57:56,619 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:57:56,626 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:57:56,629 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 11:57:56,632 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:57:56,633 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:57:56,636 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:57:56,637 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:57:56,642 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:57:56,661 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:57:56,663 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:57:56,669 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:57:57,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:57:58,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:58:22,976 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:58:22,978 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:58:22,980 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:58:22,981 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:58:24,872 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:58:24,874 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:58:24,876 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:58:26,763 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:58:26,765 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:58:26,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:58:27,256 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:58:27,550 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:58:36,725 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:58:36,727 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:58:36,728 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:58:37,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:58:37,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:58:37,909 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:58:43,788 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:58:47,866 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:58:47,868 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:58:47,868 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:58:48,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:58:48,338 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:58:48,340 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:58:48,361 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:58:51,448 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 11:58:51,451 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:58:51,777 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 247
2025-11-17 11:58:51,779 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:58:54,877 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 145
2025-11-17 11:58:54,878 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:58:55,719 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 11:58:55,729 - ispa_next.appointments.models - DEBUG - Appointment Jessica Hohmann FD-JH 53 WBA1R510807D23287 ohne Termin.
2025-11-17 11:58:55,735 - ispa_next.main - DEBUG - 



2025-11-17 11:58:55,735 - ispa_next.main - DEBUG - starting with process 3 (SLÜ-TH 10 E) of 15
2025-11-17 11:58:55,739 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:58:56,912 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:58:58,159 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 247
2025-11-17 11:58:58,161 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 145
2025-11-17 11:58:59,782 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:58:59,783 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:59:36,878 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:59:46,751 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:59:47,992 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:59:47,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:59:48,083 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:59:48,326 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:59:48,329 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:59:51,376 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:59:51,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:59:52,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:59:54,439 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:59:54,563 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:59:54,667 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:59:54,736 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:59:58,958 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:59:59,964 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:59:59,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:00:00,547 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:00:13,753 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:00:13,753 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:00:21,291 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:00:21,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:00:21,372 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:00:21,374 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:00:21,465 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:00:22,790 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:00:23,034 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:00:26,198 - ispa_next.functions - DEBUG - Updated appointment (AM00012190) customer contact data.
2025-11-17 12:00:27,133 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:00:27,135 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:00:27,940 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:00:27,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:00:28,886 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:00:32,948 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 12:00:32,948 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:00:32,948 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:00:32,951 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:00:32,951 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:00:32,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:00:33,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:00:37,581 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:00:37,589 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:00:37,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:00:37,696 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:00:47,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:00:47,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:00:47,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:00:48,680 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:00:48,681 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:00:50,013 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:00:50,015 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:00:50,860 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:00:50,862 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:00:50,864 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 12:00:50,866 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:00:50,870 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:00:50,873 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:00:50,875 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:00:50,876 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:00:50,877 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:00:50,878 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:00:50,879 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:00:51,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:00:52,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:01:17,193 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:01:17,195 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:01:17,198 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:01:17,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:01:19,204 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:01:19,206 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:01:19,213 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:01:21,062 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:01:21,064 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:01:21,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:01:21,553 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:01:21,768 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:01:30,269 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:01:30,271 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:01:30,272 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:01:30,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:01:31,356 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:01:31,513 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:01:38,345 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:01:42,046 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:01:42,049 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:01:42,050 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:01:42,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:01:42,560 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:01:42,561 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:01:42,582 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:01:45,584 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 12:01:45,587 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:01:45,915 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 247
2025-11-17 12:01:45,916 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:01:49,008 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 144
2025-11-17 12:01:49,009 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:01:50,073 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 12:01:50,084 - ispa_next.appointments.models - DEBUG - Appointment Jessica Hohmann FD-JH 53 WBA1R510807D23287 ohne Termin.
2025-11-17 12:01:50,091 - ispa_next.main - DEBUG - 



2025-11-17 12:01:50,091 - ispa_next.main - DEBUG - starting with process 4 (SLÜ-LF 47) of 15
2025-11-17 12:01:50,095 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:01:51,519 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:01:53,170 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 247
2025-11-17 12:01:53,171 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 144
2025-11-17 12:01:55,215 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:01:55,216 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:02:24,151 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:02:34,257 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:02:41,019 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:02:41,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:02:41,107 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:02:41,304 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:02:41,308 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:02:44,349 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:02:44,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:02:45,583 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:02:47,588 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:02:47,707 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:02:47,817 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:02:47,886 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:02:47,887 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:02:54,800 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:03:05,670 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:03:13,136 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:03:13,138 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:03:20,070 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:03:24,297 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:03:25,302 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:03:25,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:25,842 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:36,795 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 12:03:43,446 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:03:43,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:43,529 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:03:43,530 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:03:43,575 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:03:43,680 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:03:45,173 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:03:45,393 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:03:49,573 - ispa_next.functions - DEBUG - Updated appointment (AI00013530) customer contact data.
2025-11-17 12:03:50,525 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:03:50,527 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:03:50,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:03:51,696 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:03:53,302 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:03:53,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:03:53,485 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:03:58,545 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:03:58,545 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:03:58,548 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:03:58,549 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:03:58,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:03:59,084 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:04:03,237 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:04:04,112 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:04:17,870 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:04:17,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:04:17,983 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:04:22,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:04:22,785 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:04:22,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:04:23,632 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:04:23,633 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:04:30,910 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:04:30,912 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:04:32,446 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:04:32,448 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:04:32,449 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 12:04:32,451 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:04:32,452 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:04:32,453 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:04:32,454 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:04:32,455 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:04:32,456 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:04:32,457 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:04:32,460 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:04:33,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:04:34,162 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:05:03,722 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:05:03,725 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:05:03,727 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:05:03,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:05:12,900 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:05:12,902 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:05:12,905 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:05:21,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:05:22,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:05:32,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:05:53,343 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:05:53,345 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:05:53,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:05:54,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:05:54,897 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:06:09,224 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:06:09,228 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:06:09,231 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:06:09,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:06:10,439 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:06:10,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:06:26,147 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:06:32,799 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:06:38,999 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:06:45,871 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:06:51,218 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:06:58,901 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:07:05,246 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:07:11,544 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:07:17,559 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:07:22,895 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:07:28,261 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:07:34,908 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:07:34,911 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:07:34,912 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:07:36,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:07:36,130 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:07:36,132 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:07:36,159 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:07:42,472 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 12:07:42,476 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:07:43,380 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 248
2025-11-17 12:07:43,382 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:07:48,857 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 145
2025-11-17 12:07:48,858 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:07:49,883 - ispa_next.appointments.models - DEBUG - Appointment Mathias Donath GN-MD 1234 WBA21EV0509X05056 ohne Termin.
2025-11-17 12:07:49,894 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 12:07:49,902 - ispa_next.main - DEBUG - 



2025-11-17 12:07:49,902 - ispa_next.main - DEBUG - starting with process 5 (SLÜ-X 313) of 15
2025-11-17 12:07:49,906 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:07:51,324 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:07:52,813 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 248
2025-11-17 12:07:52,815 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 145
2025-11-17 12:07:55,001 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:07:55,002 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:08:43,124 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:08:56,177 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:08:56,340 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:08:56,608 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:08:58,637 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:08:58,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:08:58,750 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:08:59,103 - ispa_next.functions - DEBUG - HU date already expired after 1 days.
2025-11-17 12:09:07,241 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:09:07,244 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:09:10,200 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:09:10,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:09:11,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:09:13,868 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:09:14,012 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:09:17,288 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:09:17,390 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:09:17,391 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:09:19,408 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:09:31,622 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:09:32,628 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:09:32,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:33,158 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:48,197 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:09:48,197 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:09:57,083 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:09:57,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:57,198 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:09:57,199 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:09:57,282 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:09:58,724 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:09:58,965 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:10:04,212 - ispa_next.functions - DEBUG - Updated appointment (AA00062825) customer contact data.
2025-11-17 12:10:05,168 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:10:05,173 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:10:06,575 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:10:06,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:10:07,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:10:11,420 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:10:11,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:10:12,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:10:14,037 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:10:14,178 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:10:14,326 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:10:14,446 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:10:14,447 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:10:16,395 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:10:28,070 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:10:35,892 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:10:35,894 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:10:40,051 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 12:10:43,897 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:10:49,027 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:10:50,034 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:10:50,036 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:10:50,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:10:50,122 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:10:54,340 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:10:55,538 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:11:07,112 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:11:07,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:11:07,279 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:11:17,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:11:17,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:11:17,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:11:18,592 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:11:18,593 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:11:20,525 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:11:20,528 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:11:22,614 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:11:22,617 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:11:22,619 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 12:11:22,621 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:11:22,622 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:11:22,623 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:11:22,624 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:11:22,626 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:11:22,627 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:11:22,629 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:11:22,630 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:11:23,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:11:24,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:11:52,970 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:11:52,974 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:11:52,977 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:11:52,978 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:11:55,703 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:11:55,705 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:11:55,708 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:11:58,391 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:11:58,393 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:11:58,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:11:59,239 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:11:59,533 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:12:09,714 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:12:09,716 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:12:09,718 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:12:10,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:12:10,994 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:12:11,249 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:12:20,459 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:12:26,472 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:12:32,966 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:12:32,969 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:12:32,970 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:12:33,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:12:34,028 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:12:34,030 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:12:34,061 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:12:40,040 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 12:12:40,045 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:12:40,796 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 248
2025-11-17 12:12:40,798 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:12:46,146 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 144
2025-11-17 12:12:46,147 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:12:47,413 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 12:12:47,422 - ispa_next.main - DEBUG - Found new Appointment: GN-MD 1234
2025-11-17 12:12:47,429 - ispa_next.main - DEBUG - 



2025-11-17 12:12:47,429 - ispa_next.main - DEBUG - starting with process 6 (GN-MD 1234) of 16
2025-11-17 12:12:47,439 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:12:49,005 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:12:50,649 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 248
2025-11-17 12:12:50,650 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 144
2025-11-17 12:12:52,431 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:12:52,432 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:13:31,213 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:13:44,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:13:44,292 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:13:44,589 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:45,888 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:13:45,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:13:45,995 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:13:46,404 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:13:46,409 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:13:49,562 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:13:49,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:13:51,660 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:13:53,666 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:13:53,807 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:13:57,134 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:13:57,283 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:13:57,286 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:58,630 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:14:11,487 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:14:12,493 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:14:12,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:14:13,050 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:14:30,748 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 12:14:40,966 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:14:40,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:14:41,086 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:14:41,087 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:14:41,144 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:14:42,519 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:14:43,916 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:14:44,135 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:14:49,437 - ispa_next.functions - DEBUG - Updated appointment (AI00013570) customer contact data.
2025-11-17 12:14:50,424 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:14:50,428 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:14:51,756 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:14:51,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:14:52,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:14:57,676 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:14:57,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:14:58,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:15:00,277 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:15:00,447 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:15:00,670 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:15:00,824 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:15:00,826 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:15:02,934 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:15:14,276 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:15:21,960 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:15:21,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:15:24,038 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:15:28,262 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:15:29,271 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:15:29,273 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:15:29,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:15:29,368 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:15:33,605 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:15:33,611 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:15:33,611 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 12:15:33,612 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:15:35,617 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:15:35,619 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:15:37,249 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:15:37,272 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:15:37,275 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 12:15:37,278 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:15:37,279 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:15:37,281 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:15:37,282 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:15:37,284 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:15:37,286 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:15:37,288 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:15:37,290 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:15:38,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:15:39,005 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:16:08,562 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:16:08,565 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:16:08,567 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:16:08,567 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:16:11,193 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:16:11,197 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:16:11,209 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:16:13,873 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:16:13,875 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:16:13,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:16:14,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:16:15,128 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:16:32,199 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:16:32,201 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:16:32,203 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:16:32,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:16:33,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:16:33,661 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:16:42,883 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:16:48,229 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:16:54,838 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:16:54,841 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:16:54,842 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:16:55,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:16:55,957 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:16:55,958 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:16:55,989 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:17:01,337 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 12:17:01,342 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:17:02,149 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 248
2025-11-17 12:17:02,151 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:17:07,279 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 144
2025-11-17 12:17:07,280 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:17:08,405 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 12:17:08,414 - ispa_next.main - DEBUG - 



2025-11-17 12:17:08,414 - ispa_next.main - DEBUG - starting with process 7 (SLÜ-IH 11) of 16
2025-11-17 12:17:08,418 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:17:10,012 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:17:11,908 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 248
2025-11-17 12:17:11,910 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 144
2025-11-17 12:17:14,179 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:17:14,181 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:17:51,692 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:18:05,670 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:18:07,668 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:18:07,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:18:07,761 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:18:08,196 - ispa_next.functions - DEBUG - HU date soon to be invalid in 74 days.
2025-11-17 12:18:18,245 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:18:18,248 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:18:21,191 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:18:21,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:18:22,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:18:24,860 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:18:24,991 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:18:25,130 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:18:25,228 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:18:25,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:18:27,251 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:18:39,623 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:18:40,630 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:18:40,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:18:41,152 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:18:57,235 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:18:57,235 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:19:07,839 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:19:07,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:19:07,956 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:19:07,957 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:19:08,024 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:19:09,438 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:19:10,860 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:19:11,082 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:19:15,743 - ispa_next.functions - DEBUG - Updated appointment (AC00069344) customer contact data.
2025-11-17 12:19:16,723 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:19:16,728 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:19:18,269 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:19:18,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:19:19,525 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:19:23,134 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:19:23,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:19:23,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:19:25,784 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:19:26,016 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:19:26,178 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:19:26,324 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:19:26,326 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:19:28,371 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:19:39,739 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:19:47,686 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:19:47,688 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:19:49,740 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:19:54,008 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:19:55,034 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:19:55,035 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:19:55,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:19:55,166 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:19:59,382 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:19:59,387 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:19:59,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:19:59,504 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:19:59,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:20:00,424 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:20:00,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:20:01,238 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:20:01,238 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:20:03,156 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:20:03,158 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:20:04,477 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:20:04,478 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:20:04,480 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 12:20:04,482 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:20:04,485 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:20:04,487 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:20:04,489 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:20:04,490 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:20:04,491 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:20:04,493 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:20:04,494 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:20:05,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:20:06,127 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:20:34,183 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:20:34,186 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:20:34,188 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:20:34,189 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:36,949 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:20:36,951 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:20:36,954 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:39,637 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:20:39,639 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:20:39,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:20:40,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:20:40,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:55,650 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:20:55,653 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:20:55,655 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:20:56,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:20:57,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:20:57,276 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:21:06,184 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:21:12,032 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:21:12,034 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:21:12,035 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:21:12,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:21:12,873 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:21:12,875 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:21:12,899 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:21:17,925 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 12:21:17,929 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:21:18,615 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 248
2025-11-17 12:21:18,617 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:21:23,486 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 144
2025-11-17 12:21:23,488 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:21:24,552 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 12:21:24,560 - ispa_next.main - DEBUG - 



2025-11-17 12:21:24,560 - ispa_next.main - DEBUG - starting with process 8 (MKK-NL 108) of 16
2025-11-17 12:21:24,565 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:21:26,080 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:21:27,743 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 248
2025-11-17 12:21:27,745 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 144
2025-11-17 12:21:29,992 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:21:29,993 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:22:09,105 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:22:20,687 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:22:22,653 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:22:22,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:22,759 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:22:23,114 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:22:23,118 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:22:26,344 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:22:26,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:22:28,136 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:22:30,141 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:22:30,364 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:22:30,561 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:22:30,726 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:22:30,727 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:22:32,843 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:22:44,136 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:22:51,898 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:22:51,900 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:22:53,933 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:22:58,163 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:22:59,197 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:22:59,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:59,781 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:12,872 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 12:23:22,875 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:23:22,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:22,992 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:23:22,993 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:23:23,053 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:23:24,477 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:23:25,762 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:23:25,993 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:23:31,517 - ispa_next.functions - DEBUG - Updated appointment (AC00069339) customer contact data.
2025-11-17 12:23:32,474 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:23:32,476 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:23:33,890 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:23:33,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:23:35,339 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:23:39,962 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:23:39,962 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:23:40,054 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:23:40,156 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:23:40,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:23:40,883 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:23:45,038 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:23:46,037 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:23:55,636 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:23:55,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:23:55,724 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:23:56,143 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:56,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:56,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:23:57,596 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:23:57,597 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:24:00,227 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:24:00,232 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:24:01,908 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:24:01,910 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:24:01,911 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 12:24:01,917 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:24:01,919 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:24:01,921 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:24:01,924 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:24:01,927 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:24:01,929 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:24:01,931 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:24:01,933 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:24:02,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:24:03,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:24:33,837 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:24:33,840 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:24:33,842 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:24:33,843 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:24:37,293 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 12:24:43,028 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:24:43,176 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:24:43,184 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:24:46,858 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:24:46,860 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:24:46,861 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:24:47,669 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:24:47,909 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:24:57,941 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:24:57,945 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:24:57,947 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:24:58,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:24:59,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:24:59,591 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:25:09,208 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:25:16,842 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:25:22,924 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:25:29,036 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:25:29,038 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:25:29,038 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:25:29,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:25:29,864 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:25:29,865 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:25:29,889 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:25:35,020 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 12:25:35,024 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:25:35,812 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 248
2025-11-17 12:25:35,813 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:25:40,378 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 144
2025-11-17 12:25:40,379 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:25:41,594 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 12:25:41,603 - ispa_next.main - DEBUG - 



2025-11-17 12:25:41,603 - ispa_next.main - DEBUG - starting with process 9 (FD-OH 108) of 16
2025-11-17 12:25:41,608 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:25:43,644 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:25:45,692 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 248
2025-11-17 12:25:45,693 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 144
2025-11-17 12:25:47,881 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:25:47,882 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:26:35,140 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:26:48,972 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:26:55,982 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:26:55,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:26:56,091 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:26:56,676 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:26:56,679 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:26:59,788 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:26:59,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:27:01,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:27:03,750 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:27:03,924 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:27:04,065 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:27:04,170 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:27:04,172 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:27:11,339 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:27:23,643 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:27:24,649 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:27:24,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:27:25,183 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:27:40,831 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:27:40,831 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:27:51,056 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:27:51,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:27:51,156 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:27:51,157 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:27:51,224 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:27:52,557 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:27:52,761 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:27:56,728 - ispa_next.functions - DEBUG - Updated appointment (AA00062823) customer contact data.
2025-11-17 12:27:57,899 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:27:57,902 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:27:59,892 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:27:59,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:28:01,270 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:28:04,911 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:28:04,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:28:05,428 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:28:07,432 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:28:07,570 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:28:07,727 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:28:07,854 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:28:07,856 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:28:15,077 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:28:26,565 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:28:34,641 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:28:34,643 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:28:41,889 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:28:46,190 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:28:47,229 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:28:47,230 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:28:47,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:28:47,325 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:28:51,565 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:28:52,692 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:29:04,347 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:29:04,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:29:04,452 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:29:14,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:14,767 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:14,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:29:15,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:29:15,636 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:29:21,854 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:29:21,859 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:29:23,523 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:29:23,524 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:29:23,526 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 12:29:23,527 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:29:23,529 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:29:23,531 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:29:23,532 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:29:23,534 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:29:23,541 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:29:23,545 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:29:23,547 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:29:24,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:29:25,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:29:56,616 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:29:56,619 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:29:56,621 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:29:56,622 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:30:04,449 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:30:04,451 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:30:04,453 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:30:12,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:30:12,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:30:22,613 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:30:43,238 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:30:43,241 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:30:43,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:30:44,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:30:44,864 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:31:00,271 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:31:00,274 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:31:00,276 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:31:00,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:31:01,765 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:31:02,047 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:31:16,444 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:31:25,111 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:31:32,452 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:31:40,403 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:31:47,687 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:31:53,981 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:32:03,399 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:32:09,826 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:32:15,775 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:32:22,855 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:32:22,858 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:32:22,859 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:32:23,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:32:23,989 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:32:23,990 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:32:24,038 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:32:30,774 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 12:32:30,779 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:32:31,591 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 249
2025-11-17 12:32:31,593 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:32:36,894 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 145
2025-11-17 12:32:36,895 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:32:38,092 - ispa_next.appointments.models - DEBUG - Appointment Karin Jahn FD-MD 503 WBA2D710805C40887 ohne Termin.
2025-11-17 12:32:38,106 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 12:32:38,115 - ispa_next.main - DEBUG - 



2025-11-17 12:32:38,115 - ispa_next.main - DEBUG - starting with process 10 (FD-DA 1111) of 16
2025-11-17 12:32:38,119 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:32:39,772 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:32:41,343 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 249
2025-11-17 12:32:41,344 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 145
2025-11-17 12:32:43,238 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:32:43,239 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:33:23,146 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:33:35,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:33:35,731 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:33:35,949 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:33:38,639 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:33:38,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:33:38,743 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:33:39,077 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:33:39,080 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:33:42,081 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:33:42,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:33:44,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:33:46,010 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:33:54,043 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 12:34:04,633 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 12:34:05,640 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:34:05,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:06,147 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:21,399 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:34:21,399 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:34:31,994 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:34:31,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:32,126 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:34:32,126 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:34:32,183 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:34:32,333 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:34:33,779 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:34:34,091 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:34:39,301 - ispa_next.functions - DEBUG - Updated appointment (AC00069302) customer contact data.
2025-11-17 12:34:40,313 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:34:40,327 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:34:41,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:34:42,621 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:34:44,461 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:34:44,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:34:45,265 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:34:49,327 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 12:34:49,327 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:34:49,327 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:34:49,330 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:34:49,331 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:34:49,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:34:49,892 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:34:54,096 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:34:54,102 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:34:54,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:34:54,226 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:34:54,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:55,270 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:55,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:34:56,153 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:34:56,153 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:34:59,389 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:34:59,392 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:35:01,047 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:35:01,050 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:35:01,052 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 12:35:01,053 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:35:01,055 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:35:01,056 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:35:01,057 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:35:01,059 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:35:01,060 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:35:01,062 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:35:01,072 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:35:01,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:35:03,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:35:31,927 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:35:31,930 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:35:31,931 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:35:31,932 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:35:36,064 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:35:36,066 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:35:36,070 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:35:40,344 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:35:40,346 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:35:40,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:35:41,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:35:41,167 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:35:41,170 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:35:41,172 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:35:41,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:35:42,358 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:35:42,570 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:35:53,014 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:35:59,344 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:36:05,162 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:36:11,950 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:36:11,953 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:36:11,954 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:36:12,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:36:13,092 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:36:13,094 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:36:13,125 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:36:18,993 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 12:36:18,997 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:36:19,736 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 249
2025-11-17 12:36:19,738 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:36:24,508 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 145
2025-11-17 12:36:24,509 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:36:25,517 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 12:36:25,523 - ispa_next.main - DEBUG - Found new Appointment: FD-MD 503
2025-11-17 12:36:25,524 - ispa_next.main - DEBUG - 



2025-11-17 12:36:25,524 - ispa_next.main - DEBUG - starting with process 11 (FD-MD 503) of 17
2025-11-17 12:36:25,528 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:36:27,315 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:36:29,626 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 249
2025-11-17 12:36:29,628 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 145
2025-11-17 12:36:31,891 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:36:31,893 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:37:23,374 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:37:36,633 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:37:38,642 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:37:38,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:37:38,795 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:37:39,120 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:37:39,124 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:37:42,290 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:37:42,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:37:44,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:37:46,129 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:37:46,293 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:37:46,494 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:37:46,642 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:37:50,903 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:37:51,920 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:37:51,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:37:52,428 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:38:07,395 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:38:18,170 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:38:18,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:38:18,289 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:38:18,291 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:38:18,362 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:38:19,802 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:38:20,012 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:38:25,147 - ispa_next.functions - DEBUG - Updated appointment (AI00013579) customer contact data.
2025-11-17 12:38:26,118 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:38:26,120 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:38:28,329 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:38:28,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:38:29,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:38:33,530 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:38:33,530 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:38:33,533 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:38:33,534 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:38:33,534 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:38:34,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:38:38,248 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:38:38,254 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:38:38,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:38:38,345 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:38:38,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:38:39,267 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:38:39,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:38:40,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:38:40,204 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:38:42,173 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:38:42,175 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:38:43,611 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:38:43,614 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:38:43,618 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 12:38:43,620 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:38:43,622 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:38:43,635 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:38:43,637 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:38:43,642 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:38:43,643 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:38:43,644 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:38:43,646 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:38:44,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:38:45,507 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:39:15,049 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:39:15,052 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:39:15,055 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:39:15,056 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:39:17,831 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:39:17,833 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:39:17,842 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:39:20,544 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:39:20,546 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:39:20,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:39:21,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:39:21,475 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:39:24,891 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:39:24,893 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:39:24,895 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:39:25,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:39:26,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:39:26,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:39:35,915 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:39:42,294 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:39:49,041 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:39:49,044 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:39:49,045 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:39:50,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:39:50,236 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:39:50,237 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:39:50,262 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:39:56,060 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 12:39:56,064 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:39:56,869 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 249
2025-11-17 12:39:56,871 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:40:01,843 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 145
2025-11-17 12:40:01,843 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:40:03,116 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 12:40:03,125 - ispa_next.main - DEBUG - 



2025-11-17 12:40:03,125 - ispa_next.main - DEBUG - starting with process 12 (SLÜ-LD 207) of 17
2025-11-17 12:40:03,129 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:40:05,072 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:40:07,825 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 249
2025-11-17 12:40:07,827 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 145
2025-11-17 12:40:09,739 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:40:09,740 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:40:53,674 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:41:07,666 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:41:14,048 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:41:14,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:41:14,134 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:41:14,456 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:41:14,459 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:41:17,742 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:41:17,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:41:19,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:41:21,839 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:41:21,985 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:41:22,123 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:41:22,239 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:41:22,241 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:41:28,878 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:41:41,206 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:41:42,220 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:41:42,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:41:42,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:41:49,102 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:41:49,106 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:41:49,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:41:49,197 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:41:49,198 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:41:49,274 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:41:50,643 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:41:50,839 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:41:54,759 - ispa_next.functions - DEBUG - Updated appointment (AA00062821) customer contact data.
2025-11-17 12:41:55,705 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:41:55,710 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:41:57,206 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:41:57,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:41:58,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:42:02,467 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:42:02,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:42:03,034 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:42:05,039 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:42:05,177 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:42:05,382 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:42:05,513 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:42:05,516 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:42:12,127 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:42:24,557 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:43:24,563 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:43:36,689 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:43:44,751 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:43:44,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:43:51,504 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:43:55,838 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:43:56,846 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:43:56,847 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:43:56,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:43:56,946 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:44:01,187 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:44:02,436 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:44:15,002 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:44:15,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:44:15,120 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:44:23,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:44:24,547 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:44:24,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:44:25,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:44:25,472 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:44:31,232 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:44:31,234 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:44:32,994 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:44:33,009 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:44:33,012 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 12:44:33,014 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:44:33,016 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:44:33,017 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:44:33,018 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:44:33,021 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:44:33,021 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:44:33,023 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:44:33,025 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:44:33,717 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:44:34,919 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:45:03,702 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:45:03,705 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:45:03,707 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:45:03,708 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:45:11,830 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:45:11,832 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:45:11,834 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:45:19,130 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:45:19,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:45:30,370 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:45:30,388 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:45:30,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:45:31,715 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:45:31,878 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:45:44,233 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:45:44,235 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:45:44,238 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:45:44,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:45:45,691 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:45:45,890 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:45:59,609 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:46:07,436 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:46:14,674 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:46:21,807 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:46:28,501 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:46:35,210 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:46:42,059 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:46:49,814 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:46:57,049 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:46:57,051 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:46:57,052 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:46:58,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:46:58,165 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:46:58,167 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:46:58,212 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:47:05,088 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 12:47:05,092 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:47:05,871 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 250
2025-11-17 12:47:05,872 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:47:10,837 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-17 12:47:10,838 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:47:12,106 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 12:47:12,120 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 12:47:12,128 - ispa_next.main - DEBUG - 



2025-11-17 12:47:12,128 - ispa_next.main - DEBUG - starting with process 13 (MKK-KH 310) of 17
2025-11-17 12:47:12,132 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:47:14,052 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:47:16,112 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 250
2025-11-17 12:47:16,113 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-17 12:47:18,537 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:47:18,538 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:48:08,836 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:48:21,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:48:22,080 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:48:22,350 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:48:23,664 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:48:23,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:48:23,744 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:48:24,177 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:48:24,181 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:48:27,419 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:48:27,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:48:29,433 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:48:31,438 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:48:31,557 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:48:34,881 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:48:34,966 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:48:34,968 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:48:36,274 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:48:48,442 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:48:49,447 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:48:49,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:48:49,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:49:06,041 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:49:06,041 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:49:16,480 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:49:16,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:49:16,632 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:49:16,633 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:49:16,692 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:49:18,055 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:49:19,305 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:49:19,569 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:49:24,945 - ispa_next.functions - DEBUG - Updated appointment (AC00069282) customer contact data.
2025-11-17 12:49:25,868 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:49:26,036 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:49:28,202 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:49:28,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:49:29,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:49:33,244 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:49:33,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:49:33,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:49:35,758 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:49:35,973 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:49:36,113 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:49:36,245 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:49:36,246 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:37,536 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:49:49,010 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:49:56,961 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:49:56,963 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:58,340 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:50:02,554 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:50:03,572 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:50:03,579 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:50:03,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:50:03,694 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:50:07,869 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:50:07,874 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:50:07,875 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 12:50:07,875 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:50:09,248 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:50:09,251 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:50:10,868 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:50:10,873 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:50:10,875 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 12:50:10,877 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:50:10,879 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:50:10,880 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:50:10,882 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:50:10,883 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:50:10,884 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:50:10,886 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:50:10,888 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:50:11,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:50:12,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:50:42,512 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:50:42,515 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:50:42,516 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:50:42,517 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:50:44,576 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:50:44,578 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:50:44,581 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:50:46,653 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:50:46,655 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:50:46,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:50:47,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:50:48,090 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:50:58,997 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:50:58,998 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:50:59,000 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:50:59,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:51:00,565 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:51:00,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:51:09,741 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:51:16,006 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:51:16,008 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:51:16,009 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:51:16,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:51:17,049 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:51:17,050 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:51:17,078 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:51:23,051 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 12:51:23,054 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:51:23,868 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 250
2025-11-17 12:51:23,869 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:51:28,663 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-17 12:51:28,664 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:51:29,626 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 12:51:29,637 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 12:51:29,644 - ispa_next.main - DEBUG - 



2025-11-17 12:51:29,644 - ispa_next.main - DEBUG - starting with process 14 (MKK-KX 57) of 17
2025-11-17 12:51:29,648 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:51:31,069 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:51:32,650 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 250
2025-11-17 12:51:32,651 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-17 12:51:35,067 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:51:35,069 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:52:21,148 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:52:34,719 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:52:40,324 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:52:40,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:52:40,416 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:52:40,768 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:52:40,771 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:52:43,949 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:52:43,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:52:45,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:52:47,948 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:52:48,083 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:52:48,283 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:52:48,392 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:52:48,394 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:52:54,429 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:53:05,918 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:53:13,878 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:53:13,880 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:53:21,811 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motoröl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 12:53:25,175 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:53:28,772 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:53:29,790 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:53:29,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:53:30,439 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:53:47,082 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:53:58,370 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:53:58,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:53:58,472 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:53:58,473 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:53:58,531 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:53:59,920 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:54:00,126 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:54:05,481 - ispa_next.functions - DEBUG - Updated appointment (AC00069277) customer contact data.
2025-11-17 12:54:06,474 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:54:06,490 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:54:08,930 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:54:08,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:54:10,586 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:54:14,212 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:54:14,212 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:54:14,217 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:54:14,218 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:54:14,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:54:14,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:54:18,864 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:54:19,773 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:54:29,780 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:54:29,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:54:29,872 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:54:30,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:54:30,917 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:54:30,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:54:31,860 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:54:31,862 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:54:36,866 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:54:36,872 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:54:39,180 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:54:39,185 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:54:39,192 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 12:54:39,195 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:54:39,197 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:54:39,199 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:54:39,201 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:54:39,202 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:54:39,205 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:54:39,208 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:54:39,229 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:54:39,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:54:41,147 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:55:10,761 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:55:10,764 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:55:10,765 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:55:10,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:55:17,334 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 12:55:29,056 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:55:29,244 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:55:29,247 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:55:36,318 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:55:36,321 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:55:36,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:55:37,494 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:55:37,721 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:55:58,601 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:55:58,604 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:55:58,606 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:55:59,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:56:00,209 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:56:00,458 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:56:13,889 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:56:23,419 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:56:30,749 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:56:39,882 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:56:46,765 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:56:53,479 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:56:59,951 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:57:07,339 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:57:07,342 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:57:07,343 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:57:08,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:57:08,294 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:57:08,296 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:57:08,323 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:57:15,297 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 12:57:15,302 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:57:16,099 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 250
2025-11-17 12:57:16,100 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:57:21,077 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-17 12:57:21,078 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:57:22,400 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 12:57:22,416 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 12:57:22,424 - ispa_next.main - DEBUG - 



2025-11-17 12:57:22,424 - ispa_next.main - DEBUG - starting with process 15 (SLÜ-SF 64) of 17
2025-11-17 12:57:22,428 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:57:24,297 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:57:26,335 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 250
2025-11-17 12:57:26,336 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-17 12:57:28,913 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:57:28,915 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:58:13,126 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:58:27,070 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:58:29,070 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:58:29,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:58:29,145 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:58:29,515 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:58:29,518 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:58:32,541 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:58:32,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:58:34,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:58:36,648 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:58:36,796 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:58:40,095 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:58:40,228 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:58:40,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:58:42,365 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:58:54,773 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:58:55,785 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:58:55,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:58:56,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:59:12,384 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:59:12,384 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:59:23,511 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:59:23,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:59:23,632 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:59:23,633 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:59:23,721 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:59:25,167 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:59:25,449 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:59:29,754 - ispa_next.functions - DEBUG - Updated appointment (AA00062820) customer contact data.
2025-11-17 12:59:30,752 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:59:30,754 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:59:32,277 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:59:32,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:59:33,853 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:59:38,003 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 12:59:38,003 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:59:38,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:59:38,600 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:59:40,604 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:59:40,734 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:59:40,964 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:59:41,083 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:59:41,084 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:59:43,217 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:59:55,367 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:00:55,371 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:01:07,078 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:01:15,055 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:01:15,056 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:01:17,117 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:01:21,431 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:01:22,439 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:01:22,440 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:01:22,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:01:22,536 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:01:26,737 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:01:26,742 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:01:26,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:01:26,847 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:01:27,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:01:28,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:01:28,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:01:29,045 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:01:29,045 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:01:31,053 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:01:31,059 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:01:32,879 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:01:32,880 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:01:32,885 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 13:01:32,886 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:01:32,888 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:01:32,889 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:01:32,890 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:01:32,892 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:01:32,894 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:01:32,895 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:01:32,897 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:01:33,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:01:35,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:02:06,859 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:02:06,861 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:02:06,862 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:02:06,863 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:09,573 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:02:09,593 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:02:09,597 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:12,375 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:02:12,377 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:02:12,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:02:13,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:02:13,888 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:21,121 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:02:21,124 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:02:21,127 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:02:21,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:02:22,814 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:02:23,011 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:32,976 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:02:40,543 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:02:40,546 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:02:40,547 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:02:41,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:02:41,735 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:02:41,736 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 13:02:41,766 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:02:49,405 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 13:02:49,409 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:02:50,192 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 13:02:50,194 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:02:56,707 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 13:02:56,708 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:02:58,147 - ispa_next.appointments.models - DEBUG - Appointment Georg Jambor SLÜ-RG 118 WBAYH110105N09160 ohne Termin.
2025-11-17 13:02:58,160 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 13:02:58,175 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 13:02:58,183 - ispa_next.main - DEBUG - 



2025-11-17 13:02:58,183 - ispa_next.main - DEBUG - starting with process 16 (MKK-JS 407) of 17
2025-11-17 13:02:58,187 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:03:00,241 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:03:03,440 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 13:03:03,442 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 13:03:06,108 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:03:06,110 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:03:49,899 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:04:04,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:04,294 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:04:04,521 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:04:09,533 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:04:09,534 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:09,620 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:04:09,943 - ispa_next.functions - DEBUG - HU date soon to be invalid in 73 days.
2025-11-17 13:04:18,923 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:04:18,926 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:04:21,936 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:04:21,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:04:24,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:04:26,124 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:04:26,270 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:04:29,639 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:04:40,505 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 13:04:41,512 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:04:41,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:42,224 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:56,217 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 13:05:07,847 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:05:07,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:05:08,020 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:05:08,022 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:05:08,095 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:05:09,571 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:05:09,790 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:05:15,675 - ispa_next.functions - DEBUG - Updated appointment (AC00069257) customer contact data.
2025-11-17 13:05:16,791 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:05:16,793 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:05:18,442 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:05:18,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:05:20,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:05:24,388 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:05:24,388 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:05:24,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:05:25,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:05:27,005 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:05:27,197 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:05:27,355 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:05:27,510 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:05:27,512 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:05:32,718 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:05:44,910 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:06:44,913 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:06:58,730 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:07:06,643 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:07:06,644 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:07:11,842 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:07:16,110 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:07:17,116 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:07:17,117 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:07:17,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:07:17,244 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:07:21,454 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:07:21,460 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:07:21,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:07:21,557 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:07:21,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:07:22,731 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:07:22,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:07:23,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:07:23,774 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:07:28,464 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:07:28,468 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:07:30,298 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:07:30,303 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:07:30,306 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 13:07:30,309 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:07:30,311 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:07:30,312 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:07:30,313 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:07:30,315 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:07:30,316 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:07:30,317 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:07:30,320 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:07:31,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:07:32,438 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:08:03,223 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:08:03,226 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:08:03,229 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:08:03,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:08:08,970 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:08:08,972 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:08:08,974 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:08:14,727 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:08:14,730 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:08:14,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:08:15,919 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:08:16,167 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:08:29,004 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:08:29,007 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:08:29,009 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:08:29,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:08:30,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:08:30,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:08:43,502 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:08:49,626 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:08:56,678 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:09:04,154 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:09:11,168 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:09:19,267 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:09:19,269 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:09:19,270 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:09:20,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:09:20,504 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:09:20,505 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 13:09:20,534 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:09:28,029 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 13:09:28,032 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:09:28,679 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 13:09:28,681 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:09:34,140 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 13:09:34,141 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:09:35,513 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 13:09:35,530 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 13:09:35,543 - ispa_next.main - DEBUG - Found new Appointment: SLÜ-RG 118
2025-11-17 13:09:35,575 - ispa_next.main - DEBUG - 



2025-11-17 13:09:35,575 - ispa_next.main - DEBUG - starting with process 17 (SLÜ-RG 118) of 18
2025-11-17 13:09:35,585 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:09:37,627 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:09:39,689 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 13:09:39,691 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 13:09:42,231 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:09:42,234 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:10:26,878 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:10:40,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:10:40,781 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:10:41,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:10:42,518 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:10:42,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:10:42,638 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:10:43,058 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:10:43,061 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:10:46,250 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:10:46,252 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:10:48,841 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:10:50,845 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:10:51,027 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:10:51,216 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:10:51,313 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:10:51,315 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:10:52,638 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:11:04,650 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:11:12,461 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:11:12,463 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:11:13,891 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:11:18,160 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:11:19,166 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:11:19,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:11:19,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:11:38,088 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:11:47,392 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:11:47,394 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:11:47,485 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:11:47,485 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:11:47,606 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:11:49,097 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:11:49,340 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:11:55,349 - ispa_next.functions - DEBUG - Updated appointment (AI00013589) customer contact data.
2025-11-17 13:11:56,344 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:11:56,395 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:11:57,845 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:11:57,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:11:59,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:12:04,189 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:12:04,189 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:12:05,075 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:12:05,318 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:12:05,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:12:06,823 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:12:10,981 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:12:10,986 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:12:10,986 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 13:12:10,987 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:12:13,006 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:12:13,008 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:12:14,733 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:12:14,737 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:12:14,740 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 13:12:14,743 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:12:14,745 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:12:14,747 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:12:14,748 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:12:14,750 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:12:14,752 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:12:14,753 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:12:14,755 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:12:15,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:12:16,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:12:47,470 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:12:47,473 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:12:47,475 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:12:47,476 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:50,260 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:12:50,263 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:12:50,268 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:53,100 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:12:53,102 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:12:53,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:12:54,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:12:54,604 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:13:01,902 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:13:01,905 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:13:01,908 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:13:02,534 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:13:03,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:13:03,946 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:13:14,778 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:13:21,238 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:13:28,147 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:13:28,150 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:13:28,151 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:13:29,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:13:29,288 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:13:29,290 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 13:13:29,316 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:13:36,827 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 13:13:36,831 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:13:37,650 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 13:13:37,652 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:13:43,153 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-17 13:13:43,154 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:13:45,518 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 13:13:45,534 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
2025-11-17 13:13:45,568 - ispa_next.main - DEBUG - 



2025-11-17 13:13:45,568 - ispa_next.main - DEBUG - starting with process 18 (FD-LL 99) of 18
2025-11-17 13:13:45,593 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:13:47,621 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:13:49,740 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 13:13:49,741 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-17 13:13:52,437 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:13:52,439 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:14:38,241 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:14:51,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:51,788 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:14:52,025 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:54,049 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:14:54,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:54,135 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:14:54,606 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:14:54,609 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:14:57,933 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:14:57,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:15:00,386 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:15:02,389 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:15:02,523 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:15:05,855 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:15:06,014 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:15:06,015 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:08,106 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:15:20,607 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:15:21,640 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:15:21,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:15:22,172 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:15:36,285 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 13:15:45,318 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:15:45,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:15:45,415 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:15:45,416 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:15:45,472 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:15:46,856 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:15:48,229 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:15:48,491 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:15:54,265 - ispa_next.functions - DEBUG - Updated appointment (AC00069237) customer contact data.
2025-11-17 13:15:55,233 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:15:55,284 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:15:56,485 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:15:56,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:15:58,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:16:02,345 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:16:02,345 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:16:02,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:16:02,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:16:04,996 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:16:05,115 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:16:05,271 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:16:05,413 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:16:05,415 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:16:07,545 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:16:19,435 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:16:28,683 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:16:28,684 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:16:30,801 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:16:35,072 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:16:36,079 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:16:36,080 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:16:36,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:16:36,198 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:16:40,356 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:16:40,363 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:16:40,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:16:40,463 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:16:40,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:41,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:41,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:16:42,712 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:16:42,714 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:16:44,883 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:16:44,886 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:16:46,842 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:16:46,844 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:16:46,847 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 13:16:46,851 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:16:46,853 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:16:46,862 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:16:46,864 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:16:46,867 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:16:46,870 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:16:46,872 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:16:46,875 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:16:47,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:16:49,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:17:21,532 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:17:21,534 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:17:21,537 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:17:21,537 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:24,428 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:17:24,430 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:17:24,431 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:27,223 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:17:27,225 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:17:27,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:17:28,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:17:29,049 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:46,059 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:17:46,061 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:17:46,064 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:17:46,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:17:47,877 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:17:48,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:58,196 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:18:06,034 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:18:06,036 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:18:06,038 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:18:06,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:18:06,862 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:18:06,864 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 13:18:06,888 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:18:14,113 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 13:18:14,118 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:18:15,011 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 13:18:15,012 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:18:21,388 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-17 13:18:21,389 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:18:22,534 - ispa_next.appointments.models - DEBUG - Appointment Christine Colette  WBAYH110105N09160 ohne Termin.
2025-11-17 13:18:22,552 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Hellmuth Schlöffel FD-CS 1223 WBAJP31070BT94128 ohne Termin.
