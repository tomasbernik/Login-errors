2025-11-12 13:01:24,477 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 13:01:24,494 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 13:01:33,843 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:01:47,253 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:02:03,123 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:02:29,624 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 13:02:47,788 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 13:02:50,747 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:02:52,216 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-12 13:02:52,218 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 278
2025-11-12 13:02:55,166 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 125
2025-11-12 13:02:55,167 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 13:02:55,169 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:02:56,474 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:02:57,866 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:03:25,658 - ispa_next.appointments.models - DEBUG - Appointment Bianca Christiane Liebrand NE-NU 73E WMW81GC09STA95325 ohne Termin.
2025-11-12 13:03:25,723 - ispa_next.appointments.models - DEBUG - Appointment Heinz Wiedermann NE-WJ 2608 WBA61EE0X05Y34631 ohne Termin.
2025-11-12 13:03:25,734 - ispa_next.appointments.models - DEBUG - Appointment Özlem Rezgul NE-RJ 3585 WBAWY31090L531048 ohne Termin.
2025-11-12 13:03:25,747 - ispa_next.appointments.models - DEBUG - Appointment Kuri Beines Schalweb. Kraw.Fab.Tu.Dr. GmbH & Co. K MG-NA 696 WBATR95030NA40057 ohne Termin.
2025-11-12 13:03:25,747 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:03:25,761 - ispa_next.appointments.models - DEBUG - Appointment Gertrud Wiest GV-HW 1978 WBAUZ35020N007842 ohne Termin.
2025-11-12 13:03:25,775 - ispa_next.appointments.models - DEBUG - Appointment Dieter Krautwald NE-DK 6000 WBAUZ35060N006497 ohne Termin.
2025-11-12 13:03:25,788 - ispa_next.appointments.models - DEBUG - Appointment Alexander Loresch NE-AT 6872 WBAUZ35020N033230 ohne Termin.
2025-11-12 13:03:25,839 - ispa_next.appointments.models - DEBUG - Appointment Liping Italia Moda GmbH NE-Z 5888 WBAVJ31050LR18129 ohne Termin.
2025-11-12 13:03:25,859 - ispa_next.appointments.models - DEBUG - Appointment   WBAFS51080C275059 ohne Termin.
2025-11-12 13:03:25,874 - ispa_next.appointments.models - DEBUG - Appointment Jörn Stefan Lohr NE-L 357 WMWSR11090T421441 ohne Termin.
2025-11-12 13:03:25,884 - ispa_next.appointments.models - DEBUG - Appointment UKM GmbH NE-KW 444 WMW41DL0403S04779 ohne Termin.
2025-11-12 13:03:25,897 - ispa_next.appointments.models - DEBUG - Appointment Anna Hildebrandt NE-AH 2222 WBA7K110407N28819 ohne Termin.
2025-11-12 13:03:25,912 - ispa_next.appointments.models - DEBUG - Appointment Marc Daniel Gawron NE-D 485 WBA1S110607B48065 ohne Termin.
2025-11-12 13:03:25,941 - ispa_next.main - DEBUG - Found 11 out of 37 appointments to process (configured limit: 15).
2025-11-12 13:03:25,942 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 13:03:25,943 - ispa_next.main - DEBUG - Processing 8 already visited appointments (w/ RKR not callable).
2025-11-12 13:03:25,943 - ispa_next.main - DEBUG - All appointments: S-L1688E, NE OS6000, NE-FP 2004, D-DI 8212, GV-M 1208, NE-RS 442, NE-NL 1985, NE-NG 306E, GV-M 567, NE-O 1212, NE-R 4000
2025-11-12 13:03:25,946 - ispa_next.main - DEBUG - 



2025-11-12 13:03:25,946 - ispa_next.main - DEBUG - starting with process 1 (S-L1688E) of 11
2025-11-12 13:03:25,952 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:03:27,173 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:03:28,623 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-12 13:03:28,624 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 125
2025-11-12 13:03:30,096 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:03:30,097 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:04:06,973 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:04:07,076 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 13:04:07,081 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:04:07,645 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-12 13:04:07,647 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:04:10,535 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 278
2025-11-12 13:04:10,536 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:04:11,468 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:04:11,477 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:04:11,486 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:04:11,494 - ispa_next.main - DEBUG - 



2025-11-12 13:04:11,494 - ispa_next.main - DEBUG - starting with process 2 (NE OS6000) of 11
2025-11-12 13:04:11,498 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:04:12,847 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:04:14,204 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-12 13:04:14,206 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 278
2025-11-12 13:04:15,697 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:04:15,699 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:04:52,424 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:04:52,434 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 13:04:52,437 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:04:52,970 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-12 13:04:52,971 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:04:56,033 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 278
2025-11-12 13:04:56,034 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:04:57,005 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:04:57,013 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:04:57,022 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:04:57,030 - ispa_next.main - DEBUG - 



2025-11-12 13:04:57,031 - ispa_next.main - DEBUG - starting with process 3 (NE-FP 2004) of 11
2025-11-12 13:04:57,034 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:04:58,357 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:04:59,899 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-12 13:04:59,901 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 278
2025-11-12 13:05:01,626 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:05:01,627 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:05:27,089 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:05:38,246 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:05:39,528 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:05:39,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:05:39,682 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:05:39,944 - ispa_next.functions - DEBUG - HU date soon to be invalid in 42 days.
2025-11-12 13:05:47,762 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:05:47,766 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:05:50,636 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:05:50,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:05:50,889 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 13:05:51,442 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 13:05:51,460 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:05:51,461 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:05:52,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:05:53,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:05:53,065 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 13:05:53,096 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 13:05:55,908 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 13:05:55,912 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:05:56,502 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-12 13:05:56,503 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:06:00,075 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 277
2025-11-12 13:06:00,076 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:06:01,365 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:06:01,377 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:06:01,394 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:06:01,408 - ispa_next.main - DEBUG - 



2025-11-12 13:06:01,408 - ispa_next.main - DEBUG - starting with process 4 (D-DI 8212) of 11
2025-11-12 13:06:01,433 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:06:02,928 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:06:04,371 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-12 13:06:04,372 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 277
2025-11-12 13:06:06,027 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:06:06,029 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:06:34,623 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:06:36,668 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:06:42,038 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:06:44,002 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:06:44,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:06:44,135 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:06:44,548 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:06:44,551 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:06:47,475 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:06:47,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:06:48,924 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:06:50,977 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:06:51,141 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:06:51,290 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:06:51,421 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:06:55,674 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:06:56,678 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:06:56,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:06:57,240 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:07:11,897 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:07:11,897 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:07:16,373 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:07:16,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:07:16,508 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:07:16,509 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:07:16,646 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:07:18,071 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:07:20,169 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:07:20,576 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:07:22,306 - ispa_next.functions - DEBUG - Updated appointment (AB00031635) customer contact data.
2025-11-12 13:07:23,229 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:07:23,231 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:07:24,105 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:07:24,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:07:24,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:07:28,641 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:07:28,641 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:07:28,644 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:07:28,647 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:07:28,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:07:29,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:07:37,883 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 13:07:46,537 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-12 13:07:51,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:07:52,493 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:07:52,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:07:53,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:07:53,278 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:07:55,393 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:07:55,396 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:07:56,737 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:07:56,740 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:07:56,750 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:07:56,751 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:07:56,752 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:07:56,755 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:07:56,757 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:07:56,758 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:07:56,760 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:07:56,761 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:07:56,763 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:07:56,769 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:07:56,772 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:07:56,773 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:07:58,904 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:07:58,907 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:07:58,910 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:08:00,990 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:08:00,992 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:08:00,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:08:02,001 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:08:02,459 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:08:13,576 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:08:13,578 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:08:15,670 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:08:28,130 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:08:28,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:08:29,220 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:08:29,393 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:08:48,380 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:08:53,585 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:08:53,588 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:08:53,589 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:08:54,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:08:54,535 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:08:54,537 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:08:56,572 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:09:09,276 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:09:09,662 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 13:09:10,605 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:09:11,411 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 605
2025-11-12 13:09:11,412 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:09:14,912 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 276
2025-11-12 13:09:14,912 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:09:15,747 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:09:15,760 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:09:15,774 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:09:15,783 - ispa_next.main - DEBUG - 



2025-11-12 13:09:15,783 - ispa_next.main - DEBUG - starting with process 5 (GV-M 1208) of 11
2025-11-12 13:09:15,786 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:09:17,127 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:09:18,469 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 605
2025-11-12 13:09:18,470 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 276
2025-11-12 13:09:20,124 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:09:20,125 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:09:47,024 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:09:49,042 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:09:54,280 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:09:56,302 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:09:56,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:09:56,436 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:09:56,757 - ispa_next.functions - DEBUG - HU date already expired after 23 days.
2025-11-12 13:10:01,333 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:10:01,337 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:10:04,246 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:10:04,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:10:05,372 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:10:07,376 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:10:07,512 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:10:07,655 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:10:07,736 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:10:11,994 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:10:12,999 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:10:13,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:10:13,478 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:10:27,216 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:10:27,216 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:10:31,743 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:10:31,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:10:31,897 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:10:31,899 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:10:31,999 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:10:33,885 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:10:35,235 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:10:35,580 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:10:37,294 - ispa_next.functions - DEBUG - Updated appointment (AD00015105) customer contact data.
2025-11-12 13:10:38,217 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:10:38,219 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:10:39,082 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:10:39,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:10:40,062 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:10:43,706 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:10:43,706 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:10:43,709 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:10:43,712 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:10:43,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:10:44,274 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:10:44,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:10:45,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:10:45,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:10:46,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:10:46,057 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:10:48,173 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:10:48,195 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:10:50,100 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:10:50,101 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:10:50,104 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:10:50,105 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:10:50,107 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:10:50,110 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:10:50,111 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:10:50,113 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:10:50,115 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:10:50,116 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:10:50,119 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:10:50,122 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:10:50,124 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:10:50,125 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:10:52,187 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:10:52,189 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:10:52,191 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:10:54,312 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:10:54,314 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:10:54,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:10:55,153 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:10:55,443 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:11:03,272 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:11:03,274 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:11:05,397 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:11:17,695 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:11:18,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:11:18,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:11:18,925 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:11:38,312 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:11:43,667 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:11:43,670 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:11:43,671 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:11:44,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:11:44,458 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:11:44,461 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:11:46,583 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:11:55,679 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:11:56,071 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 13:11:56,985 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:11:57,795 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 605
2025-11-12 13:11:57,797 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:12:01,242 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 276
2025-11-12 13:12:01,243 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:12:02,235 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:12:02,245 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:12:02,253 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:12:02,262 - ispa_next.main - DEBUG - 



2025-11-12 13:12:02,262 - ispa_next.main - DEBUG - starting with process 6 (NE-RS 442) of 11
2025-11-12 13:12:02,265 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:12:03,557 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:12:05,204 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 605
2025-11-12 13:12:05,206 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 276
2025-11-12 13:12:07,052 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:12:07,053 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:12:33,156 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:12:35,451 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:12:41,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:41,416 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:12:41,604 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:12:43,634 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:12:43,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:43,775 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:12:44,146 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:12:44,149 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:12:47,115 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:12:47,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:12:48,622 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:12:50,626 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:12:50,830 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:12:50,929 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:12:51,084 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:12:51,085 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:12:53,209 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:13:01,634 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:13:02,638 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:13:02,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:03,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:17,547 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:13:17,548 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:13:22,152 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:13:22,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:22,368 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:13:22,369 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:13:22,484 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:13:23,887 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:13:24,286 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:13:25,943 - ispa_next.functions - DEBUG - Updated appointment (AB00031685) customer contact data.
2025-11-12 13:13:26,856 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:13:26,858 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:13:27,832 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:13:27,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:13:28,649 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:13:32,240 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:13:32,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:32,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:13:34,779 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:13:34,915 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:13:35,053 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:13:35,193 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:13:35,194 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:13:37,236 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:13:45,624 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:14:45,629 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:14:53,946 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:15:33,949 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:15:42,292 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:15:50,729 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 13:15:51,736 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:15:51,741 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:15:51,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:15:51,881 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:15:57,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:15:57,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:15:57,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:15:58,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:15:58,695 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:16:00,739 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:16:00,771 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:16:02,029 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:16:02,031 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:16:02,035 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:16:02,038 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:16:02,040 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:16:02,044 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:16:02,046 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:16:02,051 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:16:02,055 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:16:02,056 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:16:02,059 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:16:02,062 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:16:02,064 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:16:02,065 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:16:04,033 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:16:04,035 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:16:04,038 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:16:06,080 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:16:06,083 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:16:06,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:16:06,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:16:07,019 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:16:07,026 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:16:08,998 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:16:21,115 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:16:21,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:16:22,644 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:16:22,952 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:16:42,224 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:16:47,712 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:16:47,715 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:16:47,716 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:16:48,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:16:48,660 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:16:48,662 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:16:50,594 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:16:59,271 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:16:59,639 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 13:17:00,594 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:17:01,340 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 607
2025-11-12 13:17:01,341 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:17:05,132 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 277
2025-11-12 13:17:05,133 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:17:06,079 - ispa_next.appointments.models - DEBUG - Appointment Marcel Mario Warten NE-XM 39 WBA3L510X0F811833 ohne Termin.
2025-11-12 13:17:06,092 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:17:06,104 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:17:06,119 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:17:06,129 - ispa_next.main - DEBUG - 



2025-11-12 13:17:06,129 - ispa_next.main - DEBUG - starting with process 7 (NE-NL 1985) of 11
2025-11-12 13:17:06,132 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:17:07,560 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:17:08,987 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 607
2025-11-12 13:17:08,988 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 277
2025-11-12 13:17:10,834 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:17:10,836 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:17:37,518 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:17:39,893 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:17:47,515 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:17:49,836 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:17:49,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:17:49,911 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:17:50,268 - ispa_next.functions - DEBUG - HU date already expired after 177 days.
2025-11-12 13:17:54,651 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:17:54,654 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:17:57,514 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:17:57,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:17:58,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:18:00,891 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:18:01,069 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:18:01,211 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:18:01,294 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:18:05,617 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:18:06,623 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:18:06,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:07,180 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:21,171 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:18:25,754 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:18:25,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:25,850 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:18:25,851 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:18:25,939 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:18:28,051 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:18:29,479 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:18:29,883 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:18:31,682 - ispa_next.functions - DEBUG - Updated appointment (AC00019139) customer contact data.
2025-11-12 13:18:32,586 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:18:32,588 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:18:33,532 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:18:33,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:18:34,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:18:38,182 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:18:38,182 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:18:38,186 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:18:38,191 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:18:38,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:18:38,868 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:18:39,308 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:39,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:39,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:18:40,719 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:18:40,721 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:18:42,807 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:18:42,810 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:18:44,037 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:18:44,039 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:18:44,041 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:18:44,042 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:18:44,043 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:18:44,046 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:18:44,048 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:18:44,049 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:18:44,052 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:18:44,054 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:18:44,057 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:18:44,061 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:18:44,063 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:18:44,064 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:18:46,204 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:18:46,206 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:18:46,208 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:18:48,267 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:18:48,268 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:18:48,269 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:18:49,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:18:49,697 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:18:59,176 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:18:59,179 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:19:01,177 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:19:14,189 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:19:14,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:19:15,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:19:15,403 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:19:33,920 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:19:39,587 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:19:39,590 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:19:39,591 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:19:40,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:19:40,456 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:19:40,458 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:19:42,645 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:19:51,695 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:19:52,077 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 13:19:53,215 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:19:53,956 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 607
2025-11-12 13:19:53,958 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:19:57,615 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 276
2025-11-12 13:19:57,616 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:19:58,627 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:19:58,639 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:19:58,649 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:19:58,655 - ispa_next.main - DEBUG - Found new Appointment: NE-XM 39
2025-11-12 13:19:58,656 - ispa_next.main - DEBUG - 



2025-11-12 13:19:58,656 - ispa_next.main - DEBUG - starting with process 8 (NE-XM 39) of 12
2025-11-12 13:19:58,660 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:20:00,038 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:20:01,508 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 607
2025-11-12 13:20:01,510 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 276
2025-11-12 13:20:03,290 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:20:03,291 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:20:31,995 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:20:42,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:43,083 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:20:43,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:20:44,667 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:20:44,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:44,817 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:20:45,083 - ispa_next.functions - DEBUG - HU date already expired after 61 days.
2025-11-12 13:20:53,523 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:20:53,526 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:20:56,411 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:20:56,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:20:57,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:20:59,868 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:21:00,023 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:21:03,254 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:21:03,336 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:21:03,338 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:21:04,838 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:21:13,841 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:21:14,845 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:21:14,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:21:15,349 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:21:32,443 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:21:41,309 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:21:41,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:21:41,441 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:21:41,442 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:21:41,488 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:21:43,053 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:21:44,806 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:21:45,128 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:21:47,910 - ispa_next.functions - DEBUG - Updated appointment (AB00031786) customer contact data.
2025-11-12 13:21:48,834 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:21:48,837 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:21:49,853 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:21:49,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:21:50,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:21:54,436 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:21:54,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:21:54,917 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:21:56,920 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:21:57,089 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:21:57,292 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:21:57,420 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:21:57,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:21:58,820 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:22:07,454 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:23:07,459 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:23:15,878 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:23:32,881 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:23:44,734 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:23:49,103 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:23:49,105 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:23:50,416 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:23:54,694 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:23:55,700 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:23:55,703 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:23:55,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:23:55,843 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:23:56,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:23:56,838 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:23:56,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:23:57,735 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:23:57,737 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:23:59,259 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:23:59,262 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:24:00,468 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:24:00,469 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:24:00,472 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:24:00,473 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 13:24:00,474 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:24:00,477 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:24:00,478 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:24:00,479 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:24:00,482 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:24:00,483 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:24:00,485 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:24:00,487 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:24:01,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 13:24:02,108 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 13:24:14,326 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:24:14,329 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:24:14,332 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:24:14,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:24:16,253 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:24:16,256 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:24:16,258 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:24:18,224 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:24:18,226 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:24:18,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:24:18,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:24:19,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:24:28,615 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:24:28,617 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:24:30,699 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:24:43,960 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:24:44,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:24:45,059 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:24:45,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:25:03,959 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:25:09,627 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:25:09,630 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:25:09,631 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:25:10,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:25:10,624 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:25:10,630 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:25:12,779 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:25:22,551 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:25:22,930 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 13:25:24,120 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:25:24,874 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 607
2025-11-12 13:25:24,876 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:25:28,864 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 275
2025-11-12 13:25:28,865 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:25:29,789 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:25:29,800 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:25:29,812 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:25:29,819 - ispa_next.main - DEBUG - 



2025-11-12 13:25:29,820 - ispa_next.main - DEBUG - starting with process 9 (NE-NG 306E) of 12
2025-11-12 13:25:29,823 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:25:31,221 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:25:32,695 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 607
2025-11-12 13:25:32,697 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 275
2025-11-12 13:25:34,434 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:25:34,436 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:26:03,545 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:26:05,791 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:26:11,501 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:13,500 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:26:13,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:13,623 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:26:13,925 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:26:13,928 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:26:16,847 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:26:16,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:20,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:26:22,101 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:26:22,242 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:26:22,410 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:26:22,534 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:26:26,764 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:26:27,771 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:26:27,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:28,244 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:42,842 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:26:47,795 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:26:47,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:47,912 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:26:47,913 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:26:47,996 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:26:49,510 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:26:51,084 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:26:51,428 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:26:53,812 - ispa_next.functions - DEBUG - Updated appointment (AB00031584) customer contact data.
2025-11-12 13:26:54,754 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:26:54,756 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:26:55,668 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:26:55,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:26:56,701 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:27:00,381 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:27:00,381 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:27:00,384 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:27:00,387 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:27:00,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:27:00,899 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:27:06,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:27:06,931 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:27:06,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:27:07,795 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:27:07,797 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:27:09,806 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:27:09,809 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:27:10,988 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:27:10,990 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:27:10,992 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:27:10,993 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:27:10,994 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:27:10,997 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:27:10,999 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:27:11,000 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:27:11,002 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:27:11,003 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:27:11,010 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:27:11,014 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:27:11,016 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:27:11,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:13,093 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:27:13,094 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:27:13,096 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:15,098 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:27:15,100 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:27:15,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:27:16,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:27:16,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:27,377 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:27:27,378 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:29,384 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:27:42,420 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:27:42,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:27:43,520 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:27:43,695 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:02,794 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:28:08,268 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:28:08,271 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:28:08,272 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:28:09,015 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:28:09,105 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:28:09,107 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:28:11,326 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:28:20,380 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:28:20,782 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 13:28:21,866 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:28:22,693 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 13:28:22,695 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:28:26,568 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 276
2025-11-12 13:28:26,569 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:28:27,622 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:28:27,632 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:28:27,982 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:28:27,999 - ispa_next.main - DEBUG - Found new Appointment: NE-KK 104
2025-11-12 13:28:28,002 - ispa_next.main - DEBUG - 



2025-11-12 13:28:28,002 - ispa_next.main - DEBUG - starting with process 10 (NE-KK 104) of 13
2025-11-12 13:28:28,006 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:28:29,435 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:28:30,974 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 13:28:30,975 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 276
2025-11-12 13:28:32,787 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:28:32,788 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:29:00,833 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:29:12,125 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:13,398 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:29:13,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:13,488 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:29:13,748 - ispa_next.functions - DEBUG - HU date already expired after 1587 days.
2025-11-12 13:29:22,220 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:29:22,223 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:29:25,077 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:29:25,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:29:26,624 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:29:28,628 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:29:28,751 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:29:32,057 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:29:41,226 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 13:29:42,232 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:29:42,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:42,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:58,910 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:30:07,933 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:30:07,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:08,031 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:30:08,032 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:30:08,103 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:30:08,221 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:30:09,641 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 13:30:10,999 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:30:11,426 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:30:14,189 - ispa_next.functions - DEBUG - Updated appointment (AB00031788) customer contact data.
2025-11-12 13:30:15,128 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:30:15,130 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:30:15,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:30:16,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:30:18,130 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:30:18,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:30:18,671 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:30:23,318 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:30:23,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:24,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:30:26,036 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:30:26,217 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:30:26,330 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:30:26,474 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:30:30,768 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:30:31,775 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:30:31,780 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:30:31,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:31,871 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:30:32,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:32,915 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:32,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:33,860 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:30:33,861 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:30:35,849 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:30:35,851 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:30:37,585 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:30:37,588 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:30:37,591 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:30:37,595 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 13:30:37,597 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:30:37,600 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:30:37,601 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:30:37,603 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:30:37,606 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:30:37,607 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:30:37,609 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:30:37,611 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:30:38,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 13:30:39,440 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 13:30:51,028 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:30:51,030 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:30:51,032 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:30:51,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:53,700 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:30:53,702 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:30:53,705 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:56,426 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:30:56,428 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:30:56,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:30:56,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:30:57,009 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:30:57,012 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:59,807 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:31:12,943 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:31:13,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:31:14,710 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:31:15,526 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:41,854 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:31:46,480 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:31:52,228 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:31:52,231 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:31:52,232 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:31:53,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:31:53,136 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:31:53,139 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:31:55,387 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:32:01,880 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 13:32:01,881 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:32:01,882 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:32:03,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:32:03,192 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:32:03,194 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:32:05,242 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-12 13:32:05,271 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 13:32:07,776 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 13:32:07,781 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:32:11,377 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 13:32:11,380 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:32:15,412 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 276
2025-11-12 13:32:15,413 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:32:17,045 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:32:17,053 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:32:17,062 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:32:17,069 - ispa_next.main - DEBUG - 



2025-11-12 13:32:17,069 - ispa_next.main - DEBUG - starting with process 11 (GV-M 567) of 13
2025-11-12 13:32:17,072 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:32:18,465 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:32:20,104 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 13:32:20,105 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 276
2025-11-12 13:32:22,043 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:32:22,044 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:32:50,155 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:32:53,412 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:33:03,889 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:33:12,496 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:33:12,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:12,644 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:33:12,933 - ispa_next.functions - DEBUG - HU date soon to be invalid in 89 days.
2025-11-12 13:33:18,117 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:33:18,120 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:33:21,021 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:33:21,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:33:22,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:33:24,466 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:33:24,600 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:33:24,728 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:33:24,842 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:33:29,107 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:33:30,113 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:33:30,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:30,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:45,313 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:33:50,286 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:33:50,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:50,455 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:33:50,456 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:33:50,563 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:33:50,736 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:33:52,493 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:33:52,852 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:33:54,711 - ispa_next.functions - DEBUG - Updated appointment (AG00009216) customer contact data.
2025-11-12 13:33:55,748 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:33:55,751 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:33:55,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:33:57,011 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:33:58,265 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:33:58,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:33:58,342 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:34:02,455 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:34:02,455 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:34:02,458 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:34:02,461 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:34:02,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:34:03,019 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:34:09,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:10,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:10,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:34:11,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:34:11,332 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:34:16,982 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:34:17,009 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:34:18,689 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:34:18,690 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:34:18,693 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:34:18,694 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:34:18,695 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:34:18,699 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:34:18,700 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:34:18,701 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:34:18,704 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:34:18,705 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:34:18,708 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:34:18,711 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:34:18,713 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:34:18,714 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:25,262 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 13:34:28,178 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:34:28,383 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:34:28,385 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:34,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:34:34,950 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:34:46,133 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:34:46,135 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:34:46,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:34:47,223 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:34:47,621 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:01,138 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:35:01,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:07,524 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:35:21,343 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:35:21,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:35:22,443 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:35:22,688 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:23,004 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:29,034 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:36,285 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:42,666 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:48,045 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:53,430 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:58,218 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:04,890 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:09,231 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:37:09,232 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:10,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:37:10,280 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:37:10,282 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:37:14,539 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:37:25,560 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:37:25,941 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 13:37:27,686 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:28,630 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 13:37:28,632 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:33,047 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 275
2025-11-12 13:37:33,048 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:37:34,071 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:37:34,082 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:37:34,094 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:37:34,100 - ispa_next.main - DEBUG - 



2025-11-12 13:37:34,100 - ispa_next.main - DEBUG - starting with process 12 (NE-O 1212) of 13
2025-11-12 13:37:34,103 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:35,575 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:37,130 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 13:37:37,131 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 275
2025-11-12 13:37:38,958 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:38,960 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:38:10,728 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:38:13,356 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:38:18,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:38:23,886 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:38:23,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:23,998 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:38:24,291 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:38:24,295 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:38:27,263 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:38:27,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:28,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:38:30,744 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:38:30,906 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:38:31,015 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:38:31,117 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:38:35,408 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:38:36,413 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:38:36,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:36,926 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:53,855 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:38:58,829 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:38:58,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:59,058 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:38:59,059 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:38:59,204 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:39:00,648 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:39:02,401 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:39:02,789 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:39:04,820 - ispa_next.functions - DEBUG - Updated appointment (AB00031294) customer contact data.
2025-11-12 13:39:05,729 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:39:05,827 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:39:06,801 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:39:06,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:39:07,906 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:39:11,582 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:39:11,582 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:39:11,587 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:39:11,591 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:39:11,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:39:12,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:39:15,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:39:16,234 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:39:16,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:39:17,084 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:39:17,086 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:39:21,583 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:39:21,592 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:39:22,708 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:39:22,729 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:39:22,738 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:39:22,739 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:39:22,740 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:39:22,743 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:39:22,744 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:39:22,745 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:39:22,747 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:39:22,748 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:39:22,751 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:39:22,754 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:39:22,757 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:39:22,757 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:27,942 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 13:39:30,875 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:39:30,970 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:39:31,101 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:35,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:39:36,056 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:39:47,705 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:39:47,707 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:39:47,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:39:49,672 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:39:49,922 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:40:02,107 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:40:02,109 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:40:06,987 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:40:20,427 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:40:20,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:40:21,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:40:21,739 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:08,412 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:41:14,980 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:41:20,015 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:41:25,777 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:41:31,764 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:41:37,649 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:41:42,164 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:41:42,165 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:41:42,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:41:43,144 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:41:43,146 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:41:47,110 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:41:56,870 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:41:57,261 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 13:41:59,024 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:41:59,922 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 13:41:59,924 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:42:04,793 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 274
2025-11-12 13:42:04,794 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:42:05,842 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:42:05,854 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:42:05,863 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:42:05,868 - ispa_next.main - DEBUG - Found new Appointment: M-MC 294E
2025-11-12 13:42:05,870 - ispa_next.main - DEBUG - 



2025-11-12 13:42:05,870 - ispa_next.main - DEBUG - starting with process 13 (M-MC 294E) of 14
2025-11-12 13:42:05,873 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:42:07,252 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:42:08,837 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 13:42:08,839 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 274
2025-11-12 13:42:10,816 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:42:10,818 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:42:52,253 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:43:04,074 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:43:08,262 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:43:08,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:43:08,373 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:43:08,756 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:43:20,103 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:43:20,106 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:43:23,152 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:43:23,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:43:24,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:43:26,576 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:43:26,731 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:43:26,874 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:43:27,008 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:43:31,278 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:43:32,282 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:43:32,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:43:32,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:43:50,689 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:44:00,032 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:44:00,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:44:00,206 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:44:00,207 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:44:00,302 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:44:01,871 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:44:02,518 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:44:06,532 - ispa_next.functions - DEBUG - Updated appointment (AB00031791) customer contact data.
2025-11-12 13:44:07,576 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:44:07,580 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:44:08,645 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:44:08,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:44:09,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:44:13,464 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:44:13,464 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:44:13,467 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:44:13,470 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:44:13,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:44:14,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:44:14,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:44:15,624 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:44:15,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:44:16,437 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:44:16,439 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:44:20,240 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:44:20,242 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:44:21,623 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:44:21,624 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:44:21,628 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:44:21,631 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 13:44:21,632 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:44:21,639 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:44:21,640 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:44:21,642 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:44:21,648 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:44:21,650 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:44:21,654 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:44:21,656 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:44:22,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 13:44:23,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 13:44:35,382 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:44:35,385 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:44:35,387 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:44:35,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:40,217 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:44:40,219 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:44:40,221 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:45,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:44:45,540 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:44:57,418 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:45:13,458 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:45:13,460 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:45:13,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:45:14,496 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:45:14,751 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:45:25,457 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:45:25,459 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:45:30,259 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:45:43,756 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:45:44,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:45:44,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:45:45,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:46:31,499 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:46:38,433 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:46:44,502 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:46:50,210 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:46:56,277 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:02,461 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:10,067 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:47:10,067 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:47:10,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:47:10,952 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:47:10,955 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:47:15,491 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:47:25,956 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:47:26,361 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 13:47:28,491 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:47:29,475 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 13:47:29,477 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:47:33,880 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 274
2025-11-12 13:47:33,881 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:47:34,948 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:47:34,962 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:47:34,975 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
2025-11-12 13:47:34,991 - ispa_next.main - DEBUG - 



2025-11-12 13:47:34,991 - ispa_next.main - DEBUG - starting with process 14 (NE-R 4000) of 14
2025-11-12 13:47:34,996 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:47:36,472 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:47:37,856 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 13:47:37,857 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 274
2025-11-12 13:47:39,656 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:47:39,658 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:48:23,607 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:48:25,963 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:48:31,627 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:48:35,082 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:48:35,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:48:35,193 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:48:35,727 - ispa_next.functions - DEBUG - HU date already expired after 18 days.
2025-11-12 13:48:40,704 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:48:40,706 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:48:43,678 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:48:43,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:48:45,244 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:48:47,247 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:48:47,398 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:48:47,520 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:48:47,654 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:48:51,845 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:48:52,850 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:48:52,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:48:53,368 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:08,109 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:49:13,385 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:49:13,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:13,556 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:49:13,557 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:49:13,688 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:49:15,252 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:49:15,859 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:49:19,243 - ispa_next.functions - DEBUG - Updated appointment (AK00008642) customer contact data.
2025-11-12 13:49:20,253 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:49:20,254 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:49:21,299 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:49:21,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:49:22,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:49:26,188 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:49:26,188 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:49:26,193 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:49:26,197 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:49:26,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:49:26,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:49:27,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:27,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:27,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:49:28,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:49:28,414 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:49:31,681 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:49:31,683 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:49:32,872 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:49:32,874 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:49:32,877 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:49:32,878 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:49:32,879 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:49:32,881 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:49:32,882 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:49:32,883 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:49:32,886 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:49:32,887 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:49:32,890 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:49:32,893 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:49:32,896 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:49:32,897 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:36,454 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:49:36,458 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:49:36,460 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:39,818 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:49:39,820 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:49:39,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:49:41,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:49:41,361 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:51,267 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:49:51,271 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:54,858 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:50:08,044 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:50:08,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:50:09,274 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:50:09,471 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:50:42,293 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:50:47,812 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:50:53,888 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:51:00,523 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:51:00,525 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:51:00,525 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:51:01,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:51:01,362 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:51:01,387 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:51:03,662 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:51:13,358 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:51:13,739 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 13:51:15,033 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:51:16,000 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 13:51:16,002 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:51:20,440 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 272
2025-11-12 13:51:20,441 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:51:21,505 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 5 WBA5V31030FK27975 ohne Termin.
2025-11-12 13:51:21,513 - ispa_next.appointments.models - DEBUG - Appointment FS Fahrschule NRW GmbH NE-FN 80 WBA5V31080FK59742 ohne Termin.
2025-11-12 13:51:21,522 - ispa_next.appointments.models - DEBUG - Appointment Heike Piotrowski NE-HT 930 WBA1R510905K60595 ohne Termin.
