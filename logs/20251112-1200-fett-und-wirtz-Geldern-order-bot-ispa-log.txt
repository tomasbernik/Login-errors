2025-11-12 12:00:43,643 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 12:00:43,648 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 12:01:00,710 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:01:12,496 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:01:28,023 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:03:26,669 - ispa_next.app_start.main - DEBUG - Operation already took 106.54 seconds (more than 80 seconds)
2025-11-12 12:03:28,741 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_btfqv9c5_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_btfqv9c5', 'txt']
2025-11-12 12:03:29,071 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:03:29,077 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:03:29,079 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:05:28,556 - ispa_next.app_start.main - DEBUG - Operation already took 107.09 seconds (more than 80 seconds)
2025-11-12 12:05:30,615 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_w39zzzhe_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_w39zzzhe', 'txt']
2025-11-12 12:05:30,835 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:05:30,840 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:05:37,466 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 12:05:45,398 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:05:56,978 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:06:12,371 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:08:10,053 - ispa_next.app_start.main - DEBUG - Operation already took 106.60 seconds (more than 80 seconds)
2025-11-12 12:08:12,113 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_644wwlsw_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_644wwlsw', 'txt']
2025-11-12 12:08:12,344 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:08:12,348 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:08:12,348 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:10:11,686 - ispa_next.app_start.main - DEBUG - Operation already took 107.03 seconds (more than 80 seconds)
2025-11-12 12:10:13,768 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_bl36jm4o_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_bl36jm4o', 'txt']
2025-11-12 12:10:14,018 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:10:14,022 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:10:21,013 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 12:10:27,660 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:10:40,260 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:10:55,798 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:12:53,915 - ispa_next.app_start.main - DEBUG - Operation already took 107.07 seconds (more than 80 seconds)
2025-11-12 12:12:55,986 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_tvl0dct4_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_tvl0dct4', 'txt']
2025-11-12 12:12:56,211 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:12:56,215 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:12:56,215 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:14:55,213 - ispa_next.app_start.main - DEBUG - Operation already took 106.72 seconds (more than 80 seconds)
2025-11-12 12:14:57,266 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_f7ldco69_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_f7ldco69', 'txt']
2025-11-12 12:14:57,538 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:14:57,544 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:15:04,045 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-12 12:15:14,923 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:15:25,905 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:15:41,374 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:17:38,766 - ispa_next.app_start.main - DEBUG - Operation already took 106.34 seconds (more than 80 seconds)
2025-11-12 12:17:40,828 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_yaaglkgs_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\ae42f7f734a48050\\tess_yaaglkgs', 'txt']
2025-11-12 12:17:41,060 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:17:41,064 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:17:41,066 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:18:05,799 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 12:18:19,746 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 12:18:22,054 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:18:22,879 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:18:22,881 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 195
2025-11-12 12:18:24,845 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 195
2025-11-12 12:18:24,846 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 12:18:24,846 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:18:25,661 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:18:26,444 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:18:54,579 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:54,588 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:54,607 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:54,633 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Franz Tönnessen KLE-JT 304 WBA3A11000J283456 ohne Termin.
2025-11-12 12:18:54,647 - ispa_next.appointments.models - DEBUG - Appointment Daria Kamila Kolodziej KLE-QR 734 WBA8L71060K555733 ohne Termin.
2025-11-12 12:18:54,671 - ispa_next.appointments.models - DEBUG - Appointment Oliver Christian Wiegand MH-WI 1001 WMWZM31040T035812 ohne Termin.
2025-11-12 12:18:54,681 - ispa_next.appointments.models - DEBUG - Appointment Rabiullah Arash GEL-NK 786 WBAWZ510800M35552 ohne Termin.
2025-11-12 12:18:54,683 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:54,684 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:54,684 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:54,684 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:54,704 - ispa_next.main - DEBUG - Found 15 out of 47 appointments to process (configured limit: 15).
2025-11-12 12:18:54,705 - ispa_next.main - DEBUG - Processing 10 fresh appointments.
2025-11-12 12:18:54,706 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 12:18:54,706 - ispa_next.main - DEBUG - All appointments: KLE-HE 136, GEL-JP 25, LÖWN93, MO-FP 2023, KLE F 404, KLE S 7711, GEL RG111, M-D-3722, KR-SW7373, GEL VW 25, BM-R 220E, GEL-AH 22E, GEL-F 6363, KLE-B 1268, KLE-W 5828
2025-11-12 12:18:54,710 - ispa_next.main - DEBUG - 



2025-11-12 12:18:54,710 - ispa_next.main - DEBUG - starting with process 1 (KLE-HE 136) of 15
2025-11-12 12:18:54,713 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:18:55,836 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:18:56,928 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:18:56,930 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 195
2025-11-12 12:18:58,386 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:18:58,388 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:19:24,449 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:19:34,378 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:19:38,299 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:19:38,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:38,390 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:19:38,623 - ispa_next.functions - DEBUG - HU date already expired after 16 days.
2025-11-12 12:19:45,123 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:19:45,125 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:19:45,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:45,233 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:19:54,452 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:19:54,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:55,284 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:19:57,289 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:19:57,412 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:20:00,619 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:20:00,698 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:20:04,877 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:20:05,890 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:20:05,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:06,380 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:18,253 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:20:25,569 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:20:25,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:25,657 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:20:25,658 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:20:25,691 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:20:25,814 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:20:27,159 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:20:27,425 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:20:30,792 - ispa_next.functions - DEBUG - Updated appointment (AL00014291) customer contact data.
2025-11-12 12:20:31,714 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:20:31,716 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:20:31,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:20:32,477 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:20:33,994 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:20:33,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:20:34,063 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:20:37,691 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:20:37,691 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:20:37,695 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:20:37,699 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:20:37,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:38,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:20:38,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:39,156 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:39,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:39,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:20:39,811 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:20:43,919 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:20:43,922 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:20:45,018 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:20:45,020 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:20:45,024 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug maschinell waschen/aussaugen (kostenlos): active placement guards
2025-11-12 12:20:45,024 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=AU / § Hauptuntersuchung / Paketpreis, source=from_tab, target=cart)}
2025-11-12 12:20:45,026 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:20:45,030 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:20:45,030 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:20:45,032 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:20:45,042 - ispa_next.package_manager.main - DEBUG - found packages to delete: {Package(name=§ Fahrzeuguntersuchung, source=cart, target=trash)}
2025-11-12 12:20:45,046 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:20:45,052 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:20:45,056 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 12:20:45,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:20:46,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:20:56,181 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:20:56,181 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 12:20:58,529 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:20:59,054 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:20:59,998 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:21:00,608 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:21:01,147 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:21:02,085 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:21:02,643 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:21:03,181 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:21:04,146 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:21:04,759 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:21:05,277 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:21:07,068 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:21:07,617 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:21:08,154 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:21:09,094 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:21:09,647 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:21:10,212 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:21:11,137 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:21:11,713 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:21:12,240 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:21:13,185 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:21:14,059 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:21:14,061 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:21:14,062 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:18,688 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 12:21:21,164 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:21:21,212 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:21:21,216 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:25,845 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:21:25,846 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:21:25,847 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:21:25,849 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:30,398 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:21:43,251 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:21:43,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:21:44,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:21:44,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:52,882 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:21:58,185 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:21:58,187 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:21:58,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:21:58,985 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:21:58,987 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:22:02,264 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:22:10,990 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:22:11,366 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 12:22:12,330 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:22:12,814 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:22:12,815 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:22:15,340 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 194
2025-11-12 12:22:15,341 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:22:16,088 - ispa_next.main - DEBUG - 



2025-11-12 12:22:16,088 - ispa_next.main - DEBUG - starting with process 2 (GEL-JP 25) of 15
2025-11-12 12:22:16,091 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:22:16,962 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:22:17,920 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:22:17,921 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 194
2025-11-12 12:22:19,263 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:22:19,265 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:22:38,675 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:22:48,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:48,651 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:22:48,822 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:22:50,664 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:22:50,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:50,726 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:22:50,913 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:22:50,915 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:22:50,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:51,006 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:23:00,665 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:23:00,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:01,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:23:03,620 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:23:03,736 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:23:06,971 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:23:07,043 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:23:07,043 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:23:15,171 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:23:16,174 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:23:16,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:16,632 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:29,668 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:23:36,117 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:23:36,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:36,217 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:23:36,217 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:23:36,260 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:23:36,370 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:23:37,749 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:23:37,959 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:23:40,932 - ispa_next.functions - DEBUG - Updated appointment (AL00014289) customer contact data.
2025-11-12 12:23:41,868 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:23:41,869 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:23:41,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:23:42,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:23:43,805 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:23:43,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:23:43,870 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:23:48,310 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:23:48,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:48,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:23:50,793 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:23:50,892 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:23:50,994 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:23:51,055 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:23:51,055 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:23:59,742 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:24:59,746 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:25:08,049 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:25:39,052 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:25:47,039 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:25:54,179 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 12:25:55,186 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:25:55,188 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:25:55,188 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 12:25:55,193 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:25:57,624 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:25:57,627 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:25:58,968 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:25:58,969 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:25:58,977 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug maschinell waschen/aussaugen (kostenlos): active placement guards
2025-11-12 12:25:58,980 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:25:58,981 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:25:58,985 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:25:58,986 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:25:58,987 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:25:58,990 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:25:58,992 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:25:58,994 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:25:58,997 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:25:58,999 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:25:59,000 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:01,534 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:26:01,536 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:26:01,540 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:04,109 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:26:04,110 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:26:04,112 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:26:04,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:06,669 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:26:19,409 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:26:20,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:26:20,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:26:20,835 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:27,251 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:26:32,686 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:26:32,687 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:26:33,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:26:33,253 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:26:33,256 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:26:36,243 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:26:43,762 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:26:44,145 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 12:26:44,619 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:26:45,259 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:26:45,259 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:26:48,217 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 194
2025-11-12 12:26:48,218 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:26:49,146 - ispa_next.main - DEBUG - 



2025-11-12 12:26:49,147 - ispa_next.main - DEBUG - starting with process 3 (LÖWN93) of 15
2025-11-12 12:26:49,151 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:26:50,403 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:26:51,444 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:26:51,446 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 194
2025-11-12 12:26:52,633 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:26:52,634 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:27:21,681 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:27:22,336 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 12:27:22,338 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:27:22,722 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:27:22,732 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:27:24,764 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 194
2025-11-12 12:27:24,765 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:27:25,391 - ispa_next.main - DEBUG - 



2025-11-12 12:27:25,391 - ispa_next.main - DEBUG - starting with process 4 (MO-FP 2023) of 15
2025-11-12 12:27:25,397 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:27:26,238 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:27:27,295 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:27:27,296 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 194
2025-11-12 12:27:28,861 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:27:28,863 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:27:59,704 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:27:59,713 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 12:27:59,718 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:28:00,318 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:28:00,320 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:28:02,826 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 194
2025-11-12 12:28:02,827 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:28:03,645 - ispa_next.main - DEBUG - 



2025-11-12 12:28:03,645 - ispa_next.main - DEBUG - starting with process 5 (KLE F 404) of 15
2025-11-12 12:28:03,649 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:28:04,749 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:28:05,729 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:28:05,730 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 194
2025-11-12 12:28:06,974 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:28:06,975 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:28:36,270 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:28:36,280 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 12:28:36,285 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:28:36,779 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:28:36,780 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:28:39,479 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 194
2025-11-12 12:28:39,479 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:28:40,390 - ispa_next.main - DEBUG - 



2025-11-12 12:28:40,390 - ispa_next.main - DEBUG - starting with process 6 (KLE S 7711) of 15
2025-11-12 12:28:40,394 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:28:41,553 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:28:42,794 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:28:42,795 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 194
2025-11-12 12:28:44,058 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:28:44,059 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:29:15,437 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:29:15,446 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 12:29:15,450 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:29:15,951 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:29:15,952 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:29:18,070 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 194
2025-11-12 12:29:18,071 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:29:18,683 - ispa_next.main - DEBUG - 



2025-11-12 12:29:18,683 - ispa_next.main - DEBUG - starting with process 7 (GEL RG111) of 15
2025-11-12 12:29:18,686 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:29:19,680 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:29:20,954 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:29:20,955 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 194
2025-11-12 12:29:22,386 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:29:22,387 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:29:53,477 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:29:53,488 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 12:29:53,491 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:29:53,959 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:29:53,961 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:29:56,643 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 194
2025-11-12 12:29:56,644 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:29:57,491 - ispa_next.main - DEBUG - 



2025-11-12 12:29:57,491 - ispa_next.main - DEBUG - starting with process 8 (M-D-3722) of 15
2025-11-12 12:29:57,495 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:29:58,713 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:29:59,863 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:29:59,865 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 194
2025-11-12 12:30:01,103 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:30:01,105 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:30:32,234 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:30:32,248 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 12:30:32,252 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:30:32,734 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:30:32,736 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:30:35,474 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 194
2025-11-12 12:30:35,475 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:30:36,262 - ispa_next.main - DEBUG - 



2025-11-12 12:30:36,262 - ispa_next.main - DEBUG - starting with process 9 (KR-SW7373) of 15
2025-11-12 12:30:36,266 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:30:37,500 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:30:38,791 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:30:38,793 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 194
2025-11-12 12:30:40,358 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:30:40,360 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:31:12,332 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:31:12,342 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 12:31:12,344 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:31:12,812 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:31:12,812 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:31:15,894 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 194
2025-11-12 12:31:15,895 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:31:16,796 - ispa_next.main - DEBUG - 



2025-11-12 12:31:16,796 - ispa_next.main - DEBUG - starting with process 10 (GEL VW 25) of 15
2025-11-12 12:31:16,799 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:31:18,152 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:31:19,496 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:31:19,497 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 194
2025-11-12 12:31:20,894 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:31:20,896 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:31:52,974 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:31:52,984 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 12:31:52,988 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:31:53,453 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:31:53,454 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:31:56,216 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 194
2025-11-12 12:31:56,216 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:31:57,188 - ispa_next.main - DEBUG - 



2025-11-12 12:31:57,188 - ispa_next.main - DEBUG - starting with process 11 (BM-R 220E) of 15
2025-11-12 12:31:57,192 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:31:58,402 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:31:59,585 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 424
2025-11-12 12:31:59,586 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 194
2025-11-12 12:32:00,697 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:32:00,698 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:32:22,948 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:32:24,826 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:32:30,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:32:34,740 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:32:34,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:32:34,804 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:32:34,984 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 12:32:38,434 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:32:38,436 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:32:38,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:32:38,498 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:32:41,532 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:32:41,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:32:42,372 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:32:44,377 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:32:44,473 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:32:44,601 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:32:44,672 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:32:48,903 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:32:49,924 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:32:49,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:32:50,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:03,285 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:33:07,608 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:33:07,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:07,679 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:33:07,679 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:33:07,725 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:33:08,956 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:33:09,201 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:33:10,441 - ispa_next.functions - DEBUG - Updated appointment (BB00024105) customer contact data.
2025-11-12 12:33:11,362 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:33:11,364 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:33:12,150 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:33:12,152 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:33:12,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:33:16,562 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:33:16,562 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:33:16,577 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:33:16,581 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:33:16,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:33:17,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:33:26,145 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 12:33:30,512 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 12:33:30,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:31,013 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:31,015 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:33:31,721 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:33:31,723 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:33:35,887 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:33:35,890 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:33:37,042 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:33:37,044 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:33:37,047 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:33:37,048 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:33:37,052 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:33:37,052 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:33:37,056 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:33:37,057 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:33:37,061 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:33:37,070 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:33:37,072 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:33:37,072 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:33:41,671 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:33:41,671 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:33:41,673 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:33:46,260 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:33:46,261 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:33:46,263 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:33:46,265 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:33:50,852 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:34:03,507 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:34:04,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:34:04,621 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:34:04,739 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:34:13,674 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:34:17,172 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:34:17,174 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:34:17,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:34:17,884 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:34:17,890 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:34:21,329 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:34:29,135 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:34:29,516 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 12:34:30,259 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:34:30,903 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 425
2025-11-12 12:34:30,903 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:34:33,926 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 195
2025-11-12 12:34:33,926 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:34:34,900 - ispa_next.main - DEBUG - Found new Appointment: KLE-DH 228
2025-11-12 12:34:34,902 - ispa_next.main - DEBUG - 



2025-11-12 12:34:34,902 - ispa_next.main - DEBUG - starting with process 12 (KLE-DH 228) of 16
2025-11-12 12:34:34,906 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:34:35,975 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:34:37,173 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 425
2025-11-12 12:34:37,174 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 195
2025-11-12 12:34:38,636 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:34:38,638 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:35:01,694 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:35:11,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:11,853 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:35:12,039 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:35:14,006 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:35:14,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:14,085 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:35:14,394 - ispa_next.functions - DEBUG - HU date already expired after 32 days.
2025-11-12 12:35:21,033 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:35:21,035 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:35:21,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:21,089 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:35:30,291 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:35:30,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:35:31,322 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:35:33,327 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:35:33,494 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:35:33,632 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:35:33,727 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:35:33,735 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:35:45,294 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 12:35:49,995 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:35:49,996 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:35:52,120 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:35:53,135 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:35:53,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:53,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:36:05,452 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:36:05,452 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:36:13,228 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:36:13,230 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:36:13,302 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:36:13,303 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:36:13,376 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:36:14,580 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:36:15,712 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:36:15,929 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:36:19,097 - ispa_next.functions - DEBUG - Updated appointment (AL00014306) customer contact data.
2025-11-12 12:36:19,987 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:36:19,990 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:36:21,202 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:36:21,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:36:21,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:36:25,496 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:36:25,496 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:36:25,499 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:36:25,501 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:36:25,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:36:25,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:36:26,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:36:26,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:36:26,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:36:27,478 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:36:27,480 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:36:30,525 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:36:30,527 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:36:31,401 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:36:31,403 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:36:31,407 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug maschinell waschen/aussaugen (kostenlos): active placement guards
2025-11-12 12:36:31,411 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=AU / § Hauptuntersuchung / Paketpreis, source=from_tab, target=cart)}
2025-11-12 12:36:31,413 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:36:31,415 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:36:31,417 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:36:31,417 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:36:31,421 - ispa_next.package_manager.main - DEBUG - found packages to delete: {Package(name=§ Fahrzeuguntersuchung, source=cart, target=trash)}
2025-11-12 12:36:31,421 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:36:31,425 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:36:31,427 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 12:36:32,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:36:32,698 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:36:42,078 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:36:42,079 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 12:36:44,079 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:36:44,611 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:36:46,392 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:36:46,995 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:36:47,516 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:36:48,449 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:36:49,012 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:36:49,539 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:36:50,470 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:36:51,023 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:36:51,607 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:36:52,532 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:36:53,091 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:36:53,631 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:36:54,581 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:36:55,451 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:36:55,454 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:36:55,455 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:58,725 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:36:58,727 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:36:58,731 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:01,935 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:37:01,937 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:37:01,937 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:37:01,945 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:05,083 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:37:16,759 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:20,206 - ispa_next.common.mail - INFO - Successfully sent an email to 3 recipients
2025-11-12 12:37:20,210 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:37:20,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:37:21,500 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:37:21,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:28,301 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:37:33,661 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:37:33,661 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:37:34,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:37:34,220 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:37:34,222 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:37:37,210 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:37:43,539 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 12:37:43,541 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:37:43,630 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:37:44,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:37:45,004 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:37:45,005 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:37:47,943 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-12 12:37:47,971 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 12:37:50,385 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 12:37:50,387 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:37:50,825 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 425
2025-11-12 12:37:50,826 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:37:53,668 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 195
2025-11-12 12:37:53,668 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:37:54,353 - ispa_next.main - DEBUG - 



2025-11-12 12:37:54,353 - ispa_next.main - DEBUG - starting with process 13 (GEL-AH 22E) of 16
2025-11-12 12:37:54,379 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:37:55,701 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:37:56,615 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 425
2025-11-12 12:37:56,616 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 195
2025-11-12 12:37:58,212 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:37:58,215 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:38:22,430 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:38:24,442 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:38:29,213 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:38:31,779 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:38:31,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:38:31,852 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:38:32,060 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:38:32,062 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:38:32,062 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:38:32,187 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:38:35,333 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:38:35,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:38:36,376 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:38:38,381 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:38:38,479 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:38:38,610 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:38:38,681 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:38:42,867 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:38:43,880 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:38:43,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:38:44,377 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:38:55,829 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:38:55,829 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:38:59,902 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:38:59,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:38:59,976 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:38:59,978 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:39:00,036 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:39:01,453 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:39:01,668 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:39:02,930 - ispa_next.functions - DEBUG - Updated appointment (BB00024057) customer contact data.
2025-11-12 12:39:03,859 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:39:03,859 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:39:04,473 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:39:04,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:39:05,118 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:39:08,714 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:39:08,714 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:39:08,717 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:39:08,719 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:39:08,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:39:09,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:39:18,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:18,842 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:18,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:39:19,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:39:19,499 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:39:21,971 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:39:21,975 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:39:23,296 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:39:23,298 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:39:23,302 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:39:23,304 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:39:23,322 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:39:23,326 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:39:23,330 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:39:23,332 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:39:23,353 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:39:23,355 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:39:23,357 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:39:23,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:25,947 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:39:25,949 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:39:25,951 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:28,431 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:39:28,433 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:39:28,434 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:39:28,436 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:30,927 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:39:43,829 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:39:44,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:39:45,178 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:39:45,306 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:51,935 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:39:55,533 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:39:55,535 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:39:56,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:39:56,266 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:39:56,268 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:39:59,732 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:40:07,752 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:40:08,138 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 12:40:08,888 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:40:09,619 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 425
2025-11-12 12:40:09,620 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:40:12,838 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 195
2025-11-12 12:40:12,839 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:40:13,640 - ispa_next.main - DEBUG - 



2025-11-12 12:40:13,640 - ispa_next.main - DEBUG - starting with process 14 (GEL-F 6363) of 16
2025-11-12 12:40:13,643 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:40:14,748 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:40:16,017 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 425
2025-11-12 12:40:16,018 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 195
2025-11-12 12:40:17,308 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:40:17,309 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:40:39,940 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:40:41,752 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:40:47,111 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:40:52,398 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:40:52,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:40:52,473 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:40:52,657 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 12:40:56,756 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:40:56,758 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:40:56,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:40:56,820 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:40:59,665 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:40:59,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:41:01,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:41:03,137 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:41:03,285 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:41:03,389 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:41:03,458 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:41:07,679 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:41:08,683 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:41:08,684 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:09,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:21,256 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:41:25,548 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:41:25,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:25,646 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:41:25,646 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:41:25,680 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:41:26,897 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:41:28,061 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:41:28,259 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:41:29,635 - ispa_next.functions - DEBUG - Updated appointment (BB00025221) customer contact data.
2025-11-12 12:41:30,545 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:41:30,547 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:41:31,700 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:41:31,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:41:32,504 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:41:36,594 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:41:36,595 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:41:36,597 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:41:36,601 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:41:36,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:41:37,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:41:37,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:37,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:37,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:41:38,592 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:41:38,596 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:41:43,357 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:41:43,358 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:41:44,833 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:41:44,835 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:41:44,840 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:41:44,843 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:41:44,848 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:41:44,849 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:41:44,850 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:41:44,852 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:41:44,855 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:41:44,859 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:41:44,861 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:41:44,863 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:41:44,864 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:41:50,184 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:41:50,186 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:41:50,188 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:41:55,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:41:55,542 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:42:07,131 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:22,001 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:42:22,002 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:42:22,004 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:42:22,006 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:27,332 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-12 12:42:35,267 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:42:51,989 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:42:52,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:42:54,001 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:42:54,161 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:43:03,820 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:43:07,410 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:43:07,411 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:43:08,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:43:08,145 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:43:08,145 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:43:11,903 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:43:20,106 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:43:20,481 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 12:43:21,568 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:43:22,154 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 425
2025-11-12 12:43:22,156 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:43:24,881 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 195
2025-11-12 12:43:24,882 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:43:25,651 - ispa_next.main - DEBUG - 



2025-11-12 12:43:25,652 - ispa_next.main - DEBUG - starting with process 15 (KLE-B 1268) of 16
2025-11-12 12:43:25,655 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:43:26,756 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:43:27,957 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 425
2025-11-12 12:43:27,959 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 195
2025-11-12 12:43:29,367 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:43:29,368 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:44:11,501 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:44:11,513 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 12:44:11,518 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:44:12,099 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 425
2025-11-12 12:44:12,100 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:44:14,577 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 195
2025-11-12 12:44:14,577 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:44:15,375 - ispa_next.main - DEBUG - 



2025-11-12 12:44:15,375 - ispa_next.main - DEBUG - starting with process 16 (KLE-W 5828) of 16
2025-11-12 12:44:15,378 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:44:16,522 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:44:17,602 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 425
2025-11-12 12:44:17,604 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 195
2025-11-12 12:44:19,069 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:44:19,070 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:44:47,205 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:44:49,480 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:44:54,271 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:44:57,502 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:44:57,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:44:57,614 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:44:57,813 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:44:57,815 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:44:57,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:44:57,896 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:45:00,893 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:45:00,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:02,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:45:04,504 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:45:04,630 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:45:04,732 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:45:04,853 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:45:09,084 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:45:10,090 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:45:10,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:10,639 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:22,892 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:45:27,282 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:45:27,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:27,366 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:45:27,366 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:45:27,409 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:45:27,502 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:45:28,801 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:45:29,014 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:45:30,868 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:45:30,869 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:45:30,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:45:31,784 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:45:32,789 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:45:32,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:45:32,862 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:45:36,429 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:45:36,429 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:45:36,432 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:45:36,442 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:45:36,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:37,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:45:41,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:41,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:41,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:42,614 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:45:42,617 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:45:45,609 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:45:45,609 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:45:46,538 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:45:46,540 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:45:46,543 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:45:46,545 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:45:46,549 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:45:46,566 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:45:46,568 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:45:46,571 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:45:46,572 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:45:46,575 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:45:46,576 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:45:46,578 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:45:46,578 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:49,855 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:45:49,857 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:45:49,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:53,160 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:45:53,162 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:45:53,164 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:45:53,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:56,401 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:46:09,729 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:46:10,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:46:11,126 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:46:11,268 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:46:18,728 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:46:22,316 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:46:22,316 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:46:23,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:46:23,108 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:46:23,109 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:46:26,460 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:46:33,860 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:46:34,259 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 12:46:35,005 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:46:35,521 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 425
2025-11-12 12:46:35,522 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:46:37,940 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 195
2025-11-12 12:46:37,941 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
