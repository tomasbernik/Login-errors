2025-11-17 05:01:32,630 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 05:01:32,636 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 05:01:50,783 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 05:02:05,623 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 05:02:22,692 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:03:42,408 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 05:04:04,871 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 05:04:09,379 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:04:11,382 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1520
2025-11-17 05:04:11,384 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 458
2025-11-17 05:04:14,548 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 341
2025-11-17 05:04:14,549 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 05:04:14,550 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 05:04:16,145 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 05:04:17,600 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:05:26,487 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,511 - ispa_next.appointments.models - DEBUG - Appointment Frau Yanhong Sha BA-YS 531 WBA31DZ070FK02591 ohne Termin.
2025-11-17 05:05:26,545 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Mihaela Becheanu LIF.LM.92 WBA8C31080A086188, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='LIF.LM.92', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-17 05:05:26,567 - ispa_next.appointments.models - DEBUG - Appointment Herr Matthias Möller BA-MM 511 WBAJM71020B067894 ohne Termin.
2025-11-17 05:05:26,568 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,587 - ispa_next.appointments.models - DEBUG - Appointment Herr Bernhard Möhrlein BA-ZZ 43 WBAHF11030WW89645 ohne Termin.
2025-11-17 05:05:26,610 - ispa_next.appointments.models - DEBUG - Appointment Herr Stefan Endres BA-LE 234 WBA1C71000J948537 ohne Termin.
2025-11-17 05:05:26,614 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,625 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,640 - ispa_next.appointments.models - DEBUG - Appointment Siegfried Geißler  WBA51EG0505W23667 ohne Termin.
2025-11-17 05:05:26,649 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,672 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,685 - ispa_next.appointments.models - DEBUG - Appointment Frau Alexandra Wolf BA-AW 555 WBY8P210607K30883 ohne Termin.
2025-11-17 05:05:26,686 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,687 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,687 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,688 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,690 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,723 - ispa_next.appointments.models - DEBUG - Appointment Firma Minges Kaffeerösterei GmbH BA-MK 540 WBA11GR0409Y69237 ohne Termin.
2025-11-17 05:05:26,729 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,772 - ispa_next.appointments.models - DEBUG - Appointment Herr Bastian Stern HÖS-S 1312 WBA4J51020BN80220 ohne Termin.
2025-11-17 05:05:26,794 - ispa_next.appointments.models - DEBUG - Appointment Herr Stephan Nätscher BA-MN 1019 WBA7K310307J40556 ohne Termin.
2025-11-17 05:05:26,809 - ispa_next.appointments.models - DEBUG - Appointment Firma Kraftanlagen Energies & M-KA 2446 WBA41EG0905Z23353 ohne Termin.
2025-11-17 05:05:26,834 - ispa_next.appointments.models - DEBUG - Appointment Frau Franziska Berg BA-JP 1720 WMWLN710202E75045 ohne Termin.
2025-11-17 05:05:26,842 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,856 - ispa_next.appointments.models - DEBUG - Appointment Herr Jürgen Manfred Suppe BA-SU 380 WBY61EF0305W96365 ohne Termin.
2025-11-17 05:05:26,868 - ispa_next.appointments.models - DEBUG - Appointment Herr Gunter Kirsch BA-BK 746 WBA2E510205G50991 ohne Termin.
2025-11-17 05:05:26,870 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:26,883 - ispa_next.appointments.models - DEBUG - Appointment Firma Andreas Wagner Vertriebs GmbH HAS-W 3690 WBA15BZ070N298504 ohne Termin.
2025-11-17 05:05:26,994 - ispa_next.appointments.models - DEBUG - Appointment Firma Erlanger Treuhand GmbH ER-TR 70E WBA21GV020CU74535 ohne Termin.
2025-11-17 05:05:27,031 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:27,055 - ispa_next.appointments.models - DEBUG - Appointment Frau Aslihan Karaman NÖ-AK 5252 WBAHT710305K01893 ohne Termin.
2025-11-17 05:05:27,080 - ispa_next.appointments.models - DEBUG - Appointment Generalstaatsanwaltschaft BA-N 1017E WBA51BX0607T37782 ohne Termin.
2025-11-17 05:05:27,136 - ispa_next.appointments.models - DEBUG - Appointment Herr Josef Reuß KG-TR 899 WBA8H91030A719314 ohne Termin.
2025-11-17 05:05:27,164 - ispa_next.appointments.models - DEBUG - Appointment Firma Elektro Weis GmbH & Co. KG BA-XX 621 WMW61DL0503P86044 ohne Termin.
2025-11-17 05:05:27,199 - ispa_next.appointments.models - DEBUG - Appointment Frau Birgitta Helmstetter BA-A 607 WBA7K310507K49097 ohne Termin.
2025-11-17 05:05:27,231 - ispa_next.appointments.models - DEBUG - Appointment Herr Wolfgang Kießwetter BA-CL 16 WBA4A51060D408079 ohne Termin.
2025-11-17 05:05:27,253 - ispa_next.appointments.models - DEBUG - Appointment Firma bornheim GmbH & Co. KG BA-M 180 WBA11GF0107R40264 ohne Termin.
2025-11-17 05:05:27,267 - ispa_next.appointments.models - DEBUG - Appointment Herr Adam Jacek Kesminowicz BA-KA 91 WBAHT710505J98589 ohne Termin.
2025-11-17 05:05:27,281 - ispa_next.appointments.models - DEBUG - Appointment Frau Inge Kimbrough WUN-NY 111 WBA31AD0303L79467 ohne Termin.
2025-11-17 05:05:27,304 - ispa_next.appointments.models - DEBUG - Appointment Herr Peter Kupsch BA-PK 12 WBAHS910805H68893 ohne Termin.
2025-11-17 05:05:27,328 - ispa_next.appointments.models - DEBUG - Appointment Frau Jennifer Crayne ERH-JD 604 WMW51DK0102T47698 ohne Termin.
2025-11-17 05:05:27,335 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:05:27,360 - ispa_next.appointments.models - DEBUG - Appointment Herr Rainer Andreas Rebel BA-TR 2003 WBAPP11070E794980 ohne Termin.
2025-11-17 05:05:27,384 - ispa_next.appointments.models - DEBUG - Appointment Firma MG-Nährmittel Produktservice BA-M 8013 WBSAE01020CE87488 ohne Termin.
2025-11-17 05:05:27,397 - ispa_next.appointments.models - DEBUG - Appointment Herr Alexander Erdpohl BA-AE 779 WBA8H91000K868189 ohne Termin.
2025-11-17 05:05:27,448 - ispa_next.main - DEBUG - Found 1 out of 207 appointments to process (configured limit: 15).
2025-11-17 05:05:27,448 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-17 05:05:27,448 - ispa_next.main - DEBUG - All appointments: HAS-PX 9
2025-11-17 05:05:27,451 - ispa_next.main - DEBUG - 



2025-11-17 05:05:27,451 - ispa_next.main - DEBUG - starting with process 1 (HAS-PX 9) of 1
2025-11-17 05:05:27,457 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:05:28,918 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:05:30,776 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1520
2025-11-17 05:05:30,778 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-17 05:05:32,684 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:05:32,685 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:06:16,033 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:06:28,182 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:06:38,462 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:06:38,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:06:38,629 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:06:38,918 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:06:38,932 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:06:38,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:06:39,067 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:06:42,468 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:06:42,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:06:43,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:06:45,855 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:06:46,042 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:06:46,169 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:06:46,283 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:06:46,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:06:57,258 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:07:09,323 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:07:10,354 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:07:10,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:07:10,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:07:25,617 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 05:07:25,618 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 05:07:35,194 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:07:35,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:07:35,304 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:07:35,305 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:07:35,431 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:07:36,938 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:07:37,390 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:07:42,970 - ispa_next.functions - DEBUG - Updated appointment (AC00041419) customer contact data.
2025-11-17 05:07:43,927 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:07:43,989 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:07:45,139 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:07:45,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:07:46,196 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:07:49,855 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:07:49,856 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:07:50,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:07:52,411 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:07:52,602 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:07:52,702 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:07:52,844 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:07:52,846 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:08:03,696 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:08:15,607 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:08:23,579 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:08:23,581 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:08:34,300 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:08:38,563 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:08:39,571 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:08:39,572 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:08:39,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:08:39,655 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:08:43,796 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 05:08:43,803 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:08:43,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:08:43,885 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:08:49,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:08:50,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:08:50,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:08:50,897 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:08:50,904 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:09:00,416 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:09:00,418 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:09:01,448 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:09:01,450 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:09:01,456 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:09:01,457 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:09:01,463 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:09:01,465 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=BMW Sicher in den Winter, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-17 05:09:01,466 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:09:01,475 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:09:01,476 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:09:01,483 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:09:01,485 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 05:09:02,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 05:09:03,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 05:09:20,689 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 05:09:20,694 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:09:20,697 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:09:20,698 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:09:31,212 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:09:31,217 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:09:31,220 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:09:41,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:09:42,118 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:09:52,071 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:09:52,071 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 05:09:52,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:10:02,568 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:10:02,572 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:10:02,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:10:12,962 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:10:30,350 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:10:30,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:10:31,628 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:10:31,808 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:11:12,746 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:11:12,746 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:11:13,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:11:13,834 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:11:13,840 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:11:20,765 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 05:11:28,770 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 05:11:33,993 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 05:11:34,000 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:11:34,779 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1520
2025-11-17 05:11:34,781 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:11:38,945 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 458
2025-11-17 05:11:38,946 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:11:39,914 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:11:39,941 - ispa_next.appointments.models - DEBUG - Appointment Frau Yanhong Sha BA-YS 531 WBA31DZ070FK02591 ohne Termin.
