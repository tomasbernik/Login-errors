2025-11-17 15:01:25,189 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 15:01:25,297 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 15:01:38,956 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 15:01:49,760 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 15:02:05,589 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:02:33,099 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 15:02:55,674 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 15:02:59,309 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:03:00,786 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 861
2025-11-17 15:03:00,787 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 289
2025-11-17 15:03:03,906 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-17 15:03:03,907 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 15:03:03,907 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:03:05,311 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:03:06,767 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:03:34,885 - ispa_next.appointments.models - DEBUG - Appointment Kamran Abdolvahab  WBA5F710X0A465811 ohne Termin.
2025-11-17 15:03:34,905 - ispa_next.appointments.models - DEBUG - Appointment Thorsten Schwarz FT-T 171 WBAEN510X0PC21387 ohne Termin.
2025-11-17 15:03:34,918 - ispa_next.appointments.models - DEBUG - Appointment  NW-G 3322 WBATX55010NV20982 ohne Termin.
2025-11-17 15:03:34,932 - ispa_next.appointments.models - DEBUG - Appointment Peter Manger SÜW-PM 20 WBY71GM0405396367 ohne Termin.
2025-11-17 15:03:34,962 - ispa_next.appointments.models - DEBUG - Appointment Reiner Buhl NW-RB 277 WBA5V71040AH89228 ohne Termin.
2025-11-17 15:03:34,982 - ispa_next.appointments.models - DEBUG - Appointment Liza-Simona Dragoi NW-SL 648 WBAVA71010PS02943 ohne Termin.
2025-11-17 15:03:34,992 - ispa_next.appointments.models - DEBUG - Appointment Tanja Heller NW-TH 11 WBA6K31020FK00800 ohne Termin.
2025-11-17 15:03:35,004 - ispa_next.appointments.models - DEBUG - Appointment Michele Guastaferro LU-CM 231 WBAJC31010G871442 ohne Termin.
2025-11-17 15:03:35,005 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:03:35,013 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Al Ghaban NW-U 1076 WBAUY51010A886925 ohne Termin.
2025-11-17 15:03:35,024 - ispa_next.appointments.models - DEBUG - Appointment Markus Hengst  WBA1H11070VW96664 ohne Termin.
2025-11-17 15:03:35,033 - ispa_next.appointments.models - DEBUG - Appointment Weingut Reichsrat v. Buhl GmbH DÜW-RB 92 E WBA81CY080FS07302 ohne Termin.
2025-11-17 15:03:35,041 - ispa_next.appointments.models - DEBUG - Appointment Dimitri Blatner BB-DL 2908 WBAUT31030A863939 ohne Termin.
2025-11-17 15:03:35,049 - ispa_next.appointments.models - DEBUG - Appointment Nadine Hoffner NW-NH 79 WBAUE31070E070551 ohne Termin.
2025-11-17 15:03:35,057 - ispa_next.appointments.models - DEBUG - Appointment Rolf Dörr SÜW-BR 122 WBAHF11030WW43975 ohne Termin.
2025-11-17 15:03:35,065 - ispa_next.appointments.models - DEBUG - Appointment Ingrid Reinhardt NW-AR 16 WBAVN11090VN28373 ohne Termin.
2025-11-17 15:03:35,075 - ispa_next.appointments.models - DEBUG - Appointment Michael Reipert SÜW-R 7606 WBAJM71040B267868 ohne Termin.
2025-11-17 15:03:35,084 - ispa_next.appointments.models - DEBUG - Appointment Bianca Rieken WL-PP 2022 WBAUZ35030NE43537 ohne Termin.
2025-11-17 15:03:35,093 - ispa_next.appointments.models - DEBUG - Appointment Hans-Joachim Vesterling NW-UJ 68 WBA31BL090WW88639 ohne Termin.
2025-11-17 15:03:35,104 - ispa_next.appointments.models - DEBUG - Appointment Christian Mergl MA-CL 2310 WBAJM91090BH38833 ohne Termin.
2025-11-17 15:03:35,116 - ispa_next.appointments.models - DEBUG - Appointment Marc Ullemeyer GER-MU 27 WBAPF51040A428573 ohne Termin.
2025-11-17 15:03:35,134 - ispa_next.appointments.models - DEBUG - Appointment Jutta Inge Laubersheimer LD-L 400 WBA6L31090FK52101 ohne Termin.
2025-11-17 15:03:35,154 - ispa_next.appointments.models - DEBUG - Appointment Schulz Rainer HD-SP 550 WBAJP510X0BU55337 ohne Termin.
2025-11-17 15:03:35,168 - ispa_next.appointments.models - DEBUG - Appointment Sissy Klinger NW-S WBA1V710007A63233 ohne Termin.
2025-11-17 15:03:35,180 - ispa_next.appointments.models - DEBUG - Appointment Jetmire Idrizi NW-J 1999 WBAJF31070BS70122 ohne Termin.
2025-11-17 15:03:35,190 - ispa_next.appointments.models - DEBUG - Appointment Marcel Haupenthal SÜW-HM 256 WBA5F310X0FJ07362 ohne Termin.
2025-11-17 15:03:35,197 - ispa_next.appointments.models - DEBUG - Appointment Marco Röper RP-MP 210 WBAJC31010B050886 ohne Termin.
2025-11-17 15:03:35,205 - ispa_next.appointments.models - DEBUG - Appointment Andreas Friedrichsen NW-AF 46 WBAUZ35040N027624 ohne Termin.
2025-11-17 15:03:35,213 - ispa_next.appointments.models - DEBUG - Appointment Thomas Herbert Leydecker SÜW-LT 882 WBA6L71030FJ30924 ohne Termin.
2025-11-17 15:03:35,221 - ispa_next.appointments.models - DEBUG - Appointment Eduard Schall NW-ES 164 WBATX35010NC06188 ohne Termin.
2025-11-17 15:03:35,229 - ispa_next.appointments.models - DEBUG - Appointment Eduard Ludvig NW-IC 9000 WBA6L51000FJ00638 ohne Termin.
2025-11-17 15:03:35,237 - ispa_next.appointments.models - DEBUG - Appointment David Jauch SÜW-SD 712 WBAMX11050DY05841 ohne Termin.
2025-11-17 15:03:35,245 - ispa_next.appointments.models - DEBUG - Appointment Karl-Friedrich Deidesheimer NW-EF 57 WBAUM91080VR96138 ohne Termin.
2025-11-17 15:03:35,254 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Schröder NW-XO 2 WBA5F71000FH03378 ohne Termin.
2025-11-17 15:03:35,262 - ispa_next.appointments.models - DEBUG - Appointment I & C Nebel GmbH NW-IC 808 WBATX35070NE03852 ohne Termin.
2025-11-17 15:03:35,270 - ispa_next.appointments.models - DEBUG - Appointment Andreas Röhle SÜW-T 811 WBATX75090N056853 ohne Termin.
2025-11-17 15:03:35,278 - ispa_next.appointments.models - DEBUG - Appointment Schwanen Apotheke GER-NE 320 WBA6L51060FH68494 ohne Termin.
2025-11-17 15:03:35,286 - ispa_next.appointments.models - DEBUG - Appointment Matthias Glass SÜW-JG 309 WBA5F71080FH06299 ohne Termin.
2025-11-17 15:03:35,294 - ispa_next.appointments.models - DEBUG - Appointment   WBA1V710905K77064 ohne Termin.
2025-11-17 15:03:35,303 - ispa_next.appointments.models - DEBUG - Appointment Manfred Lenz DÜW-L 57 WBAHT910805J05575 ohne Termin.
2025-11-17 15:03:35,311 - ispa_next.appointments.models - DEBUG - Appointment Dritan Krijeziu NW-E 1991 WBAKS410800C35366 ohne Termin.
2025-11-17 15:03:35,320 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Lemke NW-L 803 WBAAP91090JH89911 ohne Termin.
2025-11-17 15:03:35,332 - ispa_next.appointments.models - DEBUG - Appointment Noel Rapp SÜW-GR 119 WBA2E510X05G52214 ohne Termin.
2025-11-17 15:03:35,346 - ispa_next.appointments.models - DEBUG - Appointment Jan Rudolph NW-JR 1987 WBA5L31000G079266 ohne Termin.
2025-11-17 15:03:35,359 - ispa_next.appointments.models - DEBUG - Appointment Theberio Covaci RP-TA 108 WBAPB11020WE43180 ohne Termin.
2025-11-17 15:03:35,372 - ispa_next.appointments.models - DEBUG - Appointment Stefan Ebeling NW-GZ 4 WBAHF11080WW82481 ohne Termin.
2025-11-17 15:03:35,386 - ispa_next.appointments.models - DEBUG - Appointment Günther Werner Taube DÜW-GT 11 WBACV610X09D54605 ohne Termin.
2025-11-17 15:03:35,395 - ispa_next.appointments.models - DEBUG - Appointment Christiane Drewes-Wright NW-CD 23 WBAUL91040VF72459 ohne Termin.
2025-11-17 15:03:35,403 - ispa_next.appointments.models - DEBUG - Appointment Sabine Gallina-Zabilski SÜW-SG 67 WBADV710X0E533595 ohne Termin.
2025-11-17 15:03:35,411 - ispa_next.appointments.models - DEBUG - Appointment Hannelore Jung NW-H 778 WBAVF51000VF82703 ohne Termin.
2025-11-17 15:03:35,416 - ispa_next.main - DEBUG - Found 3 out of 14 appointments to process (configured limit: 15).
2025-11-17 15:03:35,416 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-17 15:03:35,416 - ispa_next.main - DEBUG - All appointments: NW-LD 28, KIB-HU 508, SÜW-GA 11
2025-11-17 15:03:35,419 - ispa_next.main - DEBUG - 



2025-11-17 15:03:35,419 - ispa_next.main - DEBUG - starting with process 1 (NW-LD 28) of 3
2025-11-17 15:03:35,422 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:03:36,810 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:03:38,323 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 861
2025-11-17 15:03:38,324 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-17 15:03:40,039 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:03:40,040 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:04:21,764 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:04:32,941 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:04:36,296 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:04:36,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:04:36,443 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:04:36,788 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:04:36,791 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:04:39,715 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:04:39,716 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:04:41,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:04:43,048 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:04:43,211 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:04:46,504 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:04:46,909 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:04:46,910 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:04:50,379 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:05:01,985 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:05:02,990 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:05:02,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:05:03,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:05:16,250 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:05:25,254 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:05:25,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:05:25,444 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:05:25,445 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:05:25,505 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:05:26,955 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:05:28,488 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:05:28,830 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:05:32,436 - ispa_next.functions - DEBUG - Updated appointment (AA00025060) customer contact data.
2025-11-17 15:05:33,413 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:05:33,417 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:05:34,390 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:05:34,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:05:35,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:05:38,818 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:05:38,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:05:39,325 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:05:41,329 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:05:41,482 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:05:41,630 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:05:41,804 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:05:41,806 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:45,298 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:05:57,211 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 15:06:04,776 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:06:04,778 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:06:08,170 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:06:12,413 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:06:13,419 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:06:13,419 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:06:13,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:06:13,503 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:06:17,700 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 15:06:18,822 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 15:06:33,859 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:06:33,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:06:34,050 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:06:34,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:06:35,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:06:35,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:06:36,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:06:36,202 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:06:39,416 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:06:39,419 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:06:41,316 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:06:41,318 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:06:41,321 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-17 15:06:41,322 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-17 15:06:41,324 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeugoberwäsche und Aussaugen, source=from_tab, target=cart)}
2025-11-17 15:06:41,325 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:06:41,328 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:06:41,330 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter.Relax. We care., source=from_tab, target=advice_list)}
2025-11-17 15:06:41,331 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:06:41,334 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:06:41,335 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:06:41,339 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:06:41,344 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:06:42,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:06:43,801 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:06:51,122 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:06:51,123 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 15:06:51,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:06:52,075 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 15:07:00,496 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:07:00,498 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:07:00,499 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:07:00,500 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:04,647 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:07:04,650 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:07:04,654 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:08,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:07:09,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:07:19,939 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:39,893 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:07:39,894 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:07:39,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:07:41,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:07:41,307 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:48,628 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:07:48,630 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:08:11,465 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:08:12,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:08:12,721 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:08:13,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:08:51,618 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:08:51,619 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:08:53,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:08:53,531 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:08:53,533 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:09:01,975 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:09:24,531 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:09:25,075 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 15:09:29,662 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:09:31,109 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 863
2025-11-17 15:09:31,112 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:09:37,779 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 292
2025-11-17 15:09:37,781 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:09:39,466 - ispa_next.appointments.models - DEBUG - Appointment Fahrschule Wittmer FT-WI 223 WBA5V31080FM99874 ohne Termin.
2025-11-17 15:09:39,477 - ispa_next.appointments.models - DEBUG - Appointment Kamran Abdolvahab  WBA5F710X0A465811 ohne Termin.
2025-11-17 15:09:39,486 - ispa_next.appointments.models - DEBUG - Appointment Barbara Brödel PS-BB 232 WBA21BX0507L93456 ohne Termin.
2025-11-17 15:09:39,491 - ispa_next.main - DEBUG - Found new Appointment: NW-JI 74
2025-11-17 15:09:39,491 - ispa_next.main - DEBUG - Found new Appointment: NW-RF 68
2025-11-17 15:09:39,492 - ispa_next.main - DEBUG - 



2025-11-17 15:09:39,493 - ispa_next.main - DEBUG - starting with process 2 (NW-JI 74) of 5
2025-11-17 15:09:39,496 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:09:42,264 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:09:45,287 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 863
2025-11-17 15:09:45,289 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 292
2025-11-17 15:09:48,800 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:09:48,802 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:10:45,670 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:11:03,089 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:11:05,092 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:11:05,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:11:05,251 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:11:05,893 - ispa_next.functions - DEBUG - HU date already expired after 877 days.
2025-11-17 15:11:19,092 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:11:19,094 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:11:23,092 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:11:23,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:11:25,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:11:27,215 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:11:27,471 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:11:30,851 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:11:31,066 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:11:33,740 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:11:34,746 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:11:34,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:11:35,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:11:53,215 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:12:07,119 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:12:07,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:07,278 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:12:07,279 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:12:07,418 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:12:07,694 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:12:09,531 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:12:09,880 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:12:13,458 - ispa_next.functions - DEBUG - Updated appointment (AA00025063) customer contact data.
2025-11-17 15:12:14,642 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:12:14,802 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:12:15,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:12:16,530 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:12:18,897 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:12:18,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:12:19,267 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:12:22,973 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:12:22,973 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:12:22,977 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:12:22,978 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:12:22,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:23,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:12:27,819 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 15:12:29,604 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 15:12:45,266 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:12:45,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:45,444 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:12:49,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:49,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:49,729 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:50,829 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:12:50,831 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:12:52,979 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:12:52,998 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:12:55,450 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:12:55,453 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:12:55,458 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-17 15:12:55,461 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Bremsscheiben vorn auf min. Stärke prüfe, source=from_tab, target=cart), Package(name=Fahrzeugoberwäsche und Aussaugen, source=from_tab, target=cart)}
2025-11-17 15:12:55,465 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:12:55,470 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:12:55,471 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter.Relax. We care., source=from_tab, target=advice_list)}
2025-11-17 15:12:55,473 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:12:55,476 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:12:55,478 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:12:55,481 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:12:55,483 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:12:56,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:12:57,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:13:13,894 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:13:13,895 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 15:13:14,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:13:14,780 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 15:13:23,016 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:13:23,018 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:13:23,019 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:13:23,020 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:13:26,465 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:13:26,466 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:13:26,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:13:30,032 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:13:30,033 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:13:30,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:13:31,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:13:31,290 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:13:48,393 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:13:48,395 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:14:11,019 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:14:11,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:14:12,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:14:12,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:14:49,560 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:14:59,124 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:15:07,631 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:15:16,602 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:15:16,604 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:15:16,605 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:15:18,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:15:18,267 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:15:18,269 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:15:22,730 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:15:38,766 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 15:15:38,768 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:15:38,769 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:15:40,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:15:40,411 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:15:40,412 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:15:43,539 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 15:15:43,587 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:15:53,091 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 15:15:53,093 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:15:54,401 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-17 15:15:54,403 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-17 15:16:01,427 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 289
2025-11-17 15:16:01,428 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:16:03,179 - ispa_next.appointments.models - DEBUG - Appointment Barbara Brödel PS-BB 232 WBA21BX0507L93456 ohne Termin.
2025-11-17 15:16:03,186 - ispa_next.main - DEBUG - 



2025-11-17 15:16:03,186 - ispa_next.main - DEBUG - starting with process 3 (NW-RF 68) of 5
2025-11-17 15:16:03,189 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:16:05,980 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:16:09,035 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-17 15:16:09,038 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 289
2025-11-17 15:16:12,291 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-17 15:16:12,292 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:16:12,981 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 40, in process_appointment
    open_appointment(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 148, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-17 15:16:12,981 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 15:16:12,984 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:16:14,283 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-17 15:16:14,288 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-17 15:16:21,083 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 289
2025-11-17 15:16:21,084 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:16:22,909 - ispa_next.appointments.models - DEBUG - Appointment Barbara Brödel PS-BB 232 WBA21BX0507L93456 ohne Termin.
2025-11-17 15:16:22,926 - ispa_next.main - DEBUG - 



2025-11-17 15:16:22,927 - ispa_next.main - DEBUG - starting with process 4 (KIB-HU 508) of 5
2025-11-17 15:16:22,936 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:16:25,801 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:16:29,082 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-17 15:16:29,084 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 289
2025-11-17 15:16:32,600 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:16:32,603 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:17:27,421 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:17:45,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:45,605 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:45,998 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:17:47,310 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:17:47,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:47,532 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:48,076 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:17:48,079 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:17:51,460 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:17:51,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:17:53,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:17:55,651 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:17:55,844 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:17:59,260 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:17:59,436 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:17:59,438 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:18:00,895 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:18:14,412 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:18:15,418 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:18:15,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:18:15,983 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:18:34,334 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:18:48,655 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:18:48,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:18:48,801 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:18:48,802 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:18:48,910 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:18:50,371 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:18:52,120 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:18:52,478 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:18:57,355 - ispa_next.functions - DEBUG - Updated appointment (AA00025055) customer contact data.
2025-11-17 15:18:58,465 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:18:58,509 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:19:00,399 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:19:00,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:19:01,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:19:06,397 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:19:06,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:07,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:19:09,114 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:19:09,305 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:19:09,615 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:19:09,758 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:19:09,760 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:11,956 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:19:23,329 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:19:32,314 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:19:32,315 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:34,427 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:19:38,730 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:19:39,744 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:19:39,745 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:19:39,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:39,936 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:19:44,226 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:19:44,230 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:19:44,230 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:44,346 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:19:50,062 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:19:50,716 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:19:50,717 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:51,923 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:19:51,926 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:19:54,183 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:19:54,187 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:19:56,084 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:19:56,088 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:19:56,091 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-17 15:19:56,092 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-17 15:19:56,094 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeugoberwäsche und Aussaugen, source=from_tab, target=cart)}
2025-11-17 15:19:56,096 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:19:56,099 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-17 15:19:56,100 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:19:56,102 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:19:56,103 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:19:56,106 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:19:56,107 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:19:56,110 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:19:56,112 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:19:56,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:19:58,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:20:06,248 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:20:06,250 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:20:06,251 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:20:06,252 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:08,936 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:20:08,937 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:20:08,940 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:11,689 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:20:11,691 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:20:11,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:20:12,639 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:20:13,157 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:25,040 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:20:25,041 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:20:51,836 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:20:52,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:53,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:20:53,597 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:21:22,620 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:21:31,019 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:21:40,063 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:21:40,065 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:21:40,066 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:21:41,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:21:41,842 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:21:41,843 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:21:46,271 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:22:05,170 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:22:05,642 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 15:22:09,598 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:22:11,077 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-17 15:22:11,079 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:22:18,018 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 289
2025-11-17 15:22:18,019 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:22:19,772 - ispa_next.appointments.models - DEBUG - Appointment Barbara Brödel PS-BB 232 WBA21BX0507L93456 ohne Termin.
2025-11-17 15:22:19,778 - ispa_next.main - DEBUG - 



2025-11-17 15:22:19,778 - ispa_next.main - DEBUG - starting with process 5 (SÜW-GA 11) of 5
2025-11-17 15:22:19,781 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:22:22,587 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:22:25,723 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-17 15:22:25,725 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 289
2025-11-17 15:22:29,175 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:22:29,177 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:23:28,183 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:23:46,633 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:23:47,928 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:23:47,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:48,087 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:23:48,615 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:23:48,619 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:23:52,275 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:23:52,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:23:54,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:23:56,659 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:23:56,888 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:23:57,113 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:23:57,320 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:24:01,728 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:24:02,735 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:24:02,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:03,245 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:21,777 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:24:36,215 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:24:36,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:36,348 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:24:36,349 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:24:36,426 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:24:38,682 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:24:40,460 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:24:40,836 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:24:45,271 - ispa_next.functions - DEBUG - Updated appointment (AA00025056) customer contact data.
2025-11-17 15:24:46,387 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:24:46,395 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:24:48,359 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:24:48,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:24:49,985 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:24:54,953 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:24:54,953 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:24:55,190 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:24:55,191 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:24:55,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:55,841 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:25:00,225 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:25:00,229 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:25:00,230 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:25:00,439 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:25:04,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:25:04,733 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:25:04,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:25:05,899 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:25:05,901 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:25:08,054 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:25:08,058 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:25:10,327 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:25:10,330 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:25:10,334 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-17 15:25:10,342 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-17 15:25:10,348 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeugoberwäsche und Aussaugen, source=from_tab, target=cart)}
2025-11-17 15:25:10,352 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:25:10,356 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-17 15:25:10,358 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:25:10,359 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:25:10,360 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:25:10,363 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:25:10,364 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:25:10,368 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:25:10,370 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:25:11,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:25:12,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:25:20,349 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:25:20,352 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:25:20,353 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:25:20,354 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:23,180 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:25:23,182 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:25:23,184 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:25,926 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:25:25,928 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:25:25,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:25:26,787 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:25:27,072 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:34,446 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:25:34,447 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:26:00,233 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:26:00,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:26:01,514 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:26:01,902 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:26:32,450 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:26:41,213 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:26:50,066 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:26:50,068 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:26:50,069 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:51,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:26:51,820 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:26:51,821 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:26:56,310 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:27:15,778 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:27:16,179 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 15:27:20,293 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:27:21,834 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 865
2025-11-17 15:27:21,836 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:27:28,834 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 290
2025-11-17 15:27:28,835 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:27:30,564 - ispa_next.appointments.models - DEBUG - Appointment Hans Wischniowski DÜW-OO 90 WBAUM71010VH73608 ohne Termin.
2025-11-17 15:27:30,587 - ispa_next.appointments.models - DEBUG - Appointment Barbara Brödel PS-BB 232 WBA21BX0507L93456 ohne Termin.
