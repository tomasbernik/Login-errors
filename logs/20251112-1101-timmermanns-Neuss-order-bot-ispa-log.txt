2025-11-12 11:01:24,050 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:01:24,055 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:01:33,791 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:01:47,244 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:02:02,990 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:02:28,355 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:02:51,139 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:02:54,095 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:55,463 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-12 11:02:55,464 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 286
2025-11-12 11:02:58,307 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 11:02:58,308 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:02:58,309 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:02:59,705 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:03:01,047 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:03:30,659 - ispa_next.appointments.models - DEBUG - Appointment Bianca Christiane Liebrand NE-NU 73E WMW81GC09STA95325 ohne Termin.
2025-11-12 11:03:30,749 - ispa_next.appointments.models - DEBUG - Appointment Heinz Wiedermann NE-WJ 2608 WBA61EE0X05Y34631 ohne Termin.
2025-11-12 11:03:30,762 - ispa_next.appointments.models - DEBUG - Appointment Özlem Rezgul NE-RJ 3585 WBAWY31090L531048 ohne Termin.
2025-11-12 11:03:30,776 - ispa_next.appointments.models - DEBUG - Appointment Kuri Beines Schalweb. Kraw.Fab.Tu.Dr. GmbH & Co. K MG-NA 696 WBATR95030NA40057 ohne Termin.
2025-11-12 11:03:30,777 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:03:30,789 - ispa_next.appointments.models - DEBUG - Appointment Gertrud Wiest GV-HW 1978 WBAUZ35020N007842 ohne Termin.
2025-11-12 11:03:30,805 - ispa_next.appointments.models - DEBUG - Appointment Dieter Krautwald NE-DK 6000 WBAUZ35060N006497 ohne Termin.
2025-11-12 11:03:30,841 - ispa_next.appointments.models - DEBUG - Appointment Alexander Loresch NE-AT 6872 WBAUZ35020N033230 ohne Termin.
2025-11-12 11:03:30,876 - ispa_next.appointments.models - DEBUG - Appointment Liping Italia Moda GmbH NE-Z 5888 WBAVJ31050LR18129 ohne Termin.
2025-11-12 11:03:30,899 - ispa_next.appointments.models - DEBUG - Appointment   WBAFS51080C275059 ohne Termin.
2025-11-12 11:03:30,922 - ispa_next.appointments.models - DEBUG - Appointment Jörn Stefan Lohr NE-L 357 WMWSR11090T421441 ohne Termin.
2025-11-12 11:03:30,942 - ispa_next.appointments.models - DEBUG - Appointment UKM GmbH NE-KW 444 WMW41DL0403S04779 ohne Termin.
2025-11-12 11:03:30,954 - ispa_next.appointments.models - DEBUG - Appointment Anna Hildebrandt NE-AH 2222 WBA7K110407N28819 ohne Termin.
2025-11-12 11:03:30,967 - ispa_next.appointments.models - DEBUG - Appointment Marc Daniel Gawron NE-D 485 WBA1S110607B48065 ohne Termin.
2025-11-12 11:03:31,000 - ispa_next.main - DEBUG - Found 14 out of 41 appointments to process (configured limit: 15).
2025-11-12 11:03:31,001 - ispa_next.main - DEBUG - Processing 6 fresh appointments.
2025-11-12 11:03:31,002 - ispa_next.main - DEBUG - Processing 8 already visited appointments (w/ RKR not callable).
2025-11-12 11:03:31,002 - ispa_next.main - DEBUG - All appointments: NE-CU 355E, NE-AS 3040, S-L1688E, HH-BF801E, NE OS6000, NE-FP 2004, NE-BA 812, D-DI 8212, GV-M 1208, NE-NL 1985, NE-NG 306E, GV-M 567, NE-O 1212, NE-R 4000
2025-11-12 11:03:31,005 - ispa_next.main - DEBUG - 



2025-11-12 11:03:31,005 - ispa_next.main - DEBUG - starting with process 1 (NE-CU 355E) of 14
2025-11-12 11:03:31,011 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:03:32,331 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:03:33,717 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-12 11:03:33,719 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 11:03:35,381 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:03:35,382 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:04:12,043 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:04:22,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:23,024 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:04:23,184 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:25,212 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:04:25,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:25,309 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:04:25,672 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:04:25,675 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:04:28,686 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:04:28,687 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:29,896 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:04:31,899 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:04:32,058 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:04:35,353 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:04:35,479 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:04:35,480 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:37,545 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:04:46,164 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:04:47,170 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:04:47,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:47,733 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:04,099 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:05:12,808 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:05:12,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:12,962 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:05:12,963 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:05:13,110 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:05:14,639 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:05:16,144 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:05:16,768 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:05:19,234 - ispa_next.functions - DEBUG - Updated appointment (AB00031673) customer contact data.
2025-11-12 11:05:20,156 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:05:20,226 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:05:21,161 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:05:21,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:05:21,899 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:05:25,658 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:05:25,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:05:26,164 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:05:28,169 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:05:28,353 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:05:28,492 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:05:28,572 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:05:28,573 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:30,677 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:05:42,263 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:05:46,578 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:05:46,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:48,612 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:05:52,824 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:05:53,832 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:05:53,837 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:05:53,837 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 11:05:53,839 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:05:55,854 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:05:55,857 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:05:56,891 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:05:56,894 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:05:56,899 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:05:56,903 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 11:05:56,904 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:05:56,907 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:05:56,909 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:05:56,910 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:05:56,913 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:05:56,914 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:05:56,916 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:05:56,918 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:05:57,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:05:58,457 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:06:09,780 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:06:09,783 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:06:09,785 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:06:09,785 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:06:12,441 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:06:12,443 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:06:12,445 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:06:15,052 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:06:15,055 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:06:15,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:06:15,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:06:16,050 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:06:27,638 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:06:27,641 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:06:30,381 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:06:43,281 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:06:43,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:06:44,371 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:06:44,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:07:10,424 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:07:14,847 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:07:20,412 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:07:20,416 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:07:20,417 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:07:21,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:07:21,324 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:07:21,326 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:07:23,335 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:07:34,653 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:07:35,025 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:07:36,200 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:36,966 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-12 11:07:36,968 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:07:40,699 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 286
2025-11-12 11:07:40,700 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:07:41,572 - ispa_next.main - DEBUG - 



2025-11-12 11:07:41,572 - ispa_next.main - DEBUG - starting with process 2 (NE-AS 3040) of 14
2025-11-12 11:07:41,576 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:07:42,869 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:44,173 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-12 11:07:44,174 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 286
2025-11-12 11:07:45,932 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:07:45,935 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:13,158 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:08:23,819 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:25,154 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:08:25,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:25,344 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:08:25,683 - ispa_next.functions - DEBUG - HU date soon to be invalid in 9 days.
2025-11-12 11:08:33,302 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:08:33,306 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:08:36,130 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:08:36,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:08:37,370 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:08:39,372 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:08:39,548 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:08:42,793 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:08:42,899 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:08:47,136 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:08:48,141 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:08:48,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:48,746 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:05,947 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:09:15,327 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:09:15,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:15,409 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:09:15,411 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:09:15,505 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:09:15,957 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:09:17,817 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:09:18,175 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:09:21,873 - ispa_next.functions - DEBUG - Updated appointment (AB00031623) customer contact data.
2025-11-12 11:09:22,785 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:09:22,787 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:09:22,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:09:23,772 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:09:25,335 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:09:25,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:09:25,570 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:09:30,412 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:09:30,413 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:09:30,445 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:09:30,450 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:09:30,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:09:31,109 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:09:31,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:32,093 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:32,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:09:33,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:09:33,040 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:09:35,075 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:09:35,077 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:09:36,592 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:09:36,597 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:09:36,600 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:09:36,602 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 11:09:36,603 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:09:36,606 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:09:36,607 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:09:36,608 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:09:36,610 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:09:36,611 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:09:36,614 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:09:36,616 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:09:37,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:09:38,238 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:09:49,578 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:09:49,580 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:09:49,582 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:09:49,583 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:52,244 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:09:52,247 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:09:52,250 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:54,896 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:09:54,899 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:09:54,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:09:55,393 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:09:55,475 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:09:55,477 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:58,159 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:10:11,348 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:10:12,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:10:12,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:10:13,060 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:26,247 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:10:26,248 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:10:26,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:10:27,094 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:10:27,096 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:10:31,022 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:10:40,592 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:10:40,999 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:10:42,072 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:42,885 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-12 11:10:42,887 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:46,693 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 285
2025-11-12 11:10:46,693 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:47,603 - ispa_next.main - DEBUG - 



2025-11-12 11:10:47,603 - ispa_next.main - DEBUG - starting with process 3 (S-L1688E) of 14
2025-11-12 11:10:47,609 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:10:48,943 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:50,556 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-12 11:10:50,557 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 285
2025-11-12 11:10:52,282 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:52,284 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:32,715 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:11:32,845 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:11:32,850 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:33,397 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-12 11:11:33,398 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:36,662 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 285
2025-11-12 11:11:36,662 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:37,639 - ispa_next.main - DEBUG - 



2025-11-12 11:11:37,639 - ispa_next.main - DEBUG - starting with process 4 (HH-BF801E) of 14
2025-11-12 11:11:37,646 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:38,975 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:40,492 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-12 11:11:40,493 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 285
2025-11-12 11:11:42,246 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:42,248 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:15,646 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:12:15,657 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:12:15,661 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:12:16,290 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-12 11:12:16,291 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:12:19,305 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 285
2025-11-12 11:12:19,306 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:20,220 - ispa_next.main - DEBUG - 



2025-11-12 11:12:20,220 - ispa_next.main - DEBUG - starting with process 5 (NE OS6000) of 14
2025-11-12 11:12:20,226 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:12:21,549 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:12:23,039 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-12 11:12:23,040 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 285
2025-11-12 11:12:24,732 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:12:24,733 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:57,227 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:12:57,237 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:12:57,240 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:12:57,842 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-12 11:12:57,844 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:00,961 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 285
2025-11-12 11:13:00,962 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:01,908 - ispa_next.main - DEBUG - 



2025-11-12 11:13:01,908 - ispa_next.main - DEBUG - starting with process 6 (NE-FP 2004) of 14
2025-11-12 11:13:01,912 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:03,266 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:05,007 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 599
2025-11-12 11:13:05,008 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 285
2025-11-12 11:13:06,584 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:06,585 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:29,796 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:13:40,325 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:41,555 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:13:41,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:41,755 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:13:42,000 - ispa_next.functions - DEBUG - HU date soon to be invalid in 42 days.
2025-11-12 11:13:49,844 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:13:49,847 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:13:52,636 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:13:52,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:52,972 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 11:13:53,487 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 11:13:53,504 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:13:53,505 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:54,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:13:55,048 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:13:55,050 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 11:13:55,076 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:13:57,971 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:13:57,975 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:58,568 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 600
2025-11-12 11:13:58,569 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:02,388 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 286
2025-11-12 11:14:02,389 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:03,470 - ispa_next.appointments.models - DEBUG - Appointment Christian Alois Keller GV-Y 1111 WBA1W910505D08564 ohne Termin.
2025-11-12 11:14:03,491 - ispa_next.main - DEBUG - 



2025-11-12 11:14:03,491 - ispa_next.main - DEBUG - starting with process 7 (NE-BA 812) of 14
2025-11-12 11:14:03,548 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:04,871 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:06,207 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 600
2025-11-12 11:14:06,208 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 286
2025-11-12 11:14:07,783 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:07,784 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:35,229 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:14:37,837 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:14:43,271 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:14:46,741 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:14:46,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:14:46,912 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:14:47,230 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:14:47,234 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:14:50,315 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:14:50,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:14:51,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:14:53,848 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:14:53,971 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:14:54,133 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:14:54,244 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:14:56,461 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:14:57,466 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:14:57,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:14:58,061 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:16,558 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:15:21,135 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:15:21,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:21,247 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:15:21,248 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:15:21,341 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:15:22,788 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:15:23,169 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:15:25,189 - ispa_next.functions - DEBUG - Updated appointment (AD00015276) customer contact data.
2025-11-12 11:15:26,160 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:15:26,162 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:15:27,094 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:15:27,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:15:27,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:15:32,042 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:15:32,043 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:15:32,046 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:15:32,050 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:15:32,051 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:15:32,553 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:15:38,128 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:38,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:38,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:15:39,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:15:39,463 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:15:42,827 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:15:42,848 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:15:44,292 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:15:44,293 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:15:44,296 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:15:44,297 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:15:44,298 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:15:44,301 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:15:44,302 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:15:44,303 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:15:44,305 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:15:44,306 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:15:44,309 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:15:44,312 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:15:44,314 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:15:44,315 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:48,226 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:15:50,776 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:15:50,780 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:15:50,784 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:54,262 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:15:54,263 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:15:54,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:15:55,225 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:15:55,667 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:07,892 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:16:07,894 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:11,517 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:16:25,374 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:16:25,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:16:26,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:16:26,660 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:58,874 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:03,709 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:08,544 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:15,418 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:15,437 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:17:15,439 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:17:16,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:17:16,940 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:17:16,942 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:17:19,726 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:17:28,906 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:17:29,297 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:17:30,367 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:17:31,235 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 600
2025-11-12 11:17:31,237 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:17:35,173 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 286
2025-11-12 11:17:35,174 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:17:36,128 - ispa_next.appointments.models - DEBUG - Appointment Christian Alois Keller GV-Y 1111 WBA1W910505D08564 ohne Termin.
2025-11-12 11:17:36,145 - ispa_next.main - DEBUG - 



2025-11-12 11:17:36,145 - ispa_next.main - DEBUG - starting with process 8 (D-DI 8212) of 14
2025-11-12 11:17:36,148 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:17:37,480 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:17:38,904 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 600
2025-11-12 11:17:38,905 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 286
2025-11-12 11:17:40,671 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:17:40,672 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:11,516 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:18:13,927 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:18:19,527 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:21,604 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:18:21,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:21,759 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:18:22,047 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:18:22,050 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:18:25,073 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:18:25,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:26,535 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:18:28,537 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:18:28,685 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:18:28,794 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:18:28,916 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:18:33,179 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:18:34,185 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:18:34,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:34,816 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:49,742 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:18:49,744 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:18:54,376 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:18:54,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:54,545 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:18:54,546 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:18:54,633 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:18:56,010 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:18:58,194 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:18:58,626 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:19:00,404 - ispa_next.functions - DEBUG - Updated appointment (AB00031635) customer contact data.
2025-11-12 11:19:01,333 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:19:01,335 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:19:02,240 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:19:02,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:19:03,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:19:06,892 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:06,892 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:19:06,895 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:19:06,898 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:19:06,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:07,432 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:19:16,306 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:19:25,131 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-12 11:19:30,652 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:31,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:31,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:31,999 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:19:32,002 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:19:34,022 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:19:34,041 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:19:35,202 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:19:35,204 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:19:35,208 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:19:35,209 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:19:35,210 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:19:35,213 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:19:35,214 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:19:35,215 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:19:35,217 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:19:35,219 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:19:35,221 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:19:35,224 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:19:35,227 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:19:35,228 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:37,315 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:19:37,318 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:19:37,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:39,326 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:19:39,327 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:19:39,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:19:40,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:19:40,793 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:51,726 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:19:51,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:53,739 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:20:06,080 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:20:06,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:20:07,160 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:20:07,343 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:26,319 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:20:31,902 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:20:31,906 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:20:31,906 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:20:32,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:20:32,703 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:20:32,706 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:20:34,800 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:20:43,786 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:20:44,164 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:20:45,298 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:20:46,097 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 601
2025-11-12 11:20:46,098 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:20:49,987 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 287
2025-11-12 11:20:49,987 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:20:50,943 - ispa_next.appointments.models - DEBUG - Appointment Laura Frensch ME-LF 1405 WBA7K310007J93392 ohne Termin.
2025-11-12 11:20:50,951 - ispa_next.appointments.models - DEBUG - Appointment Christian Alois Keller GV-Y 1111 WBA1W910505D08564 ohne Termin.
2025-11-12 11:20:50,962 - ispa_next.main - DEBUG - 



2025-11-12 11:20:50,962 - ispa_next.main - DEBUG - starting with process 9 (GV-M 1208) of 14
2025-11-12 11:20:50,965 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:20:52,295 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:20:53,839 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 601
2025-11-12 11:20:53,841 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 287
2025-11-12 11:20:55,548 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:20:55,549 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:21:23,364 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:21:25,744 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:21:31,064 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:33,069 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:21:33,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:33,184 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:21:33,514 - ispa_next.functions - DEBUG - HU date already expired after 23 days.
2025-11-12 11:21:38,561 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:21:38,565 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:21:41,509 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:21:41,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:42,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:21:44,710 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:21:44,859 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:21:44,971 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:21:45,090 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:21:49,302 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:21:50,307 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:21:50,308 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:50,929 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:05,534 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:22:05,539 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:22:10,498 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:22:10,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:10,578 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:22:10,579 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:22:10,671 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:22:13,377 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:22:15,767 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:22:16,170 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:22:18,350 - ispa_next.functions - DEBUG - Updated appointment (AD00015105) customer contact data.
2025-11-12 11:22:19,311 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:22:19,313 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:22:20,266 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:22:20,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:22:21,251 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:22:24,865 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:22:24,865 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:22:24,868 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:22:24,871 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:22:24,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:25,371 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:22:25,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:26,257 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:26,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:26,963 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:22:26,965 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:22:29,077 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:22:29,079 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:22:30,876 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:22:30,878 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:22:30,882 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:22:30,885 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:22:30,888 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:22:30,891 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:22:30,892 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:22:30,894 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:22:30,897 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:22:30,898 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:22:30,900 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:22:30,903 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:22:30,906 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:22:30,906 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:33,089 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:22:33,091 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:22:33,108 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:35,256 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:22:35,258 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:22:35,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:22:36,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:22:36,366 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:44,129 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:22:44,132 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:46,177 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:22:58,697 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:22:59,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:59,829 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:22:59,985 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:19,571 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:23:25,121 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:23:25,124 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:23:25,124 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:23:25,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:23:25,928 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:23:25,931 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:23:28,093 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:23:37,311 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:23:37,745 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:23:38,684 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:39,563 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 600
2025-11-12 11:23:39,565 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:43,684 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 285
2025-11-12 11:23:43,685 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:44,673 - ispa_next.main - DEBUG - 



2025-11-12 11:23:44,674 - ispa_next.main - DEBUG - starting with process 10 (NE-NL 1985) of 14
2025-11-12 11:23:44,677 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:23:45,973 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:47,479 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 600
2025-11-12 11:23:47,480 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 285
2025-11-12 11:23:49,256 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:49,258 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:24:18,281 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:24:20,686 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:24:26,242 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:28,173 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:24:28,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:28,330 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:24:28,649 - ispa_next.functions - DEBUG - HU date already expired after 177 days.
2025-11-12 11:24:33,101 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:24:33,104 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:24:36,114 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:24:36,115 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:37,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:39,646 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:24:39,812 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:24:39,950 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:24:40,111 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:24:44,309 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:24:45,314 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:24:45,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:45,846 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:00,496 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:25:05,488 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:25:05,490 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:05,602 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:05,603 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:25:05,745 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:25:07,311 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:25:08,846 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:25:09,241 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:25:11,165 - ispa_next.functions - DEBUG - Updated appointment (AC00019139) customer contact data.
2025-11-12 11:25:12,127 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:25:12,129 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:25:13,357 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:25:13,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:25:14,441 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:25:18,089 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:25:18,089 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:25:18,092 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:25:18,095 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:25:18,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:18,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:25:19,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:19,545 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:19,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:20,355 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:25:20,357 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:25:22,503 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:25:22,506 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:25:23,803 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:25:23,804 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:25:23,806 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:25:23,808 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:25:23,809 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:25:23,812 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:25:23,813 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:25:23,814 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:25:23,816 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:25:23,817 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:25:23,820 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:25:23,823 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:25:23,825 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:25:23,826 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:25,939 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:25:25,941 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:25:25,943 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:28,103 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:25:28,106 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:25:28,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:25:29,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:25:29,569 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:38,944 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:25:38,947 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:40,947 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:25:53,452 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:25:53,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:25:54,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:25:54,697 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:13,164 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:26:18,716 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:26:18,719 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:26:18,720 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:26:19,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:26:19,623 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:26:19,626 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:26:21,800 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:26:31,023 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:26:31,457 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 11:26:32,576 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:26:33,352 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 600
2025-11-12 11:26:33,354 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:26:36,962 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 285
2025-11-12 11:26:36,963 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:26:38,717 - ispa_next.main - DEBUG - 



2025-11-12 11:26:38,717 - ispa_next.main - DEBUG - starting with process 11 (NE-NG 306E) of 14
2025-11-12 11:26:38,721 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:26:40,064 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:26:41,748 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 600
2025-11-12 11:26:41,749 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 285
2025-11-12 11:26:43,585 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:26:43,586 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:27:13,341 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:27:15,534 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:27:20,977 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:22,955 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:27:22,956 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:23,119 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:27:23,415 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:27:23,418 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:27:26,341 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:27:26,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:27:27,889 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:27:29,892 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:27:30,022 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:27:30,246 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:27:30,390 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:27:34,599 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:27:35,606 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:27:35,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:36,141 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:50,895 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:27:55,737 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:27:55,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:55,869 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:27:55,870 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:27:55,960 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:27:57,428 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:27:58,985 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:27:59,306 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:28:01,208 - ispa_next.functions - DEBUG - Updated appointment (AB00031584) customer contact data.
2025-11-12 11:28:02,178 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:28:02,180 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:28:03,030 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:28:03,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:28:04,529 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:28:08,124 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:28:08,124 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:28:08,127 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:28:08,130 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:28:08,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:28:08,672 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:28:14,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:15,332 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:15,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:28:16,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:28:16,544 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:28:18,577 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:28:18,578 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:28:19,823 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:28:19,825 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:28:19,828 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:28:19,839 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:28:19,842 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:28:19,847 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:28:19,849 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:28:19,850 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:28:19,852 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:28:19,853 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:28:19,855 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:28:19,859 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:28:19,862 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:28:19,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:21,916 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:28:21,918 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:28:21,921 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:23,957 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:28:23,959 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:28:23,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:28:25,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:28:25,415 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:36,208 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:28:36,212 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:38,296 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:28:51,173 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:28:51,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:28:52,332 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:28:52,497 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:11,881 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:29:17,347 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:29:17,350 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:29:17,350 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:29:18,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:29:18,172 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:29:18,174 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:29:20,294 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:29:29,540 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:29:29,942 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 11:29:30,962 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:29:31,900 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 601
2025-11-12 11:29:31,902 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:29:35,494 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 286
2025-11-12 11:29:35,495 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:29:36,569 - ispa_next.appointments.models - DEBUG - Appointment Roland Benno Schlaus NE-RS 442 WBA21GM0105115019 ohne Termin.
2025-11-12 11:29:36,581 - ispa_next.main - DEBUG - 



2025-11-12 11:29:36,581 - ispa_next.main - DEBUG - starting with process 12 (GV-M 567) of 14
2025-11-12 11:29:36,584 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:29:38,035 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:29:39,419 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 601
2025-11-12 11:29:39,420 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 286
2025-11-12 11:29:41,280 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:29:41,281 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:30:12,975 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:30:15,668 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:30:21,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:27,431 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:30:27,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:30:27,522 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:30:27,801 - ispa_next.functions - DEBUG - HU date soon to be invalid in 89 days.
2025-11-12 11:30:33,076 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:30:33,080 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:30:35,942 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:30:35,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:30:37,306 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:30:39,309 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:30:39,488 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:30:39,590 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:30:39,705 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:30:43,940 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:30:44,945 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:30:44,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:30:45,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:00,966 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:31:06,581 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:31:06,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:06,755 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:31:06,756 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:31:06,906 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:31:07,083 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:31:08,832 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:31:09,202 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:31:11,711 - ispa_next.functions - DEBUG - Updated appointment (AG00009216) customer contact data.
2025-11-12 11:31:12,681 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:31:12,684 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:31:12,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:31:13,894 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:31:15,132 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:31:15,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:31:15,290 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:31:19,334 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:31:19,334 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:31:19,338 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:31:19,342 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:31:19,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:19,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:31:26,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:27,267 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:27,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:28,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:31:28,087 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:31:33,813 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:31:33,815 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:31:35,354 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:31:35,357 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:31:35,361 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:31:35,363 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:31:35,367 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:31:35,371 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:31:35,372 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:31:35,373 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:31:35,376 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:31:35,378 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:31:35,380 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:31:35,384 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:31:35,386 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:31:35,386 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:41,671 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:31:44,629 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:31:44,632 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:31:44,634 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:50,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:51,088 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:32:02,561 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:32:02,563 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:32:02,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:32:03,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:32:03,977 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:17,467 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:32:17,469 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:23,609 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:32:37,121 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:32:37,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:32:38,212 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:32:38,389 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:38,598 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:33:44,409 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:33:51,570 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:33:57,880 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:03,163 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:08,272 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:13,300 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:19,555 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:23,638 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:34:23,639 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:34:24,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:34:24,558 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:34:24,560 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:34:29,373 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:34:39,315 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:34:39,722 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 11:34:41,315 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:34:42,299 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 601
2025-11-12 11:34:42,301 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:34:45,780 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 286
2025-11-12 11:34:45,780 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:34:46,843 - ispa_next.main - DEBUG - Found new Appointment: NE-RS 442
2025-11-12 11:34:46,847 - ispa_next.main - DEBUG - 



2025-11-12 11:34:46,847 - ispa_next.main - DEBUG - starting with process 13 (NE-RS 442) of 15
2025-11-12 11:34:46,853 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:34:48,208 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:34:49,611 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 601
2025-11-12 11:34:49,613 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 286
2025-11-12 11:34:51,328 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:34:51,330 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:35:19,706 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:35:31,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:31,332 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:35:31,556 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:32,948 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:35:32,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:33,068 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:35:33,398 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:35:33,402 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:35:36,327 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:35:36,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:35:37,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:35:39,908 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:35:40,065 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:35:43,382 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:35:43,520 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:35:43,522 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:44,974 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:35:54,294 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:35:55,300 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:35:55,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:55,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:10,720 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:36:10,720 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:36:19,416 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:36:19,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:19,553 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:36:19,554 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:36:19,636 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:36:21,151 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:36:21,547 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:36:25,109 - ispa_next.functions - DEBUG - Updated appointment (AB00031685) customer contact data.
2025-11-12 11:36:26,113 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:36:26,115 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:36:27,100 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:36:27,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:36:28,197 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:36:31,849 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:36:31,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:36:32,373 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:36:34,375 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:36:34,544 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:36:34,693 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:36:34,831 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:36:34,833 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:36,223 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:36:44,758 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:37:44,761 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:37:53,257 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:38:20,260 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:38:29,087 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:38:38,065 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:38:39,072 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:38:39,077 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:38:39,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:38:39,182 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:38:44,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:45,300 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:45,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:38:46,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:38:46,121 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:38:47,576 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:38:47,579 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:38:48,734 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:38:48,737 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:38:48,741 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:38:48,743 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 11:38:48,747 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:38:48,752 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:38:48,754 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:38:48,755 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:38:48,758 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:38:48,759 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:38:48,761 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:38:48,763 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:38:49,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:38:50,487 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:39:02,273 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:39:02,275 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:39:02,277 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:39:02,278 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:04,256 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:39:04,258 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:39:04,261 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:06,275 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:39:06,278 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:39:06,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:39:06,795 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:39:06,872 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:39:06,874 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:08,880 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:39:21,435 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:39:21,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:39:22,455 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:39:22,614 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:41,958 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:39:47,719 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:39:47,721 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:39:47,721 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:39:48,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:39:48,580 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:39:48,583 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:39:50,774 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:40:00,337 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:40:00,751 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 11:40:02,137 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:40:03,072 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 601
2025-11-12 11:40:03,074 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:40:06,928 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 286
2025-11-12 11:40:06,929 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:40:07,899 - ispa_next.main - DEBUG - 



2025-11-12 11:40:07,899 - ispa_next.main - DEBUG - starting with process 14 (NE-O 1212) of 15
2025-11-12 11:40:07,904 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:40:09,302 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:40:10,807 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 601
2025-11-12 11:40:10,809 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 286
2025-11-12 11:40:12,620 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:40:12,623 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:40:45,768 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:40:49,288 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:40:56,005 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:01,137 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:41:01,138 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:01,260 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:41:01,590 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:41:01,594 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:41:04,571 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:41:04,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:06,073 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:41:08,090 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:41:08,259 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:41:08,361 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:41:08,537 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:41:12,796 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:41:13,802 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:41:13,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:14,371 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:31,901 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:41:37,382 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:41:37,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:37,492 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:41:37,494 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:41:37,594 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:41:39,068 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:41:40,797 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:41:41,212 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:41:43,347 - ispa_next.functions - DEBUG - Updated appointment (AB00031294) customer contact data.
2025-11-12 11:41:44,335 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:41:44,338 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:41:45,284 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:41:45,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:41:46,583 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:41:50,700 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:41:50,700 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:41:50,703 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:41:50,706 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:41:50,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:51,206 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:41:54,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:55,346 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:55,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:56,268 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:41:56,271 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:42:00,710 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:42:00,713 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:42:01,979 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:42:01,980 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:42:01,983 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:42:01,984 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:42:01,985 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:42:01,988 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:42:01,989 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:42:01,990 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:42:01,993 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:42:01,994 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:42:01,997 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:42:02,000 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:42:02,002 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:42:02,003 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:42:07,117 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:42:10,138 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:42:10,337 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:42:10,339 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:42:15,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:42:15,413 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:42:27,158 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:42:27,160 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:42:27,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:42:28,313 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:42:28,646 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:42:40,981 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:42:40,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:42:45,857 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:42:59,111 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:42:59,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:43:00,217 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:43:00,503 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:47,897 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:43:54,151 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:43:59,094 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:44:05,622 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:44:10,992 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:44:17,504 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:44:21,513 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:44:21,514 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:44:22,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:44:22,477 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:44:22,479 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:44:26,492 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:44:37,455 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:44:37,885 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 11:44:39,684 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:44:40,559 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 601
2025-11-12 11:44:40,561 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:44:45,084 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 285
2025-11-12 11:44:45,085 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:44:46,112 - ispa_next.main - DEBUG - 



2025-11-12 11:44:46,113 - ispa_next.main - DEBUG - starting with process 15 (NE-R 4000) of 15
2025-11-12 11:44:46,116 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:44:47,497 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:44:49,157 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 601
2025-11-12 11:44:49,158 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 285
2025-11-12 11:44:51,116 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:44:51,118 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:45:25,061 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:45:27,736 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:45:35,556 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:45:38,915 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:45:38,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:45:39,013 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:45:39,484 - ispa_next.functions - DEBUG - HU date already expired after 18 days.
2025-11-12 11:45:44,753 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:45:44,755 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:45:47,691 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:45:47,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:45:49,240 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:45:51,245 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:45:51,375 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:45:51,541 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:45:51,618 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:45:55,897 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:45:56,902 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:45:56,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:45:57,414 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:46:12,144 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:46:17,708 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:46:17,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:46:17,785 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:46:17,786 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:46:17,861 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:46:19,358 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:46:19,729 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:46:21,837 - ispa_next.functions - DEBUG - Updated appointment (AK00008642) customer contact data.
2025-11-12 11:46:22,950 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:46:22,952 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:46:23,827 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:46:23,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:46:25,781 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:46:29,457 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:46:29,458 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:46:29,464 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:46:29,469 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:46:29,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:46:29,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:46:30,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:46:31,035 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:46:31,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:46:31,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:46:31,981 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:46:35,486 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:46:35,492 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:46:36,770 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:46:36,772 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:46:36,775 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:46:36,777 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:46:36,778 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:46:36,782 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:46:36,783 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:46:36,784 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:46:36,788 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:46:36,790 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:46:36,793 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:46:36,798 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:46:36,800 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:46:36,801 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:40,353 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:46:40,355 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:46:40,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:43,794 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:46:43,796 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:46:43,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:46:45,137 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:46:45,477 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:55,297 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:46:55,298 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:58,783 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:47:11,945 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:47:12,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:47:13,182 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:47:13,363 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:47:45,893 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:47:51,354 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:47:57,479 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:48:06,551 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:48:06,553 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:48:06,554 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:48:07,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:48:07,378 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:48:07,380 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:48:09,702 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:48:19,395 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:48:19,790 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 11:48:20,949 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:48:21,844 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 601
2025-11-12 11:48:21,846 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:48:26,325 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 11:48:26,326 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
