2025-11-12 13:07:35,377 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 13:07:35,458 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 13:07:51,199 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:08:02,093 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:08:17,740 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:10:16,394 - ispa_next.app_start.main - DEBUG - Operation already took 106.87 seconds (more than 80 seconds)
2025-11-12 13:10:18,484 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\52c221d4267b798b\\tess_zycsw3xn_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\52c221d4267b798b\\tess_zycsw3xn', 'txt']
2025-11-12 13:10:18,730 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:10:18,734 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:10:18,735 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:10:44,195 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 13:10:56,042 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 13:10:58,661 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:10:59,559 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 506
2025-11-12 13:10:59,560 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 161
2025-11-12 13:11:01,921 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 83
2025-11-12 13:11:01,922 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 13:11:01,922 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:11:02,990 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:11:04,290 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:11:16,693 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:11:16,724 - ispa_next.appointments.models - DEBUG - Appointment Janecke Möbeltechnik GmbH LIP-L 179 E WBY21HH050CU09424 ohne Termin.
2025-11-12 13:11:16,733 - ispa_next.main - DEBUG - Found 10 out of 22 appointments to process (configured limit: 15).
2025-11-12 13:11:16,733 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-12 13:11:16,733 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 13:11:16,733 - ispa_next.main - DEBUG - All appointments: LIP-CW 187, LIP-XP 51, LIP-L 0921, HX PA 5010, Lip-qz 95 e, LIP FJ 389, LIP-CP 300, LIP-JC 288, LIP-JB 17E, LIP-FB 273
2025-11-12 13:11:16,736 - ispa_next.main - DEBUG - 



2025-11-12 13:11:16,736 - ispa_next.main - DEBUG - starting with process 1 (LIP-CW 187) of 10
2025-11-12 13:11:16,740 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:11:17,873 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:11:19,040 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 506
2025-11-12 13:11:19,049 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 83
2025-11-12 13:11:20,310 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:11:20,312 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:11:45,691 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:11:55,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:11:55,766 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:11:55,889 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:11:57,089 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:11:57,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:11:57,152 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:11:57,372 - ispa_next.functions - DEBUG - HU date already expired after 268 days.
2025-11-12 13:12:03,333 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:12:03,335 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:12:03,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:03,392 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:12:06,352 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:12:06,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:12:07,315 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:12:09,319 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:12:09,466 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:12:12,698 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:12:12,803 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:12:12,803 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:12:21,220 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:12:22,235 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:12:22,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:22,736 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:32,113 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:12:39,157 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:12:39,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:39,282 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:12:39,283 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:12:39,340 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:12:40,679 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:12:42,005 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:12:42,307 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:12:45,483 - ispa_next.functions - DEBUG - Updated appointment (AA00044535) customer contact data.
2025-11-12 13:12:46,409 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:12:46,410 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:12:47,324 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:12:47,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:12:48,005 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:12:52,464 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:12:52,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:12:52,953 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:12:54,959 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:12:55,057 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:12:55,187 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:12:55,280 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:12:55,280 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:13:06,593 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:13:10,597 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:13:10,597 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:13:12,745 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:13:13,755 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:13:13,759 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:13:13,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:13,923 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:13:14,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:14,912 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:14,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:15,610 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:13:15,611 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:13:18,658 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:13:18,667 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:13:19,654 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:13:19,668 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:13:19,670 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:13:19,672 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=from_aw_package, target=cart)}
2025-11-12 13:13:19,674 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:13:19,676 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:13:19,677 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:13:19,679 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:13:19,681 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:13:19,683 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:13:19,684 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:13:19,689 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:13:45,295 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:13:45,297 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:13:45,299 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:13:45,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:13:49,220 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 13:13:52,091 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:13:52,092 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:13:52,121 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:13:56,152 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:13:56,153 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:13:56,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:13:56,827 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:13:56,999 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:17,707 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:14:17,709 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:21,680 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:14:21,682 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:14:22,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:14:22,765 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:14:22,920 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:32,373 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:14:36,152 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:14:40,085 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:14:43,821 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:14:48,915 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:14:48,916 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:14:49,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:14:49,435 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:14:49,436 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:14:52,297 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:15:02,633 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:15:03,018 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 13:15:03,303 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:15:04,170 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 506
2025-11-12 13:15:04,171 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:15:06,460 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 160
2025-11-12 13:15:06,461 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:15:07,148 - ispa_next.appointments.models - DEBUG - Appointment Jochen Jens Hillgemann LIP-JK 43 WBABN51050JT62788 ohne Termin.
2025-11-12 13:15:07,169 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 13:15:07,183 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 13:15:07,195 - ispa_next.main - DEBUG - Found new Appointment: LIP-SB 595
2025-11-12 13:15:07,233 - ispa_next.main - DEBUG - 



2025-11-12 13:15:07,233 - ispa_next.main - DEBUG - starting with process 2 (LIP-SB 595) of 11
2025-11-12 13:15:07,256 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:15:08,725 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:15:10,399 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 506
2025-11-12 13:15:10,401 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 160
2025-11-12 13:15:11,795 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:15:11,796 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:15:44,756 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:15:54,445 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:15:57,091 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:15:57,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:15:57,168 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:15:57,413 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:15:57,416 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:15:57,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:15:57,519 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:16:00,668 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:16:00,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:16:01,798 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:16:03,803 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:16:03,931 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:16:04,027 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:16:04,118 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:16:08,304 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:16:09,310 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:16:09,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:09,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:21,362 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:16:27,609 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:16:27,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:27,731 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:16:27,732 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:16:27,773 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:16:28,932 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:16:29,175 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:16:31,905 - ispa_next.functions - DEBUG - Updated appointment (AA00044540) customer contact data.
2025-11-12 13:16:32,815 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:16:32,816 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:16:33,336 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:16:33,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:16:34,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:16:37,561 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:16:37,561 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:16:37,564 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:16:37,567 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:16:37,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:16:38,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:16:46,944 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 13:16:57,525 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 13:16:57,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:58,309 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:58,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:16:59,014 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:16:59,015 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:17:01,527 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:17:01,528 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:17:02,506 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:17:02,508 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:17:02,510 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:17:02,512 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart), Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart)}
2025-11-12 13:17:02,513 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:17:02,514 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:17:02,516 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:17:02,517 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:17:02,519 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:17:02,520 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:17:02,521 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:17:02,522 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:17:47,562 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:17:47,564 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-12 13:17:53,465 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:17:53,467 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:17:53,467 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:17:57,439 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 13:18:00,282 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:18:00,286 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:18:00,306 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:18:04,333 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:18:04,335 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:18:04,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:18:05,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:18:05,134 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:18:05,138 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:18:09,115 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:18:09,117 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:18:09,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:18:10,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:18:10,212 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:18:17,418 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:18:22,363 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:18:28,284 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:18:28,285 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:18:28,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:18:28,869 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:18:28,871 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:18:31,688 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:18:40,009 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:18:40,392 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 13:18:40,788 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:18:41,591 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-12 13:18:41,592 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:18:44,544 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 160
2025-11-12 13:18:44,545 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:18:45,280 - ispa_next.appointments.models - DEBUG - Appointment Jochen Jens Hillgemann LIP-JK 43 WBABN51050JT62788 ohne Termin.
2025-11-12 13:18:45,290 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 13:18:45,296 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 13:18:45,299 - ispa_next.main - DEBUG - 



2025-11-12 13:18:45,299 - ispa_next.main - DEBUG - starting with process 3 (LIP-XP 51) of 11
2025-11-12 13:18:45,302 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:18:46,117 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:18:47,185 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-12 13:18:47,186 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 160
2025-11-12 13:18:48,496 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:18:48,497 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:19:17,435 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:19:27,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:27,620 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:19:27,760 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:19:28,935 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:19:28,936 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:29,004 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:19:29,240 - ispa_next.functions - DEBUG - HU date already expired after 1067 days.
2025-11-12 13:19:35,969 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:19:35,971 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:19:35,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:36,034 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:19:45,518 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:19:45,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:46,617 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:19:48,619 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:19:48,710 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:19:51,934 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:19:52,006 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:19:52,006 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:20:00,493 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:20:01,497 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:20:01,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:01,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:13,750 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:20:13,750 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:20:20,442 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:20:20,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:20,544 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:20:20,545 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:20:20,582 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:20:21,799 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:20:22,001 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:20:25,373 - ispa_next.functions - DEBUG - Updated appointment (AA00044528) customer contact data.
2025-11-12 13:20:26,296 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:20:26,297 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:20:27,091 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:20:27,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:20:27,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:20:31,340 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:20:31,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:20:31,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:20:33,815 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:20:33,943 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:20:34,049 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:20:34,128 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:20:34,129 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:20:42,333 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:21:42,334 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:21:53,192 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:21:57,451 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:21:57,451 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:22:01,615 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:22:02,659 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:22:02,662 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:22:02,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:22:02,727 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:22:06,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:22:07,073 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:22:07,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:22:07,790 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:22:07,791 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:22:09,096 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:22:09,099 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:22:10,078 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:22:10,079 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:22:10,081 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:22:10,083 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:22:10,083 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:22:10,085 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:22:10,087 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:22:10,088 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:22:10,101 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:22:10,110 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:22:10,112 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:22:10,117 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:22:10,119 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:22:10,119 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:22:10,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:22:11,318 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:22:11,320 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:22:11,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:22:12,528 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:22:12,529 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:22:12,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:22:13,242 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:22:13,430 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:22:21,902 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:22:21,905 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:22:23,180 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:22:23,182 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:22:23,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:22:24,209 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:22:24,385 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:22:29,955 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:22:29,957 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:22:29,958 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:22:30,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:22:30,784 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:22:30,785 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:22:32,656 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:22:39,263 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:22:39,640 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 13:22:40,334 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:22:41,036 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-12 13:22:41,039 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:22:43,940 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 160
2025-11-12 13:22:43,941 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:22:44,810 - ispa_next.appointments.models - DEBUG - Appointment Jochen Jens Hillgemann LIP-JK 43 WBABN51050JT62788 ohne Termin.
2025-11-12 13:22:44,819 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 13:22:44,826 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 13:22:44,829 - ispa_next.main - DEBUG - 



2025-11-12 13:22:44,829 - ispa_next.main - DEBUG - starting with process 4 (LIP-L 0921) of 11
2025-11-12 13:22:44,832 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:22:45,884 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:22:46,781 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-12 13:22:46,782 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 160
2025-11-12 13:22:48,024 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:22:48,026 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:23:24,768 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:23:24,881 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 13:23:24,885 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:23:25,317 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-12 13:23:25,319 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:23:27,902 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 160
2025-11-12 13:23:27,903 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:23:28,728 - ispa_next.appointments.models - DEBUG - Appointment Jochen Jens Hillgemann LIP-JK 43 WBABN51050JT62788 ohne Termin.
2025-11-12 13:23:28,736 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 13:23:28,743 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 13:23:28,746 - ispa_next.main - DEBUG - 



2025-11-12 13:23:28,746 - ispa_next.main - DEBUG - starting with process 5 (HX PA 5010) of 11
2025-11-12 13:23:28,749 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:23:29,884 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:23:31,003 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-12 13:23:31,004 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 160
2025-11-12 13:23:32,338 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:23:32,339 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:24:06,136 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:24:06,143 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 13:24:06,146 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:24:06,508 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-12 13:24:06,509 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:24:08,715 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 160
2025-11-12 13:24:08,715 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:24:09,552 - ispa_next.appointments.models - DEBUG - Appointment Jochen Jens Hillgemann LIP-JK 43 WBABN51050JT62788 ohne Termin.
2025-11-12 13:24:09,561 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 13:24:09,569 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 13:24:09,572 - ispa_next.main - DEBUG - 



2025-11-12 13:24:09,572 - ispa_next.main - DEBUG - starting with process 6 (Lip-qz 95 e) of 11
2025-11-12 13:24:09,575 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:24:10,542 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:24:11,456 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-12 13:24:11,457 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 160
2025-11-12 13:24:12,919 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:24:12,920 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:24:42,398 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:24:42,406 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 13:24:42,409 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:24:42,756 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-12 13:24:42,757 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:24:44,741 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 160
2025-11-12 13:24:44,741 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:24:45,585 - ispa_next.appointments.models - DEBUG - Appointment Jochen Jens Hillgemann LIP-JK 43 WBABN51050JT62788 ohne Termin.
2025-11-12 13:24:45,591 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 13:24:45,597 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 13:24:45,599 - ispa_next.main - DEBUG - 



2025-11-12 13:24:45,599 - ispa_next.main - DEBUG - starting with process 7 (LIP FJ 389) of 11
2025-11-12 13:24:45,604 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:24:46,605 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:24:47,524 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-12 13:24:47,525 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 160
2025-11-12 13:24:48,691 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:24:48,692 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:25:21,604 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:25:21,614 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 13:25:21,618 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:25:22,098 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-12 13:25:22,099 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:25:25,049 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 160
2025-11-12 13:25:25,049 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:25:25,864 - ispa_next.appointments.models - DEBUG - Appointment Jochen Jens Hillgemann LIP-JK 43 WBABN51050JT62788 ohne Termin.
2025-11-12 13:25:25,873 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 13:25:25,880 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 13:25:25,883 - ispa_next.main - DEBUG - 



2025-11-12 13:25:25,883 - ispa_next.main - DEBUG - starting with process 8 (LIP-CP 300) of 11
2025-11-12 13:25:25,885 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:25:27,061 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:25:28,270 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-12 13:25:28,272 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 160
2025-11-12 13:25:29,463 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:25:29,464 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:25:50,008 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:25:51,755 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:25:56,648 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:25:58,496 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:25:58,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:58,558 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:25:58,723 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:25:58,725 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:25:58,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:58,799 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:26:01,902 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:26:01,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:02,880 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:26:04,883 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:26:04,988 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:26:05,073 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:26:05,172 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:26:09,331 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:26:10,335 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:26:10,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:10,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:23,117 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:26:26,736 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:26:26,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:26,806 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:26:26,807 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:26:26,858 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:26:28,077 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:26:28,319 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:26:29,853 - ispa_next.functions - DEBUG - Updated appointment (AB00040557) customer contact data.
2025-11-12 13:26:30,766 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:26:30,768 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:26:31,485 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:26:31,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:26:32,266 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:26:35,868 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:26:35,869 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:26:35,871 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:26:35,875 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:26:35,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:36,380 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:26:42,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:42,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:42,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:43,277 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:26:43,278 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:26:45,124 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:26:45,129 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:26:46,191 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:26:46,193 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:26:46,194 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:26:46,196 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:26:46,196 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:26:46,197 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:26:46,199 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:26:46,200 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:26:46,201 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:26:46,202 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:26:46,204 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:26:46,205 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:26:46,208 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:26:46,209 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:26:46,210 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:48,083 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:26:48,085 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:26:48,092 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:50,074 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:26:50,075 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:26:50,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:26:50,818 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:26:51,108 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:01,669 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:27:01,673 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:03,553 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:27:03,554 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:27:04,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:27:04,608 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:27:04,795 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:10,027 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:27:16,243 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:27:16,245 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:27:16,246 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:27:16,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:27:16,911 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:27:16,912 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:27:18,691 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:27:25,953 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:27:26,355 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 13:27:26,667 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:27,504 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 508
2025-11-12 13:27:27,505 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:29,779 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 161
2025-11-12 13:27:29,780 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:30,727 - ispa_next.appointments.models - DEBUG - Appointment Britta Sasse HF-OS 302 WBAHF11050WX84840 ohne Termin.
2025-11-12 13:27:30,733 - ispa_next.appointments.models - DEBUG - Appointment Jochen Jens Hillgemann LIP-JK 43 WBABN51050JT62788 ohne Termin.
2025-11-12 13:27:30,740 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 13:27:30,743 - ispa_next.main - DEBUG - 



2025-11-12 13:27:30,743 - ispa_next.main - DEBUG - starting with process 9 (LIP-JC 288) of 11
2025-11-12 13:27:30,746 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:27:31,534 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:32,359 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 508
2025-11-12 13:27:32,360 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 161
2025-11-12 13:27:33,509 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:33,511 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:58,161 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:28:00,387 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:28:05,503 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:07,413 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:28:07,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:07,487 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:28:07,724 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:28:07,726 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:28:07,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:07,824 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:28:14,188 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:28:14,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:28:15,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:28:17,399 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:28:17,522 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:28:17,604 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:28:17,696 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:28:21,896 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:28:22,901 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:28:22,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:23,362 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:34,766 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:28:34,767 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:28:38,982 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:28:38,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:39,082 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:28:39,083 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:28:39,146 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:28:39,242 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:28:40,458 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:28:40,696 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:28:42,117 - ispa_next.functions - DEBUG - Updated appointment (AA00044524) customer contact data.
2025-11-12 13:28:43,289 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:28:43,290 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:28:43,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:28:44,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:28:44,948 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:28:44,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:28:45,019 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:28:48,617 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:28:48,617 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:28:48,622 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:28:48,624 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:28:48,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:28:49,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:28:49,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:49,998 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:49,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:28:50,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:28:50,771 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:28:52,696 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:28:52,698 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:28:53,649 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:28:53,654 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:28:53,657 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:28:53,659 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:28:53,660 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:28:53,661 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:28:53,663 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:28:53,664 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:28:53,665 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:28:53,667 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:28:53,668 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:28:53,669 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:28:53,671 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:28:53,672 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:28:53,673 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:55,581 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:28:55,582 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:28:55,597 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:57,504 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:28:57,506 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:28:57,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:28:58,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:28:58,734 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:07,893 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:29:07,894 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:09,774 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:29:09,775 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:29:10,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:29:10,951 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:29:11,159 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:16,512 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:29:20,776 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:29:20,777 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:29:20,778 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:29:21,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:29:21,498 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:29:21,499 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:29:23,250 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:29:31,104 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:29:31,479 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 13:29:31,945 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:29:33,001 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 508
2025-11-12 13:29:33,002 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:29:35,908 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 161
2025-11-12 13:29:35,908 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:29:36,742 - ispa_next.appointments.models - DEBUG - Appointment Jochen Jens Hillgemann LIP-JK 43 WBABN51050JT62788 ohne Termin.
2025-11-12 13:29:36,750 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 13:29:36,752 - ispa_next.main - DEBUG - Found new Appointment: HF-OS 302
2025-11-12 13:29:36,753 - ispa_next.main - DEBUG - 



2025-11-12 13:29:36,754 - ispa_next.main - DEBUG - starting with process 10 (HF-OS 302) of 12
2025-11-12 13:29:36,757 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:29:37,919 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:29:39,211 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 508
2025-11-12 13:29:39,211 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 161
2025-11-12 13:29:40,661 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:29:40,665 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:30:08,079 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:30:17,890 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:19,734 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:30:19,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:19,804 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:30:20,013 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:30:20,015 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:30:20,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:20,141 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:30:23,321 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:30:23,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:24,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:30:26,286 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:30:26,371 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:30:29,596 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:30:29,676 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:30:33,828 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:30:34,848 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:30:34,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:35,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:48,416 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:30:56,070 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:30:56,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:56,158 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:30:56,159 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:30:56,205 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:30:57,481 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:30:58,801 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:30:59,024 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:31:02,223 - ispa_next.functions - DEBUG - Updated appointment (AA00044547) customer contact data.
2025-11-12 13:31:03,147 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:31:03,149 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:31:04,008 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:31:04,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:31:04,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:31:08,460 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:31:08,460 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:31:08,463 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:31:08,466 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:31:08,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:08,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:31:14,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:15,004 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:15,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:15,712 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:31:15,713 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:31:17,563 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:31:17,565 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:31:18,530 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:31:18,532 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:31:18,535 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:31:18,537 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart)}
2025-11-12 13:31:18,538 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:31:18,540 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:31:18,541 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:31:18,541 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:31:18,543 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:31:18,544 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:31:18,546 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:31:18,548 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:31:44,459 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:31:44,460 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:31:44,462 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:31:44,463 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:47,211 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 13:31:50,112 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:31:50,124 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:31:50,126 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:52,800 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:31:52,802 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:31:52,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:31:53,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:31:53,478 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:31:53,481 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:55,955 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:31:55,956 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:31:56,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:31:56,887 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:31:56,988 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:02,965 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:32:07,517 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:32:13,126 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:32:13,126 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:32:13,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:32:13,798 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:32:13,799 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:32:17,015 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:32:23,287 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:32:23,665 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 13:32:24,129 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:32:25,128 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-12 13:32:25,129 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:32:27,942 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-12 13:32:27,943 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:32:28,754 - ispa_next.appointments.models - DEBUG - Appointment Jowat SE LIP-JW 898 WBA11GW010CV70666 ohne Termin.
2025-11-12 13:32:28,762 - ispa_next.appointments.models - DEBUG - Appointment Jochen Jens Hillgemann LIP-JK 43 WBABN51050JT62788 ohne Termin.
2025-11-12 13:32:28,771 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 13:32:28,774 - ispa_next.main - DEBUG - 



2025-11-12 13:32:28,774 - ispa_next.main - DEBUG - starting with process 11 (LIP-JB 17E) of 12
2025-11-12 13:32:28,777 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:32:29,984 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:32:31,043 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-12 13:32:31,044 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-12 13:32:32,430 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:32:32,431 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:32:58,379 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:33:00,194 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:33:05,471 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:33:09,406 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:33:09,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:09,488 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:33:09,625 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:33:09,630 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:33:09,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:09,716 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:33:12,560 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:33:12,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:33:13,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:33:15,439 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:33:15,550 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:33:15,635 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:33:15,692 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:33:19,827 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:33:20,847 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:33:20,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:21,318 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:33,167 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:33:37,167 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:33:37,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:37,267 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:33:37,268 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:33:37,311 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:33:38,542 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:33:39,768 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:33:39,996 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:33:41,443 - ispa_next.functions - DEBUG - Updated appointment (AB00040543) customer contact data.
2025-11-12 13:33:42,363 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:33:42,365 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:33:43,107 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:33:43,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:33:43,825 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:33:47,458 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:33:47,459 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:33:47,461 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:33:47,464 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:33:47,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:33:47,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:33:53,468 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:53,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:53,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:33:54,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:33:54,643 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:33:58,282 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:33:58,284 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:33:59,252 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:33:59,253 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:33:59,255 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:33:59,256 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:33:59,257 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:33:59,259 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:33:59,261 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:33:59,262 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:33:59,262 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:33:59,265 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:33:59,266 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:33:59,267 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:33:59,270 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:33:59,271 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:33:59,272 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:03,273 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 13:34:05,478 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:34:05,480 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:34:05,483 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:09,539 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:34:09,541 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:34:09,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:34:10,343 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:34:10,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:22,130 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:34:22,132 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:26,079 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:34:26,080 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:34:26,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:34:27,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:34:27,204 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:35,067 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:34:39,400 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:34:43,903 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:34:48,108 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:34:52,660 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:34:52,662 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:34:52,663 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:34:53,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:34:53,340 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:34:53,341 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:34:55,148 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:35:03,421 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:35:03,819 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 13:35:04,217 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:35:05,128 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-12 13:35:05,130 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:35:08,234 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-12 13:35:08,235 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:35:09,002 - ispa_next.appointments.models - DEBUG - Appointment Jowat SE LIP-JW 898 WBA11GW010CV70666 ohne Termin.
2025-11-12 13:35:09,016 - ispa_next.appointments.models - DEBUG - Appointment Jochen Jens Hillgemann LIP-JK 43 WBABN51050JT62788 ohne Termin.
2025-11-12 13:35:09,023 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 13:35:09,026 - ispa_next.main - DEBUG - 



2025-11-12 13:35:09,026 - ispa_next.main - DEBUG - starting with process 12 (LIP-FB 273) of 12
2025-11-12 13:35:09,029 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:35:09,972 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:35:10,857 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-12 13:35:10,858 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-12 13:35:12,187 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:35:12,188 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:35:38,891 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:35:40,782 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:35:45,916 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:49,267 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:35:49,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:49,327 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:35:49,509 - ispa_next.functions - DEBUG - HU date already expired after 3 days.
2025-11-12 13:35:53,402 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:35:53,405 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:35:53,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:53,522 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:35:56,708 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:35:56,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:35:57,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:35:59,909 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:36:00,012 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:36:00,164 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:36:00,248 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:36:04,418 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:36:05,423 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:36:05,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:05,938 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:19,495 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:36:23,461 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:36:23,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:23,545 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:36:23,546 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:36:23,580 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:36:24,852 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:36:25,059 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:36:26,534 - ispa_next.functions - DEBUG - Updated appointment (AF00021399) customer contact data.
2025-11-12 13:36:27,472 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:36:27,473 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:36:28,280 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:36:28,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:36:29,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:36:32,832 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:36:32,832 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:36:32,851 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:36:32,854 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:36:32,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:36:33,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:36:42,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:42,541 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:42,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:36:43,380 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:36:43,381 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:36:46,403 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:36:46,406 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:36:47,796 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:36:47,797 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:36:47,801 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:36:47,804 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:36:47,806 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:36:47,809 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:36:47,811 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:36:47,815 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:36:47,816 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:36:47,818 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:36:47,819 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:36:47,820 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:36:47,823 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:36:47,824 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:36:47,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:51,084 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:36:51,085 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:36:51,092 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:54,384 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:36:54,385 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:36:54,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:36:55,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:36:56,021 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:10,229 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:37:10,231 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:13,522 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:37:13,523 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:37:14,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:37:14,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:37:14,731 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:21,931 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:25,775 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:30,167 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:35,750 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:35,752 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:37:35,753 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:36,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:37:36,483 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:37:36,484 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:37:38,324 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:37:46,193 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:37:46,569 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 13:37:47,314 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:48,044 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-12 13:37:48,045 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:50,602 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-12 13:37:50,604 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:37:51,508 - ispa_next.appointments.models - DEBUG - Appointment Jowat SE LIP-JW 898 WBA11GW010CV70666 ohne Termin.
2025-11-12 13:37:51,516 - ispa_next.appointments.models - DEBUG - Appointment Jochen Jens Hillgemann LIP-JK 43 WBABN51050JT62788 ohne Termin.
2025-11-12 13:37:51,526 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
