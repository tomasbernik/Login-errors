2025-11-12 12:02:47,686 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 12:02:47,697 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 12:03:00,095 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:03:13,166 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:03:29,048 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:03:54,228 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 12:04:11,254 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 12:04:15,072 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:04:16,656 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 383
2025-11-12 12:04:16,658 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 12:04:20,200 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 139
2025-11-12 12:04:20,201 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 12:04:20,202 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:04:21,687 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:04:23,117 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:04:49,651 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:04:49,734 - ispa_next.appointments.models - DEBUG - Appointment Manuel Hermann Jaeger-Lenne GV-MJ 1989 WBAJG11030ED57177 ohne Termin.
2025-11-12 12:04:49,757 - ispa_next.appointments.models - DEBUG - Appointment Armaturen Vertrieb Alms GmbH ME-AA 340E WBY71AW020FT62013 ohne Termin.
2025-11-12 12:04:49,767 - ispa_next.appointments.models - DEBUG - Appointment   WBA11FZ090FR60998 ohne Termin.
2025-11-12 12:04:49,777 - ispa_next.appointments.models - DEBUG - Appointment Bianca Prins VIE-PE 881 WBA11AW010FL84234 ohne Termin.
2025-11-12 12:04:49,787 - ispa_next.appointments.models - DEBUG - Appointment Oliver Berndsen NE-JO 288E WBY31FK070CR63503 ohne Termin.
2025-11-12 12:04:49,802 - ispa_next.appointments.models - DEBUG - Appointment   WBY61EF0105W96493 ohne Termin.
2025-11-12 12:04:49,811 - ispa_next.appointments.models - DEBUG - Appointment Krajnc ME-VV 1979 WBA11EV0209W56488 ohne Termin.
2025-11-12 12:04:49,828 - ispa_next.main - DEBUG - Found 15 out of 30 appointments to process (configured limit: 15).
2025-11-12 12:04:49,829 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-12 12:04:49,829 - ispa_next.main - DEBUG - Processing 11 already visited appointments (w/ RKR not callable).
2025-11-12 12:04:49,829 - ispa_next.main - DEBUG - All appointments: NU-P 2200, F-S685E, NE-X 1660, NE-RK 63, D-HW 238, NE-MS 2311, NE-EG 1989, NE-GB 2917, D-NE 397, NE-EY 9, NE-RI 1352, NE-IM 149, KR-HK 6000, NE-IK 4000, VIE-RJ 766
2025-11-12 12:04:49,832 - ispa_next.main - DEBUG - 



2025-11-12 12:04:49,832 - ispa_next.main - DEBUG - starting with process 1 (NU-P 2200) of 15
2025-11-12 12:04:49,836 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:04:51,243 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:04:52,843 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 383
2025-11-12 12:04:52,844 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 139
2025-11-12 12:04:54,434 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:04:54,435 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:05:31,015 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:05:41,956 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:05:42,033 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:05:42,339 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:05:45,755 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:05:45,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:05:45,921 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:05:46,230 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:05:46,233 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:05:49,214 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:05:49,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:05:50,713 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:05:52,716 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:05:52,868 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:05:53,019 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:05:53,172 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:05:59,460 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:06:08,500 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 12:06:09,506 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:06:09,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:06:10,157 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:06:26,652 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:06:35,938 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:06:35,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:06:36,032 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:06:36,034 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:06:36,113 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:06:37,770 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:06:38,167 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:06:42,198 - ispa_next.functions - DEBUG - Updated appointment (AA00025035) customer contact data.
2025-11-12 12:06:43,141 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:06:43,143 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:06:44,221 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:06:44,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:06:45,031 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:06:48,701 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:06:48,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:06:49,239 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:06:51,241 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:06:51,446 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:06:51,608 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:06:51,756 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:06:58,049 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:07:07,190 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 12:07:08,195 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:07:08,199 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:07:08,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:07:08,281 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:07:08,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:07:09,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:07:09,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:07:10,378 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:07:10,379 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:07:13,700 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:07:13,727 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:07:14,935 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:07:14,937 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:07:14,940 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 12:07:14,942 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:07:14,946 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:07:14,951 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:07:14,953 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:07:14,954 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:07:14,956 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:07:14,957 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:07:14,960 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:07:14,963 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:07:14,965 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:07:14,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:07:18,523 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:07:18,526 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:07:18,529 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:07:21,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:07:22,011 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:07:32,010 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:07:46,195 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:07:46,197 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:07:46,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:07:47,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:07:47,107 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:07:47,136 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:07:50,434 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:08:02,917 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:08:03,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:08:03,911 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:08:04,200 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:08:30,718 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:08:30,719 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:08:31,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:08:31,596 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:08:31,597 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:08:36,511 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:08:48,813 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:08:49,236 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 12:08:50,944 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:08:51,815 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:08:51,816 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:08:56,033 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 12:08:56,034 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:08:57,094 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:08:57,108 - ispa_next.main - DEBUG - 



2025-11-12 12:08:57,108 - ispa_next.main - DEBUG - starting with process 2 (F-S685E) of 15
2025-11-12 12:08:57,112 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:08:58,638 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:09:00,451 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:09:00,453 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 12:09:02,321 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:09:02,322 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:09:39,839 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:09:39,998 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 12:09:40,002 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:09:40,749 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:09:40,750 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:09:44,071 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 12:09:44,072 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:09:45,288 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:09:45,315 - ispa_next.main - DEBUG - 



2025-11-12 12:09:45,315 - ispa_next.main - DEBUG - starting with process 3 (NE-X 1660) of 15
2025-11-12 12:09:45,320 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:09:46,842 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:09:48,620 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:09:48,622 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 12:09:50,555 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:09:50,556 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:10:25,191 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:10:36,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:10:36,870 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:10:37,100 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:10:44,736 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:10:44,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:10:44,869 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:10:45,240 - ispa_next.functions - DEBUG - HU date soon to be invalid in 4 days.
2025-11-12 12:10:53,524 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:10:53,528 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:10:56,414 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:10:56,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:10:57,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:10:59,896 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:11:00,031 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:11:00,199 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:11:00,367 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:11:00,369 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:11:08,408 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:11:20,245 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 12:11:25,938 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:11:25,940 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:11:35,802 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 12:11:39,399 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 12:11:41,644 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:11:44,607 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:11:45,612 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:11:45,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:46,141 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:12:02,595 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:12:12,451 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:12:12,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:12:12,618 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:12:12,619 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:12:12,869 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:12:13,110 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:12:14,946 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:12:15,312 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:12:19,004 - ispa_next.functions - DEBUG - Updated appointment (AC00010688) customer contact data.
2025-11-12 12:12:20,012 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:12:20,014 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:12:20,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:12:21,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:12:22,683 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:12:22,684 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:12:22,878 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:12:26,511 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:12:26,511 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:12:26,514 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:12:26,517 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:12:26,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:12:27,035 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:12:27,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:12:28,019 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:12:28,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:12:28,848 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:12:28,850 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:12:30,440 - ispa_next.package_manager.helper - DEBUG - couldn't retrieve pakage name in cart
2025-11-12 12:12:30,901 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 262, in run
    self._update_cart_content()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 36, in _update_cart_content
    self.containers[Container.CART] = self.ui_helper.get_cart_content(self.base_element)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 141, in get_cart_content
    name=cart_package_name,
         ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'cart_package_name' where it is not associated with a value

2025-11-12 12:12:30,931 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:12:30,932 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:12:31,936 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:12:32,641 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:12:32,643 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 12:12:32,667 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 12:12:36,660 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 12:12:36,663 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:12:37,393 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:12:37,395 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:12:41,655 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 12:12:41,656 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:12:42,762 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:12:42,782 - ispa_next.main - DEBUG - 



2025-11-12 12:12:42,782 - ispa_next.main - DEBUG - starting with process 4 (NE-RK 63) of 15
2025-11-12 12:12:42,788 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:12:44,327 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:12:46,222 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:12:46,224 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 12:12:47,852 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:12:47,853 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:13:15,572 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:13:26,578 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:13:28,560 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:13:28,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:13:28,651 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:13:28,944 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:13:28,947 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:13:31,828 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:13:31,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:13:32,154 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 12:13:32,593 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 12:13:32,611 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:13:32,612 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:13:33,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:13:34,143 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:13:34,145 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 12:13:34,169 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 12:13:37,403 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 12:13:37,406 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:13:37,923 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:13:37,924 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:13:42,572 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 12:13:42,573 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:13:43,981 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:13:43,989 - ispa_next.main - DEBUG - 



2025-11-12 12:13:43,990 - ispa_next.main - DEBUG - starting with process 5 (D-HW 238) of 15
2025-11-12 12:13:43,993 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:13:45,443 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:13:47,180 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:13:47,182 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 12:13:49,014 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:13:49,016 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:14:16,566 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:14:19,370 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:14:25,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:14:25,218 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:14:25,454 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:14:27,390 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:14:27,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:14:27,472 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:14:27,838 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:14:27,842 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:14:30,773 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:14:30,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:14:32,241 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:14:34,245 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:14:34,435 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:14:34,583 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:14:34,677 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:14:34,679 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:14:36,956 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:14:45,781 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:14:46,786 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:14:46,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:14:47,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:15:04,706 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:15:09,706 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:15:09,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:15:09,801 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:15:09,802 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:15:09,876 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:15:11,499 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:15:11,921 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:15:13,871 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:15:13,873 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:15:15,121 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:15:15,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:15:16,036 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:15:19,729 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:15:19,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:15:20,234 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:15:22,237 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:15:22,399 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:15:22,615 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:15:22,699 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:15:22,701 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:15:24,839 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:15:33,391 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:16:33,393 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:16:41,967 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:17:16,968 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:17:25,731 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:17:34,408 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 12:17:35,414 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:17:35,417 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:17:35,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:17:35,575 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:17:41,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:17:41,699 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:17:41,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:17:42,421 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:17:42,423 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:17:44,551 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:17:44,553 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:17:45,789 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:17:45,791 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:17:45,793 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 12:17:45,794 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:17:45,795 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:17:45,798 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:17:45,799 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:17:45,800 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:17:45,803 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:17:45,804 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:17:45,806 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:17:45,810 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:17:45,812 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:17:45,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:17:47,856 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:17:47,858 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:17:47,860 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:17:49,918 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:17:49,920 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:17:49,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:17:50,717 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:17:50,803 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:17:50,806 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:17:53,105 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:18:05,742 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:18:06,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:18:06,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:18:06,964 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:18:26,042 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:18:31,901 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:18:31,904 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:18:31,905 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:18:32,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:18:32,762 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:18:32,764 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:18:34,997 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:18:44,594 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:18:44,996 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 12:18:46,132 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:18:47,021 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:18:47,022 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:18:51,354 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 12:18:51,355 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:18:52,508 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:18:52,519 - ispa_next.main - DEBUG - 



2025-11-12 12:18:52,519 - ispa_next.main - DEBUG - starting with process 6 (NE-MS 2311) of 15
2025-11-12 12:18:52,522 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:18:54,033 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:18:55,727 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:18:55,729 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 12:18:57,617 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:18:57,618 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:19:38,346 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:19:40,618 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:19:46,237 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:19:48,208 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:19:48,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:48,380 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:19:48,724 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:19:48,728 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:19:51,651 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:19:51,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:52,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:19:54,992 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:19:55,215 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:19:55,362 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:19:55,455 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:19:59,759 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:20:00,765 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:20:00,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:01,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:16,254 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:20:16,274 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:20:21,024 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:20:21,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:21,168 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:20:21,169 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:20:21,247 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:20:22,685 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:20:24,353 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:20:24,707 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:20:26,566 - ispa_next.functions - DEBUG - Updated appointment (AB00014473) customer contact data.
2025-11-12 12:20:27,538 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:20:27,540 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:20:28,550 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:20:28,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:20:29,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:20:33,766 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 12:20:33,767 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:20:33,767 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:20:33,769 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:20:33,772 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:20:33,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:34,296 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:20:37,861 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:38,435 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:38,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:39,325 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:20:39,326 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:20:41,453 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:20:41,456 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:20:43,158 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:20:43,159 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:20:43,162 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 12:20:43,163 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:20:43,164 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:20:43,167 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:20:43,168 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:20:43,170 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:20:43,172 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:20:43,173 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:20:43,176 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:20:43,179 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:20:43,181 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:20:43,181 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:45,209 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:20:45,211 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:20:45,215 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:47,327 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:20:47,329 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:20:47,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:20:48,275 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:20:48,571 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:57,871 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:20:57,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:00,019 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:21:13,397 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:21:13,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:21:14,535 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:21:14,784 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:33,785 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:21:39,449 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:21:39,452 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:21:39,453 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:21:40,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:21:40,353 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:21:40,355 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:21:42,544 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:21:52,449 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:21:52,837 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 12:21:54,093 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:21:54,937 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:21:54,938 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:21:59,178 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 12:21:59,179 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:22:00,286 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:22:00,318 - ispa_next.main - DEBUG - 



2025-11-12 12:22:00,319 - ispa_next.main - DEBUG - starting with process 7 (NE-EG 1989) of 15
2025-11-12 12:22:00,324 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:22:01,871 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:22:03,534 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:22:03,535 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 12:22:05,521 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:22:05,522 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:22:39,251 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:22:41,957 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:22:47,433 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:22:50,212 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:22:50,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:50,342 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:22:50,668 - ispa_next.functions - DEBUG - HU date already expired after 808 days.
2025-11-12 12:22:55,908 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:22:55,912 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:22:58,793 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:22:58,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:00,224 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:23:02,227 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:23:02,371 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:23:02,490 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:23:02,590 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:23:04,759 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:23:05,764 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:23:05,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:06,268 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:23,668 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:23:28,984 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:23:28,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:29,093 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:23:29,094 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:23:29,189 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:23:29,445 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:23:31,075 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:23:31,435 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:23:34,080 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:23:34,133 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:23:34,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:23:35,389 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:23:36,575 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:23:36,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:23:36,652 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:23:40,349 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:23:40,349 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:23:40,352 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:23:40,355 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:23:40,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:40,892 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:23:41,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:41,880 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:41,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:42,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:23:42,705 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:23:45,390 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:23:45,392 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:23:47,214 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:23:47,215 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:23:47,218 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 12:23:47,219 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:23:47,220 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:23:47,224 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:23:47,225 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:23:47,226 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:23:47,229 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:23:47,230 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:23:47,232 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:23:47,235 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:23:47,237 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:23:47,238 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:50,137 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:23:50,139 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:23:50,156 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:52,915 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:23:52,917 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:23:52,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:23:53,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:23:54,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:03,559 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:24:03,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:06,324 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:24:19,905 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:24:20,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:24:21,069 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:24:21,227 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:48,723 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:24:54,048 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:24:59,224 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:24:59,226 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:24:59,227 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:25:00,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:25:00,143 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:25:00,145 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:25:02,373 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:25:12,219 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:25:12,623 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 12:25:14,200 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:25:15,158 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:25:15,159 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:25:19,719 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 12:25:19,720 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:25:20,989 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:25:20,996 - ispa_next.main - DEBUG - 



2025-11-12 12:25:20,996 - ispa_next.main - DEBUG - starting with process 8 (NE-GB 2917) of 15
2025-11-12 12:25:20,999 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:25:22,547 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:25:24,272 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:25:24,273 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 12:25:26,542 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:25:26,544 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:26:04,185 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:26:06,577 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:26:12,091 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:14,777 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:26:14,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:26:14,892 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:26:15,215 - ispa_next.functions - DEBUG - HU date already expired after 435 days.
2025-11-12 12:26:20,339 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:26:20,342 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:26:23,244 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:26:23,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:26:24,472 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:26:26,534 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:26:26,668 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:26:26,818 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:26:26,965 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:26:31,196 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:26:32,201 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:26:32,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:26:32,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:26:49,624 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:26:54,951 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:26:54,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:26:55,029 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:26:55,030 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:26:55,182 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:26:55,359 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:26:57,053 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:26:57,446 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:26:59,228 - ispa_next.functions - DEBUG - Updated appointment (AC00010673) customer contact data.
2025-11-12 12:27:00,274 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:27:00,276 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:27:00,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:27:01,926 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:27:03,206 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:27:03,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:27:03,357 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:27:07,403 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:27:07,403 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:27:07,406 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:27:07,409 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:27:07,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:27:07,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:27:08,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:09,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:09,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:27:09,963 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:27:09,965 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:27:12,727 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:27:12,741 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:27:14,187 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:27:14,188 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:27:14,191 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 12:27:14,192 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:27:14,193 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:27:14,196 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:27:14,197 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:27:14,198 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:27:14,200 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:27:14,201 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:27:14,204 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:27:14,207 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:27:14,209 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:27:14,210 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:27:17,104 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:27:17,106 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:27:17,122 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:27:19,998 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:27:19,999 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:27:20,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:27:20,938 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:27:21,062 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:27:27,354 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:27:27,356 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:27:30,078 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:27:42,898 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:27:43,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:27:43,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:27:44,210 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:28:11,992 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:28:17,534 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:28:22,827 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:28:22,830 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:28:22,830 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:28:23,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:28:23,751 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:28:23,753 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:28:26,081 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:28:36,002 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:28:36,398 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 12:28:37,623 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:28:38,581 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:28:38,583 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:28:43,225 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 12:28:43,226 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:28:44,461 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:28:44,477 - ispa_next.main - DEBUG - 



2025-11-12 12:28:44,477 - ispa_next.main - DEBUG - starting with process 9 (D-NE 397) of 15
2025-11-12 12:28:44,482 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:28:45,965 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:28:47,520 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:28:47,521 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 12:28:49,431 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:28:49,432 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:29:24,665 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:29:27,235 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:29:33,394 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:29:39,747 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:29:39,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:29:39,850 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:29:40,152 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:29:40,155 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:29:43,227 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:29:43,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:29:44,427 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:29:46,430 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:29:46,611 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:29:46,759 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:29:46,904 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:29:51,132 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:29:52,137 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:29:52,138 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:29:52,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:09,156 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:30:14,648 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:30:14,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:14,781 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:30:14,782 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:30:14,965 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:30:15,133 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:30:16,683 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:30:17,011 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:30:18,996 - ispa_next.functions - DEBUG - Updated appointment (AA00024911) customer contact data.
2025-11-12 12:30:19,951 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:30:19,956 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:30:20,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:30:21,841 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:30:23,184 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:30:23,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:30:23,297 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:30:26,910 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:30:26,910 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:30:26,913 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:30:26,916 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:30:26,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:30:27,468 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:30:27,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:28,469 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:28,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:30:29,341 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:30:29,343 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:30:35,348 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:30:35,350 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:30:36,630 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:30:36,632 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:30:36,635 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 12:30:36,636 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:30:36,637 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:30:36,640 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:30:36,641 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:30:36,642 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:30:36,645 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:30:36,646 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:30:36,649 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:30:36,652 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:30:36,654 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:30:36,655 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:30:43,069 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:30:43,071 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:30:43,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:30:49,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:30:49,437 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:31:04,287 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:31:04,290 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:31:04,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:31:05,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:31:05,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:31:19,329 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:31:19,332 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:31:25,732 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:31:39,953 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:31:40,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:31:41,060 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:31:41,239 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:32:41,803 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:32:48,378 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:32:54,027 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:33:00,231 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:33:07,222 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:33:13,444 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:33:18,790 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:33:25,578 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:33:30,105 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:33:30,106 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:33:30,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:33:31,136 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:33:31,138 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:33:36,091 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:33:47,274 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:33:47,709 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 12:33:49,587 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:33:50,534 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:33:50,535 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:33:55,355 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 12:33:55,356 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:33:56,488 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:33:56,501 - ispa_next.main - DEBUG - 



2025-11-12 12:33:56,501 - ispa_next.main - DEBUG - starting with process 10 (NE-EY 9) of 15
2025-11-12 12:33:56,506 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:33:58,154 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:33:59,958 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:33:59,960 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 12:34:01,835 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:34:01,836 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:34:44,139 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:34:46,550 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:34:52,199 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:34:54,241 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:34:54,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:34:54,413 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:34:54,673 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:34:54,681 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:34:57,739 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:34:57,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:34:59,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:35:01,379 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:35:01,518 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:35:01,692 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:35:01,826 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:35:06,107 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:35:07,113 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:35:07,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:07,665 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:24,995 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:35:30,057 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:35:30,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:30,188 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:35:30,189 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:35:30,242 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:35:31,776 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:35:32,146 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:35:35,415 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:35:35,416 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:35:36,364 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:35:36,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:35:37,612 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:35:41,250 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:35:41,250 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:35:41,253 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:35:41,257 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:35:41,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:35:41,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:35:42,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:42,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:42,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:35:43,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:35:43,775 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:35:45,766 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:35:45,769 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:35:47,199 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:35:47,201 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:35:47,205 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 12:35:47,208 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:35:47,211 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:35:47,215 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:35:47,216 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:35:47,218 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:35:47,221 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:35:47,222 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:35:47,224 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:35:47,227 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:35:47,229 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:35:47,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:35:49,351 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:35:49,353 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:35:49,355 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:35:51,494 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:35:51,496 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:35:51,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:35:52,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:35:53,179 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:02,411 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:36:02,412 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:04,515 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:36:17,932 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:36:18,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:36:19,056 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:36:19,318 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:38,374 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:36:44,566 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:36:44,569 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:36:44,570 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:36:45,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:36:45,433 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:36:45,435 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:36:47,744 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:36:57,771 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:36:58,170 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 12:36:59,639 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:37:00,747 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:37:00,748 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:37:05,110 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 12:37:05,111 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:37:06,227 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:37:06,234 - ispa_next.main - DEBUG - 



2025-11-12 12:37:06,235 - ispa_next.main - DEBUG - starting with process 11 (NE-RI 1352) of 15
2025-11-12 12:37:06,238 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:37:07,835 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:37:09,624 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:37:09,626 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 12:37:11,773 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:37:11,774 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:37:57,109 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:37:59,529 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:38:05,182 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:38:07,211 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:38:07,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:38:07,329 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:38:07,754 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:38:07,757 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:38:10,803 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:38:10,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:38:12,401 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:38:14,404 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:38:14,592 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:38:14,814 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:38:14,985 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:38:19,347 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:38:20,352 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:38:20,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:38:20,897 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:38:38,246 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:38:43,326 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:38:43,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:38:43,477 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:38:43,478 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:38:43,555 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:38:45,158 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:38:45,536 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:38:47,587 - ispa_next.functions - DEBUG - Updated appointment (AC00010676) customer contact data.
2025-11-12 12:38:48,492 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:38:48,495 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:38:49,733 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:38:49,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:38:50,965 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:38:55,113 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 12:38:55,114 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:38:55,114 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:38:55,118 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:38:55,122 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:38:55,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:38:55,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:39:00,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:00,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:00,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:39:01,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:39:01,635 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:39:03,768 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:39:03,770 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:39:05,713 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:39:05,714 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:39:05,717 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 12:39:05,718 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:39:05,720 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:39:05,722 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:39:05,723 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:39:05,724 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:39:05,727 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:39:05,728 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:39:05,731 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:39:05,734 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:39:05,736 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:39:05,736 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:07,963 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:39:07,964 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:39:07,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:10,022 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:39:10,023 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:39:10,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:39:11,368 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:39:11,662 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:21,344 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:39:21,345 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:23,416 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:39:37,520 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:39:38,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:39:38,678 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:39:38,897 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:58,186 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:40:04,305 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:40:04,307 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:40:04,308 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:40:05,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:40:05,215 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:40:05,227 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:40:07,652 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:40:17,791 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:40:18,239 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 12:40:19,551 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:40:20,559 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:40:20,561 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:40:24,612 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 12:40:24,612 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:40:25,785 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:40:25,792 - ispa_next.main - DEBUG - 



2025-11-12 12:40:25,792 - ispa_next.main - DEBUG - starting with process 12 (NE-IM 149) of 15
2025-11-12 12:40:25,795 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:40:27,313 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:40:29,119 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 384
2025-11-12 12:40:29,120 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 12:40:31,194 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:40:31,196 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:41:16,918 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:41:19,519 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:41:26,273 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:41:29,073 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:41:29,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:29,261 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:41:29,618 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 12:41:34,772 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:41:34,774 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:41:37,658 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:41:37,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:41:39,246 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:41:41,313 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:41:41,447 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:41:41,585 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:41:41,765 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:41:43,926 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:41:44,931 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:41:44,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:45,513 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:42:03,693 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:42:09,895 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:42:09,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:42:10,039 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:42:10,040 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:42:10,154 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:42:10,333 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:42:12,112 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:42:12,466 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:42:14,645 - ispa_next.functions - DEBUG - Updated appointment (AA00024982) customer contact data.
2025-11-12 12:42:15,598 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:42:15,601 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:42:15,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:42:17,102 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:42:18,806 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:42:18,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:42:18,983 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:42:23,054 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:42:23,054 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:42:23,058 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:42:23,062 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:42:23,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:42:23,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:42:24,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:42:24,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:42:24,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:42:25,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:42:25,629 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:42:28,313 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:42:28,327 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:42:31,091 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:42:31,093 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:42:31,095 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 12:42:31,096 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:42:31,097 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:42:31,100 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:42:31,101 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:42:31,102 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:42:31,105 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:42:31,106 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:42:31,108 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:42:31,111 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:42:31,113 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:42:31,115 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:34,116 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:42:34,117 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:42:34,119 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:36,856 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:42:36,858 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:42:36,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:42:38,131 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:42:38,448 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:53,322 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:42:53,325 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:56,097 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:43:10,011 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:43:10,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:43:11,251 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:43:11,410 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:43:38,198 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:43:44,037 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:43:49,792 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:43:49,794 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:43:49,795 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:43:50,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:43:50,719 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:43:50,721 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:43:53,138 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:44:04,881 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:44:05,301 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 12:44:06,824 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:44:07,906 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 385
2025-11-12 12:44:07,907 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:44:13,026 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 144
2025-11-12 12:44:13,027 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:44:14,278 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:44:14,290 - ispa_next.main - DEBUG - 



2025-11-12 12:44:14,290 - ispa_next.main - DEBUG - starting with process 13 (KR-HK 6000) of 15
2025-11-12 12:44:14,295 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:44:15,867 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:44:17,786 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 385
2025-11-12 12:44:17,788 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 144
2025-11-12 12:44:19,972 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:44:19,974 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:45:06,481 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:45:08,985 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:45:14,727 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:18,875 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:45:18,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:18,993 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:45:19,412 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:45:19,415 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:45:22,350 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:45:22,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:24,042 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:45:26,048 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:45:26,219 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:45:26,359 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:45:26,438 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:45:30,755 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:45:31,760 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:45:31,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:32,298 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:49,831 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:45:55,312 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:45:55,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:55,477 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:45:55,478 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:45:55,590 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:45:55,735 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:45:57,439 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:45:57,766 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:46:00,185 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:46:00,186 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:46:00,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:46:01,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:46:02,873 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:46:02,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:46:03,019 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:46:06,652 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:46:06,652 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:46:06,655 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:46:06,659 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:46:06,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:46:08,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:46:16,994 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 12:46:29,089 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 12:46:29,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:46:30,440 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:46:30,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:46:31,222 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:46:31,224 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:46:35,106 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:46:35,110 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:46:37,638 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:46:37,639 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:46:37,643 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 12:46:37,644 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:46:37,646 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:46:37,650 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:46:37,651 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:46:37,653 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:46:37,656 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:46:37,657 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:46:37,660 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:46:37,663 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:46:37,666 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:46:37,666 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:46:42,050 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:46:42,054 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:46:42,057 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:46:46,244 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:46:46,247 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:46:46,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:46:47,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:46:47,420 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:47:02,427 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:47:02,429 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:47:06,588 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:47:20,720 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:47:21,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:47:21,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:47:22,036 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:03,957 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:48:10,743 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:48:16,148 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:48:22,930 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:48:29,533 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:48:29,535 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:48:29,536 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:48:30,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:48:30,457 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:48:30,459 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:48:32,912 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:48:44,171 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:48:44,582 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 12:48:46,037 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:48:47,182 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 12:48:47,184 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:48:53,066 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-12 12:48:53,067 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:48:54,159 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:48:54,164 - ispa_next.main - DEBUG - Found new Appointment: HN-RP 950
2025-11-12 12:48:54,166 - ispa_next.main - DEBUG - 



2025-11-12 12:48:54,166 - ispa_next.main - DEBUG - starting with process 14 (HN-RP 950) of 16
2025-11-12 12:48:54,169 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:48:55,726 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:48:57,385 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 12:48:57,386 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-12 12:48:59,536 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:48:59,538 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:49:37,996 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:49:50,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:49:54,240 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:49:54,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:49:54,393 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:49:54,773 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:49:54,776 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:49:57,796 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:49:57,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:49:59,581 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:50:01,583 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:50:01,822 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:50:05,121 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:50:05,243 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:50:07,406 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:50:08,411 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:50:08,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:50:08,987 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:50:25,281 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:50:35,619 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:50:35,621 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:50:35,910 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:50:35,911 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:50:36,005 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:50:36,194 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:50:38,251 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:50:38,621 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:50:41,070 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:50:41,235 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:50:41,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:50:43,524 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:50:45,504 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:50:45,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:50:45,959 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:50:50,493 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:50:50,493 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:50:51,012 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:50:51,015 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:50:51,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:50:52,017 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:50:57,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:50:58,136 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:50:58,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:50:59,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:50:59,002 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:51:03,084 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:51:03,087 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:51:04,776 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:51:04,777 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:51:04,780 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 12:51:04,781 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:51:04,782 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:51:04,785 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:51:04,787 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:51:04,788 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:51:04,791 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:51:04,792 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:51:04,795 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:51:04,799 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:51:04,801 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:51:04,802 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:51:09,178 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:51:09,180 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:51:09,182 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:51:13,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:51:13,532 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:51:23,726 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:51:39,186 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:51:39,188 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:51:39,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:51:40,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:51:40,523 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:51:49,206 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:51:49,208 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:51:53,499 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:52:07,761 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:52:08,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:52:08,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:52:09,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:50,377 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:52:57,756 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:53:03,757 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:53:09,810 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:53:15,765 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:53:23,116 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:53:23,117 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:53:23,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:53:24,037 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:53:24,039 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:53:30,416 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:53:41,391 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:53:41,799 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 12:53:44,010 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:53:45,164 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 12:53:45,165 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:53:50,256 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-12 12:53:50,257 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:53:51,571 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:53:51,577 - ispa_next.main - DEBUG - 



2025-11-12 12:53:51,577 - ispa_next.main - DEBUG - starting with process 15 (NE-IK 4000) of 16
2025-11-12 12:53:51,580 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:53:53,212 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:53:55,016 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 12:53:55,017 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-12 12:53:57,190 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:53:57,192 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:54:40,910 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:54:43,410 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:54:49,228 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:54:52,777 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:54:52,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:54:52,895 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:54:53,282 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:54:53,286 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:54:56,410 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:54:56,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:54:58,016 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:55:00,020 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:55:00,187 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:55:00,372 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:55:00,548 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:55:04,777 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:55:05,782 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:55:05,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:55:06,388 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:55:24,252 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:55:30,040 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:55:30,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:55:30,180 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:55:30,181 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:55:30,256 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:55:30,503 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:55:32,030 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:55:32,394 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:55:34,919 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:55:34,921 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:55:35,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:55:36,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:55:37,685 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:55:37,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:55:37,829 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:55:41,492 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:55:41,492 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:55:41,495 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:55:41,499 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:55:41,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:55:42,024 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:55:45,944 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 12:55:57,635 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 12:55:58,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:55:58,909 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:55:58,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:55:59,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:55:59,677 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:56:02,995 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:56:02,997 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:56:04,192 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:56:04,195 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:56:04,199 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 12:56:04,203 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:56:04,204 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:56:04,208 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:56:04,210 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:56:04,211 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:56:04,214 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:56:04,215 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:56:04,217 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:56:04,220 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:56:04,223 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:56:04,224 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:56:07,766 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:56:07,767 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:56:07,769 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:56:11,339 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:56:11,341 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:56:11,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:56:12,656 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:56:12,961 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:56:22,540 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:56:22,544 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:56:25,964 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:56:40,699 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:56:41,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:56:42,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:56:42,240 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:57:15,997 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:57:21,969 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:57:27,226 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:57:34,492 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:57:34,494 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:57:34,495 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:57:35,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:57:35,371 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:57:35,373 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:57:37,920 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:57:48,553 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:57:48,964 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 12:57:50,517 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:57:51,589 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 12:57:51,591 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:57:57,609 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-12 12:57:57,610 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:57:58,756 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 12:57:58,762 - ispa_next.main - DEBUG - 



2025-11-12 12:57:58,762 - ispa_next.main - DEBUG - starting with process 16 (VIE-RJ 766) of 16
2025-11-12 12:57:58,765 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:58:00,370 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:58:02,128 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 12:58:02,130 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-12 12:58:04,388 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:58:04,389 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:58:54,594 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:58:57,467 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:59:03,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:59:03,612 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:59:03,802 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:59:08,327 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:59:08,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:59:08,430 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:59:08,850 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:59:08,856 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:59:11,988 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:59:11,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:59:13,691 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:59:15,694 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:59:15,826 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:59:15,982 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:59:16,136 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:59:16,138 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:59:19,769 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:59:28,816 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:59:29,821 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:59:29,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:59:30,339 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:59:47,646 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:59:54,049 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:59:54,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:59:54,189 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:59:54,190 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:59:54,264 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:59:54,419 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:59:56,422 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:59:56,799 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:59:59,162 - ispa_next.functions - DEBUG - Updated appointment (AA00025031) customer contact data.
2025-11-12 13:00:00,218 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:00:00,221 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:00:00,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:00:02,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:00:03,785 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:00:03,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:00:03,937 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:00:07,552 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:00:07,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:00:08,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:00:10,100 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:00:10,332 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:00:10,539 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:00:10,615 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:00:10,617 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:00:14,222 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:00:23,136 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:01:23,139 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:01:32,695 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:01:54,698 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:02:03,472 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:02:13,676 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 13:02:14,698 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:02:14,702 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:02:14,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:02:14,831 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:02:15,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:02:15,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:02:15,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:02:16,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:02:16,757 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:02:20,118 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:02:20,120 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:02:21,342 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:02:21,345 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:02:21,349 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:02:21,352 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:02:21,356 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:02:21,361 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:02:21,363 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:02:21,365 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:02:21,367 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:02:21,369 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:02:21,371 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:02:21,374 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:02:21,377 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:02:21,378 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:02:24,976 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:02:24,979 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:02:24,981 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:02:28,409 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:02:28,411 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:02:28,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:02:29,576 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:02:29,667 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:02:29,673 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:02:33,145 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:02:46,628 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:02:47,148 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:02:47,929 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:02:48,106 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:03:21,824 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:03:28,039 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:03:33,729 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:03:39,855 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:03:39,858 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:03:39,859 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:03:40,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:03:40,815 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:03:40,817 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:03:43,372 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:03:55,377 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:03:55,757 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 13:03:57,187 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:03:58,382 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 13:03:58,383 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:04:03,894 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-12 13:04:03,895 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:04:05,072 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
