2025-11-12 07:00:33,485 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 07:00:33,491 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 07:00:46,640 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:00:57,456 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:01:12,976 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:01:38,670 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 07:01:51,476 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 07:01:55,482 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:01:56,398 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:01:56,398 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 07:01:58,266 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 823
2025-11-12 07:01:58,267 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 07:01:58,268 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:01:59,470 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:02:00,463 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:03:59,130 - ispa_next.appointments.models - DEBUG - Appointment Gerhard Heierhoff NU-GH 5500 WBATX350X0NC21174 ohne Termin.
2025-11-12 07:03:59,162 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:03:59,190 - ispa_next.appointments.models - DEBUG - Appointment Marc-Oliver Simon UL-XS 94E WMW11DJ0702T73836 ohne Termin.
2025-11-12 07:03:59,199 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:03:59,225 - ispa_next.appointments.models - DEBUG - Appointment Luca Lissona NU-LL 2000 WBA5R11040FH06143 ohne Termin.
2025-11-12 07:03:59,253 - ispa_next.appointments.models - DEBUG - Appointment Carsten Werner NU-C 2705 WBAHF11050WW82664 ohne Termin.
2025-11-12 07:03:59,280 - ispa_next.appointments.models - DEBUG - Appointment Marcel Denis  WBAUX310X0A703707 ohne Termin.
2025-11-12 07:03:59,308 - ispa_next.appointments.models - DEBUG - Appointment Petrut-Marcelius Mindricel NU-KA 1990 WBAUG51020PV22612 ohne Termin.
2025-11-12 07:03:59,335 - ispa_next.appointments.models - DEBUG - Appointment Aline Walcher NU-XR 119 WBATY15050N035959 ohne Termin.
2025-11-12 07:03:59,367 - ispa_next.appointments.models - DEBUG - Appointment Wladislav Wiebe UL-SW 1204 WBAJT31030BV43579 ohne Termin.
2025-11-12 07:03:59,380 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:03:59,406 - ispa_next.appointments.models - DEBUG - Appointment Nadine Annabelle Peter UL-N 7218 WBATY55070N053421 ohne Termin.
2025-11-12 07:03:59,452 - ispa_next.appointments.models - DEBUG - Appointment Bogdan-Mihai Tritean NU-KL 2007 WBAVC31060VG12381 ohne Termin.
2025-11-12 07:03:59,481 - ispa_next.appointments.models - DEBUG - Appointment Günther Egner  WBAHF11090WW62966 ohne Termin.
2025-11-12 07:03:59,514 - ispa_next.appointments.models - DEBUG - Appointment Yannik Mario Missale BL-YM 99 WBA5V71060FH86625 ohne Termin.
2025-11-12 07:03:59,570 - ispa_next.appointments.models - DEBUG - Appointment Daniela Oßwald NU-DO 55 WBAUZ35030N001791 ohne Termin.
2025-11-12 07:03:59,598 - ispa_next.appointments.models - DEBUG - Appointment Dzafer Omerdic UL-DZ 74 WBAJP31070BT73165 ohne Termin.
2025-11-12 07:03:59,627 - ispa_next.appointments.models - DEBUG - Appointment Marcus Hermann BC-MP 307 WBAJP31050BT92541 ohne Termin.
2025-11-12 07:03:59,657 - ispa_next.appointments.models - DEBUG - Appointment   WBA5R11020FK27135 ohne Termin.
2025-11-12 07:03:59,687 - ispa_next.appointments.models - DEBUG - Appointment Ralf Pause NU-PX 88 WBAJM91050BH77340 ohne Termin.
2025-11-12 07:03:59,717 - ispa_next.appointments.models - DEBUG - Appointment Markus Henning UL-ML 35 WBA6L71060FJ55476 ohne Termin.
2025-11-12 07:03:59,751 - ispa_next.appointments.models - DEBUG - Appointment Hajro Gutic  WBAJP31030BT73745 ohne Termin.
2025-11-12 07:03:59,786 - ispa_next.appointments.models - DEBUG - Appointment Romina Reinhardt UL-JR 2202 WBAWY510900A40401 ohne Termin.
2025-11-12 07:03:59,825 - ispa_next.appointments.models - DEBUG - Appointment Emergenda NU-HK 202 WBA2D510805K80209 ohne Termin.
2025-11-12 07:03:59,866 - ispa_next.appointments.models - DEBUG - Appointment Philip Beck MA-LS 102 WBA31DX02LCD85300 ohne Termin.
2025-11-12 07:03:59,911 - ispa_next.appointments.models - DEBUG - Appointment Oula Alhajj BC-OH 2712 WBAVA71000KP97250 ohne Termin.
2025-11-12 07:03:59,944 - ispa_next.appointments.models - DEBUG - Appointment Matthias Hucker NU-CM 105 WBATX35030NE04318 ohne Termin.
2025-11-12 07:03:59,986 - ispa_next.appointments.models - DEBUG - Appointment Gregor Golaski WR-802GF WBA6L71020FJ48038 ohne Termin.
2025-11-12 07:04:00,030 - ispa_next.appointments.models - DEBUG - Appointment PERI SE NU-PE 85 WBA5F31060FK22508 ohne Termin.
2025-11-12 07:04:00,064 - ispa_next.appointments.models - DEBUG - Appointment Zoran Kadric NU-Z 1963 WBAVA71070KR36693 ohne Termin.
2025-11-12 07:04:00,103 - ispa_next.appointments.models - DEBUG - Appointment Demir Burak NU-BD 6 WBA81GE0607U10713 ohne Termin.
2025-11-12 07:04:00,167 - ispa_next.appointments.models - DEBUG - Appointment Dr. Sachs Andreas NU-XV 777 WBA5R71010FJ22363 ohne Termin.
2025-11-12 07:04:00,212 - ispa_next.appointments.models - DEBUG - Appointment Dominic Kreuzpaintner NU-DK 50 WBA71GP0809058750 ohne Termin.
2025-11-12 07:04:00,247 - ispa_next.appointments.models - DEBUG - Appointment Herbert Ronald Eichholz NU-RE 1021 WBA6L51020FJ56533 ohne Termin.
2025-11-12 07:04:00,274 - ispa_next.appointments.models - DEBUG - Appointment Dumitru-Danut Grosu NU-RD 71 WBAJM91040BH80214 ohne Termin.
2025-11-12 07:04:00,302 - ispa_next.appointments.models - DEBUG - Appointment Hasan Dikmen UL-KD 7238 WBA1V710605A67475 ohne Termin.
2025-11-12 07:04:00,328 - ispa_next.appointments.models - DEBUG - Appointment Axel Hansmann NU-DH 525 WBAJN11030BK38677 ohne Termin.
2025-11-12 07:04:00,357 - ispa_next.appointments.models - DEBUG - Appointment BMW Car IT GmbH M-JC 8400E WBY61EF0805419386 ohne Termin.
2025-11-12 07:04:00,398 - ispa_next.appointments.models - DEBUG - Appointment Bernd Schliefer ILL-KB 66 WBAJP31010BT73159 ohne Termin.
2025-11-12 07:04:00,440 - ispa_next.appointments.models - DEBUG - Appointment Max Hentschel NU-ME 2706 WBAJM91060BH38059 ohne Termin.
2025-11-12 07:04:00,467 - ispa_next.appointments.models - DEBUG - Appointment Valdrin Abazi  WBA11DY080FK03855 ohne Termin.
2025-11-12 07:04:00,498 - ispa_next.appointments.models - DEBUG - Appointment Alexander Schmid UL-AS 2220 WBAJP31060BT84111 ohne Termin.
2025-11-12 07:04:00,523 - ispa_next.appointments.models - DEBUG - Appointment Azem Alispahic NU-SL 701 WBAJP31060BT75599 ohne Termin.
2025-11-12 07:04:00,563 - ispa_next.appointments.models - DEBUG - Appointment Verena Wolf NU-BV 777 WBAJT51090CE05828 ohne Termin.
2025-11-12 07:04:00,589 - ispa_next.appointments.models - DEBUG - Appointment Markus Wieland NU-MW 1988 WBA5R110X0FJ58307 ohne Termin.
2025-11-12 07:04:00,617 - ispa_next.appointments.models - DEBUG - Appointment Klara Maria Bühler UL-RK 1606 WBATX35070NC11458 ohne Termin.
2025-11-12 07:04:00,650 - ispa_next.appointments.models - DEBUG - Appointment Eren Dogan UL-ER 462 WBAJN11080BK38366 ohne Termin.
2025-11-12 07:04:00,677 - ispa_next.appointments.models - DEBUG - Appointment Peter Wagner NU-XL 48 WBATY55020N009035 ohne Termin.
2025-11-12 07:04:00,704 - ispa_next.appointments.models - DEBUG - Appointment Sasa Fuchs UL-E 2299 WBA11AS0X0CE79272 ohne Termin.
2025-11-12 07:04:00,735 - ispa_next.appointments.models - DEBUG - Appointment Veselin Dokic NU-VD 443 WBA5V51090FH54319 ohne Termin.
2025-11-12 07:04:00,764 - ispa_next.appointments.models - DEBUG - Appointment Sonnentag Transporte GmbH GP-S 4500 WBAHF31020WW32817 ohne Termin.
2025-11-12 07:04:00,802 - ispa_next.appointments.models - DEBUG - Appointment Helmut Häuptle UL-MH 444 WBAVJ910X09C23552 ohne Termin.
2025-11-12 07:04:00,829 - ispa_next.appointments.models - DEBUG - Appointment Michael Durst BC-JD 2017 WBA6L51060FJ59063 ohne Termin.
2025-11-12 07:04:00,855 - ispa_next.appointments.models - DEBUG - Appointment Ervin Mujagic  WBATX35020NC23615 ohne Termin.
2025-11-12 07:04:00,895 - ispa_next.appointments.models - DEBUG - Appointment Arici Selcuk UL-KY 442 WBAVU31030KY03266 ohne Termin.
2025-11-12 07:04:00,926 - ispa_next.appointments.models - DEBUG - Appointment Jessin Patrick Manai RT-JM 1401 WBA5F380608B42512 ohne Termin.
2025-11-12 07:04:00,960 - ispa_next.appointments.models - DEBUG - Appointment Durna Zeynep Incedayi UL-PX 1 WMWXT710102C14755 ohne Termin.
2025-11-12 07:04:00,993 - ispa_next.appointments.models - DEBUG - Appointment Özlem Sandikci NU-EE 1903 WMWLR910602E68924 ohne Termin.
2025-11-12 07:04:01,009 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:01,040 - ispa_next.appointments.models - DEBUG - Appointment Bareiss Prüfgerätebau GmbH UL-CX 288 WBA61EE0705W35665 ohne Termin.
2025-11-12 07:04:01,072 - ispa_next.appointments.models - DEBUG - Appointment Thomas Fundel UL-TF 260 WBA5V71050FH67905 ohne Termin.
2025-11-12 07:04:01,103 - ispa_next.appointments.models - DEBUG - Appointment Leandra Kuschel UL-LQ 13 WBAVB31060VB69085 ohne Termin.
2025-11-12 07:04:01,136 - ispa_next.appointments.models - DEBUG - Appointment Guido Steinhauser BC-G 225 WBAWZ510400S27474 ohne Termin.
2025-11-12 07:04:01,166 - ispa_next.appointments.models - DEBUG - Appointment Daniela Feinäugle  WBA5F31050FJ57747 ohne Termin.
2025-11-12 07:04:01,195 - ispa_next.appointments.models - DEBUG - Appointment Izzet özcelik ILL-Z 57 WBADY31070E827083 ohne Termin.
2025-11-12 07:04:01,227 - ispa_next.appointments.models - DEBUG - Appointment Salih Karadeniz UL-SK 157 WBAJN71010BJ06939 ohne Termin.
2025-11-12 07:04:01,258 - ispa_next.appointments.models - DEBUG - Appointment Marco Troiano UL-MT 386 WBA1R510905L60132 ohne Termin.
2025-11-12 07:04:01,284 - ispa_next.appointments.models - DEBUG - Appointment Dieter Mack UL-DM 822 WBAHF11070WW89910 ohne Termin.
2025-11-12 07:04:01,319 - ispa_next.appointments.models - DEBUG - Appointment Autoforum-Muc NU-M 881 WBA11DX080CE08548 ohne Termin.
2025-11-12 07:04:01,353 - ispa_next.appointments.models - DEBUG - Appointment Hasib Mesic NU-HE 610 WBATX31060LC42685 ohne Termin.
2025-11-12 07:04:01,384 - ispa_next.appointments.models - DEBUG - Appointment Mustafa Iman UL-EE 324 WBAUD71050P268270 ohne Termin.
2025-11-12 07:04:01,412 - ispa_next.appointments.models - DEBUG - Appointment Jessin Patrick Manai RT-JM 1401 WBA5F380608B42512 ohne Termin.
2025-11-12 07:04:01,441 - ispa_next.appointments.models - DEBUG - Appointment Sascha Hankele NU-H 1820 WBAKD91000E653198 ohne Termin.
2025-11-12 07:04:01,469 - ispa_next.appointments.models - DEBUG - Appointment BMW Car IT GmbH M-JC 1039E WBY31AW010FP54558 ohne Termin.
2025-11-12 07:04:01,497 - ispa_next.appointments.models - DEBUG - Appointment Janos Loboda UL-LJ 197 WBAVD91090AE65139 ohne Termin.
2025-11-12 07:04:01,526 - ispa_next.appointments.models - DEBUG - Appointment Hannelore Seidel NU-HS 132 WBAUM510X0VE93058 ohne Termin.
2025-11-12 07:04:01,554 - ispa_next.appointments.models - DEBUG - Appointment Emre Iman UL-EX 323 WBAAM31010AZ47872 ohne Termin.
2025-11-12 07:04:01,589 - ispa_next.appointments.models - DEBUG - Appointment Muharrem Aluc UL-MA 5800 WBA5L31010G484486 ohne Termin.
2025-11-12 07:04:01,648 - ispa_next.main - DEBUG - Found 15 out of 208 appointments to process (configured limit: 15).
2025-11-12 07:04:01,649 - ispa_next.main - DEBUG - Processing 8 fresh appointments.
2025-11-12 07:04:01,649 - ispa_next.main - DEBUG - Processing 7 already visited appointments (w/ RKR not callable).
2025-11-12 07:04:01,649 - ispa_next.main - DEBUG - All appointments: NU-U 711, GA447, NU J 3339, 3508, ul vk1010, UL-ST2016, ILL-GO-67, UL HN 9695, UL-WI 8888, M-JC 234E, UL-K 1058, NU-RU 2509, NU-EL 699E, ILL-MI 11, UL-Z 89
2025-11-12 07:04:01,652 - ispa_next.main - DEBUG - 



2025-11-12 07:04:01,652 - ispa_next.main - DEBUG - starting with process 1 (NU-U 711) of 15
2025-11-12 07:04:01,661 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:04:02,913 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:04:04,084 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:04:04,086 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 823
2025-11-12 07:04:05,512 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:04:05,513 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:04:41,515 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:04:51,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:04:51,535 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:04:51,716 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:04:53,607 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:04:53,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:04:53,688 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:04:53,868 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:04:53,873 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:04:56,702 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:04:56,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:04:57,626 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:04:59,633 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:04:59,746 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:05:02,956 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:05:03,024 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:05:03,024 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:05:11,605 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:05:12,611 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:05:12,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:05:13,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:05:21,958 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:05:29,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:05:29,472 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:05:29,472 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 07:05:29,618 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-12 07:05:29,742 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-12 07:05:29,748 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:05:29,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:05:29,844 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:05:29,846 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:05:29,901 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:05:31,119 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:05:31,336 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:05:34,394 - ispa_next.functions - DEBUG - Updated appointment (AE00057143) customer contact data.
2025-11-12 07:05:35,308 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:05:35,310 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:05:36,245 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:05:36,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:05:37,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:05:41,499 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:05:41,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:05:42,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:05:44,016 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:05:44,106 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:05:44,238 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:05:44,303 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:05:44,304 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:05:55,645 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 07:06:00,474 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:06:00,475 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:06:04,686 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:06:05,693 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:06:05,695 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:06:05,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:06:05,826 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:06:09,935 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:06:09,942 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:06:09,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:06:10,017 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:06:18,752 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 07:06:26,978 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:06:26,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:06:27,645 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:06:27,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:06:28,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:06:28,273 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:06:30,762 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:06:30,769 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:06:31,777 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:06:31,779 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:06:31,781 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 07:06:31,783 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:06:31,803 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:06:31,805 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:06:31,809 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:06:31,811 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:06:31,811 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:06:31,813 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:06:31,813 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:06:31,821 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:06:31,825 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 07:06:54,354 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-12 07:06:54,456 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:06:54,458 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:06:55,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:06:56,039 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:06:56,043 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 07:06:56,073 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 07:06:58,665 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 07:06:58,670 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:06:59,806 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:06:59,808 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:07:02,827 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:07:02,828 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:07:03,676 - ispa_next.main - DEBUG - Found new Appointment: UL-XS 21
2025-11-12 07:07:03,678 - ispa_next.main - DEBUG - 



2025-11-12 07:07:03,678 - ispa_next.main - DEBUG - starting with process 2 (UL-XS 21) of 16
2025-11-12 07:07:03,683 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:07:05,047 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:07:06,293 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:07:06,295 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:07:07,802 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:07:07,804 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:07:33,340 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:07:35,587 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:07:40,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:07:44,342 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:07:44,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:07:44,422 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:07:44,582 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:07:44,584 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:07:47,411 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:07:47,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:07:48,358 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:07:50,361 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:07:50,471 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:07:50,561 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:07:50,636 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:07:52,747 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:07:53,754 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:07:53,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:07:54,245 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:08:05,901 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:08:05,901 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:08:10,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:08:10,224 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:08:10,224 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 07:08:10,394 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 07:08:10,398 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:08:10,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:08:10,470 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:08:10,470 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:08:10,503 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:08:10,615 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:08:11,815 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:08:12,042 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:08:13,798 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:08:13,801 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:08:13,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:08:14,674 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:08:15,802 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:08:15,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:08:15,877 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:08:19,440 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:08:19,440 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:08:19,445 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:08:19,446 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:08:19,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:08:19,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:08:24,033 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:08:27,078 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:08:27,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:08:27,146 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:08:27,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:08:28,132 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:08:28,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:08:28,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:08:28,813 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:08:32,393 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:08:32,395 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:08:33,218 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:08:33,218 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:08:33,220 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:08:33,222 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:08:33,224 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:08:33,226 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:08:33,230 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:08:33,232 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:08:33,234 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:08:33,236 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:08:33,236 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:08:33,240 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:08:33,244 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:08:33,246 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:08:33,249 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:08:33,249 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:08:37,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:08:37,264 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:08:48,610 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:08:48,612 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:08:48,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:08:49,297 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:08:49,332 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:08:49,336 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:08:53,211 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:09:03,867 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:09:04,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:09:04,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:09:05,024 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:09:13,863 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:09:18,181 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:09:22,532 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:09:25,341 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:09:25,343 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:09:25,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:09:25,910 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:09:25,912 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:09:31,810 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 07:09:41,110 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:09:41,489 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 07:09:42,270 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:09:43,438 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:09:43,439 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:09:46,059 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:09:46,059 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:09:46,689 - ispa_next.main - DEBUG - 



2025-11-12 07:09:46,689 - ispa_next.main - DEBUG - starting with process 3 (GA447) of 16
2025-11-12 07:09:46,696 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:09:47,638 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:09:48,872 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:09:48,874 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:09:50,483 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:09:50,485 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:10:34,931 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:10:34,944 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 07:10:34,949 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:10:35,611 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:10:35,611 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:10:38,463 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:10:38,464 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:10:39,321 - ispa_next.main - DEBUG - 



2025-11-12 07:10:39,321 - ispa_next.main - DEBUG - starting with process 4 (NU J 3339) of 16
2025-11-12 07:10:39,326 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:10:40,380 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:10:41,627 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:10:41,629 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:10:43,164 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:10:43,166 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:11:15,474 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:11:15,486 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 07:11:15,492 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:11:16,055 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:11:16,057 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:11:18,923 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:11:18,924 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:11:19,703 - ispa_next.main - DEBUG - 



2025-11-12 07:11:19,703 - ispa_next.main - DEBUG - starting with process 5 (3508) of 16
2025-11-12 07:11:19,708 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:11:21,000 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:11:22,313 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:11:22,314 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:11:24,007 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:11:24,009 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:12:03,991 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:12:04,003 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 07:12:04,007 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:12:04,489 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:12:04,491 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:12:07,136 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:12:07,137 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:12:07,911 - ispa_next.main - DEBUG - 



2025-11-12 07:12:07,912 - ispa_next.main - DEBUG - starting with process 6 (ul vk1010) of 16
2025-11-12 07:12:07,917 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:12:09,074 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:12:10,449 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:12:10,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:12:11,760 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:12:11,761 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:12:42,038 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:12:42,049 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 07:12:42,053 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:12:42,625 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:12:42,626 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:12:45,092 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:12:45,093 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:12:45,823 - ispa_next.main - DEBUG - 



2025-11-12 07:12:45,823 - ispa_next.main - DEBUG - starting with process 7 (UL-ST2016) of 16
2025-11-12 07:12:45,839 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:12:46,724 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:12:47,669 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:12:47,670 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:12:48,942 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:12:48,943 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:13:19,817 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:13:19,829 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 07:13:19,835 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:13:20,421 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:13:20,423 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:13:23,367 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:13:23,367 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:13:24,304 - ispa_next.main - DEBUG - 



2025-11-12 07:13:24,304 - ispa_next.main - DEBUG - starting with process 8 (ILL-GO-67) of 16
2025-11-12 07:13:24,309 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:13:25,586 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:13:26,737 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:13:26,738 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:13:28,165 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:13:28,166 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:13:59,438 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:13:59,452 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 07:13:59,456 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:14:00,068 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:14:00,068 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:14:02,548 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:14:02,549 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:14:03,440 - ispa_next.main - DEBUG - 



2025-11-12 07:14:03,440 - ispa_next.main - DEBUG - starting with process 9 (UL HN 9695) of 16
2025-11-12 07:14:03,446 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:14:04,667 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:14:05,844 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:14:05,845 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:14:07,211 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:14:07,212 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:14:39,686 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:14:39,700 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 07:14:39,707 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:14:40,389 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:14:40,390 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:14:43,283 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:14:43,284 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:14:44,098 - ispa_next.main - DEBUG - 



2025-11-12 07:14:44,098 - ispa_next.main - DEBUG - starting with process 10 (UL-WI 8888) of 16
2025-11-12 07:14:44,104 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:14:45,511 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:14:46,750 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:14:46,751 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:14:48,494 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:14:48,496 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:15:13,382 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:15:15,251 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:15:20,039 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:15:22,613 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:15:22,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:22,699 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:15:22,899 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:15:22,905 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:15:25,738 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:15:25,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:15:26,779 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:15:28,786 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:15:28,911 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:15:29,044 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:15:29,146 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:15:33,334 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:15:34,342 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:15:34,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:34,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:46,886 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:15:50,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:50,344 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:15:50,344 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 07:15:50,503 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 07:15:50,506 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:15:50,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:50,603 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:15:50,603 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:15:50,644 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:15:51,871 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:15:53,065 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:15:53,341 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:15:54,912 - ispa_next.functions - DEBUG - Updated appointment (GS00001180) customer contact data.
2025-11-12 07:15:55,804 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:15:55,806 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:15:56,730 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:15:56,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:15:57,490 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:16:01,607 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:16:01,608 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:16:01,612 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:16:01,612 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:16:01,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:16:02,132 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:16:06,276 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:16:06,284 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:16:06,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:16:06,390 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:16:12,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:16:12,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:16:12,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:16:13,235 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:16:13,235 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:16:15,697 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:16:15,698 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:16:16,867 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:16:16,868 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:16:16,869 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:16:16,871 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:16:16,876 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:16:16,878 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:16:16,882 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:16:16,886 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:16:16,886 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:16:16,888 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:16:16,890 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:16:16,892 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:16:16,896 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:16:16,898 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:16:16,902 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:16:16,908 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:16:19,548 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:16:19,552 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:16:19,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:16:20,275 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:16:20,560 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:16:32,138 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:16:32,142 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:16:34,799 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:16:47,005 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:16:47,485 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:16:48,014 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:16:48,210 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:16:55,628 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:16:59,913 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:17:04,505 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:17:04,507 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:17:04,509 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:17:05,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:17:05,330 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:17:05,334 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:17:07,342 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:17:15,875 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:17:16,266 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 07:17:16,809 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:17:19,138 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:17:19,140 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:17:21,952 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:17:21,953 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:17:22,978 - ispa_next.main - DEBUG - 



2025-11-12 07:17:22,979 - ispa_next.main - DEBUG - starting with process 11 (M-JC 234E) of 16
2025-11-12 07:17:22,999 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:17:24,263 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:17:25,556 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:17:25,557 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1239
2025-11-12 07:17:27,262 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:17:27,264 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:17:49,564 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:17:51,641 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:17:56,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:17:59,447 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:17:59,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:17:59,521 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:17:59,725 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:17:59,732 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:18:02,568 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:18:02,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:18:03,601 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:18:05,604 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:18:05,711 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:18:05,816 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:18:05,911 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:18:05,911 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:18:14,426 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:18:15,430 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:18:15,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:15,917 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:30,195 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:18:34,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:34,522 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:18:34,522 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 07:18:34,739 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 07:18:34,743 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:18:34,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:34,833 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:18:34,840 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:18:34,891 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:18:36,245 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:18:36,456 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:18:38,338 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:18:38,343 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:18:39,196 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:18:39,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:18:39,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:18:43,466 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:18:43,468 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:18:43,985 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:18:45,988 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:18:46,087 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:18:46,193 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:18:46,265 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:18:46,265 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:18:54,581 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:19:54,583 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:20:03,054 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:20:50,057 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:20:58,659 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:21:06,423 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 07:21:07,433 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:21:07,434 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:21:07,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:21:07,526 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:21:11,643 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:21:11,649 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:21:11,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:21:11,824 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:21:20,479 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 07:21:34,170 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:21:34,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:21:34,915 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:21:34,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:21:35,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:21:35,724 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:21:38,191 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:21:38,194 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:21:39,487 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:21:39,487 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:21:39,489 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:21:39,491 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:21:39,491 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:21:39,493 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:21:39,494 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:21:39,499 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:21:39,503 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:21:39,508 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:21:39,511 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:21:39,516 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:21:39,521 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:21:39,524 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:21:39,528 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:42,134 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:21:42,136 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:21:42,138 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:21:42,854 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:21:43,110 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:54,387 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:21:54,389 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:56,993 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:22:08,220 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:22:08,702 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:22:09,303 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:22:09,472 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:22:16,922 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:22:21,119 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:22:26,563 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:22:26,567 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:22:26,567 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:22:27,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:22:27,414 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:22:27,418 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:22:29,608 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:22:38,290 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:22:38,669 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 07:22:39,290 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:41,931 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:22:41,933 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:22:44,830 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1238
2025-11-12 07:22:44,831 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:22:45,538 - ispa_next.main - DEBUG - 



2025-11-12 07:22:45,539 - ispa_next.main - DEBUG - starting with process 12 (UL-K 1058) of 16
2025-11-12 07:22:45,568 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:22:46,463 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:47,730 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2014
2025-11-12 07:22:47,731 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1238
2025-11-12 07:22:49,351 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:22:49,356 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:23:10,500 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:23:12,552 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:23:17,557 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:20,131 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:23:20,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:20,226 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:23:20,424 - ispa_next.functions - DEBUG - HU date already expired after 1003 days.
2025-11-12 07:23:24,629 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:23:24,635 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:23:27,452 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:23:27,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:23:28,480 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:23:30,485 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:23:30,607 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:23:30,701 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:23:30,775 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:23:34,987 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:23:35,994 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:23:35,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:36,457 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:50,989 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:23:54,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:54,989 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:23:54,989 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 07:23:55,095 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-12 07:23:55,482 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-12 07:23:55,485 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:23:55,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:55,580 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:23:55,580 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:23:55,612 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:23:55,696 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:23:56,773 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 07:23:57,952 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 07:23:58,234 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:23:59,593 - ispa_next.functions - DEBUG - Updated appointment (FO00001775) customer contact data.
2025-11-12 07:24:00,485 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:24:00,488 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:24:00,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:24:01,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:24:02,473 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:24:02,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:24:02,583 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:24:06,182 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:24:06,182 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:24:06,187 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:24:06,189 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:24:06,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:24:06,879 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:24:10,987 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:24:10,993 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:24:10,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:24:11,069 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:24:11,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:11,923 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:11,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:24:12,593 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:24:12,593 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:24:15,083 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:24:15,084 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:24:15,953 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:24:15,954 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:24:15,956 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:24:15,957 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:24:15,959 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:24:15,961 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:24:15,971 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:24:15,972 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:24:15,983 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:24:15,985 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:24:15,988 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:24:15,991 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:24:15,997 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:24:16,001 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:24:16,003 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:24:16,005 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:18,612 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:24:18,618 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:24:18,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:24:19,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:24:19,622 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:29,550 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:24:29,552 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:32,193 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:24:42,982 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:24:43,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:24:44,007 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:24:44,253 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:51,652 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:24:55,991 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:25:00,735 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:25:00,739 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:25:00,741 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:25:01,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:25:01,518 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:25:01,520 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:25:03,163 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:25:11,543 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:25:11,919 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 07:25:12,521 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:25:14,971 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 07:25:14,972 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:25:17,551 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1238
2025-11-12 07:25:17,552 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:25:18,321 - ispa_next.main - DEBUG - 



2025-11-12 07:25:18,321 - ispa_next.main - DEBUG - starting with process 13 (NU-RU 2509) of 16
2025-11-12 07:25:18,326 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:25:19,189 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:25:20,067 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 07:25:20,068 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1238
2025-11-12 07:25:21,395 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:25:21,396 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:25:44,365 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:25:46,375 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:25:52,195 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:54,054 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:25:54,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:54,145 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:25:54,430 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:25:54,434 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:25:57,332 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:25:57,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:25:58,231 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:26:00,237 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:26:00,350 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:26:00,452 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:26:00,514 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:26:04,706 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:26:05,713 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:26:05,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:06,236 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:18,702 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:26:23,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:23,133 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:26:23,133 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 07:26:23,302 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 07:26:23,306 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:26:23,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:23,422 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:26:23,424 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:26:23,473 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:26:23,583 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:26:24,803 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:26:25,030 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:26:26,635 - ispa_next.functions - DEBUG - Updated appointment (KG00000183) customer contact data.
2025-11-12 07:26:27,601 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:26:27,903 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:26:28,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:26:28,892 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:26:29,994 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:26:29,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:26:30,076 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:26:33,650 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:26:33,650 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:26:33,656 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:26:33,656 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:26:33,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:34,172 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:26:38,283 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:26:38,287 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:26:38,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:38,386 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:26:38,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:39,279 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:39,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:39,971 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:26:39,972 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:26:41,845 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:26:41,847 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:26:42,759 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:26:42,762 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:26:42,765 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:26:42,766 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:26:42,771 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:26:42,774 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:26:42,781 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:26:42,792 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:26:42,794 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:26:42,798 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:26:42,800 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:26:42,800 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:26:42,804 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:26:42,808 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:26:42,812 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:26:42,816 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:44,746 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:26:44,748 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:26:44,753 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:26:45,524 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:26:45,775 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:54,892 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:26:54,894 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:56,810 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:27:07,200 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:27:07,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:27:08,187 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:27:08,312 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:27:14,522 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:27:18,788 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:27:18,792 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:27:18,792 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:27:19,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:27:19,661 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:27:19,663 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:27:21,663 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:27:29,981 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:27:30,356 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 07:27:30,953 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:27:32,669 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 07:27:32,671 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:27:35,877 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1238
2025-11-12 07:27:35,877 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:27:36,595 - ispa_next.main - DEBUG - 



2025-11-12 07:27:36,595 - ispa_next.main - DEBUG - starting with process 14 (NU-EL 699E) of 16
2025-11-12 07:27:36,602 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:27:37,541 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:27:38,720 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 07:27:38,721 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1238
2025-11-12 07:27:40,273 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:27:40,274 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:28:03,940 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:28:05,959 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:28:11,215 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:13,445 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:28:13,446 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:13,515 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:28:13,692 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:28:13,696 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:28:16,443 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:28:16,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:17,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:19,447 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:28:19,571 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:28:19,671 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:28:19,735 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:28:23,892 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:28:24,915 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:28:24,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:25,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:36,767 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:28:36,767 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:28:40,490 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:40,581 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:28:40,581 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 07:28:40,714 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 07:28:40,717 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:28:40,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:40,796 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:28:40,798 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:28:40,841 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:28:42,084 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:28:43,214 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:28:43,425 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:28:45,680 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:28:45,684 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:28:46,584 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:28:46,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:28:47,409 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:28:51,464 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-12 07:28:51,464 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:28:51,464 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:28:51,468 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:28:51,470 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:28:51,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:51,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:56,122 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:28:56,128 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:28:56,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:56,192 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:29:01,767 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:29:02,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:29:02,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:29:03,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:29:03,003 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:29:04,921 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:29:04,922 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:29:05,850 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:29:05,852 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:29:05,854 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:29:05,854 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:29:05,856 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:29:05,856 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:29:05,858 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:29:05,858 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:29:05,860 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:29:05,862 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:29:05,862 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:29:05,864 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:29:05,871 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:29:05,874 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:29:05,877 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:29:05,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:07,817 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:29:07,821 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:29:07,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:29:08,622 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:29:08,868 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:19,586 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:29:19,591 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:21,486 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:29:33,739 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:29:34,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:29:34,786 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:29:34,924 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:41,665 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:29:46,345 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:29:46,349 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:29:46,349 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:29:47,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:29:47,092 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:29:47,094 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:29:49,170 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:29:57,527 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:29:57,916 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 07:29:58,580 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:30:00,350 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 07:30:00,352 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:30:03,317 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1238
2025-11-12 07:30:03,317 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:30:04,086 - ispa_next.main - DEBUG - 



2025-11-12 07:30:04,086 - ispa_next.main - DEBUG - starting with process 15 (ILL-MI 11) of 16
2025-11-12 07:30:04,091 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:30:05,310 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:30:06,485 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 07:30:06,487 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1238
2025-11-12 07:30:08,313 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:30:08,314 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:30:36,115 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:30:38,521 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:30:44,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:47,396 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:30:47,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:47,456 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:30:47,640 - ispa_next.functions - DEBUG - HU date already expired after 2428 days.
2025-11-12 07:30:51,775 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:30:51,778 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:30:54,541 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:30:54,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:55,650 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:30:57,653 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:30:57,767 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:30:57,891 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:30:58,011 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:31:02,203 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:31:03,209 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:31:03,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:03,938 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:16,607 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:31:16,608 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:31:21,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:21,345 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:31:21,345 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 07:31:21,534 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 07:31:21,542 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:31:21,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:21,622 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:31:21,624 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:31:21,695 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:31:21,830 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:31:23,081 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:31:23,313 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:31:24,844 - ispa_next.functions - DEBUG - Updated appointment (AE00056518) customer contact data.
2025-11-12 07:31:25,845 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:31:25,849 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:31:26,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:31:27,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:31:28,200 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:31:28,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:31:28,266 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:31:32,271 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 07:31:32,271 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:31:32,271 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:31:32,275 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:31:32,275 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:31:32,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:31:32,814 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:31:36,920 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:31:36,927 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:31:36,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:31:37,005 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:31:37,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:37,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:37,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:31:38,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:31:38,573 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:31:41,612 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:31:41,614 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:31:42,595 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:31:42,597 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:31:42,599 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:31:42,599 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:31:42,601 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:31:42,601 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:31:42,603 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:31:42,606 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:31:42,607 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:31:42,607 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:31:42,609 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:31:42,609 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:31:42,614 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:31:42,618 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:31:42,621 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:31:42,626 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:45,915 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:31:45,919 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:31:45,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:31:46,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:31:46,998 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:57,569 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:31:57,571 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:32:00,933 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:32:11,905 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:32:12,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:32:12,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:32:13,051 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:32:21,180 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:32:25,158 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:32:30,858 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:32:35,097 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:32:35,099 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:32:35,099 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:32:35,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:32:35,696 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:32:35,698 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:32:37,304 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:32:44,400 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:32:44,790 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 07:32:45,521 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:32:47,339 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 07:32:47,341 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:32:50,004 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1238
2025-11-12 07:32:50,004 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:32:50,872 - ispa_next.main - DEBUG - 



2025-11-12 07:32:50,872 - ispa_next.main - DEBUG - starting with process 16 (UL-Z 89) of 16
2025-11-12 07:32:50,877 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:32:51,930 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:32:52,820 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 07:32:52,821 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1238
2025-11-12 07:32:54,258 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:32:54,259 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:33:19,463 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:33:21,642 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:33:27,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:27,423 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:33:27,614 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:30,219 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:33:30,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:30,292 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:33:30,576 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:33:30,580 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:33:33,363 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:33:33,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:33:34,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:33:36,630 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:33:36,767 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:33:36,861 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:33:36,945 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:33:36,946 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:33:45,860 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:33:46,866 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:33:46,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:47,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:00,193 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:34:00,193 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:34:08,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:08,500 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:34:08,500 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 07:34:08,672 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 07:34:08,675 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:34:08,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:08,770 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:34:08,771 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:34:08,853 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:34:08,993 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:34:10,361 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:34:10,580 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:34:12,108 - ispa_next.functions - DEBUG - Updated appointment (AH00030613) customer contact data.
2025-11-12 07:34:13,053 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:34:13,056 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:34:13,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:34:14,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:34:15,061 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:34:15,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:34:15,176 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:34:18,771 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:34:18,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:34:19,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:34:21,637 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:34:21,737 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:34:21,879 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:34:22,012 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:34:22,012 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:34:30,489 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:35:30,491 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:35:39,097 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:36:20,100 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:36:28,754 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:36:36,341 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 07:36:37,366 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:36:37,367 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:36:37,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:37,427 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:36:41,542 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:36:41,548 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:36:41,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:41,640 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:36:42,006 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:42,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:42,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:43,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:36:43,283 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:36:45,843 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:36:45,845 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:36:46,893 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:36:46,898 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:36:46,902 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:36:46,904 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:36:46,906 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:36:46,908 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:36:46,908 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:36:46,910 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:36:46,910 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:36:46,912 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:36:46,912 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:36:46,914 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:36:46,918 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:36:46,922 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:36:46,924 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:36:46,946 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:49,597 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:36:49,600 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:36:49,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:36:50,294 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:36:50,326 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:36:50,328 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:52,929 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:37:04,041 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:37:04,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:37:05,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:37:05,187 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:12,737 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:17,127 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:22,134 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:22,138 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:37:22,140 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:37:22,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:37:22,912 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:37:22,914 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:37:25,022 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:37:33,791 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:37:34,162 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 07:37:34,479 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:37:36,591 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 07:37:36,592 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:37:39,564 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1238
2025-11-12 07:37:39,565 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
