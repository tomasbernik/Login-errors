2025-11-17 11:00:32,235 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 11:00:32,238 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 11:00:40,110 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:00:52,140 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:01:08,008 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:01:32,197 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 11:01:46,059 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 11:01:49,061 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:01:50,625 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 578
2025-11-17 11:01:50,627 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-17 11:01:53,515 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 124
2025-11-17 11:01:53,515 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 11:01:53,516 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:01:54,931 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:01:56,401 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:02:22,963 - ispa_next.appointments.models - DEBUG - Appointment Bianca Christiane Liebrand NE-NU 73E WMW81GC09STA95325 ohne Termin.
2025-11-17 11:02:22,987 - ispa_next.appointments.models - DEBUG - Appointment Heinz Wiedermann NE-WJ 2608 WBA61EE0X05Y34631 ohne Termin.
2025-11-17 11:02:23,001 - ispa_next.appointments.models - DEBUG - Appointment Kuri Beines Schalweb. Kraw.Fab.Tu.Dr. GmbH & Co. K MG-NA 696 WBATR95030NA40057 ohne Termin.
2025-11-17 11:02:23,014 - ispa_next.appointments.models - DEBUG - Appointment Gertrud Wiest GV-HW 1978 WBAUZ35020N007842 ohne Termin.
2025-11-17 11:02:23,026 - ispa_next.appointments.models - DEBUG - Appointment Dieter Krautwald NE-DK 6000 WBAUZ35060N006497 ohne Termin.
2025-11-17 11:02:23,039 - ispa_next.appointments.models - DEBUG - Appointment Alexander Loresch NE-AT 6872 WBAUZ35020N033230 ohne Termin.
2025-11-17 11:02:23,082 - ispa_next.appointments.models - DEBUG - Appointment Arsim Elshani NE-QK 757 WBA2B91010V794237 ohne Termin.
2025-11-17 11:02:23,092 - ispa_next.appointments.models - DEBUG - Appointment Liping Italia Moda GmbH NE-Z 5888 WBAVJ31050LR18129 ohne Termin.
2025-11-17 11:02:23,105 - ispa_next.appointments.models - DEBUG - Appointment   WBAFS51080C275059 ohne Termin.
2025-11-17 11:02:23,122 - ispa_next.appointments.models - DEBUG - Appointment Jörn Stefan Lohr NE-L 357 WMWSR11090T421441 ohne Termin.
2025-11-17 11:02:23,136 - ispa_next.appointments.models - DEBUG - Appointment UKM GmbH NE-KW 444 WMW41DL0403S04779 ohne Termin.
2025-11-17 11:02:23,168 - ispa_next.appointments.models - DEBUG - Appointment Anna Hildebrandt NE-AH 2222 WBA7K110407N28819 ohne Termin.
2025-11-17 11:02:23,179 - ispa_next.appointments.models - DEBUG - Appointment Marc Daniel Gawron NE-D 485 WBA1S110607B48065 ohne Termin.
2025-11-17 11:02:23,193 - ispa_next.main - DEBUG - Found 7 out of 35 appointments to process (configured limit: 15).
2025-11-17 11:02:23,193 - ispa_next.main - DEBUG - Processing 7 fresh appointments.
2025-11-17 11:02:23,193 - ispa_next.main - DEBUG - All appointments: D-DS 2802, D-LT 1506, NE-JA 4321, BN-X 208, PAF-ZM 718, MG VM 1706, NE-FP 2004
2025-11-17 11:02:23,196 - ispa_next.main - DEBUG - 



2025-11-17 11:02:23,196 - ispa_next.main - DEBUG - starting with process 1 (D-DS 2802) of 7
2025-11-17 11:02:23,200 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:02:24,463 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:02:26,066 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 578
2025-11-17 11:02:26,067 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 124
2025-11-17 11:02:27,815 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:02:27,816 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:03:03,517 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:03:14,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:14,938 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:03:15,116 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:16,502 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:03:16,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:16,688 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:03:17,000 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:03:17,004 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:03:20,299 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:03:20,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:03:21,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:03:23,103 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:03:29,525 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 11:03:36,501 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 11:03:37,506 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:03:37,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:38,113 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:53,069 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:04:01,435 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:04:01,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:01,552 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:04:01,553 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:04:01,664 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:04:01,889 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:04:03,901 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:04:04,510 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:04:08,109 - ispa_next.functions - DEBUG - Updated appointment (AB00031907) customer contact data.
2025-11-17 11:04:09,032 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:04:09,034 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:04:09,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:04:10,106 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:04:11,652 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:04:11,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:04:11,795 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:04:16,014 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:04:16,014 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:04:16,014 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:04:16,017 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:04:16,022 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:04:16,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:16,546 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:04:17,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:17,639 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:17,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:18,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:04:18,404 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:04:20,404 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:04:20,408 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:04:21,388 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:04:21,391 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:04:21,396 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 11:04:21,398 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 11:04:21,399 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:04:21,402 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:04:21,403 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:04:21,404 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:04:21,406 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:04:21,408 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:04:21,410 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:04:21,412 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:04:22,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:04:22,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:04:34,635 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:04:34,637 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:04:34,639 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:04:34,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:37,249 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:04:37,251 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:04:37,255 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:39,873 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:04:39,875 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:04:39,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:04:40,409 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:04:40,478 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:04:40,481 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:43,140 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:04:55,414 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:04:55,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:04:56,406 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:04:56,699 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:05:23,130 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:05:27,504 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:05:33,229 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:05:33,231 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:05:33,232 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:05:34,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:05:34,107 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:05:34,115 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:05:36,475 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:05:48,236 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:05:48,635 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 11:05:49,484 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:05:50,426 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 578
2025-11-17 11:05:50,428 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:05:54,354 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-17 11:05:54,355 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:05:55,347 - ispa_next.appointments.models - DEBUG - Appointment Efatun Sefirm Demirbas GV-KT 42 WBA1C91090P875550 ohne Termin.
2025-11-17 11:05:55,357 - ispa_next.main - DEBUG - 



2025-11-17 11:05:55,357 - ispa_next.main - DEBUG - starting with process 2 (D-LT 1506) of 7
2025-11-17 11:05:55,361 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:05:56,865 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:05:58,459 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 578
2025-11-17 11:05:58,460 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-17 11:06:00,253 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:06:00,254 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:06:34,053 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:06:45,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:45,627 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:06:45,828 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:47,180 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:06:47,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:47,260 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:06:47,550 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:06:47,553 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:06:50,687 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:06:50,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:06:52,028 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:06:54,033 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:06:54,240 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:06:57,555 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:06:57,666 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:06:57,669 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:59,109 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:07:10,633 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:07:11,639 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:07:11,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:12,157 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:26,777 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:07:35,468 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:07:35,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:35,551 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:07:35,553 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:07:35,631 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:07:35,855 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:07:37,859 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:07:38,264 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:07:42,258 - ispa_next.functions - DEBUG - Updated appointment (AB00031903) customer contact data.
2025-11-17 11:07:43,191 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:07:43,194 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:07:43,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:07:44,238 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:07:45,847 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:07:45,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:07:46,043 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:07:49,649 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:07:49,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:07:50,184 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:07:52,187 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:07:52,330 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:07:52,439 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:07:52,520 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:07:52,522 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:07:54,649 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:08:06,114 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:09:06,118 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:09:17,597 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:09:34,601 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:09:46,301 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:09:54,030 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:09:54,031 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:01,236 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 11:10:04,803 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Zündkerzen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 11:10:08,034 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 11:10:11,413 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Luftfiltereinsatz' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 11:10:14,630 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motoröl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 11:10:17,516 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:10:22,003 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:10:23,009 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:10:23,014 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:10:23,015 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:10:23,125 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:10:26,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:10:27,433 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:10:27,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:10:28,188 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:10:28,189 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:10:30,270 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:10:30,272 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:10:33,581 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:10:33,583 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:10:33,586 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 11:10:33,588 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 11:10:33,589 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:10:33,592 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:10:33,593 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:10:33,595 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:10:33,597 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:10:33,598 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:10:33,601 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:10:33,603 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:10:34,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:10:35,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:10:47,070 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:10:47,072 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:10:47,074 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:10:47,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:49,727 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:10:49,729 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:10:49,733 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:52,524 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:10:52,526 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:10:52,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:10:53,305 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:10:53,369 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:10:53,401 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:56,133 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:11:09,341 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:11:09,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:11:10,358 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:11:10,512 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:11:36,476 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:11:41,228 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:11:46,820 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:11:46,823 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:11:46,824 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:11:47,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:11:47,836 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:11:47,838 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:11:50,158 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:11:59,838 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:12:00,258 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 11:12:01,433 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:12:02,288 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 578
2025-11-17 11:12:02,289 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:12:06,103 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 282
2025-11-17 11:12:06,104 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:12:07,077 - ispa_next.appointments.models - DEBUG - Appointment Efatun Sefirm Demirbas GV-KT 42 WBA1C91090P875550 ohne Termin.
2025-11-17 11:12:07,083 - ispa_next.main - DEBUG - 



2025-11-17 11:12:07,083 - ispa_next.main - DEBUG - starting with process 3 (NE-JA 4321) of 7
2025-11-17 11:12:07,086 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:12:08,460 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:12:09,915 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 578
2025-11-17 11:12:09,917 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-17 11:12:11,678 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:12:11,679 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:12:56,003 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:13:08,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:08,829 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:13:09,058 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:13:10,346 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:13:10,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:10,448 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:13:10,949 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:13:10,954 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:13:13,784 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:13:13,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:13:15,240 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:13:17,244 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:13:24,820 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 11:13:32,922 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 11:13:33,927 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:13:33,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:34,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:49,150 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:13:57,624 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:13:57,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:57,731 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:13:57,732 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:13:57,837 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:13:57,993 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:13:59,907 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:14:00,310 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:14:03,912 - ispa_next.functions - DEBUG - Updated appointment (AB00031885) customer contact data.
2025-11-17 11:14:04,888 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:14:04,890 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:14:05,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:14:06,189 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:14:07,399 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:14:07,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:14:07,495 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:14:11,161 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:14:11,161 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:14:11,165 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:14:11,169 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:14:11,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:14:11,708 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:14:12,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:14:12,824 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:14:12,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:14:13,618 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:14:13,620 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:14:15,245 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:14:15,248 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:14:16,797 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:14:16,800 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:14:16,804 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 11:14:16,805 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 11:14:16,807 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:14:16,810 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:14:16,811 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:14:16,812 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:14:16,815 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:14:16,816 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:14:16,818 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:14:16,820 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:14:17,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:14:18,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:14:30,062 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:14:30,065 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:14:30,066 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:14:30,067 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:14:32,075 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:14:32,078 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:14:32,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:14:34,068 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:14:34,071 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:14:34,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:14:34,603 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:14:34,710 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:14:34,712 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:14:36,772 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:14:49,732 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:14:50,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:14:50,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:14:50,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:15:09,585 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:15:15,433 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:15:15,435 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:15:15,436 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:15:16,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:15:16,268 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:15:16,269 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:15:18,394 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:15:27,926 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:15:28,334 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 11:15:29,607 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:15:30,405 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 579
2025-11-17 11:15:30,407 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:15:34,397 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 283
2025-11-17 11:15:34,398 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:15:35,400 - ispa_next.appointments.models - DEBUG - Appointment Efatun Sefirm Demirbas GV-KT 42 WBA1C91090P875550 ohne Termin.
2025-11-17 11:15:35,403 - ispa_next.main - DEBUG - Found new Appointment: NE-JW 518
2025-11-17 11:15:35,405 - ispa_next.main - DEBUG - 



2025-11-17 11:15:35,405 - ispa_next.main - DEBUG - starting with process 4 (NE-JW 518) of 8
2025-11-17 11:15:35,408 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:15:36,839 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:15:38,406 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 579
2025-11-17 11:15:38,407 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 283
2025-11-17 11:15:40,231 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:15:40,233 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:16:15,676 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:16:26,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:26,929 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:16:27,142 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:29,263 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:16:29,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:29,383 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:16:29,821 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:16:29,824 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:16:32,809 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:16:32,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:16:34,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:16:36,549 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:16:36,712 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:16:39,999 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:16:40,079 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:16:40,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:42,255 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:16:54,074 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:16:55,079 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:16:55,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:55,601 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:12,684 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:17:21,870 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:17:21,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:22,028 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:17:22,029 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:17:22,126 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:17:22,315 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:17:24,403 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:17:24,729 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:17:26,621 - ispa_next.functions - DEBUG - Updated appointment (AB00031910) customer contact data.
2025-11-17 11:17:27,577 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:17:27,579 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:17:28,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:17:28,872 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:17:30,481 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:17:30,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:17:30,675 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:17:34,347 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:17:34,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:17:34,884 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:17:36,888 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:17:37,033 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:17:37,193 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:17:37,304 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:17:37,306 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:17:40,039 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:17:50,876 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:18:00,431 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:18:00,433 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:18:03,873 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:18:08,101 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:18:09,107 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:18:09,111 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:18:09,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:18:09,239 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:18:15,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:16,041 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:16,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:18:16,870 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:18:16,871 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:18:19,485 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:18:19,488 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:18:20,838 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:18:20,841 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:18:20,844 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 11:18:20,845 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 11:18:20,847 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:18:20,850 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:18:20,851 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:18:20,852 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:18:20,854 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:18:20,855 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:18:20,858 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:18:20,860 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:18:21,672 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:18:22,613 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:18:34,524 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:18:34,526 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:18:34,528 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:18:34,529 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:18:37,823 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:18:37,825 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:18:37,828 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:18:41,196 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:18:41,198 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:18:41,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:18:41,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:18:42,355 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:18:54,526 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:18:54,528 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:18:57,957 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:19:11,997 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:19:12,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:19:13,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:19:13,303 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:45,863 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:19:50,491 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:19:55,624 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:01,775 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:01,778 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:20:01,779 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:20:02,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:20:02,692 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:20:02,694 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:20:04,908 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:20:14,759 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:20:15,152 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 11:20:16,449 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:20:17,381 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 580
2025-11-17 11:20:17,383 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:20:21,503 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 283
2025-11-17 11:20:21,504 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:20:22,491 - ispa_next.appointments.models - DEBUG - Appointment Efatun Sefirm Demirbas GV-KT 42 WBA1C91090P875550 ohne Termin.
2025-11-17 11:20:22,498 - ispa_next.main - DEBUG - 



2025-11-17 11:20:22,498 - ispa_next.main - DEBUG - starting with process 5 (BN-X 208) of 8
2025-11-17 11:20:22,503 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:20:23,918 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:20:25,508 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 580
2025-11-17 11:20:25,510 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 283
2025-11-17 11:20:27,244 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:20:27,245 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:21:03,911 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:21:15,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:21:15,412 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:21:15,641 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:21:17,011 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:21:17,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:21:17,092 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:21:17,465 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:21:17,468 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:21:20,332 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:21:20,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:21:21,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:21:23,821 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:21:24,002 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:21:27,294 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:21:27,437 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:21:27,438 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:21:28,766 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:21:40,836 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:21:41,841 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:21:41,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:21:42,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:21:59,323 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:22:08,460 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:22:08,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:22:08,582 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:22:08,584 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:22:08,679 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:22:08,815 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:22:10,898 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:22:11,272 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:22:14,454 - ispa_next.functions - DEBUG - Updated appointment (AB00031906) customer contact data.
2025-11-17 11:22:15,435 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:22:15,437 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:22:15,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:22:16,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:22:18,259 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:22:18,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:22:18,339 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:22:22,010 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:22:22,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:22:22,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:22:24,521 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:22:24,675 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:22:24,829 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:22:24,910 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:22:24,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:22:26,965 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:22:38,454 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:23:38,459 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:23:49,892 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:24:04,896 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:24:16,068 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:24:23,405 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:24:23,407 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:25,444 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:24:29,671 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:24:30,678 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:24:30,682 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:24:30,683 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:24:30,802 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:24:31,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:24:31,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:24:31,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:24:32,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:24:32,790 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:24:34,723 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:24:34,725 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:24:35,884 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:24:35,886 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:24:35,889 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 11:24:35,890 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 11:24:35,891 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:24:35,893 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:24:35,894 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:24:35,896 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:24:35,898 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:24:35,899 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:24:35,902 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:24:35,904 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:24:36,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:24:37,557 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:24:49,368 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:24:49,370 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:24:49,372 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:24:49,373 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:52,010 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:24:52,012 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:24:52,015 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:54,723 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:24:54,725 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:24:54,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:24:55,514 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:24:55,877 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:25:05,920 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:25:05,922 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:25:08,758 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:25:22,626 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:25:23,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:25:23,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:25:23,971 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:25:50,661 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:25:55,867 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:26:01,725 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:26:01,727 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:26:01,728 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:26:02,485 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:26:02,606 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:26:02,612 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:26:04,968 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:26:15,035 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:26:15,409 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 11:26:16,681 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:26:17,533 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 580
2025-11-17 11:26:17,537 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:26:21,904 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 283
2025-11-17 11:26:21,905 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:26:23,010 - ispa_next.appointments.models - DEBUG - Appointment Efatun Sefirm Demirbas GV-KT 42 WBA1C91090P875550 ohne Termin.
2025-11-17 11:26:23,016 - ispa_next.main - DEBUG - 



2025-11-17 11:26:23,016 - ispa_next.main - DEBUG - starting with process 6 (PAF-ZM 718) of 8
2025-11-17 11:26:23,020 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:26:24,417 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:26:26,044 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 580
2025-11-17 11:26:26,045 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 283
2025-11-17 11:26:27,681 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:26:27,682 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:27:01,866 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:27:13,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:27:13,607 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:27:13,856 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:15,207 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:27:15,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:27:15,323 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:27:15,644 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:27:15,647 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:27:18,869 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:27:18,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:27:20,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:27:22,547 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:27:22,718 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:27:25,952 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:27:26,042 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:27:26,044 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:27,576 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:27:39,407 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:27:40,412 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:27:40,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:27:40,932 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:28:07,631 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:28:18,123 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:28:18,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:28:18,306 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:28:18,307 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:28:18,406 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:28:19,828 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:28:21,608 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:28:22,010 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:28:25,259 - ispa_next.functions - DEBUG - Updated appointment (AB00031904) customer contact data.
2025-11-17 11:28:26,205 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:28:26,215 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:28:27,283 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:28:27,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:28:28,228 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:28:31,828 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:28:31,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:28:32,338 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:28:34,343 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:28:34,515 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:28:34,719 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:28:34,843 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:28:34,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:28:36,330 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:28:47,919 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:28:56,117 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:28:56,119 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:28:57,448 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:29:01,676 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:29:02,683 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:29:02,686 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:29:02,686 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 11:29:02,688 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:29:04,165 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:29:04,168 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:29:05,353 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:29:05,355 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:29:05,362 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 11:29:05,365 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 11:29:05,366 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:29:05,369 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:29:05,370 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:29:05,371 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:29:05,373 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:29:05,374 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:29:05,378 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:29:05,380 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:29:06,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:29:07,197 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:29:18,940 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:29:18,942 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:29:18,944 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:29:18,945 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:29:20,857 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:29:20,859 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:29:20,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:29:22,849 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:29:22,851 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:29:22,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:29:23,684 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:29:24,007 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:29:35,092 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:29:35,096 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:29:37,233 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:29:51,161 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:29:51,693 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:29:52,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:29:52,480 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:30:11,883 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:30:18,503 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:30:18,506 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:30:18,506 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:30:19,252 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:30:19,432 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:30:19,434 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:30:21,648 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:30:31,881 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:30:32,258 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 11:30:33,689 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:30:34,558 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 581
2025-11-17 11:30:34,560 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:30:38,851 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-17 11:30:38,852 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:30:39,887 - ispa_next.main - DEBUG - 



2025-11-17 11:30:39,887 - ispa_next.main - DEBUG - starting with process 7 (MG VM 1706) of 8
2025-11-17 11:30:39,911 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:30:41,396 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:30:43,050 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 581
2025-11-17 11:30:43,052 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-17 11:30:44,870 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:30:44,872 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:31:19,881 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:31:31,491 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:32,851 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:31:32,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:33,044 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:31:33,338 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 11:31:42,057 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:31:42,061 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:31:44,950 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:31:44,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:31:46,686 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:31:48,689 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:31:48,860 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:31:52,227 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:32:01,286 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 11:32:02,292 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:32:02,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:32:02,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:32:07,427 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 11:32:07,432 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:32:07,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:32:07,537 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:32:07,538 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:32:07,631 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:32:09,075 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:32:10,465 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:32:10,911 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:32:12,887 - ispa_next.functions - DEBUG - Updated appointment (AG00009252) customer contact data.
2025-11-17 11:32:13,865 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:32:13,867 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:32:14,809 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:32:14,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:32:15,903 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:32:19,551 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:32:19,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:32:20,104 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:32:22,107 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:32:22,265 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:32:22,427 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:32:22,509 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:32:22,510 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:32:24,512 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:32:36,167 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:33:36,175 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:33:47,079 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:33:54,380 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:33:54,382 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:55,659 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:33:59,868 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:34:00,874 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:34:00,878 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:34:00,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:34:00,974 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:34:09,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:10,507 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:10,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:34:11,293 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:34:11,295 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:34:12,711 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:34:12,714 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:34:14,031 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:34:14,034 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:34:14,038 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 11:34:14,041 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 11:34:14,045 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:34:14,050 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:34:14,051 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:34:14,052 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:34:14,055 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:34:14,056 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:34:14,059 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:34:14,060 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:34:14,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:34:15,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:34:27,932 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:34:27,935 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:34:27,937 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:34:27,938 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:34:29,966 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:34:29,968 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:34:29,971 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:34:32,052 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:34:32,054 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:34:32,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:34:32,908 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:34:33,305 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:34:44,250 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:34:44,254 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:34:46,330 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:34:59,607 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:35:00,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:35:00,692 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:35:00,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:35:20,257 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:35:26,073 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:35:26,075 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:35:26,076 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:35:26,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:35:26,949 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:35:26,951 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:35:29,273 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:35:39,072 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:35:39,481 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 11:35:40,882 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:35:41,897 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 581
2025-11-17 11:35:41,898 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:35:46,247 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-17 11:35:46,247 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:35:47,253 - ispa_next.main - DEBUG - 



2025-11-17 11:35:47,253 - ispa_next.main - DEBUG - starting with process 8 (NE-FP 2004) of 8
2025-11-17 11:35:47,258 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:35:48,707 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:35:50,212 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 581
2025-11-17 11:35:50,214 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-17 11:35:52,079 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:35:52,080 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:36:23,060 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:36:34,750 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:36:36,107 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:36:36,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:36:36,212 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:36:36,620 - ispa_next.functions - DEBUG - HU date soon to be invalid in 42 days.
2025-11-17 11:36:45,076 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:36:45,082 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:36:48,049 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:36:48,051 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:36:48,295 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 11:36:50,080 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 11:36:50,101 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:36:50,102 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:36:51,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:36:51,732 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:36:51,733 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:36:51,765 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:36:55,167 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 11:36:55,171 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:36:55,730 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 581
2025-11-17 11:36:55,731 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:37:00,357 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-17 11:37:00,358 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
