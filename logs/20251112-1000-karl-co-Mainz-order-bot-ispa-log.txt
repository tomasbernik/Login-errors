2025-11-12 10:00:35,799 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:00:35,805 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:00:47,751 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:00:59,276 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:01:14,786 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:01:56,222 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:02:08,504 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:02:11,743 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:02:13,115 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:02:13,116 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 10:02:15,788 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 200
2025-11-12 10:02:15,788 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:02:15,789 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:02:16,975 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:02:18,250 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:02:44,990 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:45,062 - ispa_next.appointments.models - DEBUG - Appointment Hatidzhe Dhevdzhet Chaylyak GG-HI 889 WBAVJ11040LF60481 ohne Termin.
2025-11-12 10:02:45,088 - ispa_next.appointments.models - DEBUG - Appointment Ulas Korkmaz  WBAJM710X0B068176 ohne Termin.
2025-11-12 10:02:45,101 - ispa_next.appointments.models - DEBUG - Appointment Florian Goertz RPL 11-3 WBA2D310505C65769 ohne Termin.
2025-11-12 10:02:45,148 - ispa_next.main - DEBUG - Found 15 out of 96 appointments to process (configured limit: 15).
2025-11-12 10:02:45,148 - ispa_next.main - DEBUG - Processing 10 fresh appointments.
2025-11-12 10:02:45,149 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 10:02:45,149 - ispa_next.main - DEBUG - All appointments: MZ-AA 112, MZ RM 753, MZJK217, MZ - AW 77E, KI-KI 0815, KI-KI 0815, KI-KI 0815, MZ-ME 141E, RÜD CS 677, MZ MV 279, WI-AZ 44, MZ-SB 872, WI-DF 901, AZ-EL 7777, MZ-S 7911 E
2025-11-12 10:02:45,151 - ispa_next.main - DEBUG - 



2025-11-12 10:02:45,151 - ispa_next.main - DEBUG - starting with process 1 (MZ-AA 112) of 15
2025-11-12 10:02:45,156 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:02:46,118 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:02:47,062 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:02:47,064 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 200
2025-11-12 10:02:48,305 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:02:48,306 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:15,517 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:03:25,794 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:03:28,378 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:03:28,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:03:28,448 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:03:28,677 - ispa_next.functions - DEBUG - HU date already expired after 1342 days.
2025-11-12 10:03:35,646 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:03:35,649 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:03:38,334 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:03:38,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:03:39,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:03:41,399 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:03:48,097 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 10:03:55,442 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 10:03:56,448 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:03:56,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:03:56,939 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:08,592 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:04:16,226 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:04:16,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:16,304 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:04:16,305 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:04:16,346 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:04:16,437 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:04:17,635 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:04:17,846 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:04:21,995 - ispa_next.functions - DEBUG - Updated appointment (AI00026198) customer contact data.
2025-11-12 10:04:22,908 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:04:22,910 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:04:22,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:04:23,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:04:25,159 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:04:25,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:04:25,257 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:04:29,253 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:04:29,254 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:04:29,254 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:04:29,258 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:04:29,259 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:04:29,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:04:29,792 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:04:33,913 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:04:33,917 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:04:33,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:04:34,040 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:04:34,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:34,870 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:34,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:04:35,578 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:04:35,579 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:04:38,512 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:04:38,514 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:04:39,428 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:04:39,430 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:04:39,432 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:04:39,433 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-12 10:04:39,433 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:04:39,435 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:04:39,436 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:04:39,436 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:04:39,438 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:04:39,438 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:04:39,440 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:04:39,442 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:04:40,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:04:40,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:04:53,593 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:04:53,595 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:04:53,597 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:04:53,598 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:04:57,507 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:04:57,510 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:04:57,512 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:04:57,513 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:04:57,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:04:58,042 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:04:58,074 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:04:58,080 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:05:02,057 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:05:13,809 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:05:14,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:05:14,800 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:05:15,006 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:05:52,873 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:05:56,297 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:05:59,650 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:06:03,761 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:06:08,171 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:06:08,173 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:06:08,174 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:06:09,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:06:09,106 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:06:09,108 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:06:10,989 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:06:22,628 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:06:23,000 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:06:23,673 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:06:25,029 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:06:25,031 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:06:27,929 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 434
2025-11-12 10:06:27,930 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:06:28,909 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:06:28,916 - ispa_next.main - DEBUG - 



2025-11-12 10:06:28,916 - ispa_next.main - DEBUG - starting with process 2 (MZ RM 753) of 15
2025-11-12 10:06:28,920 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:06:30,029 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:06:31,345 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:06:31,346 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 434
2025-11-12 10:06:32,919 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:06:32,920 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:07:03,228 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:07:03,312 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:07:03,316 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:07:03,884 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:07:03,885 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:07:06,707 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 434
2025-11-12 10:07:06,708 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:07:07,492 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:07:07,498 - ispa_next.main - DEBUG - 



2025-11-12 10:07:07,498 - ispa_next.main - DEBUG - starting with process 3 (MZJK217) of 15
2025-11-12 10:07:07,502 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:07:08,438 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:07:09,418 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:07:09,419 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 434
2025-11-12 10:07:10,724 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:07:10,725 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:07:44,622 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:07:44,631 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:07:44,634 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:07:45,120 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:07:45,121 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:07:47,979 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 434
2025-11-12 10:07:47,980 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:07:48,901 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:07:48,907 - ispa_next.main - DEBUG - 



2025-11-12 10:07:48,907 - ispa_next.main - DEBUG - starting with process 4 (MZ - AW 77E) of 15
2025-11-12 10:07:48,913 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:07:50,039 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:07:50,961 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:07:50,962 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 434
2025-11-12 10:07:52,298 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:07:52,302 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:08:24,338 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:08:24,349 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:08:24,353 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:08:24,949 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:08:24,950 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:08:27,092 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 434
2025-11-12 10:08:27,093 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:08:27,732 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:08:27,737 - ispa_next.main - DEBUG - 



2025-11-12 10:08:27,737 - ispa_next.main - DEBUG - starting with process 5 (KI-KI 0815) of 15
2025-11-12 10:08:27,742 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:08:28,677 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:08:29,640 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:08:29,641 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 434
2025-11-12 10:08:30,976 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:08:30,977 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:08:52,052 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 179, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-12 10:08:52,062 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:08:52,066 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:08:52,724 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:08:52,726 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:08:55,559 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 434
2025-11-12 10:08:55,560 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:08:56,457 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:08:56,462 - ispa_next.main - DEBUG - 



2025-11-12 10:08:56,463 - ispa_next.main - DEBUG - starting with process 6 (KI-KI 0815) of 15
2025-11-12 10:08:56,467 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:08:57,890 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:08:59,104 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:08:59,105 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 434
2025-11-12 10:09:00,863 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:09:00,864 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:09:21,911 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 179, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-12 10:09:21,921 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:09:21,925 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:22,515 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:09:22,518 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:09:25,291 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 434
2025-11-12 10:09:25,291 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:09:26,128 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:09:26,133 - ispa_next.main - DEBUG - 



2025-11-12 10:09:26,133 - ispa_next.main - DEBUG - starting with process 7 (KI-KI 0815) of 15
2025-11-12 10:09:26,137 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:09:27,401 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:28,715 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:09:28,716 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 434
2025-11-12 10:09:30,237 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:09:30,239 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:09:53,100 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 179, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-12 10:09:53,112 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 10:09:53,115 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:53,563 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:09:53,564 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:09:56,508 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 434
2025-11-12 10:09:56,509 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:09:57,401 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:09:57,415 - ispa_next.main - DEBUG - 



2025-11-12 10:09:57,416 - ispa_next.main - DEBUG - starting with process 8 (MZ-ME 141E) of 15
2025-11-12 10:09:57,430 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:09:58,435 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:59,330 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:09:59,332 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 434
2025-11-12 10:10:00,775 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:10:00,776 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:33,405 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:10:33,412 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 10:10:33,416 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:33,801 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:10:33,802 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:10:36,166 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 434
2025-11-12 10:10:36,167 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:36,850 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:36,858 - ispa_next.main - DEBUG - 



2025-11-12 10:10:36,858 - ispa_next.main - DEBUG - starting with process 9 (RÜD CS 677) of 15
2025-11-12 10:10:36,862 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:10:37,750 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:38,748 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:10:38,749 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 434
2025-11-12 10:10:40,007 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:10:40,009 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:12,057 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:11:12,073 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 10:11:12,077 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:12,759 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:11:12,760 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:15,531 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 434
2025-11-12 10:11:15,532 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:16,435 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:11:16,443 - ispa_next.main - DEBUG - 



2025-11-12 10:11:16,443 - ispa_next.main - DEBUG - starting with process 10 (MZ MV 279) of 15
2025-11-12 10:11:16,448 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:11:17,743 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:19,099 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:11:19,101 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 434
2025-11-12 10:11:20,660 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:20,661 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:55,238 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:11:55,247 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 10:11:55,251 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:55,866 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:11:55,867 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:58,652 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 434
2025-11-12 10:11:58,653 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:59,516 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:11:59,522 - ispa_next.main - DEBUG - 



2025-11-12 10:11:59,522 - ispa_next.main - DEBUG - starting with process 11 (WI-AZ 44) of 15
2025-11-12 10:11:59,527 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:12:00,820 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:12:02,100 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1625
2025-11-12 10:12:02,102 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 434
2025-11-12 10:12:03,549 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:12:03,551 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:12:25,530 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:12:27,268 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:12:32,625 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:35,164 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:12:35,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:35,256 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:12:35,503 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:12:35,507 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:12:38,472 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:12:38,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:39,486 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:12:41,490 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:12:41,642 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:12:41,724 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:12:41,803 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:12:46,002 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:12:47,007 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:12:47,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:47,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:59,281 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:13:03,674 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:13:03,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:03,815 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:13:03,816 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:13:03,845 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:13:05,123 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:13:05,344 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:13:08,552 - ispa_next.functions - DEBUG - Updated appointment (AG00036607) customer contact data.
2025-11-12 10:13:09,482 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:13:09,485 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:13:10,425 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:13:10,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:13:11,271 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:13:14,852 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:13:14,852 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:13:14,856 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:13:14,857 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:13:14,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:13:15,359 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:13:19,502 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:13:19,506 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:13:19,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:13:19,615 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:13:23,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:24,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:24,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:13:25,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:13:25,118 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:13:27,551 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:13:27,553 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:13:28,606 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:13:28,607 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:13:28,609 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:13:28,610 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:13:28,612 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:13:28,613 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:13:28,614 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:13:28,617 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:13:28,618 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:13:28,619 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:13:28,621 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:13:28,624 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:13:28,626 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:13:28,627 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:31,213 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:13:31,214 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:13:31,216 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:13:31,218 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:13:31,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:13:31,848 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:13:32,028 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:40,401 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:13:40,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:42,966 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:13:54,671 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:13:55,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:13:55,683 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:13:55,859 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:20,559 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:24,011 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:27,822 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:27,824 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:14:27,825 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:28,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:14:28,453 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:14:28,455 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:14:29,982 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:14:37,427 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:14:37,817 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 10:14:38,151 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:39,799 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1627
2025-11-12 10:14:39,801 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:42,318 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 436
2025-11-12 10:14:42,319 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:14:43,029 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:14:43,034 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:14:43,039 - ispa_next.main - DEBUG - 



2025-11-12 10:14:43,039 - ispa_next.main - DEBUG - starting with process 12 (MZ-SB 872) of 15
2025-11-12 10:14:43,052 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:43,977 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:44,872 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1627
2025-11-12 10:14:44,873 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 436
2025-11-12 10:14:46,300 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:46,301 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:15:13,351 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:15:15,382 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:15:20,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:24,064 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:15:24,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:24,162 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:15:24,490 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:15:24,494 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:15:27,327 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:15:27,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:28,318 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:15:30,323 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:15:30,436 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:15:30,552 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:15:30,624 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:15:30,625 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:33,881 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:15:45,323 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:15:49,517 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:15:49,518 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:52,900 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:15:57,065 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:15:58,245 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:15:58,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:58,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:03,405 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 10:16:03,410 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:16:03,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:03,555 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:16:03,556 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:16:03,625 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:16:05,185 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:16:06,879 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:16:07,461 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:16:13,455 - ispa_next.functions - DEBUG - Updated appointment (AI00026194) customer contact data.
2025-11-12 10:16:14,403 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:16:14,405 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:16:15,740 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:16:15,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:16:16,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:16:20,846 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:16:20,846 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:16:20,850 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:16:20,851 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:16:20,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:16:21,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:16:25,439 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:16:25,443 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:16:25,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:16:25,517 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:16:25,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:26,385 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:26,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:16:27,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:16:27,149 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:16:30,233 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:16:30,236 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:16:31,192 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:16:31,194 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:16:31,218 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:16:31,228 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:16:31,238 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:16:31,241 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:16:31,250 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:16:31,390 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:16:31,406 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:16:31,410 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:16:31,423 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:16:31,427 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:16:31,429 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:16:31,431 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:34,718 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:16:34,720 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:16:34,723 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:16:34,724 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:16:34,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:16:35,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:16:35,674 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:46,157 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:16:46,159 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:49,450 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:17:01,797 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:17:02,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:17:02,826 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:17:02,991 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:17:34,334 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:17:37,825 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:17:41,539 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:17:45,677 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:17:45,679 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:17:45,680 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:17:46,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:17:46,306 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:17:46,308 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:17:47,901 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:17:57,033 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:17:57,399 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 10:17:57,825 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:17:59,811 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1627
2025-11-12 10:17:59,812 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:18:02,639 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 436
2025-11-12 10:18:02,640 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:18:03,573 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:18:03,579 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:18:03,588 - ispa_next.main - DEBUG - 



2025-11-12 10:18:03,588 - ispa_next.main - DEBUG - starting with process 13 (WI-DF 901) of 15
2025-11-12 10:18:03,592 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:18:04,892 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:18:05,964 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1627
2025-11-12 10:18:05,965 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 436
2025-11-12 10:18:07,400 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:18:07,401 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:18:32,903 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:18:35,271 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:18:40,523 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:45,101 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:18:45,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:45,173 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:18:45,391 - ispa_next.functions - DEBUG - HU date already expired after 19 days.
2025-11-12 10:18:50,209 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:18:50,212 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:18:53,068 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:18:53,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:54,035 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:56,040 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:18:56,125 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:18:56,227 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:18:56,288 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:19:00,468 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:19:01,474 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:19:01,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:02,035 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:14,687 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:19:14,687 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:19:19,652 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:19:19,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:19,749 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:19:19,750 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:19:19,811 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:19:19,941 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:19:21,263 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:19:21,485 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:19:24,860 - ispa_next.functions - DEBUG - Updated appointment (AR00013972) customer contact data.
2025-11-12 10:19:25,777 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:19:25,779 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:19:25,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:19:26,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:19:27,819 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:19:27,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:19:27,905 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:19:31,473 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:19:31,473 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:19:31,477 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:19:31,478 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:19:31,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:31,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:19:36,093 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 10:19:39,433 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:19:39,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:39,507 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:19:43,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:43,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:43,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:44,449 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:19:44,450 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:19:48,648 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:19:48,650 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:19:50,000 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:19:50,001 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:19:50,003 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:19:50,005 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:19:50,007 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:19:50,009 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:19:50,012 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:19:50,015 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:19:50,019 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:19:50,020 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:19:50,022 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:19:50,024 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:19:50,026 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:19:50,027 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:54,644 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:19:57,276 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:19:57,279 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:19:57,281 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:19:57,283 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:19:57,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:19:58,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:19:58,341 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:20:10,206 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:20:10,208 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:20:14,811 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:20:27,742 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:20:28,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:20:28,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:20:28,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:14,953 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:19,104 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:24,139 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:28,161 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:32,546 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:36,407 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:36,409 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:21:36,410 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:21:36,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:21:37,047 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:21:37,049 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:21:38,719 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:21:47,265 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:21:47,648 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 10:21:48,044 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:49,882 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1627
2025-11-12 10:21:49,883 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:52,231 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 436
2025-11-12 10:21:52,232 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:52,961 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:21:52,966 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:21:52,970 - ispa_next.main - DEBUG - 



2025-11-12 10:21:52,970 - ispa_next.main - DEBUG - starting with process 14 (AZ-EL 7777) of 15
2025-11-12 10:21:52,974 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:21:53,933 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:54,940 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1627
2025-11-12 10:21:54,940 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 436
2025-11-12 10:21:56,360 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:56,364 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:22:27,436 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:22:29,619 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:22:35,235 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:22:37,830 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:22:37,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:37,902 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:22:38,154 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:22:38,158 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:22:40,967 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:22:40,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:22:41,858 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:22:43,861 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:22:43,972 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:22:44,064 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:22:44,132 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:22:48,309 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:22:49,315 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:22:49,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:49,831 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:01,484 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:23:01,484 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:23:05,874 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:23:05,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:05,956 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:23:05,956 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:23:06,030 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:23:07,305 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:23:07,526 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:23:10,718 - ispa_next.functions - DEBUG - Updated appointment (BA00011080) customer contact data.
2025-11-12 10:23:11,617 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:23:11,619 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:23:12,325 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:23:12,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:23:13,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:23:16,628 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:23:16,628 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:23:16,632 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:23:16,632 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:23:16,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:17,141 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:23:21,312 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 10:23:24,647 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:23:24,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:24,719 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:23:33,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:34,273 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:34,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:35,019 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:23:35,020 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:23:37,454 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:23:37,456 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:23:39,462 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:23:39,464 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:23:39,466 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:23:39,467 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:23:39,468 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:23:39,471 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:23:39,479 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:23:39,482 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:23:39,485 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:23:39,488 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:23:39,490 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:23:39,493 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:23:39,495 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:23:39,495 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:42,098 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:23:42,099 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:23:42,101 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:23:42,103 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:23:42,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:23:42,900 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:23:43,122 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:52,924 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:23:52,926 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:55,518 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:24:07,851 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:24:08,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:24:08,860 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:24:09,088 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:34,599 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:24:39,320 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:24:44,097 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:24:44,099 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:24:44,099 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:24:44,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:24:44,726 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:24:44,728 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:24:46,407 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:24:54,696 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:24:55,114 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 10:24:55,495 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:24:58,127 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1627
2025-11-12 10:24:58,132 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:25:01,085 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 436
2025-11-12 10:25:01,085 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:01,925 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:25:01,929 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:25:01,935 - ispa_next.main - DEBUG - 



2025-11-12 10:25:01,935 - ispa_next.main - DEBUG - starting with process 15 (MZ-S 7911 E) of 15
2025-11-12 10:25:01,939 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:25:03,346 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:25:04,704 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1627
2025-11-12 10:25:04,705 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 436
2025-11-12 10:25:06,372 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:25:06,374 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:42,060 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:25:44,264 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:25:49,454 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:51,373 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:25:51,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:51,433 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:25:51,608 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:25:51,611 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:25:54,379 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:25:54,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:25:55,289 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:25:57,292 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:25:57,411 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:25:57,503 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:25:57,628 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:26:01,809 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:26:02,815 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:26:02,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:03,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:13,626 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:26:17,564 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:26:17,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:17,643 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:26:17,643 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:26:17,684 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:26:18,898 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:26:20,093 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:26:20,322 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:26:23,639 - ispa_next.functions - DEBUG - Updated appointment (AZ00011291) customer contact data.
2025-11-12 10:26:24,598 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:26:24,601 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:26:25,542 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:26:25,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:26:26,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:26:30,003 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:26:30,003 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:26:30,018 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:26:30,019 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:26:30,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:30,525 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:26:34,746 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:26:34,766 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:26:34,767 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:34,878 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:26:35,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:35,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:35,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:36,617 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:26:36,619 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:26:38,468 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:26:38,470 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:26:39,800 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:26:39,801 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:26:39,803 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:26:39,804 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:26:39,805 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:26:39,807 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:26:39,808 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:26:39,809 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:26:39,810 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:26:39,812 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:26:39,822 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:26:39,824 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:26:39,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:41,702 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:26:41,705 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:26:41,706 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:26:41,709 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:26:41,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:26:42,450 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:26:42,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:51,815 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:26:51,820 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:53,698 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:27:06,166 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:27:06,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:27:07,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:27:07,376 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:27:25,673 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:30,360 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:30,362 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:27:30,363 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:27:30,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:27:31,026 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:27:31,028 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:27:32,553 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:27:40,387 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:27:40,769 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 10:27:41,299 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:27:42,920 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1627
2025-11-12 10:27:42,922 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:27:45,690 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 436
2025-11-12 10:27:45,690 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:27:46,406 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:27:46,411 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
