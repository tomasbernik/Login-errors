2025-11-12 11:00:35,796 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:00:35,804 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:00:47,571 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:01:01,572 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:01:17,030 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:01:41,575 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:01:53,292 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:01:55,868 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:01:57,057 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:01:57,059 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:01:59,460 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:01:59,461 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:01:59,462 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:02:00,673 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:02:01,807 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:02:26,824 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:26,841 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:26,880 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:26,907 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Franz Tönnessen KLE-JT 304 WBA3A11000J283456 ohne Termin.
2025-11-12 11:02:26,922 - ispa_next.appointments.models - DEBUG - Appointment Daria Kamila Kolodziej KLE-QR 734 WBA8L71060K555733 ohne Termin.
2025-11-12 11:02:26,946 - ispa_next.appointments.models - DEBUG - Appointment Oliver Christian Wiegand MH-WI 1001 WMWZM31040T035812 ohne Termin.
2025-11-12 11:02:26,957 - ispa_next.appointments.models - DEBUG - Appointment Rabiullah Arash GEL-NK 786 WBAWZ510800M35552 ohne Termin.
2025-11-12 11:02:26,959 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:26,959 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:26,959 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:26,960 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:26,978 - ispa_next.main - DEBUG - Found 15 out of 46 appointments to process (configured limit: 15).
2025-11-12 11:02:26,979 - ispa_next.main - DEBUG - Processing 10 fresh appointments.
2025-11-12 11:02:26,979 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 11:02:26,979 - ispa_next.main - DEBUG - All appointments: LÖWN93, MO-FP 2023, WES-SC 128, KLE F 404, KLE S 7711, GEL RG111, M-D-3722, KR-SW7373, GEL VW 25, Kle-FM-44e, BM-R 220E, GEL-AH 22E, GEL-F 6363, KLE-B 1268, KLE-W 5828
2025-11-12 11:02:26,982 - ispa_next.main - DEBUG - 



2025-11-12 11:02:26,983 - ispa_next.main - DEBUG - starting with process 1 (LÖWN93) of 15
2025-11-12 11:02:26,987 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:02:28,010 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:29,196 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:02:29,198 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:02:30,333 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:02:30,335 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:03:03,391 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:03:03,477 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:03:03,481 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:03:03,930 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:03:03,930 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:03:06,374 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:03:06,375 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:03:07,162 - ispa_next.main - DEBUG - Found new Appointment: GEL-LJ 23
2025-11-12 11:03:07,164 - ispa_next.main - DEBUG - 



2025-11-12 11:03:07,164 - ispa_next.main - DEBUG - starting with process 2 (GEL-LJ 23) of 16
2025-11-12 11:03:07,168 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:03:08,318 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:03:09,551 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:03:09,553 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:03:10,793 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:03:10,794 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:03:32,639 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:03:34,388 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:03:39,354 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:03:41,897 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:03:41,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:41,965 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:42,244 - ispa_next.functions - DEBUG - HU date already expired after 116 days.
2025-11-12 11:03:45,430 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:03:45,432 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:03:45,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:45,502 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:52,098 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:03:52,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:03:53,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:03:55,069 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:03:55,185 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:03:55,289 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:03:55,353 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:03:59,572 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:04:00,578 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:04:00,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:01,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:12,577 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:04:16,555 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:04:16,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:16,647 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:04:16,647 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:04:16,691 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:04:17,939 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:04:19,008 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:04:19,278 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:04:20,500 - ispa_next.functions - DEBUG - Updated appointment (AL00014243) customer contact data.
2025-11-12 11:04:21,415 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:04:21,416 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:04:22,137 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:04:22,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:04:22,897 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:04:26,911 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:04:26,911 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:04:26,915 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:04:26,917 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:04:26,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:27,441 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:04:27,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:28,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:28,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:29,171 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:04:29,175 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:04:31,690 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:04:31,691 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:04:33,042 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:04:33,042 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:04:33,052 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:04:33,054 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:04:33,060 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:04:33,060 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:04:33,061 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:04:33,065 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:04:33,067 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:04:33,071 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:04:33,076 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:04:33,078 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:04:33,078 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:35,633 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:04:35,634 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:04:35,645 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:38,262 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:04:38,264 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:04:38,266 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:04:38,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:40,765 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:04:52,356 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:04:53,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:04:53,706 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:04:53,930 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:00,619 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:05:04,137 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:05:04,137 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:05:04,717 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:05:04,786 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:05:04,788 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:05:08,570 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:05:25,165 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:05:25,561 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:05:26,026 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:05:38,869 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:05:38,871 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:05:41,773 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:05:41,774 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:05:42,598 - ispa_next.main - DEBUG - 



2025-11-12 11:05:42,598 - ispa_next.main - DEBUG - starting with process 3 (MO-FP 2023) of 16
2025-11-12 11:05:42,602 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:05:43,688 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:05:44,674 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:05:44,675 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:05:46,060 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:05:46,061 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:06:17,413 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:06:17,421 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:06:17,425 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:17,817 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:06:17,819 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:20,332 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:06:20,332 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:06:21,172 - ispa_next.main - DEBUG - 



2025-11-12 11:06:21,172 - ispa_next.main - DEBUG - starting with process 4 (WES-SC 128) of 16
2025-11-12 11:06:21,175 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:06:22,275 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:23,498 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:06:23,500 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:06:24,867 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:24,868 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:06:46,511 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:06:55,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:55,930 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:06:56,102 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:06:57,311 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:06:57,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:57,379 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:06:57,538 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:06:57,540 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:06:57,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:57,647 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:07:00,564 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:07:00,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:07:01,582 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:07:03,586 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:07:03,707 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:07:06,932 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:07:07,022 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:07:07,023 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:07:15,158 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:07:16,162 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:07:16,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:16,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:27,146 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:07:33,648 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:07:33,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:33,722 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:07:33,723 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:07:33,763 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:07:34,937 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:07:36,108 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:07:36,372 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:07:39,507 - ispa_next.functions - DEBUG - Updated appointment (BB00025530) customer contact data.
2025-11-12 11:07:40,503 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:07:40,505 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:07:41,135 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:07:41,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:07:41,733 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:07:45,322 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:07:45,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:07:45,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:07:47,865 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:07:47,968 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:07:48,062 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:07:48,127 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:07:48,128 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:07:59,555 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:08:03,713 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:08:03,713 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:08:07,956 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:08:08,971 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:08:08,975 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:08:08,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:08:09,097 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:08:14,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:15,214 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:15,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:08:15,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:08:15,970 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:08:17,276 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:08:17,278 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:08:18,271 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:08:18,272 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:08:18,276 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-12 11:08:18,278 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:08:18,281 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:08:18,283 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:08:18,283 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:08:18,287 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:08:18,288 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:08:18,298 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:08:18,302 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:08:18,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:08:19,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:08:26,624 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:08:26,626 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:08:26,627 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:08:26,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:28,585 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:08:28,587 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:08:28,589 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:30,449 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:08:30,451 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:08:30,453 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:08:30,455 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:32,323 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:08:45,247 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:08:45,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:08:46,614 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:08:46,780 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:52,690 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:08:58,657 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:08:58,657 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:08:59,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:08:59,322 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:08:59,324 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:09:02,680 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:09:10,058 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:09:10,435 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:09:11,310 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:11,975 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:09:11,976 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:15,059 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:09:15,060 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:15,967 - ispa_next.main - DEBUG - 



2025-11-12 11:09:15,967 - ispa_next.main - DEBUG - starting with process 5 (KLE F 404) of 16
2025-11-12 11:09:15,971 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:09:17,112 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:18,321 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:09:18,322 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:09:19,840 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:19,842 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:00,787 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:10:00,794 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:10:00,799 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:01,332 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:10:01,334 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:03,939 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:10:03,940 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:04,846 - ispa_next.main - DEBUG - 



2025-11-12 11:10:04,847 - ispa_next.main - DEBUG - starting with process 6 (KLE S 7711) of 16
2025-11-12 11:10:04,850 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:10:05,932 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:06,994 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:10:06,995 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:10:08,326 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:08,327 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:39,459 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:10:39,467 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:10:39,471 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:39,836 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:10:39,836 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:42,000 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:10:42,001 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:42,694 - ispa_next.main - DEBUG - 



2025-11-12 11:10:42,695 - ispa_next.main - DEBUG - starting with process 7 (GEL RG111) of 16
2025-11-12 11:10:42,699 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:10:43,574 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:44,490 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:10:44,491 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:10:45,642 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:45,643 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:16,555 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:11:16,565 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:11:16,569 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:16,976 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:11:16,976 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:19,613 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:11:19,613 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:20,247 - ispa_next.main - DEBUG - 



2025-11-12 11:11:20,247 - ispa_next.main - DEBUG - starting with process 8 (M-D-3722) of 16
2025-11-12 11:11:20,250 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:21,047 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:21,803 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:11:21,804 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:11:23,033 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:23,034 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:53,683 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:11:53,693 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:11:53,696 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:54,278 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:11:54,280 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:57,098 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:11:57,102 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:57,898 - ispa_next.main - DEBUG - 



2025-11-12 11:11:57,898 - ispa_next.main - DEBUG - starting with process 9 (KR-SW7373) of 16
2025-11-12 11:11:57,902 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:59,346 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:12:00,522 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:12:00,524 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:12:02,030 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:12:02,031 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:34,454 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:12:34,464 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:12:34,468 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:12:35,053 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:12:35,054 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:12:37,556 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:12:37,557 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:38,403 - ispa_next.main - DEBUG - 



2025-11-12 11:12:38,403 - ispa_next.main - DEBUG - starting with process 10 (GEL VW 25) of 16
2025-11-12 11:12:38,407 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:12:39,626 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:12:40,751 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:12:40,753 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:12:42,326 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:12:42,327 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:11,993 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:13:12,000 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 11:13:12,004 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:12,543 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:13:12,543 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:15,142 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:13:15,143 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:15,818 - ispa_next.main - DEBUG - 



2025-11-12 11:13:15,819 - ispa_next.main - DEBUG - starting with process 11 (Kle-FM-44e) of 16
2025-11-12 11:13:15,822 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:16,676 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:17,636 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:13:17,637 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:13:18,866 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:18,867 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:49,463 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:13:49,471 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 11:13:49,475 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:49,986 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:13:49,988 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:52,800 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:13:52,800 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:53,587 - ispa_next.main - DEBUG - 



2025-11-12 11:13:53,587 - ispa_next.main - DEBUG - starting with process 12 (BM-R 220E) of 16
2025-11-12 11:13:53,590 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:54,722 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:55,920 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 430
2025-11-12 11:13:55,921 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:13:57,185 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:57,186 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:19,786 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:14:21,675 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:14:26,949 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:14:31,638 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:14:31,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:14:31,707 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:14:31,925 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:14:35,531 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:14:35,533 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:14:35,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:14:35,593 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:14:38,729 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:14:38,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:14:39,640 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:14:41,644 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:14:41,746 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:14:41,863 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:14:41,967 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:14:46,161 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:14:47,166 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:14:47,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:14:47,715 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:01,841 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:15:05,984 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:15:05,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:06,442 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:15:06,443 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:15:06,500 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:15:08,308 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:15:08,731 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:15:10,091 - ispa_next.functions - DEBUG - Updated appointment (BB00024105) customer contact data.
2025-11-12 11:15:11,110 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:15:11,113 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:15:11,777 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:15:11,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:15:12,457 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:15:16,036 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:15:16,036 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:15:16,040 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:15:16,042 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:15:16,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:15:16,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:15:25,663 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:15:30,144 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:15:30,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:30,868 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:30,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:15:31,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:15:31,562 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:15:35,744 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:15:35,746 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:15:37,038 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:15:37,042 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:15:37,048 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:15:37,050 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:15:37,054 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:15:37,054 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:15:37,059 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:15:37,060 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:15:37,064 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:15:37,069 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:15:37,070 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:15:37,070 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:41,782 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:15:41,784 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:15:41,786 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:46,374 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:15:46,375 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:15:46,376 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:15:46,378 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:50,937 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:16:03,462 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:16:04,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:16:04,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:16:04,985 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:13,778 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:16:17,151 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:16:17,152 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:16:17,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:16:17,952 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:16:17,954 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:16:21,614 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:16:30,321 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:16:30,711 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 11:16:31,488 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:32,126 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 421
2025-11-12 11:16:32,128 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:34,888 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:16:34,889 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:35,745 - ispa_next.main - DEBUG - 



2025-11-12 11:16:35,745 - ispa_next.main - DEBUG - starting with process 13 (GEL-AH 22E) of 16
2025-11-12 11:16:35,749 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:16:36,849 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:37,951 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 421
2025-11-12 11:16:37,952 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:16:39,612 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:39,613 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:17:03,006 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:17:05,102 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:17:10,661 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:13,241 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:17:13,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:13,311 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:13,523 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:17:13,525 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:17:13,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:13,638 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:16,745 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:17:16,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:17,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:19,799 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:17:19,953 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:17:20,058 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:17:20,131 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:17:24,347 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:17:25,363 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:17:25,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:25,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:38,503 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:17:38,503 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:17:43,123 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:17:43,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:43,198 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:43,215 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:17:43,285 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:17:44,556 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:17:44,776 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:17:46,269 - ispa_next.functions - DEBUG - Updated appointment (BB00024057) customer contact data.
2025-11-12 11:17:47,182 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:17:47,184 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:17:47,902 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:17:47,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:17:48,687 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:17:52,255 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:17:52,255 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:17:52,259 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:17:52,262 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:17:52,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:52,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:18:01,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:02,223 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:02,224 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:02,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:18:02,929 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:18:05,427 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:18:05,428 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:18:06,849 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:18:06,853 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:18:06,857 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:18:06,859 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:18:06,863 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:18:06,865 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:18:06,869 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:18:06,869 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:18:06,873 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:18:06,878 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:18:06,878 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:18:06,880 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:09,477 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:18:09,478 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:18:09,481 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:12,117 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:18:12,119 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:18:12,121 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:18:12,123 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:14,726 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:18:26,402 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:18:26,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:27,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:18:27,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:34,447 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:37,422 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:18:37,423 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:37,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:37,957 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:18:37,959 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:18:41,404 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:18:49,418 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:18:49,804 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 11:18:50,587 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:51,147 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 421
2025-11-12 11:18:51,147 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:53,622 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:18:53,622 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:54,280 - ispa_next.main - DEBUG - 



2025-11-12 11:18:54,280 - ispa_next.main - DEBUG - starting with process 14 (GEL-F 6363) of 16
2025-11-12 11:18:54,285 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:55,099 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:55,890 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 421
2025-11-12 11:18:55,891 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:18:57,155 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:57,157 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:21,452 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:19:24,263 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:19:29,295 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:34,685 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:19:34,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:34,750 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:34,967 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:19:40,147 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:19:40,149 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:19:40,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:40,267 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:43,512 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:43,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:44,683 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:19:46,687 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:19:46,813 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:19:46,932 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:19:46,999 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:19:51,252 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:19:52,257 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:19:52,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:52,746 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:05,103 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:20:09,746 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:20:09,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:09,844 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:09,846 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:20:09,884 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:20:11,118 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:20:12,251 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:20:12,471 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:20:13,857 - ispa_next.functions - DEBUG - Updated appointment (BB00025221) customer contact data.
2025-11-12 11:20:14,774 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:20:14,776 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:20:15,645 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:20:15,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:20:16,317 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:20:20,330 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:20:20,330 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:20:20,334 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:20:20,338 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:20:20,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:20,831 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:21,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:21,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:21,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:22,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:22,363 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:20:27,054 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:20:27,056 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:20:28,530 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:20:28,531 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:28,535 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:20:28,539 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:28,545 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:20:28,547 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:20:28,549 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:20:28,551 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:20:28,553 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:20:28,557 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:20:28,559 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:20:28,561 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:20:28,561 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:33,957 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:20:33,959 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:20:33,961 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:39,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:39,324 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:20:51,135 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:05,692 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:21:05,694 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:21:05,696 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:21:05,698 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:11,129 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-12 11:21:19,160 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:21:36,149 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:21:37,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:21:38,451 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:21:38,720 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:52,245 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:21:55,750 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:21:55,751 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:21:56,490 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:21:56,572 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:21:56,573 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:22:00,045 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:22:07,932 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:22:08,302 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 11:22:09,477 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:09,973 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 421
2025-11-12 11:22:09,974 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:12,719 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:22:12,720 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:22:13,444 - ispa_next.main - DEBUG - 



2025-11-12 11:22:13,445 - ispa_next.main - DEBUG - starting with process 15 (KLE-B 1268) of 16
2025-11-12 11:22:13,449 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:14,660 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:15,616 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 421
2025-11-12 11:22:15,617 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:22:17,017 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:17,018 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:22:48,165 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:22:48,178 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 11:22:48,186 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:48,781 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 421
2025-11-12 11:22:48,782 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:51,485 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:22:51,486 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:22:52,601 - ispa_next.main - DEBUG - 



2025-11-12 11:22:52,601 - ispa_next.main - DEBUG - starting with process 16 (KLE-W 5828) of 16
2025-11-12 11:22:52,608 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:53,859 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:55,293 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 421
2025-11-12 11:22:55,295 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 11:22:56,951 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:56,952 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:28,349 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:23:28,359 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 11:23:28,363 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:28,895 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 421
2025-11-12 11:23:28,895 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:31,535 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 11:23:31,536 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
