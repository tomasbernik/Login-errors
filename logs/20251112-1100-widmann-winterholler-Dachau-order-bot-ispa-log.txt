2025-11-12 11:00:37,277 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:00:37,288 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:00:46,673 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:00:59,124 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:01:14,737 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:01:38,556 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:01:49,497 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:01:53,057 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:01:54,193 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:01:54,194 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-12 11:01:56,814 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 126
2025-11-12 11:01:56,815 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:01:56,816 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:01:58,158 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:01:59,462 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:02:16,414 - ispa_next.appointments.models - DEBUG - Appointment Robert Charles Armin FS-NA 42 WMWYT910303D93360 ohne Termin.
2025-11-12 11:02:16,430 - ispa_next.appointments.models - DEBUG - Appointment Nils-Roman Juraske MB-RJ 25 WBAJN71070CD07600 ohne Termin.
2025-11-12 11:02:16,446 - ispa_next.appointments.models - DEBUG - Appointment Benedikt Burger FFB-XG 87 WBS11DM0708D97738 ohne Termin.
2025-11-12 11:02:16,457 - ispa_next.appointments.models - DEBUG - Appointment Timon Wohlfarth  WMWXU710402M05502 ohne Termin.
2025-11-12 11:02:16,465 - ispa_next.appointments.models - DEBUG - Appointment Neutrik EMEA GmbH DAH-NG 90E WBY71GM0905348864 ohne Termin.
2025-11-12 11:02:16,475 - ispa_next.appointments.models - DEBUG - Appointment Chi Chung Nguyen M-HC 2737 WBACR61070LJ18143 ohne Termin.
2025-11-12 11:02:16,484 - ispa_next.appointments.models - DEBUG - Appointment Ingrid Berger M-MB 525 WBAFF41030L117517 ohne Termin.
2025-11-12 11:02:16,484 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:16,484 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:16,484 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:16,486 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:16,486 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:16,487 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:16,490 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:16,498 - ispa_next.appointments.models - DEBUG - Appointment Brigitte Lang DAH-U 904 WMW21DL0703N66211 ohne Termin.
2025-11-12 11:02:16,506 - ispa_next.appointments.models - DEBUG - Appointment Franziska Scheitler DAH-FS 242 WBA31DZ040FJ93655 ohne Termin.
2025-11-12 11:02:16,513 - ispa_next.appointments.models - DEBUG - Appointment NovaTaste Germany GmbH BGL-NT 303 WBA41EG0005X32470 ohne Termin.
2025-11-12 11:02:16,521 - ispa_next.appointments.models - DEBUG - Appointment Sieglinde Wasmeier PAN-SW 11 WBA21BX0907N85009 ohne Termin.
2025-11-12 11:02:16,528 - ispa_next.appointments.models - DEBUG - Appointment REWE Markt GmbH FS-RE 208 WBA71AC0505R28464 ohne Termin.
2025-11-12 11:02:16,537 - ispa_next.appointments.models - DEBUG - Appointment Christos Michalopoulos DAH-GR 517 WBATX95050ND73284 ohne Termin.
2025-11-12 11:02:16,547 - ispa_next.appointments.models - DEBUG - Appointment Harald Schmidt-Habich FS-CU 168 WBAWZ510700L19145 ohne Termin.
2025-11-12 11:02:16,554 - ispa_next.appointments.models - DEBUG - Appointment Hiller DAH-LH 258 WBAWY510600E18805 ohne Termin.
2025-11-12 11:02:16,562 - ispa_next.appointments.models - DEBUG - Appointment Johannes Nist DAH-VN 66 WBA11GR0209Z99162 ohne Termin.
2025-11-12 11:02:16,570 - ispa_next.appointments.models - DEBUG - Appointment Annemarie Eichhorn DAH-AE 279 WBA71AC0405V15516 ohne Termin.
2025-11-12 11:02:16,580 - ispa_next.appointments.models - DEBUG - Appointment Ezmin Tanjic RE-EZA 1 WBACV61030LJ72146 ohne Termin.
2025-11-12 11:02:16,587 - ispa_next.appointments.models - DEBUG - Appointment PRK GmbH Kunststoffverarbeitung  WMW61DL0903S22669 ohne Termin.
2025-11-12 11:02:16,596 - ispa_next.appointments.models - DEBUG - Appointment Härtetechnik Redak GmbH & Co. KG DAH-MC 510 WBS41AY030FM13870 ohne Termin.
2025-11-12 11:02:16,605 - ispa_next.appointments.models - DEBUG - Appointment Volksbank Raiffeisenbank Dachau eG DAH-VR 86 E WBA81CY050FS22937 ohne Termin.
2025-11-12 11:02:16,613 - ispa_next.appointments.models - DEBUG - Appointment Dirk Ullrich RN-M 500E WBS81GV040CV92768 ohne Termin.
2025-11-12 11:02:16,622 - ispa_next.appointments.models - DEBUG - Appointment Jörg Rolfes OAL-AR 191 WBAUZ35010N015446 ohne Termin.
2025-11-12 11:02:16,631 - ispa_next.appointments.models - DEBUG - Appointment Andreas Christmann M-AK 1539E WMW11GC05RTA37157 ohne Termin.
2025-11-12 11:02:16,638 - ispa_next.appointments.models - DEBUG - Appointment Christian Ettenberger FFB-CE 56E WMW11DJ0602T37216 ohne Termin.
2025-11-12 11:02:16,647 - ispa_next.appointments.models - DEBUG - Appointment Baader Bank AG M-V 7427 WBA41EG0X05Y35735 ohne Termin.
2025-11-12 11:02:16,654 - ispa_next.appointments.models - DEBUG - Appointment Dr. Nicola Steiner DAH-LS 855 WMWXU71010TN14283 ohne Termin.
2025-11-12 11:02:16,661 - ispa_next.appointments.models - DEBUG - Appointment Rita Oberrecht-Schwarz DAH-RA 13 WBA11AB01N5T43220 ohne Termin.
2025-11-12 11:02:16,668 - ispa_next.appointments.models - DEBUG - Appointment Rolf Ludwig Hagert DAH-AR 678 WBA2E310705D82895 ohne Termin.
2025-11-12 11:02:16,675 - ispa_next.appointments.models - DEBUG - Appointment Rainer Tobias Möller DAH-ST 807 WBA6V31070EB10798 ohne Termin.
2025-11-12 11:02:16,681 - ispa_next.appointments.models - DEBUG - Appointment Dr. Norbert Metz STA-M 2828 WBA6X310405T68381 ohne Termin.
2025-11-12 11:02:16,689 - ispa_next.appointments.models - DEBUG - Appointment Franz Rockinger FFB-FR 267 WBA31BX0807R25447 ohne Termin.
2025-11-12 11:02:16,698 - ispa_next.appointments.models - DEBUG - Appointment Dario Zandonella Maiucco DAH-DZ 73 WBAXA51050C586150 ohne Termin.
2025-11-12 11:02:16,706 - ispa_next.appointments.models - DEBUG - Appointment Anna Gushchina M-AG 7192 WMWRC310X0TB89348 ohne Termin.
2025-11-12 11:02:16,707 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:16,714 - ispa_next.appointments.models - DEBUG - Appointment Radloff DAH-RA 238 WBY71AW050FR88400 ohne Termin.
2025-11-12 11:02:16,721 - ispa_next.appointments.models - DEBUG - Appointment Augusto Fracasso DAH-GF 289 WBA11AB0005N66647 ohne Termin.
2025-11-12 11:02:16,734 - ispa_next.main - DEBUG - Found 9 out of 56 appointments to process (configured limit: 15).
2025-11-12 11:02:16,734 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-12 11:02:16,735 - ispa_next.main - DEBUG - Processing 4 already visited appointments (w/ RKR not callable).
2025-11-12 11:02:16,735 - ispa_next.main - DEBUG - All appointments: M-JW 1077E, M GX 4646, M-TU1209, DAH-VA33E, DAH-VA27E, M-MM 569, M-WB 1959, FS-PK 118, CHA-M 3195
2025-11-12 11:02:16,738 - ispa_next.main - DEBUG - 



2025-11-12 11:02:16,738 - ispa_next.main - DEBUG - starting with process 1 (M-JW 1077E) of 9
2025-11-12 11:02:16,745 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:02:17,917 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:19,245 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:02:19,247 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 126
2025-11-12 11:02:20,675 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:02:20,676 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:02:47,552 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:02:58,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:02:58,517 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:02:58,701 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:02:59,881 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:02:59,882 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:02:59,983 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:00,248 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:03:00,252 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:03:03,256 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:03:03,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:03:04,417 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:03:06,420 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:03:06,514 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:03:09,748 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:03:09,811 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:03:09,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:03:11,076 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:03:19,641 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:03:20,647 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:03:20,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:21,174 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:35,093 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:03:43,159 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:03:43,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:43,253 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:43,254 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:03:43,294 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:03:44,558 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:03:44,775 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:03:47,966 - ispa_next.functions - DEBUG - Updated appointment (AX00012318) customer contact data.
2025-11-12 11:03:48,903 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:03:48,905 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:03:49,603 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:03:49,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:03:50,283 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:03:53,880 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:03:53,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:03:54,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:03:56,369 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:03:56,464 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:03:56,570 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:03:56,632 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:03:56,633 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:03:57,838 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:04:09,051 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:04:13,336 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:04:13,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:14,570 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:04:18,755 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:04:19,769 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:04:19,769 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:04:19,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:19,841 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:04:24,004 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:04:24,008 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:04:24,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:24,106 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:04:34,187 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:04:42,367 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-12 11:04:50,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:50,985 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:50,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:51,644 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:04:51,646 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:04:52,985 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:04:52,987 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:04:53,943 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:04:53,954 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:04:53,957 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Servicereinigung / Maschinelle Oberwäsche und Fußr, source=from_tab, target=cart)}
2025-11-12 11:04:53,958 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:04:53,960 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:04:53,961 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-12 11:04:53,962 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Winter - Fit - Paket / Winter - Fit - Paket, source=from_tab, target=advice_list)}
2025-11-12 11:04:53,963 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:04:53,965 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:04:53,966 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:04:53,968 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:04:53,969 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:04:54,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:04:55,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:05:00,868 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:05:00,869 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 11:05:01,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:05:01,704 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-12 11:05:14,744 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:05:14,746 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:05:14,748 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:05:14,749 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:16,657 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:05:16,658 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:05:16,666 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:18,536 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:05:18,538 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:05:18,539 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:05:18,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:20,398 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:05:38,381 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:05:39,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:05:40,164 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:05:40,362 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:46,923 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:05:51,760 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:05:51,763 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:05:51,763 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:05:52,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:05:52,659 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:05:52,661 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:05:54,813 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:06:04,507 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:06:04,897 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:06:05,416 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:07,018 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:06:07,019 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:09,300 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-12 11:06:09,301 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:06:10,000 - ispa_next.main - DEBUG - 



2025-11-12 11:06:10,000 - ispa_next.main - DEBUG - starting with process 2 (M GX 4646) of 9
2025-11-12 11:06:10,004 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:06:10,983 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:11,910 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:06:11,911 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-12 11:06:13,217 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:13,219 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:06:49,793 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:06:49,870 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:06:49,873 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:50,436 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:06:50,437 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:52,704 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-12 11:06:52,705 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:06:53,403 - ispa_next.main - DEBUG - 



2025-11-12 11:06:53,403 - ispa_next.main - DEBUG - starting with process 3 (M-TU1209) of 9
2025-11-12 11:06:53,407 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:06:54,388 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:55,369 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:06:55,370 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-12 11:06:56,970 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:56,972 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:07:29,363 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:07:29,371 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:07:29,374 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:29,839 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:07:29,840 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:07:32,158 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-12 11:07:32,159 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:07:32,885 - ispa_next.main - DEBUG - 



2025-11-12 11:07:32,885 - ispa_next.main - DEBUG - starting with process 4 (DAH-VA33E) of 9
2025-11-12 11:07:32,891 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:07:33,799 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:34,777 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:07:34,779 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-12 11:07:36,142 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:07:36,143 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:06,417 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:08:06,425 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:08:06,428 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:06,941 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:08:06,942 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:09,270 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-12 11:08:09,271 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:10,012 - ispa_next.main - DEBUG - 



2025-11-12 11:08:10,012 - ispa_next.main - DEBUG - starting with process 5 (DAH-VA27E) of 9
2025-11-12 11:08:10,015 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:08:11,022 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:12,305 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:08:12,306 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-12 11:08:14,105 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:14,106 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:45,987 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:08:45,997 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:08:46,001 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:46,737 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:08:46,738 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:49,783 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-12 11:08:49,784 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:50,744 - ispa_next.main - DEBUG - 



2025-11-12 11:08:50,744 - ispa_next.main - DEBUG - starting with process 6 (M-MM 569) of 9
2025-11-12 11:08:50,748 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:08:52,172 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:53,592 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:08:53,594 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-12 11:08:55,407 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:55,408 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:19,408 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:09:21,751 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:09:27,369 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:32,720 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:09:32,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:32,796 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:09:32,996 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:09:37,494 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:09:37,497 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:09:40,217 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:09:40,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:09:41,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:09:43,329 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:09:43,492 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:09:43,619 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:09:43,708 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:09:47,969 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:09:48,974 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:09:48,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:49,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:02,712 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:10:07,431 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:10:07,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:07,526 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:10:07,527 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:10:07,589 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:10:07,670 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:10:08,824 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 11:10:10,024 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 11:10:10,326 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:10:11,632 - ispa_next.functions - DEBUG - Updated appointment (AX00012220) customer contact data.
2025-11-12 11:10:12,523 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:10:12,525 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:10:12,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:10:13,285 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:10:14,331 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:10:14,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:10:14,404 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:10:18,394 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:10:18,394 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:10:18,397 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:10:18,398 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:10:18,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:18,883 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:10:23,031 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:10:23,036 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:10:23,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:23,150 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:10:23,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:24,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:24,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:24,842 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:10:24,843 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:10:29,683 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:10:29,684 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:10:31,159 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:10:31,164 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:10:31,167 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:10:31,169 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:10:31,170 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:10:31,172 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-12 11:10:31,174 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:10:31,177 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:10:31,179 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:10:31,180 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:10:31,183 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:10:31,185 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:10:31,188 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:10:31,190 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:36,600 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:10:36,602 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:10:36,606 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:41,927 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:10:41,930 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:10:41,933 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:10:41,936 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:47,222 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:11:02,292 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:11:02,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:11:03,711 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:11:04,040 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:14,225 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:18,640 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:23,346 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:27,668 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:31,922 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:36,641 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:41,227 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:41,229 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:11:41,230 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:42,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:11:42,156 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:11:42,158 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:11:44,445 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:11:53,231 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:11:53,627 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:11:53,984 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:55,830 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:11:55,831 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:58,592 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-12 11:11:58,594 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:59,488 - ispa_next.main - DEBUG - 



2025-11-12 11:11:59,488 - ispa_next.main - DEBUG - starting with process 7 (M-WB 1959) of 9
2025-11-12 11:11:59,492 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:12:00,412 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:12:01,540 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1291
2025-11-12 11:12:01,541 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-12 11:12:02,825 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:12:02,827 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:26,583 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:12:28,697 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:12:34,360 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:37,650 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:12:37,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:37,784 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:37,965 - ispa_next.functions - DEBUG - HU date already expired after 840 days.
2025-11-12 11:12:42,388 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:12:42,391 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:12:45,291 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:12:45,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:46,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:48,499 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:12:48,621 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:12:48,709 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:12:48,782 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:12:52,999 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:12:54,004 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:12:54,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:54,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:08,683 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:13:13,189 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:13:13,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:13,264 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:13:13,265 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:13:13,359 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:13:14,646 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:13:14,865 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:13:16,169 - ispa_next.functions - DEBUG - Updated appointment (BH00015640) customer contact data.
2025-11-12 11:13:17,085 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:13:17,088 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:13:17,996 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:13:17,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:13:18,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:13:22,992 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:13:22,992 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:13:22,996 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:13:22,996 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:13:22,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:23,498 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:13:27,623 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:13:27,627 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:13:27,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:27,696 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:13:28,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:28,577 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:28,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:29,256 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:13:29,258 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:13:32,299 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:13:32,301 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:13:33,640 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:13:33,641 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:13:33,643 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:13:33,644 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:13:33,646 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:13:33,647 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-12 11:13:33,648 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:13:33,649 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:13:33,651 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:13:33,652 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:13:33,654 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:13:33,660 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:13:33,662 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:13:33,662 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:36,917 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:13:36,918 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:13:36,920 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:40,177 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:13:40,179 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:13:40,181 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:13:40,182 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:43,384 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:13:56,206 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:13:56,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:13:57,425 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:13:57,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:14:05,048 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:10,500 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:15,238 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:20,134 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:20,136 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:14:20,137 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:21,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:14:21,123 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:14:21,124 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:14:23,317 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:14:32,684 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:14:33,049 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:14:33,410 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:35,505 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1292
2025-11-12 11:14:35,506 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:38,868 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-12 11:14:38,869 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:39,869 - ispa_next.main - DEBUG - 



2025-11-12 11:14:39,869 - ispa_next.main - DEBUG - starting with process 8 (FS-PK 118) of 9
2025-11-12 11:14:39,874 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:41,243 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:42,710 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1292
2025-11-12 11:14:42,711 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-12 11:14:44,364 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:44,366 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:10,622 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:15:12,431 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:15:17,886 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:22,590 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:15:22,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:22,650 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:15:22,819 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:15:26,248 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:15:26,251 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:15:28,924 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:15:28,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:15:30,082 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:15:32,084 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:15:32,197 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:15:32,288 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:15:32,396 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:15:32,397 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:37,177 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:15:45,833 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:15:46,837 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:15:46,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:47,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:00,709 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:16:04,234 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:16:04,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:04,331 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:16:04,332 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:16:04,390 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:16:05,626 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:16:05,830 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:16:07,327 - ispa_next.functions - DEBUG - Updated appointment (AX00012117) customer contact data.
2025-11-12 11:16:08,239 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:16:08,240 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:16:08,908 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:16:08,909 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:16:09,622 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:16:13,624 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:16:13,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:16:14,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:16:16,136 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:16:16,244 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:16:16,356 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:16:16,415 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:16:16,416 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:21,118 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:16:29,654 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:17:29,656 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:17:38,104 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:18:11,108 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:18:22,846 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen' in nested popup
2025-11-12 11:18:27,342 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:18:27,344 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:32,153 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:18:36,340 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:18:37,356 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:18:37,357 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:18:37,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:37,449 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:18:41,621 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:18:41,624 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:18:41,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:41,690 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:18:42,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:42,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:42,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:43,252 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:18:43,253 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:18:47,457 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:18:47,460 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:18:49,023 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:18:49,025 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:18:49,027 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:18:49,032 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:18:49,036 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:18:49,040 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-12 11:18:49,044 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:18:49,046 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:18:49,049 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:18:49,050 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:18:49,052 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:18:49,055 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:18:49,057 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:18:49,058 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:53,787 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:18:53,789 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:18:53,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:58,432 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:18:58,445 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:18:58,447 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:18:58,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:03,026 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:19:18,974 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:19:19,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:19:20,547 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:19:20,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:29,796 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:19:33,919 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:19:38,514 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:19:43,186 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:19:47,713 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:19:52,081 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:19:52,084 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:19:52,085 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:19:52,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:19:53,052 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:19:53,054 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:19:55,298 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:20:03,540 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:20:03,921 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:20:04,264 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:20:06,534 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1292
2025-11-12 11:20:06,536 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:20:09,512 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-12 11:20:09,513 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:20:10,418 - ispa_next.main - DEBUG - 



2025-11-12 11:20:10,418 - ispa_next.main - DEBUG - starting with process 9 (CHA-M 3195) of 9
2025-11-12 11:20:10,422 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:20:11,745 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:20:13,105 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1292
2025-11-12 11:20:13,107 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-12 11:20:14,874 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:20:14,875 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:20:45,348 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:20:47,013 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:20:51,834 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:54,388 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:20:54,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:54,462 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:54,636 - ispa_next.functions - DEBUG - HU date already expired after 532 days.
2025-11-12 11:20:59,081 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:20:59,084 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:21:01,793 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:21:01,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:02,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:21:04,756 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:21:04,849 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:21:04,951 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:21:05,035 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:21:09,284 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:21:10,290 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:21:10,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:10,837 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:23,548 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:21:28,224 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:21:28,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:28,312 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:21:28,312 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:21:28,370 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:21:28,516 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:21:29,728 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:21:29,991 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:21:31,744 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:21:31,746 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:21:32,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:21:32,745 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:21:33,870 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:21:33,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:21:33,961 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:21:38,025 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:21:38,025 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:21:38,028 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:21:38,029 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:21:38,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:38,543 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:21:42,649 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:21:46,533 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:21:46,534 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:46,604 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:21:46,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:47,491 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:47,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:48,190 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:21:48,191 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:21:50,593 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:21:50,595 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:21:52,477 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:21:52,478 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:21:52,481 - ispa_next.package_manager.main - DEBUG - Cannot place Servicereinigung / Maschinelle Oberwäsche und Fußr: active service advisor guards
2025-11-12 11:21:52,483 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:21:52,485 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:21:52,487 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:21:52,490 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-12 11:21:52,492 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:21:52,494 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:21:52,507 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:21:52,511 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:21:52,513 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:21:52,516 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:21:52,518 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:21:52,519 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:55,141 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:21:57,186 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:21:57,188 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:21:57,190 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:59,780 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:21:59,781 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:21:59,783 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:21:59,787 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:02,402 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:22:17,285 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:22:17,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:18,766 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:22:18,951 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:25,286 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:28,982 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:33,783 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:33,785 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:22:33,786 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:34,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:34,680 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:22:34,681 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:22:36,923 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:22:46,460 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:22:46,826 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:22:47,246 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:49,355 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1292
2025-11-12 11:22:49,356 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:52,601 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-12 11:22:52,601 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
