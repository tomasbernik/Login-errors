2025-11-12 11:00:34,205 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:00:34,210 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:01:10,594 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:01:20,903 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:01:36,555 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:02:01,431 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:02:15,536 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:02:18,790 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:19,995 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:02:19,996 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-12 11:02:22,351 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 200
2025-11-12 11:02:22,352 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:02:22,353 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:02:23,671 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:02:25,029 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:02:56,681 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:02:56,766 - ispa_next.appointments.models - DEBUG - Appointment Hatidzhe Dhevdzhet Chaylyak GG-HI 889 WBAVJ11040LF60481 ohne Termin.
2025-11-12 11:02:56,792 - ispa_next.appointments.models - DEBUG - Appointment Ulas Korkmaz  WBAJM710X0B068176 ohne Termin.
2025-11-12 11:02:56,807 - ispa_next.appointments.models - DEBUG - Appointment Florian Goertz RPL 11-3 WBA2D310505C65769 ohne Termin.
2025-11-12 11:02:56,852 - ispa_next.main - DEBUG - Found 15 out of 96 appointments to process (configured limit: 15).
2025-11-12 11:02:56,853 - ispa_next.main - DEBUG - Processing 10 fresh appointments.
2025-11-12 11:02:56,853 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 11:02:56,853 - ispa_next.main - DEBUG - All appointments: MZ-B 3462, 0, MZJK217, MZ - AW 77E, KI-KI 0815, KI-KI 0815, KI-KI 0815, BN E 596, MZ-ME 141E, RÜD CS 677, WI-AZ 44, WI-DF 901, AZ-EL 7777, MZ-S 7911 E, MZ NE 4752
2025-11-12 11:02:56,858 - ispa_next.main - DEBUG - 



2025-11-12 11:02:56,858 - ispa_next.main - DEBUG - starting with process 1 (MZ-B 3462) of 15
2025-11-12 11:02:56,863 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:02:58,115 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:59,469 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:02:59,470 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 200
2025-11-12 11:03:01,007 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:03:01,008 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:03:36,813 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:03:47,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:47,287 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:47,492 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:03:48,771 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:03:48,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:48,850 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:49,103 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:03:49,107 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:03:51,977 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:03:51,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:03:52,973 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:03:54,978 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:03:55,075 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:03:58,306 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:03:58,376 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:03:58,377 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:03:59,597 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:04:07,817 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:04:08,822 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:04:08,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:09,285 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:20,722 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:04:28,441 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:04:28,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:28,510 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:04:28,511 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:04:28,587 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:04:29,825 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:04:30,088 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:04:32,916 - ispa_next.functions - DEBUG - Updated appointment (AK00021361) customer contact data.
2025-11-12 11:04:33,800 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:04:33,802 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:04:34,648 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:04:34,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:04:35,363 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:04:38,983 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:04:38,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:39,465 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:04:41,469 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:04:41,584 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:04:41,660 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:04:41,730 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:04:41,731 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:43,019 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:04:54,334 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:04:58,695 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:04:58,696 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:59,940 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:05:04,133 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:05:05,156 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:05:05,158 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:05:05,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:05:05,258 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:05:09,383 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:05:09,388 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:05:09,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:05:09,482 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:05:09,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:10,369 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:10,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:05:11,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:05:11,027 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:05:12,317 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:05:12,318 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:05:13,404 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:05:13,405 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:05:13,406 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:05:13,407 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-12 11:05:13,408 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:05:13,410 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:05:13,411 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:05:13,412 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:05:13,413 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:05:13,414 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:05:13,416 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:05:13,417 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:05:14,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:05:14,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:05:17,063 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:05:17,065 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:05:17,067 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:05:17,068 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:18,305 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:05:18,307 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:05:18,309 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:05:18,311 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:05:18,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:05:18,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:05:18,953 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:26,776 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:05:26,778 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:27,992 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:05:40,368 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:05:40,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:05:41,376 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:05:41,583 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:53,329 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:05:53,333 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:05:53,334 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:05:54,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:05:54,220 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:05:54,222 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:05:56,826 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:06:07,630 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:06:08,040 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:06:08,611 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:09,977 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:06:09,978 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:13,083 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 437
2025-11-12 11:06:13,083 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:06:14,000 - ispa_next.main - DEBUG - 



2025-11-12 11:06:14,000 - ispa_next.main - DEBUG - starting with process 2 (0) of 15
2025-11-12 11:06:14,004 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:06:15,180 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:16,490 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:06:16,491 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-12 11:06:18,158 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:18,160 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:06:49,827 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:06:49,923 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:06:49,927 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:50,512 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:06:50,512 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:53,346 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 437
2025-11-12 11:06:53,346 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:06:54,239 - ispa_next.main - DEBUG - 



2025-11-12 11:06:54,239 - ispa_next.main - DEBUG - starting with process 3 (MZJK217) of 15
2025-11-12 11:06:54,243 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:06:55,508 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:56,597 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:06:56,598 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-12 11:06:58,052 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:58,054 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:07:32,776 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:07:32,786 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:07:32,790 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:33,418 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:07:33,419 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:07:36,098 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 437
2025-11-12 11:07:36,098 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:07:36,795 - ispa_next.main - DEBUG - 



2025-11-12 11:07:36,795 - ispa_next.main - DEBUG - starting with process 4 (MZ - AW 77E) of 15
2025-11-12 11:07:36,800 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:07:37,805 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:38,806 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:07:38,807 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-12 11:07:40,448 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:07:40,449 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:11,334 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:08:11,345 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:08:11,349 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:12,029 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:08:12,030 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:14,717 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 437
2025-11-12 11:08:14,718 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:15,499 - ispa_next.main - DEBUG - 



2025-11-12 11:08:15,499 - ispa_next.main - DEBUG - starting with process 5 (KI-KI 0815) of 15
2025-11-12 11:08:15,503 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:08:16,848 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:18,086 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:08:18,087 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-12 11:08:19,737 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:19,742 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:42,614 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 179, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-12 11:08:42,625 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:08:42,630 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:43,164 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:08:43,165 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:45,906 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 437
2025-11-12 11:08:45,907 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:46,606 - ispa_next.main - DEBUG - 



2025-11-12 11:08:46,606 - ispa_next.main - DEBUG - starting with process 6 (KI-KI 0815) of 15
2025-11-12 11:08:46,613 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:08:47,661 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:48,896 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:08:48,897 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-12 11:08:50,261 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:50,263 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:11,109 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 179, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-12 11:09:11,118 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:09:11,124 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:11,632 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:09:11,633 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:14,308 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 437
2025-11-12 11:09:14,309 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:15,101 - ispa_next.main - DEBUG - 



2025-11-12 11:09:15,101 - ispa_next.main - DEBUG - starting with process 7 (KI-KI 0815) of 15
2025-11-12 11:09:15,128 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:09:16,256 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:17,282 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:09:17,283 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-12 11:09:18,691 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:18,692 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:40,272 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 179, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-12 11:09:40,281 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:09:40,284 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:40,860 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:09:40,861 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:43,281 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 437
2025-11-12 11:09:43,282 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:43,970 - ispa_next.main - DEBUG - 



2025-11-12 11:09:43,970 - ispa_next.main - DEBUG - starting with process 8 (BN E 596) of 15
2025-11-12 11:09:43,975 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:09:45,004 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:46,018 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:09:46,019 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-12 11:09:47,529 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:47,530 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:18,805 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:10:18,816 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:10:18,821 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:19,556 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:10:19,558 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:21,881 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 437
2025-11-12 11:10:21,882 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:22,858 - ispa_next.main - DEBUG - 



2025-11-12 11:10:22,858 - ispa_next.main - DEBUG - starting with process 9 (MZ-ME 141E) of 15
2025-11-12 11:10:22,864 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:10:24,183 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:25,613 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:10:25,614 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-12 11:10:26,990 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:26,991 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:58,299 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:10:58,309 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:10:58,313 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:58,877 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:10:58,878 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:01,015 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 437
2025-11-12 11:11:01,015 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:01,748 - ispa_next.main - DEBUG - 



2025-11-12 11:11:01,748 - ispa_next.main - DEBUG - starting with process 10 (RÜD CS 677) of 15
2025-11-12 11:11:01,753 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:02,709 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:03,671 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:11:03,673 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-12 11:11:05,090 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:05,091 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:37,589 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:11:37,599 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 11:11:37,604 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:38,184 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:11:38,185 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:40,685 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 437
2025-11-12 11:11:40,686 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:41,380 - ispa_next.main - DEBUG - 



2025-11-12 11:11:41,380 - ispa_next.main - DEBUG - starting with process 11 (WI-AZ 44) of 15
2025-11-12 11:11:41,383 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:42,281 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:43,242 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:11:43,244 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-12 11:11:44,626 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:44,627 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:07,815 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:12:09,443 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:12:14,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:17,406 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:12:17,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:17,476 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:17,700 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:12:17,702 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:12:20,591 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:12:20,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:21,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:23,610 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:12:23,763 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:12:23,844 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:12:23,935 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:12:28,066 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:12:29,072 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:12:29,072 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:29,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:41,234 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:12:45,417 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:12:45,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:45,492 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:45,503 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:12:45,580 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:12:46,834 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:12:47,083 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:12:50,400 - ispa_next.functions - DEBUG - Updated appointment (AG00036607) customer contact data.
2025-11-12 11:12:51,312 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:12:51,314 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:12:52,099 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:12:52,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:12:52,793 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:12:56,385 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:12:56,385 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:12:56,390 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:12:56,391 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:12:56,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:56,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:13:01,133 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:13:01,136 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:13:01,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:01,245 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:13:05,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:05,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:05,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:06,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:13:06,556 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:13:09,004 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:13:09,006 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:13:10,005 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:13:10,006 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:13:10,009 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:13:10,012 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:13:10,015 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:13:10,019 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:13:10,023 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:13:10,026 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:13:10,028 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:13:10,029 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:13:10,031 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:13:10,036 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:13:10,038 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:13:10,039 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:12,628 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:13:12,630 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:13:12,633 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:13:12,634 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:13:12,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:13:13,331 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:13:13,571 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:21,803 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:13:21,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:24,366 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:13:36,958 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:13:37,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:13:38,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:13:38,152 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:14:03,166 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:07,457 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:11,967 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:11,969 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:14:11,970 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:12,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:14:12,925 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:14:12,930 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:14:14,958 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:14:22,158 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:14:22,527 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 11:14:22,872 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:25,089 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1635
2025-11-12 11:14:25,091 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:27,561 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 439
2025-11-12 11:14:27,562 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:28,187 - ispa_next.main - DEBUG - Found new Appointment: MZ-AT607
2025-11-12 11:14:28,187 - ispa_next.main - DEBUG - Found new Appointment: MZ-RS 786
2025-11-12 11:14:28,189 - ispa_next.main - DEBUG - 



2025-11-12 11:14:28,189 - ispa_next.main - DEBUG - starting with process 12 (MZ-AT607) of 17
2025-11-12 11:14:28,192 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:29,236 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:30,524 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1635
2025-11-12 11:14:30,526 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 439
2025-11-12 11:14:32,179 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:32,180 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:06,394 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:15:06,402 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 11:15:06,405 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:06,930 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1635
2025-11-12 11:15:06,932 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:10,784 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 439
2025-11-12 11:15:10,785 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:11,636 - ispa_next.main - DEBUG - 



2025-11-12 11:15:11,636 - ispa_next.main - DEBUG - starting with process 13 (MZ-RS 786) of 17
2025-11-12 11:15:11,641 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:15:12,940 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:14,236 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1635
2025-11-12 11:15:14,238 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 439
2025-11-12 11:15:15,842 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:15,844 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:40,135 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:15:50,800 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:53,353 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:15:53,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:53,438 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:15:53,642 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:15:53,646 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:15:56,477 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:15:56,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:15:57,508 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:15:59,525 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:15:59,647 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:16:02,894 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:16:02,993 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:16:07,127 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:16:08,133 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:16:08,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:08,680 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:20,172 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:16:27,037 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:16:27,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:27,098 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:16:27,099 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:16:27,154 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:16:28,342 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:16:29,473 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:16:29,684 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:16:32,363 - ispa_next.functions - DEBUG - Updated appointment (AK00021367) customer contact data.
2025-11-12 11:16:33,371 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:16:33,373 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:16:33,981 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:16:33,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:16:34,730 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:16:38,776 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:16:38,777 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:16:38,777 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:16:38,779 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:16:38,780 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:16:38,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:16:39,269 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:16:43,440 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:16:43,444 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:16:43,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:16:43,514 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:16:47,764 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:48,304 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:48,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:16:48,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:16:48,979 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:16:51,408 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:16:51,410 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:16:52,380 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:16:52,383 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:16:52,389 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:16:52,391 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-12 11:16:52,393 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:16:52,395 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:16:52,396 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:16:52,397 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:16:52,400 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:16:52,401 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:16:52,402 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:16:52,404 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:16:53,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:16:53,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:17:07,495 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:17:07,498 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:17:07,500 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:17:07,500 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:10,801 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:17:10,803 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:17:10,804 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:17:10,806 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:17:10,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:17:11,258 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:17:11,490 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:25,592 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:17:25,594 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:28,897 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:17:39,780 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:17:40,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:17:40,867 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:17:41,123 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:13,166 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:17,980 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:22,420 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:26,578 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:26,581 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:18:26,581 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:27,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:27,210 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:18:27,212 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:18:28,932 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:18:37,867 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:18:38,244 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 11:18:39,064 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:40,467 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1634
2025-11-12 11:18:40,468 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:43,484 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 438
2025-11-12 11:18:43,484 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:44,440 - ispa_next.main - DEBUG - 



2025-11-12 11:18:44,440 - ispa_next.main - DEBUG - starting with process 14 (WI-DF 901) of 17
2025-11-12 11:18:44,444 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:45,636 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:46,581 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1634
2025-11-12 11:18:46,582 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 438
2025-11-12 11:18:47,962 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:47,963 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:22,546 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:19:24,649 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:19:29,818 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:34,411 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:19:34,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:34,472 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:34,860 - ispa_next.functions - DEBUG - HU date already expired after 19 days.
2025-11-12 11:19:39,222 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:19:39,225 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:19:42,056 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:42,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:43,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:19:45,014 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:19:45,136 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:19:45,218 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:19:45,295 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:19:49,468 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:19:50,473 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:19:50,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:50,985 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:02,713 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:20:02,713 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:20:07,095 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:20:07,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:07,217 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:07,218 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:20:07,263 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:20:07,395 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:20:08,636 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:20:08,859 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:20:11,930 - ispa_next.functions - DEBUG - Updated appointment (AR00013972) customer contact data.
2025-11-12 11:20:12,839 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:20:12,841 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:20:12,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:20:13,549 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:20:14,445 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:20:14,446 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:20:14,508 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:20:18,099 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:20:18,099 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:20:18,103 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:20:18,104 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:20:18,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:18,612 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:22,827 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:20:26,640 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:20:26,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:26,738 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:20:30,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:31,090 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:31,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:31,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:31,696 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:20:35,834 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:20:35,837 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:20:37,031 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:20:37,032 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:37,033 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:20:37,034 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:20:37,037 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:37,039 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:20:37,042 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:20:37,044 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:20:37,048 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:20:37,049 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:20:37,050 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:20:37,053 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:20:37,054 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:20:37,055 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:41,758 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:20:44,091 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:20:44,094 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:20:44,096 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:20:44,099 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:20:44,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:20:44,927 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:20:45,160 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:57,124 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:20:57,125 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:01,757 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:21:14,153 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:21:14,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:21:15,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:21:15,317 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:00,398 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:04,742 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:09,446 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:14,206 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:18,905 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:23,870 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:23,872 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:22:23,873 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:24,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:24,497 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:22:24,499 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:22:26,075 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:22:33,138 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:22:33,523 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 11:22:33,827 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:35,541 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1635
2025-11-12 11:22:35,541 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:38,314 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 439
2025-11-12 11:22:38,315 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:22:39,212 - ispa_next.appointments.models - DEBUG - Appointment Eleonora Reiter GG-EJ 474 WBAJC51050WE55575 ohne Termin.
2025-11-12 11:22:39,222 - ispa_next.main - DEBUG - 



2025-11-12 11:22:39,222 - ispa_next.main - DEBUG - starting with process 15 (AZ-EL 7777) of 17
2025-11-12 11:22:39,226 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:40,442 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:41,754 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1635
2025-11-12 11:22:41,755 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 439
2025-11-12 11:22:43,435 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:43,436 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:15,311 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:23:17,083 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:23:22,123 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:24,643 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:23:24,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:24,736 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:24,971 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:23:24,974 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:23:27,824 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:23:27,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:23:28,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:23:30,952 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:23:31,047 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:23:31,129 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:23:31,229 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:23:35,436 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:23:36,442 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:23:36,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:36,965 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:48,747 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:23:48,747 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:23:52,321 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:23:52,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:52,406 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:52,407 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:23:52,445 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:23:53,649 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:23:53,867 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:23:57,108 - ispa_next.functions - DEBUG - Updated appointment (BA00011080) customer contact data.
2025-11-12 11:23:58,076 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:23:58,077 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:23:59,034 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:23:59,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:23:59,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:24:03,536 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:24:03,536 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:24:03,540 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:24:03,541 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:24:03,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:04,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:08,216 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:24:11,924 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:24:11,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:12,013 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:24:21,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:21,591 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:21,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:22,258 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:22,258 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:24:24,740 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:24:24,742 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:24:26,897 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:24:26,898 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:24:26,900 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:24:26,902 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:24:26,903 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:24:26,904 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:24:26,905 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:24:26,906 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:24:26,908 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:24:26,915 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:24:26,919 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:24:26,928 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:24:26,930 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:24:26,931 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:29,562 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:24:29,565 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:24:29,567 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:24:29,569 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:24:29,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:24:30,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:24:30,668 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:40,551 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:24:40,555 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:43,157 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:24:55,635 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:24:56,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:24:56,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:24:56,830 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:21,986 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:25:26,685 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:25:31,294 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:25:31,296 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:25:31,297 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:25:31,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:25:31,912 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:25:31,915 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:25:33,713 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:25:40,991 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:25:41,366 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 11:25:41,939 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:25:43,361 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1636
2025-11-12 11:25:43,363 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:25:46,343 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 439
2025-11-12 11:25:46,344 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:25:47,284 - ispa_next.main - DEBUG - Found new Appointment: GG-EJ 474
2025-11-12 11:25:47,286 - ispa_next.main - DEBUG - 



2025-11-12 11:25:47,286 - ispa_next.main - DEBUG - starting with process 16 (GG-EJ 474) of 18
2025-11-12 11:25:47,290 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:25:48,687 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:25:49,984 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1636
2025-11-12 11:25:49,986 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 439
2025-11-12 11:25:51,516 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:25:51,521 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:26:16,031 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:26:27,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:27,576 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:26:27,747 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:28,987 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:26:28,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:29,057 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:26:29,291 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:26:29,293 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:26:32,231 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:26:32,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:33,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:26:35,469 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:26:35,570 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:26:38,829 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:26:38,906 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:26:38,907 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:40,188 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:26:48,745 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:26:49,750 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:26:49,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:50,273 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:02,223 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:27:09,766 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:27:09,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:09,840 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:27:09,841 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:27:09,871 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:27:11,054 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:27:11,266 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:27:16,720 - ispa_next.functions - DEBUG - Updated appointment (AK00021371) customer contact data.
2025-11-12 11:27:17,649 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:27:17,692 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:27:18,601 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:27:18,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:27:19,274 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:27:22,877 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:27:22,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:27:23,427 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:27:25,431 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:27:25,546 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:27:25,634 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:27:25,710 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:27:25,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:27,022 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:27:35,961 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:28:35,964 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:28:47,029 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:28:52,067 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:28:52,068 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:53,365 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:28:57,590 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:28:58,597 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:28:58,597 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:28:58,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:28:58,681 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:29:02,808 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:29:02,812 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:29:02,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:02,899 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:29:03,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:04,058 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:04,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:04,826 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:29:04,827 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:29:06,122 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:29:06,125 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:29:07,185 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:29:07,186 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:29:07,189 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:29:07,193 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-12 11:29:07,196 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:29:07,198 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:29:07,199 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:29:07,200 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:29:07,202 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:29:07,203 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:29:07,204 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:29:07,206 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:29:07,909 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:29:08,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:29:22,270 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:29:22,273 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:29:22,274 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:29:22,275 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:24,228 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:29:24,230 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:29:24,232 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:29:24,234 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:29:24,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:29:24,822 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:29:25,020 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:34,168 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:29:34,173 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:36,075 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:29:49,151 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:29:49,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:29:50,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:29:50,471 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:09,100 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:30:14,047 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:30:14,049 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:30:14,050 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:30:14,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:30:14,990 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:30:14,991 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:30:16,933 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:30:25,767 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:30:26,144 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 11:30:26,923 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:30:28,394 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1637
2025-11-12 11:30:28,395 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:30:31,355 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 439
2025-11-12 11:30:31,356 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:30:32,196 - ispa_next.main - DEBUG - 



2025-11-12 11:30:32,196 - ispa_next.main - DEBUG - starting with process 17 (MZ-S 7911 E) of 18
2025-11-12 11:30:32,200 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:30:33,473 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:30:34,783 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1637
2025-11-12 11:30:34,783 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 439
2025-11-12 11:30:36,457 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:30:36,459 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:07,637 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:31:09,695 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:31:14,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:16,241 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:31:16,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:16,320 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:31:16,580 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:31:16,583 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:31:19,414 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:31:19,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:20,381 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:31:22,384 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:31:22,489 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:31:22,587 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:31:22,676 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:31:26,869 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:31:27,875 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:31:27,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:28,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:40,131 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:31:44,257 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:31:44,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:44,358 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:31:44,360 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:31:44,484 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:31:45,646 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:31:46,872 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:31:47,096 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:31:50,422 - ispa_next.functions - DEBUG - Updated appointment (AZ00011291) customer contact data.
2025-11-12 11:31:51,341 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:31:51,344 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:31:51,998 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:31:51,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:31:52,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:31:56,406 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:31:56,406 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:31:56,409 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:31:56,410 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:31:56,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:56,886 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:32:00,995 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:32:01,000 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:32:01,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:32:01,066 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:32:01,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:01,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:01,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:32:02,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:32:02,628 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:32:04,474 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:32:04,485 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:32:05,763 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:32:05,765 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:32:05,766 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:32:05,767 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:32:05,768 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:32:05,770 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:32:05,771 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:32:05,772 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:32:05,774 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:32:05,775 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:32:05,779 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:32:05,781 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:32:05,782 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:07,638 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:32:07,641 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:32:07,643 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:32:07,646 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:32:07,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:32:08,449 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:32:08,672 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:17,777 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:32:17,778 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:19,652 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:32:30,488 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:32:30,956 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:32:31,449 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:32:31,604 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:49,818 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:32:54,497 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:32:54,499 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:32:54,500 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:32:55,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:32:55,342 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:32:55,344 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:32:57,250 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:33:06,053 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:33:06,455 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 11:33:06,869 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:33:08,412 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1638
2025-11-12 11:33:08,413 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:33:11,686 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 440
2025-11-12 11:33:11,687 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:33:12,569 - ispa_next.appointments.models - DEBUG - Appointment Martin Kaminski MZ-R 1083 WBAVJ31010LR17334 ohne Termin.
2025-11-12 11:33:12,578 - ispa_next.main - DEBUG - 



2025-11-12 11:33:12,578 - ispa_next.main - DEBUG - starting with process 18 (MZ NE 4752) of 18
2025-11-12 11:33:12,582 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:33:13,960 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:33:15,311 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1638
2025-11-12 11:33:15,312 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 440
2025-11-12 11:33:16,712 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:33:16,713 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:33:49,316 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:33:49,338 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 11:33:49,356 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:33:50,004 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1638
2025-11-12 11:33:50,005 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:33:52,914 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 440
2025-11-12 11:33:52,915 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:33:53,772 - ispa_next.appointments.models - DEBUG - Appointment Martin Kaminski MZ-R 1083 WBAVJ31010LR17334 ohne Termin.
