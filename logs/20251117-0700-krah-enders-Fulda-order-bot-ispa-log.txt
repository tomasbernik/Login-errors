2025-11-17 07:07:35,638 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 07:07:35,645 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 07:07:43,823 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 07:07:55,168 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 07:08:10,684 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:10:08,818 - ispa_next.app_start.main - DEBUG - Operation already took 106.80 seconds (more than 80 seconds)
2025-11-17 07:10:10,899 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\5a4267ed9dfadd93\\tess_jnw9tti2_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\5a4267ed9dfadd93\\tess_jnw9tti2', 'txt']
2025-11-17 07:10:11,135 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:10:11,142 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:10:11,142 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:12:09,804 - ispa_next.app_start.main - DEBUG - Operation already took 106.35 seconds (more than 80 seconds)
2025-11-17 07:12:11,865 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\5a4267ed9dfadd93\\tess_zxda3qvy_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\5a4267ed9dfadd93\\tess_zxda3qvy', 'txt']
2025-11-17 07:12:12,091 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:12:12,094 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:12:18,328 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 07:12:27,436 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 07:12:37,683 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 07:12:53,020 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:14:49,987 - ispa_next.app_start.main - DEBUG - Operation already took 105.93 seconds (more than 80 seconds)
2025-11-17 07:14:52,055 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\5a4267ed9dfadd93\\tess_ou02kuks_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\5a4267ed9dfadd93\\tess_ou02kuks', 'txt']
2025-11-17 07:14:52,297 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:14:52,301 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:14:52,302 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:16:51,379 - ispa_next.app_start.main - DEBUG - Operation already took 106.72 seconds (more than 80 seconds)
2025-11-17 07:16:53,457 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\5a4267ed9dfadd93\\tess_5qwxqldu_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\5a4267ed9dfadd93\\tess_5qwxqldu', 'txt']
2025-11-17 07:16:53,695 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:16:53,701 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:16:59,885 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 07:17:07,518 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 07:17:18,383 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 07:17:33,903 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:17:59,355 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 07:18:13,993 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 07:18:16,509 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:18:17,336 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 882
2025-11-17 07:18:17,338 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 269
2025-11-17 07:18:19,295 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 71
2025-11-17 07:18:19,296 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 07:18:19,296 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 07:18:20,169 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 07:18:20,973 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:18:31,457 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:18:31,477 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:18:31,491 - ispa_next.appointments.models - DEBUG - Appointment Daniel Tin FD-T 115 WBAJP310X0BT73435 ohne Termin.
2025-11-17 07:18:31,492 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:18:31,501 - ispa_next.appointments.models - DEBUG - Appointment Edgar Blum VB-EB 903 WBA5V51090AE18702 ohne Termin.
2025-11-17 07:18:31,501 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:18:31,510 - ispa_next.appointments.models - DEBUG - Appointment Sarah Rockel VB-SR 4592 WBAJF31060WW33714 ohne Termin.
2025-11-17 07:18:31,518 - ispa_next.appointments.models - DEBUG - Appointment Edwin Schneider VB-CF 8691 WBATX31040LC42233 ohne Termin.
2025-11-17 07:18:31,525 - ispa_next.appointments.models - DEBUG - Appointment Rudolf Panzner FD-BR 42 WBAUJ710209C56237 ohne Termin.
2025-11-17 07:18:31,532 - ispa_next.appointments.models - DEBUG - Appointment Mahmut Odabasi FD-IL 1983 WBAJP31070BT73358 ohne Termin.
2025-11-17 07:18:31,539 - ispa_next.appointments.models - DEBUG - Appointment Elisabeth Jonas FD-M 100 WBAJF31050WW40413 ohne Termin.
2025-11-17 07:18:31,540 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:18:31,548 - ispa_next.appointments.models - DEBUG - Appointment Andreas Dumler FD-ED 2206 WBA6L51070FJ14696 ohne Termin.
2025-11-17 07:18:31,548 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:18:31,549 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:18:31,549 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:18:31,549 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:18:31,550 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:18:31,550 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:18:31,559 - ispa_next.main - DEBUG - Found 1 out of 12 appointments to process (configured limit: 15).
2025-11-17 07:18:31,559 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-17 07:18:31,559 - ispa_next.main - DEBUG - All appointments: FD:S 1110E
2025-11-17 07:18:31,562 - ispa_next.main - DEBUG - 



2025-11-17 07:18:31,562 - ispa_next.main - DEBUG - starting with process 1 (FD:S 1110E) of 1
2025-11-17 07:18:31,565 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:18:32,827 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:18:33,912 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 882
2025-11-17 07:18:33,913 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 71
2025-11-17 07:18:35,304 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:18:35,306 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:19:09,732 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:19:09,824 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 07:19:09,827 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:19:10,394 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 882
2025-11-17 07:19:10,396 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:19:13,067 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 269
2025-11-17 07:19:13,068 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:19:13,986 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:19:13,994 - ispa_next.appointments.models - DEBUG - Appointment Bürner Michael HD-MB 2176 WBAUD710X0P407017 ohne Termin.
2025-11-17 07:19:13,996 - ispa_next.main - DEBUG - Found new Appointment: FD-EX 20 E
2025-11-17 07:19:13,998 - ispa_next.main - DEBUG - 



2025-11-17 07:19:13,998 - ispa_next.main - DEBUG - starting with process 2 (FD-EX 20 E) of 2
2025-11-17 07:19:14,011 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:19:15,196 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:19:16,678 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 882
2025-11-17 07:19:16,679 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 269
2025-11-17 07:19:18,028 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:19:18,030 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:19:40,750 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:19:42,763 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-17 07:19:47,935 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:19:50,499 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:19:50,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:19:50,562 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:19:50,759 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:19:50,776 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:19:53,596 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:19:53,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:19:54,448 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:19:56,453 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:19:56,602 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:19:56,709 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:19:56,784 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:20:00,997 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 07:20:02,003 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:20:02,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:20:02,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:20:13,433 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 07:20:17,346 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:20:17,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:20:17,440 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:20:17,442 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 07:20:17,494 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 07:20:18,680 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 07:20:19,875 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 07:20:20,203 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 07:20:21,949 - ispa_next.functions - DEBUG - Updated appointment (AC00069333) customer contact data.
2025-11-17 07:20:22,867 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:20:22,868 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 07:20:23,619 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:20:23,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:20:24,350 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:20:27,973 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:20:27,973 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 07:20:27,975 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:20:27,977 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:20:27,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:20:28,453 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:20:32,591 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 07:20:32,595 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:20:32,596 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:20:32,657 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:20:41,668 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 07:20:45,205 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 07:20:45,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:20:45,645 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:20:45,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:20:46,242 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:20:46,242 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:20:48,606 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:20:48,608 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:20:50,583 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:20:50,583 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:20:50,585 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:20:50,587 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:20:50,588 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 07:20:50,589 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:20:50,590 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:20:50,592 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:20:50,592 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:20:50,596 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:20:50,598 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:20:50,598 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:20:53,158 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:20:53,159 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:20:53,178 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:20:55,661 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:20:55,663 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:20:55,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 07:20:56,262 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 07:20:56,500 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:21:11,058 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:21:11,060 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:21:11,062 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:21:11,062 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:21:11,064 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:21:11,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:21:12,297 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:21:12,297 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:21:14,330 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:21:23,027 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:21:23,397 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 07:21:23,907 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:21:24,770 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 882
2025-11-17 07:21:24,772 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:21:27,035 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 269
2025-11-17 07:21:27,035 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:21:27,700 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:21:27,711 - ispa_next.appointments.models - DEBUG - Appointment Bürner Michael HD-MB 2176 WBAUD710X0P407017 ohne Termin.
