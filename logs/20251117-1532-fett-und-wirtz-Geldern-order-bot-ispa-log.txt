2025-11-17 15:32:38,813 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 15:32:38,819 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 15:32:48,535 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 15:33:01,427 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 15:33:17,022 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:33:41,140 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 15:33:52,023 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 15:33:54,467 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:33:55,647 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 337
2025-11-17 15:33:55,648 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 227
2025-11-17 15:33:57,936 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 225
2025-11-17 15:33:57,937 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 15:33:57,937 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:33:58,986 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:33:59,898 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:34:25,007 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA2C11090V904353 ohne Termin.
2025-11-17 15:34:25,032 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:34:25,058 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Franz Tönnessen KLE-JT 304 WBA3A11000J283456 ohne Termin.
2025-11-17 15:34:25,067 - ispa_next.appointments.models - DEBUG - Appointment Daria Kamila Kolodziej KLE-QR 734 WBA8L71060K555733 ohne Termin.
2025-11-17 15:34:25,088 - ispa_next.appointments.models - DEBUG - Appointment Oliver Christian Wiegand MH-WI 1001 WMWZM31040T035812 ohne Termin.
2025-11-17 15:34:25,097 - ispa_next.appointments.models - DEBUG - Appointment Rabiullah Arash GEL-NK 786 WBAWZ510800M35552 ohne Termin.
2025-11-17 15:34:25,103 - ispa_next.main - DEBUG - Found 7 out of 19 appointments to process (configured limit: 15).
2025-11-17 15:34:25,103 - ispa_next.main - DEBUG - Processing 7 fresh appointments.
2025-11-17 15:34:25,103 - ispa_next.main - DEBUG - All appointments: GEL-T 6370, MO-VE 157, KLE-MY 369, KLE-W 1982, KLE-PR 281, M-D-3722, KK-B 602
2025-11-17 15:34:25,105 - ispa_next.main - DEBUG - 



2025-11-17 15:34:25,105 - ispa_next.main - DEBUG - starting with process 1 (GEL-T 6370) of 7
2025-11-17 15:34:25,108 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:34:25,896 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:34:26,822 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 337
2025-11-17 15:34:26,823 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 225
2025-11-17 15:34:28,140 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:34:28,142 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:35:03,256 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:35:12,646 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:35:14,535 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:35:14,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:14,619 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:35:14,810 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:35:14,812 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:35:14,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:14,908 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:35:18,089 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:35:18,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:35:19,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:35:21,071 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:35:21,205 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:35:24,420 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:35:24,483 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:35:28,687 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:35:29,707 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:35:29,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:30,190 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:41,983 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:35:41,983 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:35:49,151 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:35:49,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:49,235 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:35:49,235 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:35:49,313 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:35:50,555 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:35:50,789 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:35:53,917 - ispa_next.functions - DEBUG - Updated appointment (AV00009516) customer contact data.
2025-11-17 15:35:54,835 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:35:54,836 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:35:55,640 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:35:55,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:35:56,370 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:36:00,809 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:36:00,809 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:36:00,812 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:36:00,815 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:36:00,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:36:01,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:36:10,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:36:10,930 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:36:10,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:36:11,717 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:36:11,720 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:36:13,552 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:36:13,553 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:36:14,968 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:36:14,970 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:36:14,975 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 15:36:14,979 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:36:14,984 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:36:14,985 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:36:14,987 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:36:14,990 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:36:14,991 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:36:14,995 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:36:14,997 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:36:15,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:36:16,405 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:36:22,998 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:36:23,000 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:36:23,001 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:36:23,001 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:25,570 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:36:25,572 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:36:25,575 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:28,117 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:36:28,119 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:36:28,120 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:36:28,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:30,623 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:36:43,530 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:36:44,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:36:44,815 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:36:44,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:51,233 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:36:57,115 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:36:57,116 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:36:57,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:36:57,840 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:36:57,841 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:37:01,181 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:37:11,129 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:37:11,519 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 15:37:12,223 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:37:12,838 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 337
2025-11-17 15:37:12,839 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:37:15,865 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 227
2025-11-17 15:37:15,865 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:37:16,840 - ispa_next.appointments.models - DEBUG - Appointment Gabriele Raffs GEL-G 485E WBY71EG0805483494 ohne Termin.
2025-11-17 15:37:16,845 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA2C11090V904353 ohne Termin.
2025-11-17 15:37:16,851 - ispa_next.main - DEBUG - 



2025-11-17 15:37:16,851 - ispa_next.main - DEBUG - starting with process 2 (MO-VE 157) of 7
2025-11-17 15:37:16,853 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:37:17,966 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:37:19,076 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 337
2025-11-17 15:37:19,078 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 227
2025-11-17 15:37:20,478 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:37:20,479 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:37:45,659 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:37:54,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:37:54,967 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:37:55,126 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:37:56,360 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:37:56,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:37:56,434 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:37:56,674 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:37:56,676 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:37:56,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:37:56,769 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:37:59,904 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:37:59,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:38:00,795 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:38:02,799 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:38:02,920 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:38:06,140 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:38:06,205 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:38:06,206 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:38:17,274 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:38:18,278 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:38:18,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:38:18,806 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:38:31,817 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:38:38,980 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:38:38,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:38:39,056 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:38:39,057 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:38:39,086 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:38:39,216 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:38:40,310 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:38:40,517 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:38:43,454 - ispa_next.functions - DEBUG - Updated appointment (AM00012166) customer contact data.
2025-11-17 15:38:44,336 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:38:44,337 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:38:44,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:38:45,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:38:46,430 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:38:46,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:38:46,554 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:38:50,158 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:38:50,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:38:50,671 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:38:52,674 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:38:52,809 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:38:52,897 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:38:52,974 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:38:52,975 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:39:04,383 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:39:11,384 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:39:11,384 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:39:15,560 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:39:16,566 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:39:16,570 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:39:16,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:39:16,634 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:39:22,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:39:22,712 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:39:22,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:39:23,334 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:39:23,337 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:39:25,212 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:39:25,214 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:39:26,218 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:39:26,221 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:39:26,226 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 15:39:26,229 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:39:26,232 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:39:26,234 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:39:26,235 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:39:26,241 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:39:26,242 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:39:26,246 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:39:26,248 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:39:26,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:39:27,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:39:34,457 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:39:34,459 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:39:34,460 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:39:34,460 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:39:37,025 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:39:37,027 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:39:37,028 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:39:39,571 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:39:39,572 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:39:39,573 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:39:39,575 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:39:42,053 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:39:54,005 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:39:54,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:39:55,083 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:39:55,214 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:40:01,945 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:40:08,097 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:40:08,098 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:40:08,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:40:08,803 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:40:08,805 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:40:11,835 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:40:18,609 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:40:19,018 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 15:40:19,560 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:40:20,074 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 337
2025-11-17 15:40:20,075 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:40:22,920 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 15:40:22,921 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:40:23,817 - ispa_next.appointments.models - DEBUG - Appointment Gabriele Raffs GEL-G 485E WBY71EG0805483494 ohne Termin.
2025-11-17 15:40:23,823 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA2C11090V904353 ohne Termin.
2025-11-17 15:40:23,828 - ispa_next.main - DEBUG - 



2025-11-17 15:40:23,828 - ispa_next.main - DEBUG - starting with process 3 (KLE-MY 369) of 7
2025-11-17 15:40:23,831 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:40:24,912 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:40:26,152 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 337
2025-11-17 15:40:26,153 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 15:40:27,749 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:40:27,749 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:41:01,891 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:41:11,469 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:41:17,419 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:41:17,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:41:17,515 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:41:17,679 - ispa_next.functions - DEBUG - HU date already expired after 25 days.
2025-11-17 15:41:24,658 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:41:24,660 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:41:24,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:41:24,749 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:41:27,713 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:41:27,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:41:28,621 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:41:30,627 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:41:30,795 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:41:30,867 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:41:30,966 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:41:33,091 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:41:34,096 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:41:34,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:41:34,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:41:46,765 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:41:54,195 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:41:54,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:41:54,261 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:41:54,262 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:41:54,300 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:41:55,528 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:41:55,755 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:41:58,532 - ispa_next.functions - DEBUG - Updated appointment (AM00012154) customer contact data.
2025-11-17 15:41:59,436 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:41:59,437 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:42:00,249 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:42:00,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:42:00,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:42:04,498 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:42:04,498 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:42:04,501 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:42:04,503 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:42:04,504 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:42:04,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:42:05,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:42:05,865 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:42:05,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:42:06,533 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:42:06,537 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:42:11,969 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:42:11,975 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:42:13,047 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:42:13,048 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:42:13,051 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 15:42:13,052 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:42:13,056 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:42:13,056 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:42:13,057 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:42:13,061 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:42:13,063 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:42:13,068 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:42:13,072 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:42:13,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:42:14,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:42:21,362 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:42:21,364 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:42:21,365 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:42:21,366 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:42:28,010 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:42:28,011 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:42:28,013 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:42:34,637 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:42:34,638 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:42:34,640 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:42:34,641 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:42:41,365 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:42:55,020 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:42:55,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:42:56,230 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:42:56,434 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:43:07,139 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:43:13,059 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:43:13,059 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:43:13,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:43:13,793 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:43:13,794 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:43:17,641 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:43:24,518 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:43:24,892 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 15:43:25,521 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:43:25,993 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 336
2025-11-17 15:43:25,994 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:43:28,745 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 225
2025-11-17 15:43:28,746 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:43:29,614 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA2C11090V904353 ohne Termin.
2025-11-17 15:43:29,620 - ispa_next.main - DEBUG - 



2025-11-17 15:43:29,620 - ispa_next.main - DEBUG - starting with process 4 (KLE-W 1982) of 7
2025-11-17 15:43:29,624 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:43:30,749 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:43:31,813 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 336
2025-11-17 15:43:31,814 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 225
2025-11-17 15:43:33,276 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:43:33,278 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:43:59,446 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:44:08,068 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:08,153 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:44:08,309 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:44:10,210 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:44:10,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:10,291 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:44:10,662 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:44:10,664 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:44:10,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:10,778 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:44:13,790 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:44:13,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:44:14,673 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:44:16,675 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:44:16,804 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:44:19,991 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 15:44:27,563 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 15:44:28,567 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:44:28,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:29,040 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:40,831 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:44:48,220 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:44:48,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:48,309 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:44:48,309 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:44:48,357 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:44:49,518 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:44:49,724 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:44:52,895 - ispa_next.functions - DEBUG - Updated appointment (AM00012148) customer contact data.
2025-11-17 15:44:53,840 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:44:53,842 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:44:54,598 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:44:54,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:44:55,457 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:45:00,016 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:45:00,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:45:00,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:45:02,577 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:45:02,679 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:45:02,772 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:45:02,836 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:45:02,837 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:45:13,984 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:46:13,986 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:46:24,955 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:46:31,949 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:46:31,950 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:46:36,119 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:46:37,125 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:46:37,128 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:46:37,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:46:37,205 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:46:42,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:46:43,264 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:46:43,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:46:43,934 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:46:43,936 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:46:46,342 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:46:46,344 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:46:47,567 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:46:47,568 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:46:47,571 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 15:46:47,572 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:46:47,576 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 15:46:47,577 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:46:47,580 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:46:47,582 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:46:47,585 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:46:47,586 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:46:48,258 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:46:48,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:46:55,640 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:46:55,641 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 15:46:57,606 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:46:58,138 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:46:59,054 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:46:59,606 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:47:00,132 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:47:01,076 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:47:01,646 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:47:02,172 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:47:03,618 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:47:04,174 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:47:04,723 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:47:05,654 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:47:06,816 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:47:07,716 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:47:08,270 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:47:09,204 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:47:09,648 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:47:09,653 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:47:09,657 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:47:12,680 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:47:12,682 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:47:12,684 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:47:15,332 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:47:15,334 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:47:15,335 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:47:15,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:47:17,881 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:47:31,003 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:47:31,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:47:32,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:47:32,346 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:47:38,667 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:47:44,048 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:47:44,049 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:47:44,485 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:47:44,567 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:47:44,568 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:47:47,601 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:47:54,727 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:47:55,108 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 15:47:55,722 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:47:56,331 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 336
2025-11-17 15:47:56,333 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:47:58,913 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 15:47:58,913 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:47:59,675 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA2C11090V904353 ohne Termin.
2025-11-17 15:47:59,683 - ispa_next.main - DEBUG - Found new Appointment: GEL-G 485E
2025-11-17 15:47:59,685 - ispa_next.main - DEBUG - 



2025-11-17 15:47:59,685 - ispa_next.main - DEBUG - starting with process 5 (GEL-G 485E) of 8
2025-11-17 15:47:59,688 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:48:00,811 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:48:02,228 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 336
2025-11-17 15:48:02,230 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 15:48:03,601 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:48:03,602 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:48:40,273 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:48:50,085 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:48:51,340 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:48:51,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:48:51,425 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:48:51,644 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:48:51,646 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:48:51,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:48:51,753 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:48:54,816 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:48:54,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:48:55,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:48:57,793 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:48:57,899 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:48:58,015 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:48:58,082 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:48:58,083 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:49:09,446 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:49:16,536 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:49:16,536 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:49:20,721 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:49:21,727 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:49:21,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:49:22,207 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:49:35,755 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:49:42,916 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:49:42,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:49:43,006 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:49:43,007 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:49:43,037 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:49:44,235 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:49:45,429 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:49:45,649 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:49:48,056 - ispa_next.functions - DEBUG - Updated appointment (CJ00001129) customer contact data.
2025-11-17 15:49:48,952 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:49:48,954 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:49:49,545 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:49:49,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:49:50,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:49:53,777 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:49:53,777 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:49:53,779 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:49:53,782 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:49:53,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:49:54,262 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:49:59,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:50:00,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:50:00,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:50:01,059 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:50:01,062 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:50:02,414 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:50:02,416 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:50:03,317 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:50:03,319 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:50:03,323 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 15:50:03,324 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:50:03,327 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:50:03,329 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:50:03,329 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:50:03,334 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:50:03,335 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:50:03,338 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:50:03,347 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:50:04,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:50:05,041 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:50:11,919 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:50:11,921 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:50:11,922 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:50:11,923 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:50:13,835 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:50:13,836 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:50:13,850 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:50:15,730 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:50:15,732 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:50:15,733 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:50:15,735 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:50:17,599 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:50:30,053 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:50:30,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:50:31,407 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:50:31,617 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:50:37,551 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:50:42,816 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:50:42,816 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:50:43,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:50:43,362 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:50:43,363 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:50:47,322 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:50:54,999 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:50:55,419 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 15:50:56,130 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:50:56,669 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 336
2025-11-17 15:50:56,670 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:50:59,526 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 15:50:59,526 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:51:00,433 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA2C11090V904353 ohne Termin.
2025-11-17 15:51:00,439 - ispa_next.main - DEBUG - 



2025-11-17 15:51:00,439 - ispa_next.main - DEBUG - starting with process 6 (KLE-PR 281) of 8
2025-11-17 15:51:00,442 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:51:01,487 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:51:02,844 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 336
2025-11-17 15:51:02,846 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 15:51:04,365 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:51:04,367 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:51:33,890 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:51:44,003 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:51:47,328 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:51:47,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:51:47,400 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:51:47,595 - ispa_next.functions - DEBUG - HU date already expired after 4 days.
2025-11-17 15:51:53,706 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:51:53,707 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:51:53,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:51:53,782 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:52:04,018 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:52:04,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:52:04,909 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:52:06,912 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:52:12,454 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 15:52:19,779 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 15:52:20,783 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:52:20,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:52:21,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:52:33,385 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:52:41,164 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:52:41,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:52:41,251 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:52:41,252 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:52:41,318 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:52:41,436 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:52:42,623 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:52:42,849 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:52:45,778 - ispa_next.functions - DEBUG - Updated appointment (AM00012120) customer contact data.
2025-11-17 15:52:46,671 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:52:46,674 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:52:46,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:52:47,851 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:52:49,238 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:52:49,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:52:49,334 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:52:53,348 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 15:52:53,349 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:52:53,349 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:52:53,351 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:52:53,354 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:52:53,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:52:53,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:52:54,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:52:54,754 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:52:54,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:52:55,388 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:52:55,391 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:52:59,010 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:52:59,011 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:52:59,800 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:52:59,801 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:52:59,805 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug maschinell waschen/aussaugen (kostenlos): active placement guards
2025-11-17 15:52:59,807 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=AU / § Hauptuntersuchung / Paketpreis, source=from_tab, target=cart)}
2025-11-17 15:52:59,808 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:52:59,813 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:52:59,817 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:52:59,818 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:52:59,821 - ispa_next.package_manager.main - DEBUG - found packages to delete: {Package(name=§ Fahrzeuguntersuchung, source=cart, target=trash)}
2025-11-17 15:52:59,822 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:52:59,826 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:52:59,827 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:53:00,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:53:01,132 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:53:10,512 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:53:10,513 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 15:53:12,576 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:53:13,120 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:53:14,050 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:53:14,615 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:53:15,140 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:53:16,062 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:53:16,620 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:53:17,143 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:53:19,032 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:53:19,587 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:53:20,121 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:53:21,062 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:53:21,620 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:53:22,150 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:53:23,108 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:53:23,683 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:53:24,216 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:53:25,147 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:53:26,033 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:53:26,044 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:53:26,048 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:53:30,035 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:53:30,036 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:53:30,038 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:53:33,993 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:53:33,993 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:53:33,994 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:53:33,997 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:53:37,971 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:53:51,490 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:53:52,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:53:52,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:53:53,044 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:54:00,571 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:54:05,915 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:54:05,918 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:54:06,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:54:06,671 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:54:06,673 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:54:10,131 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:54:18,632 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:54:19,011 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 15:54:19,836 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:54:20,515 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 336
2025-11-17 15:54:20,516 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:54:23,423 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 15:54:23,424 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:54:24,301 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA2C11090V904353 ohne Termin.
2025-11-17 15:54:24,308 - ispa_next.main - DEBUG - 



2025-11-17 15:54:24,308 - ispa_next.main - DEBUG - starting with process 7 (M-D-3722) of 8
2025-11-17 15:54:24,312 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:54:25,451 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:54:26,579 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 336
2025-11-17 15:54:26,580 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 15:54:28,435 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:54:28,436 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:54:57,796 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:55:07,982 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:55:12,616 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:55:12,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:55:12,738 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:55:12,970 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:55:12,973 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:55:12,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:55:13,114 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:55:16,131 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:55:16,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:55:17,566 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:55:19,573 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:55:19,672 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:55:19,798 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:55:19,889 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:55:19,889 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:55:31,065 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:55:32,071 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:55:32,072 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:55:32,557 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:55:46,657 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:55:54,801 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:55:54,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:55:54,917 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:55:54,918 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:55:54,950 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:55:56,136 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:55:57,184 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:55:57,393 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:55:59,592 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:55:59,593 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:56:00,363 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:56:00,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:56:01,141 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:56:04,710 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:56:04,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:56:05,195 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:56:07,226 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:56:07,406 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:56:07,514 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:56:07,606 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:56:07,606 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:56:18,769 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 15:56:25,833 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:56:25,834 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:56:27,959 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:56:28,964 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:56:28,966 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:56:28,967 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:56:29,036 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:56:34,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:56:35,069 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:56:35,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:56:35,790 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:56:35,794 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:56:39,993 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:56:39,999 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:56:41,038 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:56:41,039 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:56:41,043 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 15:56:41,044 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:56:41,047 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:56:41,048 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:56:41,049 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:56:41,052 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:56:41,056 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:56:41,064 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:56:41,067 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:56:41,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:56:42,581 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:56:49,768 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:56:49,802 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:56:49,803 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:56:49,804 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:56:55,156 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:56:55,157 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:56:55,160 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:57:00,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:57:00,912 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:57:10,424 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:57:25,344 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:57:25,346 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:57:25,347 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:57:25,349 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:57:30,671 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 15:57:39,663 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:57:53,507 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:57:54,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:57:54,897 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:57:55,078 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:58:04,757 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:58:10,843 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:58:10,844 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:58:11,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:58:11,581 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:58:11,582 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:58:15,409 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:58:20,806 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:58:24,261 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 15:58:24,264 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:58:24,697 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 336
2025-11-17 15:58:24,698 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:58:27,856 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 15:58:27,857 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:58:28,648 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA2C11090V904353 ohne Termin.
2025-11-17 15:58:28,653 - ispa_next.main - DEBUG - 



2025-11-17 15:58:28,654 - ispa_next.main - DEBUG - starting with process 8 (KK-B 602) of 8
2025-11-17 15:58:28,657 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:58:29,776 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:58:30,958 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 336
2025-11-17 15:58:30,959 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 15:58:32,952 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:58:32,954 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:59:03,986 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:59:13,864 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:59:22,809 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:59:22,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:59:22,910 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:59:23,155 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:59:23,157 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:59:23,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:59:23,244 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:59:26,395 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:59:26,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:59:27,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:59:29,487 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:59:29,625 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:59:29,707 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:59:29,820 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:59:29,820 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:59:41,373 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:59:42,376 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:59:42,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:59:42,870 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:59:55,670 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 16:00:04,130 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 16:00:04,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 16:00:04,202 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 16:00:04,203 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 16:00:04,234 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 16:00:05,484 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 16:00:08,042 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 16:00:08,441 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 16:00:13,076 - ispa_next.functions - DEBUG - Updated appointment (AA00073898) customer contact data.
2025-11-17 16:00:14,010 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 16:00:14,012 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 16:00:15,036 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 16:00:15,038 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 16:00:16,193 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 16:00:19,771 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 16:00:19,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 16:00:20,252 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 16:00:22,255 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 16:00:22,424 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 16:00:22,534 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 16:00:22,593 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 16:00:22,593 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 16:00:33,535 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 16:00:40,615 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 16:00:40,615 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 16:00:44,832 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 16:00:45,850 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 16:00:45,852 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 16:00:45,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 16:00:45,975 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 16:00:51,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 16:00:52,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 16:00:52,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 16:00:52,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 16:00:52,887 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 16:01:00,611 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 16:01:00,613 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 16:01:01,579 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 16:01:01,580 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 16:01:01,586 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 16:01:01,589 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 16:01:01,596 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 16:01:01,598 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 16:01:01,599 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 16:01:01,603 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 16:01:01,604 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 16:01:01,609 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 16:01:01,611 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 16:01:02,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 16:01:03,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 16:01:10,914 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 16:01:10,915 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 16:01:10,917 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 16:01:10,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 16:01:20,413 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 16:01:20,414 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 16:01:20,416 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 16:01:29,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 16:01:30,339 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 16:01:42,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 16:02:02,002 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 16:02:02,003 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 16:02:02,004 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 16:02:02,006 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 16:02:11,540 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 16:02:20,542 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 16:02:33,935 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 16:02:34,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 16:02:35,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 16:02:35,558 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 16:02:49,365 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 16:02:54,875 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 16:02:54,876 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 16:02:55,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 16:02:55,526 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 16:02:55,527 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 16:02:59,042 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 16:03:02,429 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 16:03:06,436 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 16:03:06,439 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 16:03:06,973 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 336
2025-11-17 16:03:06,974 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 16:03:09,792 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 16:03:09,793 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 16:03:10,515 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA2C11090V904353 ohne Termin.
