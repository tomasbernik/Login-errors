2025-11-12 14:00:36,347 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 14:00:36,371 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 14:00:49,242 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 14:01:01,174 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 14:01:16,737 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 14:03:14,549 - ispa_next.app_start.main - DEBUG - Operation already took 106.51 seconds (more than 80 seconds)
2025-11-12 14:03:16,634 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\43f0037be26d24de\\tess_r18c804j_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\43f0037be26d24de\\tess_r18c804j', 'txt']
2025-11-12 14:03:16,934 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 14:03:16,939 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 14:03:16,940 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 14:04:31,321 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 14:04:43,386 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 14:04:45,930 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:04:47,198 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 625
2025-11-12 14:04:47,199 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 14:04:49,746 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 148
2025-11-12 14:04:49,747 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 14:04:49,747 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 14:04:50,927 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 14:04:52,027 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:05:15,737 - ispa_next.appointments.models - DEBUG - Appointment Mariya Aleksandrovna OS-UA 81 WBA4C11010G273031 ohne Termin.
2025-11-12 14:05:15,755 - ispa_next.appointments.models - DEBUG - Appointment Öezlem Cicek HF-OZ 84 WBA31AX010FP86133 ohne Termin.
2025-11-12 14:05:15,764 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-12 14:05:15,774 - ispa_next.appointments.models - DEBUG - Appointment Karlheinz Böttger HF-EK 2016 WBA2X71000V366813 ohne Termin.
2025-11-12 14:05:15,785 - ispa_next.main - DEBUG - Found 8 out of 37 appointments to process (configured limit: 15).
2025-11-12 14:05:15,785 - ispa_next.main - DEBUG - Processing 8 fresh appointments.
2025-11-12 14:05:15,785 - ispa_next.main - DEBUG - All appointments: HF-X 1020, BÜNDE, HF-LB-222, HF L 1612, OS-CW177, HF-BT 540, MI-JC 96 E, BÜNDE
2025-11-12 14:05:15,788 - ispa_next.main - DEBUG - 



2025-11-12 14:05:15,788 - ispa_next.main - DEBUG - starting with process 1 (HF-X 1020) of 8
2025-11-12 14:05:15,791 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:05:16,633 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:05:17,692 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 625
2025-11-12 14:05:17,694 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 148
2025-11-12 14:05:19,035 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:05:19,037 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:05:54,201 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 14:06:03,499 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:06:11,521 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 14:06:11,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:06:11,606 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:06:11,790 - ispa_next.functions - DEBUG - HU date already expired after 78 days.
2025-11-12 14:06:19,130 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 14:06:19,133 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 14:06:19,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:06:19,212 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:06:29,119 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:06:29,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:06:30,208 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:06:32,211 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:06:32,307 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:06:35,546 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:06:35,617 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:06:35,618 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:06:46,867 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 14:06:47,872 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 14:06:47,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:06:48,355 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:07:02,361 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 14:07:09,611 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 14:07:09,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:07:09,695 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:07:09,696 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 14:07:09,742 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 14:07:10,927 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 14:07:11,992 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 14:07:13,144 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 14:07:13,490 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 14:07:16,084 - ispa_next.functions - DEBUG - Updated appointment (AA00044542) customer contact data.
2025-11-12 14:07:16,992 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 14:07:16,993 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 14:07:17,719 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 14:07:17,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:07:18,409 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 14:07:22,466 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 14:07:22,466 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:07:22,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:07:22,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:07:24,948 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:07:25,068 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:07:25,175 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:07:25,287 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:07:25,287 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:07:36,820 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 14:08:36,822 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:08:48,203 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 14:08:54,206 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:09:05,463 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 14:09:12,791 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 14:09:12,791 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 14:09:14,894 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 14:09:15,903 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:09:15,909 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:09:15,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:09:16,009 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:09:16,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:09:16,855 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:09:16,856 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:09:17,625 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:09:17,626 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:09:25,788 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:09:25,789 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:09:26,712 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:09:26,714 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:09:26,717 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart), Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=from_aw_package, target=cart)}
2025-11-12 14:09:26,720 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:09:26,722 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 14:09:26,724 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 14:09:26,725 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:09:26,726 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:09:26,727 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:09:26,729 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:09:26,730 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 14:10:24,992 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 14:10:24,995 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:10:24,996 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:10:24,997 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:10:35,652 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 14:10:41,259 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:10:41,265 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:10:41,268 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:10:51,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:10:52,054 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:11:02,354 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:11:22,846 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:11:22,847 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:11:22,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 14:11:23,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 14:11:23,737 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:11:36,677 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:11:36,695 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:11:47,537 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:11:47,538 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:11:47,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:11:48,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:11:48,582 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:12:00,476 - ispa_next.common.utils - DEBUG - Attempt 1/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-12 14:12:00,476 - ispa_next.common.utils - DEBUG - Attempt 1/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 1.0s
2025-11-12 14:12:02,764 - ispa_next.common.utils - DEBUG - Attempt 2/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-12 14:12:02,765 - ispa_next.common.utils - DEBUG - Attempt 2/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 2.0s
2025-11-12 14:12:05,999 - ispa_next.common.utils - DEBUG - Attempt 3/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-12 14:12:06,000 - ispa_next.common.utils - DEBUG - Attempt 3/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 4.0s
2025-11-12 14:12:11,457 - ispa_next.common.utils - DEBUG - Attempt 4/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-12 14:12:11,457 - ispa_next.common.utils - DEBUG - Attempt 4/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 8.0s
2025-11-12 14:12:20,851 - ispa_next.common.utils - DEBUG - Attempt 5/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-12 14:12:20,851 - ispa_next.common.utils - DEBUG - Attempt 5/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 16.0s
2025-11-12 14:12:38,258 - ispa_next.common.utils - DEBUG - Attempt 6/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-12 14:12:38,983 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 128, in process_appointment
    f.check_cart_packages_for_parts_service_and_parts_availability(app, appointment, state)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\functions.py", line 390, in check_cart_packages_for_parts_service_and_parts_availability
    retry_ui_action(open_job_details_view, condition=job_details_view_exists, base_delay=1.0)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\utils.py", line 399, in retry_ui_action
    raise RetryUiActionError(f"UI action failed after {max_attempts} attempts: Condition never satisfied")
ispa_next.exceptions.RetryUiActionError: UI action failed after 6 attempts: Condition never satisfied

2025-11-12 14:12:39,073 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:12:39,074 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:12:39,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:12:39,789 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 14:12:39,790 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 14:12:39,815 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 14:12:42,910 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 14:12:42,913 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:12:43,460 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:12:43,461 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:12:46,268 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-12 14:12:46,269 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:12:47,123 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 14:12:47,132 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 14:12:47,139 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 14:12:47,143 - ispa_next.main - DEBUG - Found new Appointment: HF-XJ 168
2025-11-12 14:12:47,145 - ispa_next.main - DEBUG - 



2025-11-12 14:12:47,145 - ispa_next.main - DEBUG - starting with process 2 (HF-XJ 168) of 9
2025-11-12 14:12:47,149 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:12:47,886 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:12:48,631 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:12:48,631 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-12 14:12:49,832 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:12:49,833 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:13:14,644 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 14:13:24,580 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:13:26,456 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 14:13:26,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:13:26,522 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:13:26,856 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 14:13:26,859 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 14:13:26,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:13:26,985 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:13:30,094 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:13:30,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:13:30,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:13:33,004 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:13:33,128 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:13:36,412 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:13:36,485 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:13:36,486 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:13:47,828 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 14:13:48,833 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 14:13:48,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:13:49,346 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:13:58,531 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 14:14:05,759 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 14:14:05,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:14:05,860 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:14:05,861 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 14:14:05,897 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 14:14:07,146 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 14:14:08,303 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 14:14:08,527 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 14:14:11,130 - ispa_next.functions - DEBUG - Updated appointment (AA00044554) customer contact data.
2025-11-12 14:14:12,086 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 14:14:12,089 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 14:14:12,984 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 14:14:12,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:14:13,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 14:14:17,209 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:14:17,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:14:17,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:14:19,725 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:14:19,862 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:14:19,981 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:14:20,075 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:14:20,076 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:14:30,659 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 14:14:37,706 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 14:14:37,707 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 14:14:41,953 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 14:14:42,959 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:14:42,963 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:14:42,964 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:14:43,032 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:14:48,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:14:49,222 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:14:49,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:14:49,894 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:14:49,902 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:14:52,365 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:14:52,378 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:14:53,444 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:14:53,446 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:14:53,448 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 14:14:53,450 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 14:14:53,451 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 14:14:53,452 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:14:53,454 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 14:14:53,456 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 14:14:53,457 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:14:53,470 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:14:53,473 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:14:53,479 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:14:53,483 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:14:53,485 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:14:53,486 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:14:56,042 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:14:56,043 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:14:56,048 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:14:58,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:14:58,687 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:15:08,236 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:15:20,365 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:15:20,366 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:15:20,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 14:15:21,071 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 14:15:21,277 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:15:34,642 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:15:34,643 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:15:37,219 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:15:37,221 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:15:37,729 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:15:38,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:15:38,342 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:15:44,816 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:15:48,997 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:15:54,240 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:15:54,240 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:15:54,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:15:54,907 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 14:15:54,908 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:15:57,944 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 14:16:07,070 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 14:16:07,477 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 14:16:08,259 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:16:08,698 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:16:08,699 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:16:11,297 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-12 14:16:11,298 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:16:11,927 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 14:16:11,935 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 14:16:11,945 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 14:16:11,951 - ispa_next.main - DEBUG - 



2025-11-12 14:16:11,952 - ispa_next.main - DEBUG - starting with process 3 (BÜNDE) of 9
2025-11-12 14:16:11,955 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:16:12,713 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:16:13,643 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:16:13,644 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-12 14:16:14,796 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:16:14,797 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:16:44,736 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 14:16:44,746 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 14:16:44,752 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:16:45,088 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:16:45,089 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:16:47,466 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-12 14:16:47,467 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:16:48,240 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 14:16:48,247 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 14:16:48,255 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 14:16:48,258 - ispa_next.main - DEBUG - 



2025-11-12 14:16:48,258 - ispa_next.main - DEBUG - starting with process 4 (HF-LB-222) of 9
2025-11-12 14:16:48,262 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:16:49,552 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:16:50,693 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:16:50,695 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-12 14:16:51,907 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:16:51,908 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:17:26,509 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 14:17:26,519 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 14:17:26,523 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:17:27,016 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:17:27,017 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:17:29,224 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-12 14:17:29,225 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:17:30,069 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 14:17:30,077 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 14:17:30,086 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 14:17:30,089 - ispa_next.main - DEBUG - 



2025-11-12 14:17:30,090 - ispa_next.main - DEBUG - starting with process 5 (HF L 1612) of 9
2025-11-12 14:17:30,093 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:17:31,243 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:17:32,451 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:17:32,452 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-12 14:17:33,681 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:17:33,682 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:18:04,756 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 14:18:04,764 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 14:18:04,767 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:18:05,109 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:18:05,110 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:18:07,597 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-12 14:18:07,598 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:18:08,389 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 14:18:08,396 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 14:18:08,403 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 14:18:08,407 - ispa_next.main - DEBUG - 



2025-11-12 14:18:08,407 - ispa_next.main - DEBUG - starting with process 6 (OS-CW177) of 9
2025-11-12 14:18:08,410 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:18:09,434 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:18:10,190 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:18:10,191 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-12 14:18:11,336 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:18:11,336 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:18:42,636 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 14:18:42,646 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 14:18:42,649 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:18:43,084 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:18:43,085 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:18:45,574 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-12 14:18:45,574 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:18:46,228 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 14:18:46,234 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 14:18:46,240 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 14:18:46,243 - ispa_next.main - DEBUG - 



2025-11-12 14:18:46,243 - ispa_next.main - DEBUG - starting with process 7 (HF-BT 540) of 9
2025-11-12 14:18:46,248 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:18:47,093 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:18:47,998 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:18:48,000 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-12 14:18:49,349 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:18:49,350 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:19:12,463 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 14:19:21,471 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:19:25,497 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 14:19:25,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:19:25,581 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:19:25,829 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 14:19:25,832 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 14:19:25,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:19:25,942 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:19:29,063 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:19:29,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:19:30,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:19:32,264 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:19:32,381 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:19:35,626 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:19:35,702 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:19:35,702 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:19:46,715 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 14:19:47,720 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 14:19:47,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:19:48,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:20:00,281 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 14:20:00,281 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 14:20:07,498 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 14:20:07,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:20:07,580 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:20:07,582 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 14:20:07,628 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 14:20:08,883 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 14:20:09,092 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 14:20:12,396 - ispa_next.functions - DEBUG - Updated appointment (AE00024535) customer contact data.
2025-11-12 14:20:13,320 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 14:20:13,322 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 14:20:14,353 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 14:20:14,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:20:15,058 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 14:20:18,644 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:20:18,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:20:19,129 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:20:21,133 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:20:21,266 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:20:21,346 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:20:21,419 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:20:21,420 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:20:32,111 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 14:20:39,416 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 14:20:39,417 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 14:20:43,636 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 14:20:44,642 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:20:44,644 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:20:44,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:20:44,716 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:20:54,087 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 14:20:59,176 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 14:20:59,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:20:59,795 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:20:59,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:21:00,483 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:21:00,485 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:21:04,065 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:21:04,067 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:21:05,166 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:21:05,168 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:21:05,171 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 14:21:05,189 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 14:21:05,193 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 14:21:05,194 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:21:05,198 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 14:21:05,199 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 14:21:05,200 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:21:05,202 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:21:05,203 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:21:05,205 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:21:05,209 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 14:21:27,190 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-12 14:21:27,209 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:21:27,211 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:21:27,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:21:28,505 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:21:28,506 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 14:21:28,535 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 14:21:31,148 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 14:21:31,153 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:21:31,699 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:21:31,700 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:21:34,607 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-12 14:21:34,608 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:21:35,432 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 14:21:35,440 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 14:21:35,448 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 14:21:35,452 - ispa_next.main - DEBUG - 



2025-11-12 14:21:35,452 - ispa_next.main - DEBUG - starting with process 8 (MI-JC 96 E) of 9
2025-11-12 14:21:35,455 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:21:36,656 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:21:37,731 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:21:37,733 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-12 14:21:39,002 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:21:39,003 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:22:08,940 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 14:22:08,948 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 14:22:08,951 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:22:09,235 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:22:09,236 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:22:11,438 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-12 14:22:11,439 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:22:12,274 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 14:22:12,417 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 14:22:12,424 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 14:22:12,442 - ispa_next.main - DEBUG - 



2025-11-12 14:22:12,442 - ispa_next.main - DEBUG - starting with process 9 (BÜNDE) of 9
2025-11-12 14:22:12,446 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:22:13,528 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:22:14,827 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:22:14,829 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-12 14:22:16,254 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:22:16,255 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:22:45,906 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 14:22:45,915 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 14:22:45,918 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:22:46,315 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 626
2025-11-12 14:22:46,317 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:22:49,036 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-12 14:22:49,037 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:22:49,863 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 14:22:49,870 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 14:22:49,877 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
