2025-11-12 13:08:25,475 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 13:08:25,482 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 13:08:36,386 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:08:46,949 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:09:02,835 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:09:27,321 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 13:09:46,138 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 13:09:50,003 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:09:51,494 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:09:51,496 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 13:09:54,522 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 341
2025-11-12 13:09:54,523 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 13:09:54,523 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:09:55,905 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:09:57,343 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:11:01,487 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment AIR LIQUIDE Deutschland GmbH D-S-0-099/24-00420 WBA11BZ0309V09489, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='D-S-0-099/24-00420', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-12 13:11:01,508 - ispa_next.appointments.models - DEBUG - Appointment Kapellmann und Partner Rechtsanwaelte mbB D-AE 2222 WBAHF51080WW33367 ohne Termin.
2025-11-12 13:11:01,521 - ispa_next.appointments.models - DEBUG - Appointment Zhong Zhao NE-ZZ 668 WBAJT9100KBJ24904 ohne Termin.
2025-11-12 13:11:01,538 - ispa_next.appointments.models - DEBUG - Appointment Maersk Deutschland HH-M 3071E WBA81CY060FN31767 ohne Termin.
2025-11-12 13:11:01,555 - ispa_next.appointments.models - DEBUG - Appointment Weinmann Ulrich D-UW 19 WBAUZ35030NE17326 ohne Termin.
2025-11-12 13:11:01,570 - ispa_next.appointments.models - DEBUG - Appointment Shikoku Kakoki Europe GmbH D-SK 1601 WBA21FZ000FU12151 ohne Termin.
2025-11-12 13:11:01,650 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Esser D-FL 495 WBAUZ35030N020597 ohne Termin.
2025-11-12 13:11:01,664 - ispa_next.appointments.models - DEBUG - Appointment Armin Händeler D-AA 93 WBAHF11000WW66520 ohne Termin.
2025-11-12 13:11:01,686 - ispa_next.appointments.models - DEBUG - Appointment Tolga Erol NE-TE 1490 WBA5R11070AE79396 ohne Termin.
2025-11-12 13:11:01,820 - ispa_next.main - DEBUG - Found 15 out of 85 appointments to process (configured limit: 15).
2025-11-12 13:11:01,821 - ispa_next.main - DEBUG - Processing 10 fresh appointments.
2025-11-12 13:11:01,821 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 13:11:01,822 - ispa_next.main - DEBUG - All appointments: D-KM 855E, BN-TD2222, D-QQ200, NE-TP72, NE FK333E, F-HT 2012, NEAH187, NE HP 110E, D-MK-7692E, NE M 5560E, DKJ1628, D-PE 8787, D-KS-266, BM -K 7709, KR-AD 1408
2025-11-12 13:11:01,825 - ispa_next.main - DEBUG - 



2025-11-12 13:11:01,825 - ispa_next.main - DEBUG - starting with process 1 (D-KM 855E) of 15
2025-11-12 13:11:01,832 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:11:03,218 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:11:04,671 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:11:04,672 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 13:11:06,326 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:11:06,328 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:11:40,235 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:11:51,258 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:11:51,374 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:11:51,584 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:11:53,659 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:11:53,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:11:53,757 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:11:54,010 - ispa_next.functions - DEBUG - HU date already expired after 125 days.
2025-11-12 13:12:02,411 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:12:02,416 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:12:05,309 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:12:05,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:12:06,372 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:12:08,376 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:12:08,522 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:12:11,759 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:12:11,865 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:12:11,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:12:13,965 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:12:22,439 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:12:23,444 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:12:23,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:23,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:38,341 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:12:47,247 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:12:47,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:47,342 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:12:47,343 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:12:47,421 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:12:49,097 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:12:49,511 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:12:53,728 - ispa_next.functions - DEBUG - Updated appointment (AB00031784) customer contact data.
2025-11-12 13:12:54,752 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:12:54,756 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:12:56,485 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:12:56,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:12:57,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:13:01,044 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:13:01,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:01,550 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:13:03,552 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:13:03,727 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:13:03,857 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:13:03,934 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:13:03,937 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:13:06,112 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:13:14,657 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:14:14,660 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:14:26,289 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:14:30,649 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:14:30,650 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:32,691 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:14:36,924 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:14:37,931 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:14:37,935 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:14:37,936 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:14:38,136 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:14:38,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:14:39,156 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:14:39,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:14:40,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:14:40,011 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:14:42,077 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:14:42,079 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:14:42,859 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:14:42,873 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:14:42,876 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:14:42,878 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 13:14:42,879 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:14:42,882 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 13:14:42,883 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:14:42,886 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:14:42,888 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:14:42,890 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:14:42,894 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:14:43,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 13:14:44,427 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 13:14:54,102 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:14:54,103 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 13:14:56,502 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:14:57,050 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:14:58,621 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 13:14:59,192 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:14:59,731 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:15:00,683 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 13:15:01,255 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:15:01,796 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:15:02,734 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 13:15:03,899 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:15:04,897 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 13:15:05,485 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:15:05,494 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:15:05,498 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:15:07,458 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:15:07,461 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:15:07,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:15:09,425 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:15:09,428 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:15:09,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:15:10,016 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:15:10,397 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:15:24,923 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:15:24,925 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:15:26,933 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:15:40,041 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:15:40,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:15:41,136 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:15:41,324 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:16:00,527 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:16:06,030 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:16:06,035 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:16:06,036 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:16:06,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:16:06,964 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:16:06,967 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:16:09,365 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:16:21,464 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:16:21,868 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 13:16:23,190 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:16:23,924 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:16:23,925 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:16:27,494 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 435
2025-11-12 13:16:27,495 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:16:28,497 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:16:28,508 - ispa_next.main - DEBUG - 



2025-11-12 13:16:28,508 - ispa_next.main - DEBUG - starting with process 2 (BN-TD2222) of 15
2025-11-12 13:16:28,513 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:16:29,971 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:16:31,534 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:16:31,535 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 13:16:33,480 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:16:33,482 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:17:06,513 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:17:06,631 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 13:17:06,637 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:17:07,271 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:17:07,273 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:17:10,745 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 435
2025-11-12 13:17:10,746 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:17:11,711 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:17:11,718 - ispa_next.main - DEBUG - 



2025-11-12 13:17:11,718 - ispa_next.main - DEBUG - starting with process 3 (D-QQ200) of 15
2025-11-12 13:17:11,722 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:17:13,109 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:17:14,554 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:17:14,555 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 13:17:16,370 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:17:16,371 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:17:53,349 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:17:53,359 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 13:17:53,363 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:17:53,955 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:17:53,956 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:17:57,356 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 435
2025-11-12 13:17:57,357 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:17:58,482 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:17:58,490 - ispa_next.main - DEBUG - 



2025-11-12 13:17:58,490 - ispa_next.main - DEBUG - starting with process 4 (NE-TP72) of 15
2025-11-12 13:17:58,494 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:17:59,962 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:18:01,562 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:18:01,564 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 13:18:03,163 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:18:03,164 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:18:45,952 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:18:45,963 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 13:18:45,967 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:18:46,529 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:18:46,530 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:18:49,926 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 435
2025-11-12 13:18:49,927 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:18:51,047 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:18:51,057 - ispa_next.main - DEBUG - 



2025-11-12 13:18:51,057 - ispa_next.main - DEBUG - starting with process 5 (NE FK333E) of 15
2025-11-12 13:18:51,061 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:18:52,591 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:18:54,451 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:18:54,452 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 13:18:56,380 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:18:56,381 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:19:31,976 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:19:31,991 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 13:19:31,997 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:19:32,657 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:19:32,658 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:19:36,362 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 435
2025-11-12 13:19:36,363 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:19:37,356 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:19:37,363 - ispa_next.main - DEBUG - 



2025-11-12 13:19:37,363 - ispa_next.main - DEBUG - starting with process 6 (F-HT 2012) of 15
2025-11-12 13:19:37,367 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:19:38,822 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:19:40,369 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:19:40,371 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 13:19:42,038 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:19:42,040 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:20:23,353 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:20:23,368 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 13:20:23,375 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:20:24,103 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:20:24,104 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:20:27,438 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 435
2025-11-12 13:20:27,439 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:20:28,612 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:20:28,623 - ispa_next.main - DEBUG - 



2025-11-12 13:20:28,623 - ispa_next.main - DEBUG - starting with process 7 (NEAH187) of 15
2025-11-12 13:20:28,630 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:20:30,084 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:20:31,781 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:20:31,784 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 13:20:33,451 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:20:33,452 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:21:10,724 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:21:10,735 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 13:21:10,739 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:21:11,286 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:21:11,287 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:21:14,473 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 435
2025-11-12 13:21:14,474 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:21:15,525 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:21:15,532 - ispa_next.main - DEBUG - 



2025-11-12 13:21:15,532 - ispa_next.main - DEBUG - starting with process 8 (NE HP 110E) of 15
2025-11-12 13:21:15,536 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:21:17,015 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:21:18,487 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:21:18,488 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 13:21:20,153 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:21:20,154 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:21:54,639 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:21:54,650 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 13:21:54,654 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:21:55,282 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:21:55,283 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:21:58,475 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 435
2025-11-12 13:21:58,475 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:21:59,585 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:21:59,597 - ispa_next.main - DEBUG - 



2025-11-12 13:21:59,597 - ispa_next.main - DEBUG - starting with process 9 (D-MK-7692E) of 15
2025-11-12 13:21:59,607 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:22:01,049 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:22:02,824 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:22:02,826 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 13:22:04,510 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:22:04,517 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:22:40,503 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:22:40,515 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 13:22:40,519 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:22:41,099 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:22:41,100 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:22:45,441 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 435
2025-11-12 13:22:45,442 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:22:47,831 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:22:47,857 - ispa_next.main - DEBUG - 



2025-11-12 13:22:47,857 - ispa_next.main - DEBUG - starting with process 10 (NE M 5560E) of 15
2025-11-12 13:22:47,933 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:22:50,737 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:22:52,286 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:22:52,287 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 13:22:54,512 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:22:54,514 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:23:36,109 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:23:36,120 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 13:23:36,124 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:23:36,679 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:23:36,680 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:23:39,943 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 435
2025-11-12 13:23:39,944 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:23:41,015 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:23:41,040 - ispa_next.main - DEBUG - 



2025-11-12 13:23:41,041 - ispa_next.main - DEBUG - starting with process 11 (DKJ1628) of 15
2025-11-12 13:23:41,047 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:23:42,497 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:23:44,277 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:23:44,278 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 13:23:46,104 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:23:46,105 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:24:24,851 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:24:24,907 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 13:24:24,913 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:24:25,628 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:24:25,630 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:24:28,971 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 435
2025-11-12 13:24:28,972 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:24:30,229 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:24:30,239 - ispa_next.main - DEBUG - 



2025-11-12 13:24:30,239 - ispa_next.main - DEBUG - starting with process 12 (D-PE 8787) of 15
2025-11-12 13:24:30,243 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:24:31,675 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:24:33,259 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 858
2025-11-12 13:24:33,266 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-12 13:24:34,867 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:24:34,869 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:25:10,100 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:25:12,790 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:25:18,657 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:25:21,271 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:25:21,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:21,352 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:25:21,697 - ispa_next.functions - DEBUG - HU date already expired after 111 days.
2025-11-12 13:25:27,054 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:25:27,059 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:25:29,927 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:25:29,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:25:31,108 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:25:33,113 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:25:33,255 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:25:33,402 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:25:33,541 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:25:37,770 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:25:38,778 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:25:38,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:39,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:55,639 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:26:00,752 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:26:00,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:00,877 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:26:00,878 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:26:00,969 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:26:01,149 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:26:03,230 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:26:03,681 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:26:05,431 - ispa_next.functions - DEBUG - Updated appointment (AB00031135) customer contact data.
2025-11-12 13:26:06,392 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:26:06,409 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:26:06,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:26:07,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:26:08,895 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:26:08,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:26:09,002 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:26:13,099 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:26:13,099 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:26:13,102 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:26:13,108 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:26:13,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:13,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:26:14,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:14,894 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:14,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:15,765 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:26:15,766 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:26:18,420 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:26:18,431 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:26:19,838 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:26:19,840 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:26:19,845 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:26:19,846 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:26:19,847 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:26:19,851 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:26:19,852 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:26:19,854 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:26:19,856 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:26:19,858 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:26:19,860 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:26:19,864 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:26:19,867 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:26:19,868 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:22,778 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:26:22,782 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:26:22,785 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:25,557 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:26:25,560 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:26:25,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:26:26,426 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:26:26,737 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:36,703 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:26:36,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:39,590 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:26:53,057 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:26:53,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:26:54,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:26:54,446 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:20,130 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:27:24,686 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:27:30,290 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:27:30,295 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:27:30,295 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:27:31,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:27:31,284 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:27:31,287 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:27:33,673 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:27:43,526 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:27:43,934 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 13:27:44,819 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:46,068 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 861
2025-11-12 13:27:46,070 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:49,555 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 437
2025-11-12 13:27:49,556 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:50,579 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:27:50,586 - ispa_next.main - DEBUG - Found new Appointment: NE-NI 98E
2025-11-12 13:27:50,589 - ispa_next.main - DEBUG - 



2025-11-12 13:27:50,589 - ispa_next.main - DEBUG - starting with process 13 (NE-NI 98E) of 16
2025-11-12 13:27:50,594 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:27:52,048 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:53,689 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 861
2025-11-12 13:27:53,690 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-12 13:27:55,542 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:55,544 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:28:32,675 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:28:43,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:44,052 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:28:44,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:45,571 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:28:45,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:45,737 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:28:45,991 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:28:45,995 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:28:49,079 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:28:49,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:28:50,358 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:28:52,363 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:28:52,530 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:28:55,771 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:29:05,254 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 13:29:06,259 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:29:06,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:06,786 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:21,546 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:29:30,072 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:29:30,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:30,203 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:29:30,204 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:29:30,291 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:29:31,820 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:29:32,218 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:29:34,929 - ispa_next.functions - DEBUG - Updated appointment (AB00031787) customer contact data.
2025-11-12 13:29:35,889 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:29:35,891 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:29:36,799 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:29:36,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:29:38,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:29:41,667 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:29:41,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:29:42,174 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:29:44,180 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:29:44,343 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:29:44,537 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:29:44,655 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:29:44,661 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:45,943 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:29:55,350 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:30:55,353 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:31:04,311 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:31:33,314 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:31:41,853 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:31:50,554 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 13:31:51,561 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:31:51,565 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:31:51,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:51,693 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:31:57,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:57,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:57,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:58,549 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:31:58,551 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:32:00,118 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:32:00,121 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:32:01,199 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:32:01,226 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:32:01,229 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:32:01,231 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 13:32:01,232 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:32:01,235 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:32:01,236 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:32:01,237 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:32:01,239 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:32:01,240 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:32:01,243 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:32:01,245 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:32:02,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 13:32:02,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 13:32:12,151 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:32:12,154 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:32:12,156 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:32:12,157 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:14,254 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:32:14,256 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:32:14,258 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:16,235 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:32:16,238 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:32:16,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:32:16,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:32:16,842 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:32:16,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:18,776 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:32:31,365 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:32:31,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:32:32,371 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:32:32,654 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:52,069 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:32:57,888 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:32:57,892 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:32:57,893 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:32:58,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:32:58,744 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:32:58,747 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:33:01,042 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:33:11,192 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:33:11,625 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 13:33:12,941 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:13,771 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 862
2025-11-12 13:33:13,772 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:17,652 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 438
2025-11-12 13:33:17,653 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:33:18,710 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:33:18,716 - ispa_next.main - DEBUG - 



2025-11-12 13:33:18,716 - ispa_next.main - DEBUG - starting with process 14 (D-KS-266) of 16
2025-11-12 13:33:18,720 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:33:20,121 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:21,753 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 862
2025-11-12 13:33:21,754 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 438
2025-11-12 13:33:23,531 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:23,533 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:34:00,730 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:34:00,741 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 13:34:00,746 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:34:01,479 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 862
2025-11-12 13:34:01,480 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:34:04,966 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 438
2025-11-12 13:34:04,967 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:34:05,962 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:34:05,968 - ispa_next.main - DEBUG - 



2025-11-12 13:34:05,968 - ispa_next.main - DEBUG - starting with process 15 (BM -K 7709) of 16
2025-11-12 13:34:05,972 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:34:07,444 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:34:08,983 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 862
2025-11-12 13:34:08,985 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 438
2025-11-12 13:34:10,823 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:34:10,824 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:34:48,851 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:34:48,863 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 13:34:48,868 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:34:49,538 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 862
2025-11-12 13:34:49,539 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:34:53,036 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 438
2025-11-12 13:34:53,037 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:34:54,109 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
2025-11-12 13:34:54,118 - ispa_next.main - DEBUG - 



2025-11-12 13:34:54,118 - ispa_next.main - DEBUG - starting with process 16 (KR-AD 1408) of 16
2025-11-12 13:34:54,124 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:34:55,641 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:34:57,305 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 862
2025-11-12 13:34:57,306 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 438
2025-11-12 13:34:59,367 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:34:59,368 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:35:29,267 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:35:31,628 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:35:37,273 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:39,264 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:35:39,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:39,345 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:35:39,692 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:35:44,460 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:35:44,463 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:35:47,379 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:35:47,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:35:48,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:35:50,632 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:35:50,771 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:35:50,914 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:35:51,023 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:35:55,260 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:35:56,266 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:35:56,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:57,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:10,707 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:36:15,756 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:36:15,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:15,986 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:36:15,987 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:36:16,038 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:36:17,484 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:36:17,867 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:36:19,575 - ispa_next.functions - DEBUG - Updated appointment (AB00031302) customer contact data.
2025-11-12 13:36:20,525 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:36:20,527 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:36:21,538 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:36:21,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:36:22,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:36:26,447 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:36:26,447 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:36:26,451 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:36:26,455 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:36:26,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:36:26,955 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:36:32,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:33,125 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:33,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:36:33,922 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:36:33,923 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:36:36,075 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:36:36,077 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:36:37,527 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:36:37,530 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:36:37,532 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:36:37,534 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:36:37,535 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:36:37,538 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:36:37,540 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:36:37,541 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:36:37,544 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:36:37,545 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:36:37,547 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:36:37,551 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:36:37,555 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:36:37,555 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:39,638 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:36:39,641 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:36:39,662 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:41,786 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:36:41,789 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:36:41,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:36:42,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:36:42,919 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:54,448 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:36:54,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:56,467 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:37:09,998 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:37:10,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:37:11,120 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:37:11,363 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:31,045 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:36,778 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:36,783 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:37:36,784 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:37,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:37:37,690 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:37:37,692 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:37:40,043 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:37:50,000 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:37:50,416 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 13:37:51,701 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:52,557 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 862
2025-11-12 13:37:52,558 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:56,812 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 438
2025-11-12 13:37:56,813 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:37:57,801 - ispa_next.appointments.models - DEBUG - Appointment Nick Lamers VIE-NL 409 WBAUR11090VU31559 ohne Termin.
