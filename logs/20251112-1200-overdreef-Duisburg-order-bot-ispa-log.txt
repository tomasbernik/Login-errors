2025-11-12 12:00:38,581 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 12:00:38,587 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 12:00:53,757 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:01:04,791 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:01:20,335 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:02:16,597 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 12:02:29,291 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 12:02:32,143 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:02:33,221 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:02:33,223 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:02:35,696 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 138
2025-11-12 12:02:35,697 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 12:02:35,698 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:02:36,995 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:02:38,227 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:02:58,955 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:02:58,970 - ispa_next.appointments.models - DEBUG - Appointment Nehad Djika DU-XH 11 WBAJC31000D030956 ohne Termin.
2025-11-12 12:02:58,982 - ispa_next.appointments.models - DEBUG - Appointment Ammar Saidavey DU-ZD 555 WBATB410209D95081 ohne Termin.
2025-11-12 12:02:58,992 - ispa_next.appointments.models - DEBUG - Appointment Dilara Demir DU-QM 40 WBA5R11030AK33636 ohne Termin.
2025-11-12 12:02:58,999 - ispa_next.appointments.models - DEBUG - Appointment Firma Effizienz-Agentur NRW MH-EF 51 WBA31BL000WY01751 ohne Termin.
2025-11-12 12:02:59,007 - ispa_next.appointments.models - DEBUG - Appointment Firma Goldmann KFZ DU-OO 2 WBA31DZ010FJ99431 ohne Termin.
2025-11-12 12:02:59,016 - ispa_next.appointments.models - DEBUG - Appointment Alexandre Magno Rezende ME-AP 7810 WBA35BG0X0N050338 ohne Termin.
2025-11-12 12:02:59,025 - ispa_next.appointments.models - DEBUG - Appointment Ali Sarmand DU-SI 48 WBA11DW010CD72865 ohne Termin.
2025-11-12 12:02:59,035 - ispa_next.appointments.models - DEBUG - Appointment Ilta Prokschi DU-AE 1621 WBAJN110X0BK38238 ohne Termin.
2025-11-12 12:02:59,044 - ispa_next.appointments.models - DEBUG - Appointment Emre Kara DU-EK 280 WBA5F31040FH73684 ohne Termin.
2025-11-12 12:02:59,054 - ispa_next.appointments.models - DEBUG - Appointment Bernd Markus Wallhorn DU-W 172 WBAHF11010WW28262 ohne Termin.
2025-11-12 12:02:59,073 - ispa_next.appointments.models - DEBUG - Appointment Roman Vertkin MO-VV 6880 WBA6L31030FK09194 ohne Termin.
2025-11-12 12:02:59,094 - ispa_next.appointments.models - DEBUG - Appointment Melanie Anni Anneliese Kaminsk DU-UH 1217 WBA6K310X0FJ11363 ohne Termin.
2025-11-12 12:02:59,102 - ispa_next.appointments.models - DEBUG - Appointment Sebastian Czwalinna KLE-CB 278 WBA6L51040FJ39992 ohne Termin.
2025-11-12 12:02:59,112 - ispa_next.appointments.models - DEBUG - Appointment Devinder Singh DU-LR 1805 WBA4M910609F16559 ohne Termin.
2025-11-12 12:02:59,124 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Fischer DUJF 2602 WBAJT31020CE34043 ohne Termin.
2025-11-12 12:02:59,133 - ispa_next.appointments.models - DEBUG - Appointment Bernd Maas DU-BB 5560 WBATY51040LE76512 ohne Termin.
2025-11-12 12:02:59,141 - ispa_next.appointments.models - DEBUG - Appointment Mustafa Karamalak DU-C 5067 WBA5F31060FH59429 ohne Termin.
2025-11-12 12:02:59,150 - ispa_next.appointments.models - DEBUG - Appointment Thorsten Hübner MO-AT 238 WBA31DZ050FK27506 ohne Termin.
2025-11-12 12:02:59,159 - ispa_next.appointments.models - DEBUG - Appointment Can Arslanboga DU-CQ 46 WBAJM91020BE38406 ohne Termin.
2025-11-12 12:02:59,168 - ispa_next.appointments.models - DEBUG - Appointment Günther Wagner DU-G 66 WBA5R11040FH35321 ohne Termin.
2025-11-12 12:02:59,178 - ispa_next.appointments.models - DEBUG - Appointment Marianne Gerharz DU-DM 199 WBA5F31030FJ87992 ohne Termin.
2025-11-12 12:02:59,187 - ispa_next.appointments.models - DEBUG - Appointment Andreas Vanek DU-V 306 WBATY15000N028675 ohne Termin.
2025-11-12 12:02:59,197 - ispa_next.appointments.models - DEBUG - Appointment Hareen Bagehany OB-T 1810 WBAJF31040WW51838 ohne Termin.
2025-11-12 12:02:59,205 - ispa_next.appointments.models - DEBUG - Appointment Rafael Kossok D-K 4001 WBA5V31000FH40118 ohne Termin.
2025-11-12 12:02:59,215 - ispa_next.appointments.models - DEBUG - Appointment Andrea Heringloh DU-AH 184 WBAHF11080WW34771 ohne Termin.
2025-11-12 12:02:59,224 - ispa_next.appointments.models - DEBUG - Appointment Michael Anton Castelijn MO-MC 1221 WBAJP31040BT94572 ohne Termin.
2025-11-12 12:02:59,233 - ispa_next.appointments.models - DEBUG - Appointment Markus Gundermann DU-GU 666 WBAJM71030B068259 ohne Termin.
2025-11-12 12:02:59,241 - ispa_next.appointments.models - DEBUG - Appointment Sönke Nils Hoffmann DU-SN 2906 WBAJT31010BV43614 ohne Termin.
2025-11-12 12:02:59,254 - ispa_next.appointments.models - DEBUG - Appointment Frank Flechsig WES-FF 71 WBAJP51090BU52820 ohne Termin.
2025-11-12 12:02:59,265 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Alfons Bartelt DU-RH 124 WBA11DW040CD91149 ohne Termin.
2025-11-12 12:02:59,274 - ispa_next.appointments.models - DEBUG - Appointment Helmut Karl Rainer DU-HR 2804 WBAUZ35080N008140 ohne Termin.
2025-11-12 12:02:59,286 - ispa_next.appointments.models - DEBUG - Appointment Heinz Rainer Jung DU-RJ 2311 WBAUZ35090N012133 ohne Termin.
2025-11-12 12:02:59,298 - ispa_next.appointments.models - DEBUG - Appointment Ramiz Dolicanin DU-SD 2712 WBAJE310X0B169899 ohne Termin.
2025-11-12 12:02:59,307 - ispa_next.appointments.models - DEBUG - Appointment Beate Corona DU-B 396 WBA1V71070V832349 ohne Termin.
2025-11-12 12:02:59,317 - ispa_next.appointments.models - DEBUG - Appointment Katharina Overdreef MO-K 1709 WBATY15060ND79772 ohne Termin.
2025-11-12 12:02:59,324 - ispa_next.appointments.models - DEBUG - Appointment Jörg Lemmin  WBY61EF0905457502 ohne Termin.
2025-11-12 12:02:59,333 - ispa_next.appointments.models - DEBUG - Appointment Firma Alders Electronic GmbH  WBY61EF0905451862 ohne Termin.
2025-11-12 12:02:59,344 - ispa_next.appointments.models - DEBUG - Appointment Firma Shimadzu Europa GmbH DU-SH 7700 WBA85BZ050N296538 ohne Termin.
2025-11-12 12:02:59,352 - ispa_next.appointments.models - DEBUG - Appointment Ibrahim Tizniti K-IT 1605 WBA8H91090A720533 ohne Termin.
2025-11-12 12:02:59,361 - ispa_next.appointments.models - DEBUG - Appointment Firma Netzwerk Aussenwirtschaft GmbH NE-DG 4441 WBATY55020N120555 ohne Termin.
2025-11-12 12:02:59,371 - ispa_next.main - DEBUG - Found 14 out of 20 appointments to process (configured limit: 15).
2025-11-12 12:02:59,371 - ispa_next.main - DEBUG - Processing 9 fresh appointments.
2025-11-12 12:02:59,372 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 12:02:59,372 - ispa_next.main - DEBUG - All appointments: DU-EH 1314, DU-K 9705, DU-LM 3820, DU-YA 501, DU-MM 9492, DU-VG 91, DU-CA 35, KLE-GA 313, DU-ES 550 E, DU-F 7412, DU-EF 3450, DU-WH 3678, MH-PI 88, DU-S 425
2025-11-12 12:02:59,375 - ispa_next.main - DEBUG - 



2025-11-12 12:02:59,375 - ispa_next.main - DEBUG - starting with process 1 (DU-EH 1314) of 14
2025-11-12 12:02:59,378 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:03:00,666 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:03:01,952 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:03:01,953 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 138
2025-11-12 12:03:03,343 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:03:03,345 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:03:27,281 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:03:36,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:03:38,658 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:03:38,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:03:38,735 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:03:39,039 - ispa_next.functions - DEBUG - HU date already expired after 142 days.
2025-11-12 12:03:45,922 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:03:45,925 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:03:45,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:03:46,002 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:03:55,814 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:03:55,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:03:56,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:03:58,593 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:04:04,115 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 12:04:10,573 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 12:04:11,579 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:04:11,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:04:12,036 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:04:23,029 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:04:29,171 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:04:29,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:04:29,233 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:04:29,234 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:04:29,316 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:04:29,415 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:04:30,644 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 12:04:31,823 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 12:04:32,136 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:04:35,326 - ispa_next.functions - DEBUG - Updated appointment (AB00016453) customer contact data.
2025-11-12 12:04:36,291 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:04:36,293 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:04:36,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:04:37,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:04:38,384 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:04:38,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:04:38,456 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:04:42,521 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 12:04:42,522 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:04:42,522 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:04:42,524 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:04:42,524 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:04:42,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:04:43,056 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:04:47,170 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:04:50,369 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:04:50,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:04:50,451 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:04:50,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:04:51,411 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:04:51,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:04:52,118 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:04:52,119 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:04:54,527 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:04:54,529 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:04:55,379 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:04:55,380 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:04:55,381 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:04:55,382 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:04:55,384 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:04:55,385 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:04:55,386 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:04:55,387 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:04:55,388 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:04:55,390 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:04:55,392 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:04:55,393 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:04:55,393 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:04:57,983 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:04:57,984 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:04:57,985 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:05:00,629 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:05:00,630 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:05:00,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:05:01,247 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:05:01,458 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:05:09,838 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:05:09,841 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:05:12,439 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:05:23,626 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:05:24,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:05:24,598 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:05:24,802 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:05:31,534 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:05:36,761 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:05:36,763 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:05:37,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:05:37,437 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:05:37,438 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:05:40,327 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:05:50,760 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:05:51,142 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 12:05:51,413 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:05:52,321 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:05:52,323 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:05:55,074 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 12:05:55,075 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:05:55,921 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:05:55,930 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:05:55,938 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:05:55,942 - ispa_next.main - DEBUG - 



2025-11-12 12:05:55,943 - ispa_next.main - DEBUG - starting with process 2 (DU-K 9705) of 14
2025-11-12 12:05:55,947 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:05:57,110 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:05:58,129 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:05:58,130 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:05:59,378 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:05:59,379 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:06:30,151 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:06:30,229 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 12:06:30,232 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:06:30,572 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:06:30,574 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:06:32,447 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 12:06:32,448 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:06:33,118 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:06:33,123 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:06:33,131 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:06:33,135 - ispa_next.main - DEBUG - 



2025-11-12 12:06:33,135 - ispa_next.main - DEBUG - starting with process 3 (DU-LM 3820) of 14
2025-11-12 12:06:33,138 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:06:33,976 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:06:34,786 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:06:34,787 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:06:35,969 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:06:35,970 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:07:06,101 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:07:06,110 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 12:07:06,113 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:07:06,503 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:07:06,505 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:07:09,038 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 12:07:09,039 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:07:09,837 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:07:09,844 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:07:09,852 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:07:09,854 - ispa_next.main - DEBUG - 



2025-11-12 12:07:09,854 - ispa_next.main - DEBUG - starting with process 4 (DU-YA 501) of 14
2025-11-12 12:07:09,858 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:07:11,187 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:07:12,412 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:07:12,414 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:07:13,878 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:07:13,880 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:07:43,883 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:07:43,892 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 12:07:43,896 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:07:44,393 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:07:44,394 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:07:46,954 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 12:07:46,955 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:07:47,817 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:07:47,824 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:07:47,832 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:07:47,835 - ispa_next.main - DEBUG - 



2025-11-12 12:07:47,836 - ispa_next.main - DEBUG - starting with process 5 (DU-MM 9492) of 14
2025-11-12 12:07:47,839 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:07:49,029 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:07:49,984 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:07:49,985 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:07:51,402 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:07:51,403 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:08:21,491 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:08:21,501 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 12:08:21,504 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:08:22,018 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:08:22,019 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:08:24,604 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 12:08:24,605 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:08:25,443 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:08:25,449 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:08:25,457 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:08:25,460 - ispa_next.main - DEBUG - 



2025-11-12 12:08:25,460 - ispa_next.main - DEBUG - starting with process 6 (DU-VG 91) of 14
2025-11-12 12:08:25,465 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:08:26,769 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:08:28,053 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:08:28,054 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:08:29,559 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:08:29,560 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:09:02,563 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:09:02,570 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 12:09:02,572 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:09:02,969 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:09:02,971 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:09:05,206 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 12:09:05,207 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:09:05,911 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:09:05,917 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:09:05,925 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:09:05,929 - ispa_next.main - DEBUG - 



2025-11-12 12:09:05,929 - ispa_next.main - DEBUG - starting with process 7 (DU-CA 35) of 14
2025-11-12 12:09:05,933 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:09:06,885 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:09:07,720 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:09:07,721 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:09:08,841 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:09:08,842 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:09:38,395 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:09:38,404 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 12:09:38,407 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:09:38,944 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:09:38,945 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:09:41,406 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 12:09:41,407 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:09:42,293 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:09:42,299 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:09:42,308 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:09:42,311 - ispa_next.main - DEBUG - 



2025-11-12 12:09:42,311 - ispa_next.main - DEBUG - starting with process 8 (KLE-GA 313) of 14
2025-11-12 12:09:42,315 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:09:43,628 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:09:44,820 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:09:44,822 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:09:46,244 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:09:46,245 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:10:17,747 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:10:17,756 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 12:10:17,759 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:10:18,169 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:10:18,169 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:10:21,093 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 12:10:21,094 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:10:22,059 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:10:22,068 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:10:22,082 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:10:22,087 - ispa_next.main - DEBUG - 



2025-11-12 12:10:22,087 - ispa_next.main - DEBUG - starting with process 9 (DU-ES 550 E) of 14
2025-11-12 12:10:22,096 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:10:23,317 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:10:24,772 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:10:24,774 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:10:26,132 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:10:26,133 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:10:54,191 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:10:54,199 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 12:10:54,201 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:10:54,510 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:10:54,512 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:10:56,519 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 12:10:56,521 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:10:57,244 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:10:57,256 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:10:57,273 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:10:57,283 - ispa_next.main - DEBUG - 



2025-11-12 12:10:57,283 - ispa_next.main - DEBUG - starting with process 10 (DU-F 7412) of 14
2025-11-12 12:10:57,286 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:10:58,121 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:10:58,866 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:10:58,867 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:11:00,220 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:11:00,221 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:11:21,648 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:11:23,505 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:11:28,566 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:11:29,781 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:11:29,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:29,941 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:11:30,239 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:11:30,241 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:11:30,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:30,376 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:11:36,131 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:11:36,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:11:36,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:11:38,906 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:11:38,998 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:11:39,110 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:11:39,169 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:11:43,355 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:11:44,360 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:11:44,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:44,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:55,781 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:11:59,194 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:11:59,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:59,266 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:11:59,266 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:11:59,324 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:12:00,632 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:12:01,798 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:12:02,130 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:12:03,938 - ispa_next.functions - DEBUG - Updated appointment (AD00012015) customer contact data.
2025-11-12 12:12:04,850 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:12:04,851 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:12:05,527 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:12:05,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:12:06,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:12:09,798 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:12:09,798 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:12:09,801 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:12:09,801 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:12:09,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:12:10,315 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:12:14,448 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:12:14,451 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:12:14,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:12:14,520 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:12:18,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:12:19,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:12:19,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:12:19,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:12:19,865 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:12:21,178 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:12:21,181 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:12:22,134 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:12:22,136 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:12:22,137 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:12:22,138 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:12:22,143 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:12:22,146 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:12:22,149 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:12:22,151 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:12:22,153 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:12:22,154 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:12:22,157 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:12:22,158 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:12:22,158 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:12:23,384 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:12:23,385 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:12:23,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:12:24,626 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:12:24,627 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:12:24,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:12:25,295 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:12:25,632 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:12:34,093 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:12:34,094 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:12:35,295 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:12:45,823 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:12:46,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:12:46,886 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:12:47,029 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:12:52,093 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:12:52,095 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:12:52,096 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:12:52,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:12:52,835 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:12:52,836 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:12:54,509 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:13:01,658 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:13:02,034 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 12:13:02,389 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:13:03,257 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:13:03,258 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:13:06,342 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 12:13:06,342 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:13:07,214 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:13:07,221 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:13:07,230 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:13:07,233 - ispa_next.main - DEBUG - 



2025-11-12 12:13:07,233 - ispa_next.main - DEBUG - starting with process 11 (DU-EF 3450) of 14
2025-11-12 12:13:07,235 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:13:08,417 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:13:09,549 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:13:09,551 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:13:10,753 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:13:10,754 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:13:34,689 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:13:36,744 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:13:41,953 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:13:47,263 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:13:47,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:13:47,354 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:13:47,569 - ispa_next.functions - DEBUG - HU date soon to be invalid in 48 days.
2025-11-12 12:13:51,355 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:13:51,358 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:13:51,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:13:51,415 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:13:57,498 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:13:57,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:13:58,391 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:14:00,396 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:14:00,583 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:14:00,671 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:14:00,772 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:14:02,947 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:14:03,951 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:14:03,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:14:04,430 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:14:16,021 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:14:20,016 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:14:20,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:14:20,102 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:14:20,103 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:14:20,136 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:14:20,267 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:14:21,419 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 12:14:22,629 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 12:14:22,947 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:14:24,778 - ispa_next.functions - DEBUG - Updated appointment (AD00011934) customer contact data.
2025-11-12 12:14:25,693 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:14:25,695 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:14:25,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:14:26,529 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:14:27,535 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:14:27,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:14:27,605 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:14:31,203 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:14:31,203 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:14:31,206 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:14:31,207 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:14:31,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:14:31,711 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:14:35,822 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:14:39,044 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:14:39,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:14:39,147 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:14:39,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:14:40,108 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:14:40,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:14:40,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:14:40,812 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:14:45,544 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:14:45,551 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:14:46,923 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:14:46,926 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:14:46,928 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:14:46,930 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:14:46,933 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:14:46,934 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:14:46,935 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:14:46,936 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:14:46,938 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:14:46,939 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:14:46,941 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:14:46,942 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:14:46,943 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:14:52,300 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 12:14:54,962 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:14:54,964 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:14:54,968 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:15:00,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:15:00,361 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:15:15,693 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:15:15,694 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:15:15,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:15:16,680 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:15:16,889 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:15:32,478 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:15:32,481 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:15:37,793 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:15:49,006 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:15:49,575 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:15:50,090 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:15:50,219 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:15:59,705 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:16:03,589 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:16:06,365 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:16:06,366 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:16:06,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:16:07,040 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:16:07,041 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:16:10,027 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:16:18,092 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:16:18,470 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 12:16:19,657 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:16:20,427 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:16:20,428 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:16:23,813 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 12:16:23,814 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:16:24,469 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:16:24,475 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:16:24,482 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:16:24,484 - ispa_next.main - DEBUG - 



2025-11-12 12:16:24,485 - ispa_next.main - DEBUG - starting with process 12 (DU-WH 3678) of 14
2025-11-12 12:16:24,488 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:16:25,395 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:16:26,259 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:16:26,260 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:16:27,274 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:16:27,276 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:16:50,056 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:16:51,612 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:16:56,179 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:16:57,400 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:16:57,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:16:57,499 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:16:57,680 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:16:57,682 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:16:57,683 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:16:57,759 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:17:01,148 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:17:01,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:17:02,500 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:17:04,502 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:17:04,593 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:17:04,748 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:17:04,813 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:17:04,814 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:17:06,036 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:17:14,441 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:17:15,468 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:17:15,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:17:16,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:17:27,214 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:17:30,911 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:17:30,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:17:30,976 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:17:30,976 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:17:31,038 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:17:32,197 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:17:33,260 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:17:33,482 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:17:35,309 - ispa_next.functions - DEBUG - Updated appointment (AB00016366) customer contact data.
2025-11-12 12:17:36,228 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:17:36,230 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:17:36,702 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:17:36,702 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:17:37,373 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:17:40,982 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:17:40,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:17:41,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:17:43,515 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:17:43,614 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:17:43,733 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:17:43,812 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:17:43,814 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:17:45,092 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:17:53,548 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:18:53,550 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:19:01,837 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:19:50,843 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:19:59,340 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:20:06,950 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 12:20:07,954 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:20:07,955 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:20:07,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:08,105 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:20:12,225 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:20:12,230 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:20:12,230 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:12,291 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:20:21,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:22,336 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:22,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:22,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:20:22,989 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:20:24,290 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:20:24,291 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:20:25,408 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:20:25,409 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:20:25,411 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:20:25,411 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:20:25,413 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:20:25,414 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:20:25,414 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:20:25,416 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:20:25,418 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:20:25,421 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:20:25,427 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:20:25,428 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:20:25,428 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:26,603 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:20:26,617 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:20:26,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:27,806 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:20:27,808 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:20:27,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:20:28,523 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:20:28,559 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:20:28,561 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:29,873 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:20:39,294 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:20:39,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:20:40,252 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:20:40,351 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:46,358 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:20:46,360 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:20:46,361 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:20:46,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:20:47,039 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:20:47,040 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:20:48,868 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:20:55,036 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:20:55,406 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 12:20:55,687 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:20:56,389 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:20:56,390 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:20:58,961 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 12:20:58,962 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:20:59,715 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:20:59,722 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:20:59,731 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:20:59,736 - ispa_next.main - DEBUG - 



2025-11-12 12:20:59,736 - ispa_next.main - DEBUG - starting with process 13 (MH-PI 88) of 14
2025-11-12 12:20:59,740 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:21:00,889 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:21:02,317 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 539
2025-11-12 12:21:02,319 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 12:21:03,591 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:21:03,592 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:21:36,277 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:21:37,774 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:21:42,195 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:44,776 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:21:44,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:21:44,917 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:21:45,099 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:21:45,101 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:21:45,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:21:45,181 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:21:51,449 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:21:51,449 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:21:52,524 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:21:54,528 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:21:54,630 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:21:54,752 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:21:54,832 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:21:59,005 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:22:00,026 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:22:00,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:00,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:09,141 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 12:22:12,481 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:22:12,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:12,570 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:22:12,571 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:22:12,604 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:22:13,845 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:22:14,077 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:22:16,259 - ispa_next.functions - DEBUG - Updated appointment (AD00011951) customer contact data.
2025-11-12 12:22:17,157 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:22:17,158 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:22:17,948 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:22:17,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:22:18,730 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:22:22,293 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:22:22,293 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:22:22,296 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:22:22,297 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:22:22,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:22:22,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:22:26,951 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:22:30,578 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:22:30,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:22:30,675 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:22:31,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:31,578 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:31,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:22:32,296 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:22:32,297 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:22:34,738 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:22:34,741 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:22:35,692 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:22:35,693 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:22:35,695 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:22:35,696 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:22:35,697 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:22:35,700 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:22:35,703 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:22:35,707 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:22:35,709 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:22:35,711 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:22:35,714 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:22:35,715 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:22:35,716 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:22:38,325 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:22:38,326 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:22:38,329 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:22:40,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:22:41,039 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:22:52,774 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:22:52,775 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:22:52,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:22:53,474 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:22:53,657 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:03,403 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:23:03,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:06,023 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:23:17,022 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:23:17,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:23:18,029 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:23:18,162 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:24,542 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:23:29,037 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:23:32,168 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:23:32,169 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:23:32,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:23:32,924 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:23:32,925 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:23:36,003 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:23:43,339 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:23:43,721 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 12:23:44,892 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:23:45,507 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 540
2025-11-12 12:23:45,509 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:23:48,595 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 285
2025-11-12 12:23:48,596 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:23:49,479 - ispa_next.appointments.models - DEBUG - Appointment Frank Rieger DIN-F 102 WBA5F31090FH47663 ohne Termin.
2025-11-12 12:23:49,486 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:23:49,492 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:23:49,501 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
2025-11-12 12:23:49,505 - ispa_next.main - DEBUG - 



2025-11-12 12:23:49,505 - ispa_next.main - DEBUG - starting with process 14 (DU-S 425) of 14
2025-11-12 12:23:49,508 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:23:50,712 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:23:51,892 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 540
2025-11-12 12:23:51,894 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 285
2025-11-12 12:23:53,308 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:23:53,309 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:24:18,456 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:24:20,746 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:24:25,751 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:29,709 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:24:29,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:24:29,787 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:24:30,003 - ispa_next.functions - DEBUG - HU date already expired after 19 days.
2025-11-12 12:24:33,511 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:24:33,512 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:24:33,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:24:33,582 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:24:36,551 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:24:36,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:24:37,613 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:24:39,617 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:24:39,804 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:24:39,900 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:24:39,968 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:24:42,130 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:24:43,133 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:24:43,134 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:24:43,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:24:54,498 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:24:58,643 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:24:58,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:24:58,741 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:24:58,742 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:24:58,798 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:25:00,093 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:25:00,313 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:25:02,149 - ispa_next.functions - DEBUG - Updated appointment (AB00016421) customer contact data.
2025-11-12 12:25:03,098 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:25:03,100 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:25:03,764 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:25:03,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:25:04,595 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:25:08,599 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 12:25:08,599 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:25:08,599 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:25:08,602 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:25:08,602 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:25:08,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:25:09,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:25:13,222 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:25:16,919 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:25:16,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:25:16,992 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:25:26,448 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 12:25:34,754 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-12 12:25:38,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:25:38,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:25:38,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:25:39,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:25:39,523 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:25:43,089 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:25:43,091 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:25:44,150 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:25:44,152 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:25:44,154 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:25:44,155 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:25:44,156 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:25:44,157 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:25:44,158 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:25:44,160 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:25:44,161 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:25:44,162 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:25:44,164 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:25:44,166 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:25:44,167 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:25:48,131 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:25:48,133 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:25:48,138 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:25:52,117 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:25:52,119 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:25:52,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:25:52,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:25:52,952 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:25:59,741 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:25:59,743 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:03,716 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:26:14,130 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:26:14,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:26:15,171 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:26:15,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:23,158 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:26:26,877 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:26:31,113 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:26:33,815 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:26:33,818 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:26:34,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:26:34,358 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:26:34,359 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:26:36,919 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:26:44,530 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:26:44,913 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 12:26:45,713 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:26:46,417 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 540
2025-11-12 12:26:46,418 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:26:49,411 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 285
2025-11-12 12:26:49,411 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:26:50,183 - ispa_next.appointments.models - DEBUG - Appointment Frank Rieger DIN-F 102 WBA5F31090FH47663 ohne Termin.
2025-11-12 12:26:50,190 - ispa_next.appointments.models - DEBUG - Appointment Andreas Wallhorn DU-WA 30 WBAJR31000BU98079 ohne Termin.
2025-11-12 12:26:50,195 - ispa_next.appointments.models - DEBUG - Appointment Estelle Engels DU-EJ 1337 WBA31AA0405V49537 ohne Termin.
2025-11-12 12:26:50,202 - ispa_next.appointments.models - DEBUG - Appointment Emre Yalcin DU-KY 1994 WBAJF31030WW36098 ohne Termin.
