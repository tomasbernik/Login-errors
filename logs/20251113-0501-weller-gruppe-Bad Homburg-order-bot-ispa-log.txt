2025-11-13 05:01:38,331 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-13 05:01:38,338 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-13 05:02:03,392 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-13 05:02:19,001 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-13 05:02:37,297 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-13 05:04:54,923 - ispa_next.app_start.main - DEBUG - Operation already took 123.38 seconds (more than 80 seconds)
2025-11-13 05:04:57,021 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4d626014d3417587\\tess_6hdsxtpb_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4d626014d3417587\\tess_6hdsxtpb', 'txt']
2025-11-13 05:04:59,225 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-13 05:04:59,232 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-13 05:04:59,234 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-13 05:07:03,578 - ispa_next.app_start.main - DEBUG - Operation already took 111.40 seconds (more than 80 seconds)
2025-11-13 05:07:05,691 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4d626014d3417587\\tess_0psx3vvu_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4d626014d3417587\\tess_0psx3vvu', 'txt']
2025-11-13 05:07:06,097 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-13 05:07:06,102 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-13 05:07:10,295 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-13 05:07:22,028 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-13 05:07:32,756 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-13 05:07:48,886 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-13 05:09:51,241 - ispa_next.app_start.main - DEBUG - Operation already took 111.20 seconds (more than 80 seconds)
2025-11-13 05:09:53,333 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4d626014d3417587\\tess_njv2k_8z_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4d626014d3417587\\tess_njv2k_8z', 'txt']
2025-11-13 05:09:53,693 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-13 05:09:53,699 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-13 05:09:53,700 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-13 05:11:57,851 - ispa_next.app_start.main - DEBUG - Operation already took 111.56 seconds (more than 80 seconds)
2025-11-13 05:11:59,989 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4d626014d3417587\\tess_wy62melj_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\4d626014d3417587\\tess_wy62melj', 'txt']
2025-11-13 05:12:00,384 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-13 05:12:00,389 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-13 05:12:04,618 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-13 05:12:15,977 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-13 05:12:28,093 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-13 05:12:44,147 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-13 05:13:31,619 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-13 05:13:49,980 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-13 05:13:55,002 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:13:57,405 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:13:57,406 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-13 05:14:01,145 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 72
2025-11-13 05:14:01,147 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-13 05:14:01,147 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-13 05:14:02,787 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-13 05:14:04,347 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:14:17,825 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:14:17,893 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:14:17,895 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:14:17,908 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:14:17,914 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:14:17,934 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:14:17,935 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:14:17,960 - ispa_next.main - DEBUG - Found 8 out of 58 appointments to process (configured limit: 15).
2025-11-13 05:14:17,960 - ispa_next.main - DEBUG - Processing 8 fresh appointments.
2025-11-13 05:14:17,960 - ispa_next.main - DEBUG - All appointments: HG-K 1151, HG-GM 2708, HG LY 772, F-AS 3777, FMM1233, FB-D 1387, F GF 195, HGXR7777
2025-11-13 05:14:17,963 - ispa_next.main - DEBUG - 



2025-11-13 05:14:17,963 - ispa_next.main - DEBUG - starting with process 1 (HG-K 1151) of 8
2025-11-13 05:14:18,042 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:14:19,685 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:14:21,570 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:14:21,572 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 72
2025-11-13 05:14:24,341 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:14:24,342 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:15:14,093 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:15:26,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:15:26,821 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:15:27,065 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:15:29,148 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:15:29,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:15:29,265 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:15:29,561 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-13 05:15:39,308 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:15:39,312 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:15:42,201 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:15:42,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:15:43,887 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:15:45,893 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:15:46,037 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:15:49,368 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:15:49,474 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:15:49,477 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:15:51,781 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:16:03,775 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-13 05:16:04,782 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:16:04,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:16:05,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:16:10,303 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-13 05:16:10,308 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:16:10,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:16:10,395 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:16:10,396 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:16:10,493 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:16:11,991 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:16:12,579 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:16:17,137 - ispa_next.functions - DEBUG - Updated appointment (AB00036742) customer contact data.
2025-11-13 05:16:18,183 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:16:18,186 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:16:19,523 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:16:19,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:16:20,802 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:16:25,683 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:16:25,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:16:26,600 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:16:28,604 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:16:28,833 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:16:28,962 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:16:29,105 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:16:29,107 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:16:31,324 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:16:43,520 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-13 05:17:43,523 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:17:55,481 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-13 05:18:14,484 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:18:26,631 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-13 05:18:36,334 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-13 05:18:36,335 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:18:40,649 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-13 05:18:44,366 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-13 05:18:48,711 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-13 05:18:49,717 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:18:49,718 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:18:49,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:18:49,906 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:18:54,088 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-13 05:18:55,222 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-13 05:19:15,664 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:19:15,664 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-13 05:19:15,669 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:19:17,802 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:19:17,804 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:19:20,975 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:19:20,977 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:19:20,979 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:19:20,980 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:19:20,983 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-13 05:19:20,984 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-13 05:19:20,986 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:19:20,987 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:19:20,990 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:19:20,992 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:19:20,996 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:19:20,998 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:19:20,999 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:19:23,348 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:19:23,353 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:19:23,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:19:25,517 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:19:25,527 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:19:25,530 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:19:25,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:19:27,740 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:19:58,745 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:19:59,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:20:00,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:20:02,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:20:15,300 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:20:29,533 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:20:29,534 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:20:31,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:20:31,558 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:20:31,559 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:20:44,401 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-13 05:21:10,177 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:21:10,589 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-13 05:21:11,642 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:21:15,170 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:21:15,178 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:21:22,292 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-13 05:21:22,293 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:21:24,438 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:21:24,466 - ispa_next.appointments.models - DEBUG - Appointment Boris Novikov HG-BN 777 WBA11FJ0X0CU26390 ohne Termin.
2025-11-13 05:21:24,478 - ispa_next.main - DEBUG - 



2025-11-13 05:21:24,478 - ispa_next.main - DEBUG - starting with process 2 (HG-GM 2708) of 8
2025-11-13 05:21:24,483 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:21:27,677 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:21:30,944 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:21:30,947 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-13 05:21:34,638 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:21:34,640 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:22:11,605 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:22:30,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:22:30,861 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:22:31,196 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:22:33,364 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:22:33,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:22:33,610 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:22:34,227 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-13 05:22:49,625 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:22:49,630 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:22:53,035 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:22:53,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:22:55,939 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:22:57,942 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:23:13,790 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-13 05:23:30,417 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-13 05:23:31,426 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:23:31,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:23:32,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:23:41,339 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-13 05:23:41,344 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:23:41,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:23:41,561 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:23:41,562 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:23:41,672 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:23:42,000 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-13 05:23:43,904 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:23:44,323 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:23:49,416 - ispa_next.functions - DEBUG - Updated appointment (AB00036743) customer contact data.
2025-11-13 05:23:50,585 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:23:50,608 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:23:50,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:23:52,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:23:55,313 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:23:55,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:23:55,554 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-13 05:23:59,788 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-13 05:23:59,789 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:23:59,789 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-13 05:23:59,792 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:23:59,793 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:23:59,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:24:00,593 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:24:04,912 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-13 05:24:04,917 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:24:04,917 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-13 05:24:04,918 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:24:07,118 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:24:07,120 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:24:09,879 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:24:09,881 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:24:09,883 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:24:09,884 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:24:09,886 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-13 05:24:09,888 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-13 05:24:09,889 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:24:09,890 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:24:09,892 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:24:09,894 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:24:09,898 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:24:09,901 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:24:09,902 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:24:12,224 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:24:12,232 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:24:12,237 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:24:14,556 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:24:14,562 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:24:14,571 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:24:14,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:24:16,759 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:24:51,541 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:24:52,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:24:54,176 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:24:54,782 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:25:10,142 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:25:23,895 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:25:23,896 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:25:25,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:25:25,913 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:25:25,915 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:25:38,726 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-13 05:26:00,939 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:26:01,418 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-13 05:26:02,517 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:26:06,360 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:26:06,363 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:26:13,751 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-13 05:26:13,752 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:26:16,164 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:26:16,177 - ispa_next.appointments.models - DEBUG - Appointment Boris Novikov HG-BN 777 WBA11FJ0X0CU26390 ohne Termin.
2025-11-13 05:26:16,183 - ispa_next.main - DEBUG - 



2025-11-13 05:26:16,183 - ispa_next.main - DEBUG - starting with process 3 (HG LY 772) of 8
2025-11-13 05:26:16,189 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:26:19,136 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:26:22,705 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:26:22,707 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-13 05:26:26,731 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:26:26,733 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:27:17,563 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-13 05:27:18,715 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-13 05:27:18,722 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:27:20,808 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:27:20,819 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:27:28,326 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-13 05:27:28,327 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:27:30,701 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:27:30,719 - ispa_next.appointments.models - DEBUG - Appointment Boris Novikov HG-BN 777 WBA11FJ0X0CU26390 ohne Termin.
2025-11-13 05:27:30,726 - ispa_next.main - DEBUG - 



2025-11-13 05:27:30,726 - ispa_next.main - DEBUG - starting with process 4 (F-AS 3777) of 8
2025-11-13 05:27:30,730 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:27:34,143 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:27:37,580 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:27:37,582 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-13 05:27:41,726 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:27:41,728 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:28:32,603 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-13 05:28:32,616 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-13 05:28:32,621 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:28:34,401 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:28:34,442 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:28:41,729 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-13 05:28:41,730 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:28:43,705 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:28:43,718 - ispa_next.appointments.models - DEBUG - Appointment Boris Novikov HG-BN 777 WBA11FJ0X0CU26390 ohne Termin.
2025-11-13 05:28:43,724 - ispa_next.main - DEBUG - 



2025-11-13 05:28:43,724 - ispa_next.main - DEBUG - starting with process 5 (FMM1233) of 8
2025-11-13 05:28:43,728 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:28:46,765 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:28:50,407 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:28:50,409 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-13 05:28:54,356 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:28:54,358 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:29:42,603 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-13 05:29:42,616 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-13 05:29:42,620 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:29:44,154 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:29:44,157 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:29:51,334 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-13 05:29:51,335 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:29:53,392 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:29:53,404 - ispa_next.appointments.models - DEBUG - Appointment Boris Novikov HG-BN 777 WBA11FJ0X0CU26390 ohne Termin.
2025-11-13 05:29:53,413 - ispa_next.main - DEBUG - 



2025-11-13 05:29:53,413 - ispa_next.main - DEBUG - starting with process 6 (FB-D 1387) of 8
2025-11-13 05:29:53,419 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:29:56,391 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:29:59,904 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:29:59,906 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-13 05:30:04,614 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:30:04,691 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:31:05,265 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:31:25,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:31:31,522 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:31:31,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:31:31,654 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:31:32,362 - ispa_next.functions - DEBUG - HU date already expired after 347 days.
2025-11-13 05:31:48,177 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:31:48,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:31:48,350 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:31:59,789 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:32:03,623 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:32:03,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:32:05,696 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:32:07,700 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:32:08,014 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:32:11,512 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-13 05:32:28,986 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-13 05:32:29,992 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:32:29,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:32:30,600 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:32:52,005 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-13 05:33:08,771 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:33:08,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:33:08,957 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:33:08,959 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:33:09,055 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:33:11,130 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:33:11,555 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:33:14,764 - ispa_next.functions - DEBUG - Updated appointment (AB00036619) customer contact data.
2025-11-13 05:33:16,039 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:33:16,106 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:33:18,624 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:33:18,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:33:20,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:33:23,903 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:33:23,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:33:24,472 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:33:26,476 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:33:26,764 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:33:27,000 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:33:27,198 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:33:27,219 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:33:33,552 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:33:47,452 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-13 05:34:05,456 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:34:19,787 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-13 05:34:37,672 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-13 05:34:38,678 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:34:38,680 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:34:38,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:34:38,831 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:34:43,190 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-13 05:34:43,197 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:34:43,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:34:43,407 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:34:43,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:34:44,573 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:34:44,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:34:46,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:34:46,010 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:34:47,739 - ispa_next.package_manager.helper - DEBUG - couldn't retrieve pakage name in cart
2025-11-13 05:34:48,209 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 262, in run
    self._update_cart_content()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 36, in _update_cart_content
    self.containers[Container.CART] = self.ui_helper.get_cart_content(self.base_element)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 141, in get_cart_content
    name=cart_package_name,
         ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'cart_package_name' where it is not associated with a value

2025-11-13 05:34:48,242 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:34:48,247 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:34:50,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:34:51,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:34:51,982 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-13 05:34:52,036 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-13 05:35:00,480 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-13 05:35:00,488 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:35:01,995 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:35:01,998 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:35:11,458 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-13 05:35:11,460 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:35:13,672 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:35:13,690 - ispa_next.appointments.models - DEBUG - Appointment Boris Novikov HG-BN 777 WBA11FJ0X0CU26390 ohne Termin.
2025-11-13 05:35:13,700 - ispa_next.main - DEBUG - 



2025-11-13 05:35:13,700 - ispa_next.main - DEBUG - starting with process 7 (F GF 195) of 8
2025-11-13 05:35:13,705 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:35:16,650 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:35:20,141 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:35:20,143 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-13 05:35:24,132 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:35:24,134 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:36:15,268 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-13 05:36:15,282 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-13 05:36:15,287 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:36:16,769 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:36:16,771 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:36:23,903 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-13 05:36:23,905 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:36:26,350 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:36:26,362 - ispa_next.appointments.models - DEBUG - Appointment Boris Novikov HG-BN 777 WBA11FJ0X0CU26390 ohne Termin.
2025-11-13 05:36:26,371 - ispa_next.main - DEBUG - 



2025-11-13 05:36:26,371 - ispa_next.main - DEBUG - starting with process 8 (HGXR7777) of 8
2025-11-13 05:36:26,376 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:36:29,734 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:36:33,395 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:36:33,425 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-13 05:36:37,486 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:36:37,488 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:37:34,741 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-13 05:37:34,757 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-13 05:37:34,761 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:37:36,334 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1048
2025-11-13 05:37:36,336 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:37:43,495 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-13 05:37:43,496 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:37:45,620 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:37:45,637 - ispa_next.appointments.models - DEBUG - Appointment Boris Novikov HG-BN 777 WBA11FJ0X0CU26390 ohne Termin.
