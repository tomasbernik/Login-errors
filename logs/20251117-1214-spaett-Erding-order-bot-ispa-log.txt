2025-11-17 12:28:46,786 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 12:28:46,793 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 12:28:53,565 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 12:29:06,551 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 12:29:22,728 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 12:29:48,345 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 12:30:00,685 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 12:30:04,651 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:30:05,839 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 511
2025-11-17 12:30:05,841 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 347
2025-11-17 12:30:07,882 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 326
2025-11-17 12:30:07,883 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 12:30:07,883 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:30:08,747 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:30:10,233 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:30:52,191 - ispa_next.appointments.models - DEBUG - Appointment Giovanni Ciconti ED-GC 1000 WBA31BN070CL81257 ohne Termin.
2025-11-17 12:30:52,220 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-17 12:30:52,233 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:30:52,257 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:30:52,269 - ispa_next.appointments.models - DEBUG - Appointment Bogdan-Laurentiu Turcu ED-BT 315 WBA5U91000FK31617 ohne Termin.
2025-11-17 12:30:52,280 - ispa_next.appointments.models - DEBUG - Appointment Ute Mätzig M-U 7573 WBA81GE0007T32557 ohne Termin.
2025-11-17 12:30:52,289 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Miotorenwerke Akti M-NK 3548 WBA15GR030N352507 ohne Termin.
2025-11-17 12:30:52,298 - ispa_next.appointments.models - DEBUG - Appointment Rainer Kollenda ED-XX 24 WBAMT11020C298608 ohne Termin.
2025-11-17 12:30:52,308 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-17 12:30:52,318 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-17 12:30:52,331 - ispa_next.appointments.models - DEBUG - Appointment Fitim Kucani ED-FF 2723 WBAUE11050PZ54416 ohne Termin.
2025-11-17 12:30:52,332 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:30:52,345 - ispa_next.appointments.models - DEBUG - Appointment Daniel Raphael ED-RD 212 WBA6T510607D45067 ohne Termin.
2025-11-17 12:30:52,358 - ispa_next.appointments.models - DEBUG - Appointment Firma Bucher Hydraulics Erding GmbH ED-BH 186 WBA5V7105LFH57377 ohne Termin.
2025-11-17 12:30:52,370 - ispa_next.appointments.models - DEBUG - Appointment Katerina Werner M-W 7091 WBA11EV0809V62969 ohne Termin.
2025-11-17 12:30:52,387 - ispa_next.appointments.models - DEBUG - Appointment Benedikt Friedl ED-SE 225 WBA61CA0X09V93186 ohne Termin.
2025-11-17 12:30:52,397 - ispa_next.appointments.models - DEBUG - Appointment Harald Kümmet ED-H 110 WMWSS91020WN99113 ohne Termin.
2025-11-17 12:30:52,403 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:30:52,420 - ispa_next.appointments.models - DEBUG - Appointment Thomas Ralf Olaf Buer ED-B 880 5UXWX7C54EL983484 ohne Termin.
2025-11-17 12:30:52,442 - ispa_next.appointments.models - DEBUG - Appointment Alen Halidowicz ED-HA 910 WBA6E41080G692725 ohne Termin.
2025-11-17 12:30:52,455 - ispa_next.appointments.models - DEBUG - Appointment Martina Bauer ED-Z 1988 WBADS41020GU95176 ohne Termin.
2025-11-17 12:30:52,467 - ispa_next.appointments.models - DEBUG - Appointment Ludwig Schönhuber FS-M 2909 WBAHF31040WX45135 ohne Termin.
2025-11-17 12:30:52,478 - ispa_next.appointments.models - DEBUG - Appointment Alois Obermaier ED-AO 67 WBA35BG040N074618 ohne Termin.
2025-11-17 12:30:52,488 - ispa_next.appointments.models - DEBUG - Appointment Karl-Heinz Baris ED-JA 828 WBA8J91020A190670 ohne Termin.
2025-11-17 12:30:52,498 - ispa_next.appointments.models - DEBUG - Appointment Rainer Wieder FS-RW 606 WBAJP310X0CD36205 ohne Termin.
2025-11-17 12:30:52,509 - ispa_next.appointments.models - DEBUG - Appointment Firma Büro der Fachärzte ED-BF 811 WBAPY71050C023350 ohne Termin.
2025-11-17 12:30:52,523 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Wildried Rademann ED-JR 900 WBAJP31030BT83692 ohne Termin.
2025-11-17 12:30:52,532 - ispa_next.appointments.models - DEBUG - Appointment Markus Christian Geyer M-CG 3388 WBA3Z910X0D367242 ohne Termin.
2025-11-17 12:30:52,542 - ispa_next.appointments.models - DEBUG - Appointment Levente Gergely ED-GL 71 WBA4X31050AA80192 ohne Termin.
2025-11-17 12:30:52,552 - ispa_next.appointments.models - DEBUG - Appointment Markus Kerndlbacher ED-MK 135 WBAUC71000VE99305 ohne Termin.
2025-11-17 12:30:52,561 - ispa_next.appointments.models - DEBUG - Appointment Firma VR-Bank Erding eG ED-VR 530 WBA5D31040GV81033 ohne Termin.
2025-11-17 12:30:52,574 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Scheid ED-P 1307 WBATX35020NC37837 ohne Termin.
2025-11-17 12:30:52,585 - ispa_next.appointments.models - DEBUG - Appointment Jakob Angermaier ED-AJ 44 WBAHS910105F51976 ohne Termin.
2025-11-17 12:30:52,596 - ispa_next.appointments.models - DEBUG - Appointment Almperto Kyriazis ED-AK 1994 WBA1A11020J903022 ohne Termin.
2025-11-17 12:30:52,607 - ispa_next.appointments.models - DEBUG - Appointment Firma Cleaning Express Gebäudedienst ED-BS 887 WBA41BX0707N24573 ohne Termin.
2025-11-17 12:30:52,628 - ispa_next.appointments.models - DEBUG - Appointment Bianca-Viviana Huber FS-H 162 E WBY8P210507H82040 ohne Termin.
2025-11-17 12:30:52,638 - ispa_next.appointments.models - DEBUG - Appointment Katharina Eichinger ED-LE 236 WMW11BR0903N74463 ohne Termin.
2025-11-17 12:30:52,648 - ispa_next.appointments.models - DEBUG - Appointment Firma BayWa Aktiengesellschaft M-GH 7766 WBA15BZ000N166569 ohne Termin.
2025-11-17 12:30:52,658 - ispa_next.appointments.models - DEBUG - Appointment Firma Privatbr. ERDINGER Weißbräu ED-EW 332 WBA41EG0005X82947 ohne Termin.
2025-11-17 12:30:52,658 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:30:52,668 - ispa_next.appointments.models - DEBUG - Appointment Carmen Berndt ED-CP 1725 WBAYN110X05T94356 ohne Termin.
2025-11-17 12:30:52,678 - ispa_next.appointments.models - DEBUG - Appointment Luigi Fazio  WBAKS410500C30478 ohne Termin.
2025-11-17 12:30:52,689 - ispa_next.appointments.models - DEBUG - Appointment Zhensheng Guo ED-SG 8888 WBA5L31030G122160 ohne Termin.
2025-11-17 12:30:52,699 - ispa_next.appointments.models - DEBUG - Appointment Christine Ertel ED-C 1272 WMW31DH0802W00594 ohne Termin.
2025-11-17 12:30:52,711 - ispa_next.appointments.models - DEBUG - Appointment Daniel Franke LA-EB 308 WBA1V71070V616601 ohne Termin.
2025-11-17 12:30:52,721 - ispa_next.appointments.models - DEBUG - Appointment Paul Valerian Mona MM 23 MON WBA5E51090G100007 ohne Termin.
2025-11-17 12:30:52,730 - ispa_next.appointments.models - DEBUG - Appointment Firma Lear Corporation GmbH GG-LC 292E WBA81CY000FS44344 ohne Termin.
2025-11-17 12:30:52,749 - ispa_next.main - DEBUG - Found 1 out of 124 appointments to process (configured limit: 20).
2025-11-17 12:30:52,749 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-17 12:30:52,749 - ispa_next.main - DEBUG - All appointments: ED-MM 12
2025-11-17 12:30:52,751 - ispa_next.main - DEBUG - 



2025-11-17 12:30:52,751 - ispa_next.main - DEBUG - starting with process 1 (ED-MM 12) of 1
2025-11-17 12:30:52,755 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:30:53,544 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:30:54,406 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 511
2025-11-17 12:30:54,407 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 326
2025-11-17 12:30:55,491 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:30:55,492 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:31:22,643 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:31:31,435 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:31:32,669 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:31:32,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:31:32,753 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:31:32,942 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 12:31:38,982 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:31:38,985 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:31:41,640 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:31:41,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:31:42,577 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:31:44,580 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:31:44,699 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:31:47,889 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:31:47,953 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:31:47,954 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:31:59,469 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:32:00,474 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:32:00,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:32:00,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:32:14,095 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 12:32:21,716 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:32:21,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:32:21,804 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:32:21,805 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:32:21,874 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:32:23,139 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:32:23,369 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:32:26,144 - ispa_next.functions - DEBUG - Updated appointment (AA00022375) customer contact data.
2025-11-17 12:32:27,061 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:32:27,086 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:32:27,913 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:32:27,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:32:28,640 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:32:32,258 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:32:32,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:32:32,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:32:34,756 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:32:34,870 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:32:34,950 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:32:35,030 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:32:35,031 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:32:46,424 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:33:46,428 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:33:57,719 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:34:04,881 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:34:04,881 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:34:09,064 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:34:10,073 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:34:10,077 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:34:10,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:34:10,146 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:34:10,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:11,083 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:11,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:34:11,800 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:34:11,801 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:34:13,163 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:34:13,168 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:34:14,128 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:34:14,129 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:34:14,130 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:34:14,136 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:34:14,139 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:34:14,142 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:34:14,146 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:34:14,147 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:34:14,148 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:34:14,150 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:34:14,153 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:34:14,155 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:34:14,156 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:34:15,367 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:34:15,370 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:34:15,372 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:34:16,596 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:34:16,598 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:34:16,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:34:17,357 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:34:17,557 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:34:20,209 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:34:20,211 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:34:21,479 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:34:32,486 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:34:32,964 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:34:33,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:34:33,623 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:34:45,105 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:34:45,108 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:34:45,109 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:34:45,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:34:45,818 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:34:45,820 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:34:47,667 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:34:58,365 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:34:58,744 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 12:34:59,085 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:35:00,909 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 512
2025-11-17 12:35:00,910 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:35:03,836 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 348
2025-11-17 12:35:03,837 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:35:04,687 - ispa_next.appointments.models - DEBUG - Appointment Marion Wachinger ED-DB 345 WBA1R510007A42195 ohne Termin.
