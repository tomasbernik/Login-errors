2025-11-12 07:00:33,400 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 07:00:33,405 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 07:00:43,966 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:00:59,362 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:01:14,920 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:03:12,546 - ispa_next.app_start.main - DEBUG - Operation already took 106.37 seconds (more than 80 seconds)
2025-11-12 07:03:14,625 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess_rbjhxaz0_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess_rbjhxaz0', 'txt']
2025-11-12 07:03:14,934 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:03:14,938 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:03:14,938 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:05:13,901 - ispa_next.app_start.main - DEBUG - Operation already took 106.66 seconds (more than 80 seconds)
2025-11-12 07:05:15,966 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess__rzgq8ik_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess__rzgq8ik', 'txt']
2025-11-12 07:05:16,178 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:05:16,182 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:05:22,374 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 07:05:31,243 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:05:41,584 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:05:57,199 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:07:54,559 - ispa_next.app_start.main - DEBUG - Operation already took 106.28 seconds (more than 80 seconds)
2025-11-12 07:07:56,620 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess_g29nh21k_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess_g29nh21k', 'txt']
2025-11-12 07:07:56,866 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:07:56,870 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:07:56,871 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:09:55,933 - ispa_next.app_start.main - DEBUG - Operation already took 106.77 seconds (more than 80 seconds)
2025-11-12 07:09:57,996 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess_1nsp6851_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess_1nsp6851', 'txt']
2025-11-12 07:09:58,236 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:09:58,241 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:10:04,189 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 07:10:12,760 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:10:23,205 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:10:38,795 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:12:36,351 - ispa_next.app_start.main - DEBUG - Operation already took 106.43 seconds (more than 80 seconds)
2025-11-12 07:12:38,432 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess_3ztjovic_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess_3ztjovic', 'txt']
2025-11-12 07:12:38,657 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:12:38,661 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:12:38,661 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:14:37,311 - ispa_next.app_start.main - DEBUG - Operation already took 106.40 seconds (more than 80 seconds)
2025-11-12 07:14:39,405 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess_469f15kg_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess_469f15kg', 'txt']
2025-11-12 07:14:39,652 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:14:39,657 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:14:45,678 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-12 07:14:54,525 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:15:04,781 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:15:20,348 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:17:18,085 - ispa_next.app_start.main - DEBUG - Operation already took 106.68 seconds (more than 80 seconds)
2025-11-12 07:17:20,149 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess_bf9_rv5k_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\92e160b8f5ecdc0b\\tess_bf9_rv5k', 'txt']
2025-11-12 07:17:20,381 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:17:20,389 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:17:20,391 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:17:47,942 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 07:17:58,980 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 07:18:02,075 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:18:02,977 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:18:02,978 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:18:04,847 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 161
2025-11-12 07:18:04,848 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 07:18:04,848 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:18:05,690 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:18:06,530 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:18:28,988 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:18:28,998 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:18:29,010 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:18:29,055 - ispa_next.appointments.models - DEBUG - Appointment Ulrich Franz WW-SC 91 WBA5V71020FH87156 ohne Termin.
2025-11-12 07:18:29,091 - ispa_next.appointments.models - DEBUG - Appointment Firma AKC Angersbach & Kaiser  WBA65GP080N366928 ohne Termin.
2025-11-12 07:18:29,105 - ispa_next.appointments.models - DEBUG - Appointment   WBA11GV080CW64111 ohne Termin.
2025-11-12 07:18:29,114 - ispa_next.appointments.models - DEBUG - Appointment Marcel Werner Hohmann FD-MH 1306 WBAJN71050BS67908 ohne Termin.
2025-11-12 07:18:29,121 - ispa_next.appointments.models - DEBUG - Appointment   WBA32EE0805469799 ohne Termin.
2025-11-12 07:18:29,130 - ispa_next.appointments.models - DEBUG - Appointment Dino Keshishi HU-MD 1991 WBA8T31040GB33829 ohne Termin.
2025-11-12 07:18:29,136 - ispa_next.appointments.models - DEBUG - Appointment Edat Bayram GN-XM 1996 WBA7C41070BR92361 ohne Termin.
2025-11-12 07:18:29,145 - ispa_next.appointments.models - DEBUG - Appointment Firma MARL Seafood GmbH OF-AL 4545 WBA41EU0609Z08046 ohne Termin.
2025-11-12 07:18:29,184 - ispa_next.main - DEBUG - Found 15 out of 137 appointments to process (configured limit: 15).
2025-11-12 07:18:29,184 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-12 07:18:29,185 - ispa_next.main - DEBUG - Processing 0 already visited appointments (w/ RKR not callable).
2025-11-12 07:18:29,185 - ispa_next.main - DEBUG - All appointments: BÜD XP 42, FCG1203, HEF-TT 369, M-FB 6992, MKK-RR 51 E, FB-RM 411, HU-SU 2014, HU-AS 262, F-CA 525, HN FL 983, HU LJ 3118, HG-PL 4219, GN-A 713, BIR-F 196, HU-RM 109
2025-11-12 07:18:29,187 - ispa_next.main - DEBUG - 



2025-11-12 07:18:29,187 - ispa_next.main - DEBUG - starting with process 1 (BÜD XP 42) of 15
2025-11-12 07:18:29,192 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:18:30,168 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:18:31,398 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:18:31,400 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 161
2025-11-12 07:18:32,804 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:18:32,805 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:19:08,586 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:19:08,686 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 07:19:08,692 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:19:09,197 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:19:09,198 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:19:11,302 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:19:11,303 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:19:12,115 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:19:12,134 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:19:12,144 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:19:12,151 - ispa_next.main - DEBUG - 



2025-11-12 07:19:12,151 - ispa_next.main - DEBUG - starting with process 2 (FCG1203) of 15
2025-11-12 07:19:12,155 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:19:13,261 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:19:14,368 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:19:14,369 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:19:15,599 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:19:15,600 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:19:46,591 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:19:46,602 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 07:19:46,606 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:19:47,147 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:19:47,148 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:19:49,227 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:19:49,227 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:19:49,873 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:19:49,901 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:19:49,917 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:19:49,927 - ispa_next.main - DEBUG - 



2025-11-12 07:19:49,927 - ispa_next.main - DEBUG - starting with process 3 (HEF-TT 369) of 15
2025-11-12 07:19:49,932 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:19:51,141 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:19:52,306 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:19:52,307 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:19:53,768 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:19:53,769 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:20:18,559 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:20:21,804 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:20:26,354 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:20:26,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:26,427 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:20:26,691 - ispa_next.functions - DEBUG - HU date already expired after 747 days.
2025-11-12 07:20:30,081 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:20:30,083 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:20:30,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:30,142 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:20:36,991 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:20:36,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:20:38,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:20:40,014 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:20:40,140 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:20:40,278 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:20:40,376 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:20:44,533 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:20:45,540 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:20:45,546 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:20:45,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:46,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:46,033 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:20:46,104 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:20:47,311 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:20:48,506 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:20:48,768 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:20:50,507 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:20:50,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:50,583 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:20:50,802 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 07:20:50,804 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:20:51,583 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:20:51,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:20:52,341 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:20:56,374 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:20:56,374 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:20:56,378 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:20:56,378 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:20:56,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:20:56,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:21:01,007 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:21:01,013 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:21:01,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:21:01,106 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:21:01,468 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:21:01,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:21:01,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:21:02,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:21:02,518 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:21:06,622 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:21:06,624 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:21:07,445 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:21:07,450 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:21:07,458 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:21:07,462 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:21:07,463 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:21:07,465 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:21:07,467 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:21:07,469 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:21:07,471 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:21:07,473 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:21:07,487 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:21:07,489 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:21:07,491 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:12,114 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 07:21:14,391 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:21:14,395 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:21:14,413 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:19,072 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:21:19,138 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:21:31,299 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:21:31,301 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:21:31,302 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:21:31,306 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:35,970 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:21:35,972 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:21:36,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:21:37,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:21:37,436 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:22:16,217 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:22:20,874 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:22:25,207 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:22:29,275 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:22:33,582 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:22:33,586 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:22:33,586 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:22:34,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:22:34,329 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:22:34,333 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:22:36,316 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:22:47,245 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:22:47,652 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 07:22:48,616 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:49,286 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:22:49,287 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:22:51,807 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:22:51,808 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:22:52,589 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:22:52,602 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:22:52,612 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:22:52,618 - ispa_next.main - DEBUG - 



2025-11-12 07:22:52,618 - ispa_next.main - DEBUG - starting with process 4 (M-FB 6992) of 15
2025-11-12 07:22:52,622 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:22:53,703 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:54,534 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:22:54,536 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:22:55,745 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:22:55,747 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:23:24,090 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:23:27,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:29,675 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:23:29,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:29,754 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:23:29,919 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 07:23:33,015 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:23:33,017 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:23:33,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:33,092 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:23:35,982 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:23:35,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:23:36,987 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:23:38,991 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:23:39,117 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:23:39,188 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:23:39,243 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:23:39,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:41,914 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:23:50,389 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:23:51,394 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:23:51,398 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:23:51,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:51,919 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:51,920 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:23:51,975 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:23:52,075 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:23:53,169 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 07:23:54,406 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 07:23:54,725 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:23:56,387 - ispa_next.functions - DEBUG - Updated appointment (AZ00002280) customer contact data.
2025-11-12 07:23:57,311 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:23:57,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:57,401 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:23:57,549 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 07:23:57,553 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:23:57,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:23:58,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:23:59,308 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:23:59,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:23:59,381 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:24:03,354 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:24:03,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:24:03,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:24:05,835 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:24:05,940 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:24:06,031 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:24:06,097 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:24:06,099 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:08,667 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:24:16,732 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:25:16,733 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:25:24,952 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:26:24,954 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:26:33,061 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:26:36,556 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 07:26:37,563 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:26:37,564 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:26:37,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:37,691 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:26:41,814 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:26:41,818 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:26:41,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:41,941 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:26:47,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:47,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:47,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:48,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:26:48,584 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:26:51,084 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:26:51,086 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:26:52,142 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:26:52,143 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:26:52,144 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:26:52,144 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:26:52,146 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:26:52,146 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:26:52,148 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:26:52,150 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:26:52,150 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:26:52,152 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:26:52,154 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:26:52,158 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:26:52,158 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:54,757 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:26:54,759 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:26:54,763 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:57,371 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:26:57,374 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:26:57,376 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:26:57,378 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:59,959 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:26:59,963 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:27:00,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:27:01,421 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:27:01,595 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:27:26,036 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:27:29,292 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:27:33,106 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:27:33,108 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:27:33,108 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:27:33,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:27:33,602 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:27:33,604 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:27:34,988 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:27:41,167 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:27:41,587 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 07:27:42,283 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:27:42,754 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:27:42,755 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:27:45,155 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:27:45,155 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:27:45,770 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:27:45,781 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:27:45,791 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:27:45,797 - ispa_next.main - DEBUG - 



2025-11-12 07:27:45,797 - ispa_next.main - DEBUG - starting with process 5 (MKK-RR 51 E) of 15
2025-11-12 07:27:45,802 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:27:46,670 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:27:47,443 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:27:47,444 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:27:48,680 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:27:48,681 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:28:09,737 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:28:12,730 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:15,335 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:28:15,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:15,424 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:28:15,620 - ispa_next.functions - DEBUG - HU date already expired after 12 days.
2025-11-12 07:28:19,471 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:28:19,474 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:28:19,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:19,546 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:28:22,485 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:28:22,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:23,423 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:25,426 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:28:25,541 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:28:25,624 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:28:25,722 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:28:29,874 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:28:30,879 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:28:30,885 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:28:30,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:31,354 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:31,355 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:28:31,400 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:28:32,683 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:28:32,906 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:28:34,550 - ispa_next.functions - DEBUG - Updated appointment (AA00029962) customer contact data.
2025-11-12 07:28:35,463 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:28:35,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:35,548 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:28:35,721 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 07:28:35,723 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:28:36,449 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:28:36,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:28:37,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:28:40,817 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:28:40,818 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:28:40,821 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:28:40,822 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:28:40,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:41,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:45,442 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:28:48,806 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:28:48,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:48,908 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:28:52,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:52,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:52,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:53,585 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:53,586 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:28:56,016 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:28:56,018 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:28:57,289 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:28:57,290 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:28:57,291 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:28:57,292 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:28:57,293 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:28:57,294 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:28:57,295 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:28:57,296 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:28:57,297 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:28:57,302 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:28:57,304 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:28:57,304 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:59,881 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 07:29:02,054 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:29:02,060 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:29:02,076 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:04,680 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:29:04,682 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:29:04,686 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:29:04,688 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:07,214 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:29:07,216 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:29:07,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:29:08,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:29:08,659 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:27,744 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:29:31,719 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:29:31,722 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:29:31,722 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:29:32,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:29:32,249 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:29:32,251 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:29:33,756 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:29:40,549 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:29:40,961 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 07:29:41,756 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:29:42,293 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:29:42,293 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:29:45,313 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:29:45,314 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:29:46,047 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:29:46,069 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:29:46,078 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:29:46,086 - ispa_next.main - DEBUG - 



2025-11-12 07:29:46,086 - ispa_next.main - DEBUG - starting with process 6 (FB-RM 411) of 15
2025-11-12 07:29:46,089 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:29:46,979 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:29:48,182 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:29:48,184 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:29:49,604 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:29:49,605 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:30:14,268 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:30:17,328 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:20,565 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:30:20,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:20,638 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:30:20,942 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:30:20,944 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:30:20,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:21,037 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:30:24,121 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:30:24,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:25,118 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:30:27,121 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:30:27,264 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:30:27,346 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:30:27,438 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:30:31,589 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:30:32,596 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:30:32,600 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:30:32,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:33,131 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:33,131 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:30:33,170 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:30:34,369 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:30:35,563 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:30:35,774 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:30:37,449 - ispa_next.functions - DEBUG - Updated appointment (AA00029960) customer contact data.
2025-11-12 07:30:38,368 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:30:38,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:38,453 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:30:40,214 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:30:41,018 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:30:41,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:30:41,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:30:45,348 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:30:45,348 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:30:45,352 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:30:45,352 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:30:45,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:45,822 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:30:49,965 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:30:49,969 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:30:49,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:50,092 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:30:58,776 - ispa_next.wipers - DEBUG - valid contract found: BMW Service Plus
2025-11-12 07:31:08,240 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:31:08,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:08,903 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:08,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:31:09,705 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:31:09,707 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:31:12,678 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:31:12,680 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:31:13,680 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:31:13,680 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:31:13,682 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:31:13,684 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:31:13,684 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:31:13,686 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:31:13,686 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:31:13,688 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:31:13,688 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:31:13,698 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:31:13,703 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:31:13,705 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:31:13,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:16,972 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:31:16,974 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:31:16,978 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:20,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:31:20,312 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:31:31,594 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:43,809 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:31:43,811 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:31:43,813 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:31:43,815 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:47,097 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:31:47,099 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:31:48,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:31:49,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:31:49,420 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:32:20,929 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:32:26,355 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:32:30,780 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:32:35,560 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:32:35,564 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:32:35,565 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:32:36,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:32:36,305 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:32:36,307 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:32:38,191 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:32:45,206 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:32:45,585 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 07:32:46,671 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:32:47,272 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:32:47,274 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:32:49,860 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:32:49,861 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:32:50,770 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:32:50,784 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:32:50,795 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:32:50,801 - ispa_next.main - DEBUG - 



2025-11-12 07:32:50,801 - ispa_next.main - DEBUG - starting with process 7 (HU-SU 2014) of 15
2025-11-12 07:32:50,805 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:32:51,958 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:32:53,135 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:32:53,136 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:32:54,758 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:32:54,760 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:33:29,719 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:33:32,994 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:36,270 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:33:36,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:36,344 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:33:36,545 - ispa_next.functions - DEBUG - HU date already expired after 16 days.
2025-11-12 07:33:40,106 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:33:40,108 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:33:40,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:40,182 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:33:46,752 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:33:46,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:33:47,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:33:49,999 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:33:50,134 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:33:50,242 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:33:50,352 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:33:54,525 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:33:55,531 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:33:55,537 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:33:55,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:56,025 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:56,027 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:33:56,091 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:33:56,204 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:33:57,405 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:33:57,627 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:33:59,291 - ispa_next.functions - DEBUG - Updated appointment (AT00004939) customer contact data.
2025-11-12 07:34:00,180 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:34:00,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:00,263 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:34:00,416 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 07:34:00,418 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:34:00,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:34:01,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:34:02,107 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:34:02,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:34:02,168 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:34:05,720 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:34:05,720 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:34:05,724 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:34:05,724 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:34:05,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:34:06,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:34:10,401 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:34:13,908 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:34:13,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:34:13,997 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:34:17,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:18,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:18,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:34:18,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:34:18,822 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:34:21,920 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:34:21,922 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:34:23,994 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:34:23,995 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:34:23,996 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:34:23,997 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:34:23,998 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:34:23,998 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:34:24,002 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:34:24,004 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:34:24,006 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:34:24,009 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:34:24,014 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:34:24,016 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:34:24,016 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:27,240 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:34:27,242 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:34:27,243 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:30,391 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:34:30,393 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:34:30,395 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:34:30,397 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:33,670 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:34:33,672 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:34:34,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:34:35,004 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:34:35,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:06,383 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:09,898 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:13,110 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:17,276 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:17,280 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:35:17,281 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:35:17,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:35:18,026 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:35:18,028 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:35:19,630 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:35:27,459 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:35:27,832 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 07:35:28,660 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:35:29,397 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:35:29,398 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:35:32,594 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:35:32,595 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:35:33,395 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:35:33,410 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:35:33,420 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:35:33,427 - ispa_next.main - DEBUG - 



2025-11-12 07:35:33,427 - ispa_next.main - DEBUG - starting with process 8 (HU-AS 262) of 15
2025-11-12 07:35:33,431 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:35:34,596 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:35:35,826 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:35:35,827 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:35:37,140 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:35:37,142 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:36:10,274 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:36:13,398 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:15,324 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:36:15,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:15,400 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:36:15,567 - ispa_next.functions - DEBUG - HU date already expired after 261 days.
2025-11-12 07:36:19,370 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:36:19,372 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:36:19,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:19,466 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:36:25,304 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:36:25,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:26,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:36:28,261 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:36:33,742 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 07:36:37,331 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 07:36:38,336 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:36:38,339 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:36:38,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:38,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:38,850 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:36:38,882 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:36:38,979 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:36:40,096 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:36:40,294 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:36:41,950 - ispa_next.functions - DEBUG - Updated appointment (AG00016916) customer contact data.
2025-11-12 07:36:42,868 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:36:42,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:42,980 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:36:43,111 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 07:36:43,114 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:36:43,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:36:43,913 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:36:44,964 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:36:44,964 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:36:45,039 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:36:49,085 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 07:36:49,085 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:36:49,085 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:36:49,089 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:36:49,089 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:36:49,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:49,610 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:36:53,743 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:36:53,747 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:36:53,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:53,819 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:36:54,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:54,726 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:54,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:55,496 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:36:55,496 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:36:57,329 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:36:57,331 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:36:58,266 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:36:58,269 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:36:58,271 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:36:58,273 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:36:58,275 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:36:58,277 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:36:58,277 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:36:58,299 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:36:58,303 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:36:58,305 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:36:58,307 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:36:58,309 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:36:58,311 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:00,199 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 07:37:02,278 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:37:02,281 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:37:02,283 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:04,149 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:37:04,153 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:37:04,155 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:37:04,161 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:06,053 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:37:06,055 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:37:06,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:37:07,462 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:37:07,601 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:25,525 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:29,234 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:29,236 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:37:29,236 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:37:29,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:37:29,889 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:37:29,892 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:37:31,844 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:37:40,208 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:37:40,581 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 07:37:40,919 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:37:41,902 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:37:41,903 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:37:45,118 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:37:45,118 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:37:45,978 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:37:45,990 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:37:46,026 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:37:46,073 - ispa_next.main - DEBUG - 



2025-11-12 07:37:46,073 - ispa_next.main - DEBUG - starting with process 9 (F-CA 525) of 15
2025-11-12 07:37:46,105 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:37:47,585 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:37:48,858 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:37:48,860 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:37:50,279 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:37:50,280 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:38:14,082 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:38:17,191 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:19,089 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:38:19,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:38:19,164 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:38:19,331 - ispa_next.functions - DEBUG - HU date already expired after 13 days.
2025-11-12 07:38:22,838 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:38:22,840 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:38:22,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:38:22,906 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:38:25,944 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:38:25,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:38:27,081 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:38:29,083 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:38:29,176 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:38:29,300 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:38:29,402 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:38:29,404 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:31,384 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:38:39,894 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:38:40,901 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:38:40,906 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:38:40,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:38:41,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:38:41,401 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:38:41,486 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:38:41,591 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:38:42,706 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:38:42,937 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:38:44,651 - ispa_next.functions - DEBUG - Updated appointment (AV00003233) customer contact data.
2025-11-12 07:38:45,582 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:38:45,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:38:45,693 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:38:45,822 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 07:38:45,825 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:38:45,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:38:46,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:38:47,616 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:38:47,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:38:47,699 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:38:51,278 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:38:51,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:38:51,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:38:53,807 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:38:53,943 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:38:54,037 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:38:54,116 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:38:54,116 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:56,028 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:39:04,405 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:40:04,407 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:40:13,009 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:41:13,012 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:41:21,283 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:41:24,635 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 07:41:25,646 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:41:25,646 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:41:25,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:41:25,711 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:41:29,835 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:41:29,839 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:41:29,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:41:29,921 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:41:35,496 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:36,006 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:36,006 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:41:36,729 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:41:36,729 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:41:38,581 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:41:38,583 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:41:39,991 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:41:39,993 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:41:39,994 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:41:39,996 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:41:40,001 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:41:40,003 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:41:40,005 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:41:40,007 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:41:40,007 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:41:40,009 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:41:40,013 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:41:40,015 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:41:40,015 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:41,931 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:41:41,933 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:41:41,939 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:43,777 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:41:43,779 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:41:43,781 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:41:43,785 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:45,657 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:41:45,659 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:41:46,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:41:47,244 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:41:47,369 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:05,073 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:42:09,950 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:42:09,952 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:42:09,952 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:42:10,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:42:10,627 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:42:10,629 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:42:12,401 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:42:19,849 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:42:20,234 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 07:42:20,859 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:42:21,512 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:42:21,513 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:42:24,645 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:42:24,646 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:42:25,529 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:42:25,542 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:42:25,553 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:42:25,560 - ispa_next.main - DEBUG - 



2025-11-12 07:42:25,560 - ispa_next.main - DEBUG - starting with process 10 (HN FL 983) of 15
2025-11-12 07:42:25,564 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:42:26,807 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:42:28,151 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:42:28,152 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:42:29,723 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:42:29,725 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:43:01,597 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:43:01,607 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 07:43:01,615 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:43:02,198 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:43:02,199 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:43:04,665 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:43:04,666 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:43:05,487 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:43:05,498 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:43:05,507 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:43:05,521 - ispa_next.main - DEBUG - 



2025-11-12 07:43:05,521 - ispa_next.main - DEBUG - starting with process 11 (HU LJ 3118) of 15
2025-11-12 07:43:05,525 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:43:06,412 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:43:07,287 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:43:07,288 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:43:08,572 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:43:08,573 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:43:42,288 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:43:42,298 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 07:43:42,302 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:43:42,814 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:43:42,814 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:43:45,301 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:43:45,302 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:43:46,101 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:43:46,113 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:43:46,123 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:43:46,141 - ispa_next.main - DEBUG - 



2025-11-12 07:43:46,141 - ispa_next.main - DEBUG - starting with process 12 (HG-PL 4219) of 15
2025-11-12 07:43:46,145 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:43:47,215 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:43:48,473 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:43:48,475 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:43:49,869 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:43:49,870 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:44:15,760 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:44:18,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:44:23,560 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:44:23,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:23,675 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:44:23,938 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:44:23,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:24,033 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:44:28,807 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:44:28,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:28,871 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:44:31,944 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:44:31,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:44:33,036 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:44:35,039 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:44:35,149 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:44:35,259 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:44:35,336 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:44:39,489 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:44:40,495 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:44:40,501 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:44:40,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:40,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:40,977 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:44:41,019 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:44:42,204 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:44:43,582 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:44:43,777 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:44:45,458 - ispa_next.functions - DEBUG - Updated appointment (AA00029929) customer contact data.
2025-11-12 07:44:46,361 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:44:46,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:46,440 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:44:46,635 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 07:44:46,637 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:44:47,483 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:44:47,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:44:48,270 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:44:51,902 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:44:51,902 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:44:51,907 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:44:51,907 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:44:51,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:44:52,413 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:44:56,613 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:45:00,514 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:45:00,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:45:00,575 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:45:04,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:45:04,507 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:45:04,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:45:05,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:45:05,243 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:45:09,394 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:45:09,398 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:45:10,314 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:45:10,316 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:45:10,317 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:45:10,319 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:45:10,321 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:45:10,321 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:45:10,321 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:45:10,323 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:45:10,323 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:45:10,325 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:45:10,329 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:45:10,331 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:45:10,331 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:14,980 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:45:14,982 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:45:14,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:19,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:45:19,660 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:45:28,557 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:42,463 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:45:42,465 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:45:42,467 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:45:42,469 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:47,052 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:45:47,054 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:45:47,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:45:48,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:45:48,538 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:46:33,740 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:46:39,361 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:46:44,175 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:46:48,646 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:46:53,525 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:46:57,961 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:46:57,963 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:46:57,964 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:46:58,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:46:58,696 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:46:58,698 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:47:00,478 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:47:09,039 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:47:09,421 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 07:47:10,614 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:47:11,428 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:47:11,428 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:47:14,452 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:47:14,452 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:47:15,297 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:47:15,309 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:47:15,319 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:47:15,326 - ispa_next.main - DEBUG - 



2025-11-12 07:47:15,326 - ispa_next.main - DEBUG - starting with process 13 (GN-A 713) of 15
2025-11-12 07:47:15,330 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:47:16,306 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:47:17,402 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:47:17,403 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:47:18,989 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:47:18,991 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:47:50,318 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:47:53,618 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:56,911 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:47:56,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:56,981 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:47:57,259 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:47:57,261 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:47:57,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:57,351 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:48:00,515 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:48:00,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:48:01,712 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:48:03,719 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:48:03,815 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:48:03,910 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:48:03,987 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:48:08,175 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:48:09,181 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:48:09,185 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:48:09,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:48:09,687 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:48:09,687 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:48:09,731 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:48:09,837 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:48:10,960 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:48:11,165 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:48:12,908 - ispa_next.functions - DEBUG - Updated appointment (AB00028015) customer contact data.
2025-11-12 07:48:13,828 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:48:13,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:48:13,900 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:48:14,086 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 07:48:14,088 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:48:14,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:48:15,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:48:16,105 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:48:16,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:48:16,173 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:48:19,745 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:48:19,745 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:48:19,749 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:48:19,750 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:48:19,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:48:20,262 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:48:24,361 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:48:27,790 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:48:27,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:48:27,903 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:48:33,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:48:34,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:48:34,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:48:34,771 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:48:34,772 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:48:37,801 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:48:37,803 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:48:38,711 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:48:38,711 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:48:38,714 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:48:38,719 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:48:38,721 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:48:38,723 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:48:38,725 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:48:38,727 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:48:38,728 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:48:38,729 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:48:38,732 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:48:38,734 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:48:38,736 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:48:42,005 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:48:42,009 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:48:42,009 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:48:45,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:48:45,332 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:48:54,442 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:49:06,971 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:49:06,973 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:49:06,975 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:49:06,989 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:49:10,275 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:49:10,277 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:49:10,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:49:11,656 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:49:11,796 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:49:43,621 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:49:49,456 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:49:54,152 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:49:58,509 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:49:58,511 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:49:58,511 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:49:59,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:49:59,309 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:49:59,312 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:50:00,898 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:50:09,729 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:50:10,107 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 07:50:11,332 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:50:11,976 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:50:11,978 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:50:15,102 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 07:50:15,103 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:50:15,988 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:50:16,000 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:50:16,010 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:50:16,016 - ispa_next.main - DEBUG - 



2025-11-12 07:50:16,016 - ispa_next.main - DEBUG - starting with process 14 (BIR-F 196) of 15
2025-11-12 07:50:16,020 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:50:17,183 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:50:18,463 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-12 07:50:18,463 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 07:50:20,018 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:50:20,020 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:50:53,086 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:50:56,297 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:50:58,860 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:50:58,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:58,925 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:50:59,134 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:50:59,138 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:50:59,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:59,205 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:51:02,259 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:51:02,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:51:03,302 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:51:05,310 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:51:05,413 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:51:05,518 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:51:05,598 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:51:05,602 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:51:08,270 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:51:16,602 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:51:17,606 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:51:17,610 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:51:17,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:51:18,173 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:51:18,173 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:51:18,239 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:51:18,344 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:51:19,479 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:51:19,701 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:51:21,450 - ispa_next.functions - DEBUG - Updated appointment (AE00018235) customer contact data.
2025-11-12 07:51:22,362 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:51:22,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:51:22,484 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:51:22,608 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 07:51:22,612 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:51:22,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:51:23,474 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:51:24,378 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:51:24,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:51:24,488 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:51:28,056 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:51:28,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:51:28,535 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:51:30,574 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:51:30,716 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:51:30,828 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:51:30,923 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:51:30,923 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:51:33,565 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:51:41,633 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:52:41,636 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:52:50,282 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:53:50,284 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:53:58,851 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:54:06,624 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 07:54:07,651 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:54:07,652 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:54:07,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:54:07,724 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:54:11,829 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:54:15,939 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:54:15,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:54:16,001 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:54:26,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:54:27,344 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:54:27,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:54:27,984 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:54:27,984 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:54:30,473 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:54:30,475 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:54:32,506 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:54:32,507 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:54:32,507 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:54:32,509 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:54:32,509 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:54:32,511 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:54:32,511 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:54:32,513 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:54:32,515 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:54:32,515 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:54:32,519 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:54:32,521 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:54:32,522 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:54:35,186 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:54:35,189 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:54:35,191 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:54:37,805 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:54:37,809 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:54:37,813 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:54:37,817 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:54:40,386 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:54:40,389 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:54:41,051 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:54:41,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:54:41,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:55:06,784 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:55:10,923 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:55:15,357 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:55:15,360 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:55:15,360 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:55:15,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:55:16,070 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:55:16,072 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:55:17,798 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:55:25,893 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:55:26,260 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 07:55:27,139 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:55:27,832 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 688
2025-11-12 07:55:27,835 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:55:30,725 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 201
2025-11-12 07:55:30,726 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:55:31,696 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:55:31,710 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:55:31,720 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:55:31,731 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 07:55:31,736 - ispa_next.main - DEBUG - 



2025-11-12 07:55:31,736 - ispa_next.main - DEBUG - starting with process 15 (HU-RM 109) of 15
2025-11-12 07:55:31,741 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:55:33,012 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:55:34,192 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 688
2025-11-12 07:55:34,194 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 201
2025-11-12 07:55:35,699 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:55:35,700 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:56:08,230 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:56:11,454 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:56:13,381 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:56:13,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:56:13,472 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:56:13,690 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:56:13,694 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:56:13,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:56:13,785 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:56:16,983 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:56:16,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:56:18,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:56:20,043 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:56:20,141 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:56:20,238 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:56:20,365 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:56:20,366 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:56:22,346 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:56:30,770 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:56:31,774 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:56:31,778 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:56:31,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:56:32,279 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:56:32,279 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:56:32,318 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:56:33,486 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:56:34,656 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:56:34,914 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:56:36,681 - ispa_next.functions - DEBUG - Updated appointment (AE00018234) customer contact data.
2025-11-12 07:56:37,576 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:56:37,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:56:37,659 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:56:37,855 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 07:56:37,858 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:56:38,605 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:56:38,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:56:39,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:56:43,536 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:56:43,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:56:44,051 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:56:46,057 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:56:46,165 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:56:46,268 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:56:46,366 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:56:46,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:56:48,292 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:57:00,138 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:57:04,377 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:57:04,377 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:57:06,342 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:57:10,521 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:57:11,528 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:57:11,529 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:57:11,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:57:11,589 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:57:15,735 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:57:15,738 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:57:15,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:57:15,801 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:57:21,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:57:22,184 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:57:22,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:57:22,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:57:22,968 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:57:24,905 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:57:24,907 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:57:25,791 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:57:25,792 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:57:25,794 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:57:25,794 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:57:25,796 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:57:25,796 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:57:25,797 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:57:25,798 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:57:25,798 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:57:25,800 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:57:25,802 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:57:25,806 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:57:25,806 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:57:27,710 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:57:27,711 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:57:27,716 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:57:29,635 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:57:29,638 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:57:29,641 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:57:29,644 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:57:31,505 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:57:31,507 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:57:32,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:57:32,762 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:57:32,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:57:51,034 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:57:55,511 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:57:55,515 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:57:55,515 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:57:56,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:57:56,202 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:57:56,204 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:57:58,097 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:58:06,384 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:58:06,760 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 07:58:07,453 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:58:08,201 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 688
2025-11-12 07:58:08,203 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:58:11,036 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 201
2025-11-12 07:58:11,036 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:58:11,948 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 07:58:11,960 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 07:58:11,970 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 07:58:11,980 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
