2025-11-12 05:00:33,111 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 05:00:33,118 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 05:00:47,230 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 05:00:58,163 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 05:01:13,833 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:01:52,670 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 05:02:05,400 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 05:02:09,512 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:02:10,347 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:02:10,347 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:02:12,678 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 823
2025-11-12 05:02:12,679 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 05:02:12,680 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 05:02:13,861 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 05:02:15,020 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:04:18,033 - ispa_next.appointments.models - DEBUG - Appointment Gerhard Heierhoff NU-GH 5500 WBATX350X0NC21174 ohne Termin.
2025-11-12 05:04:18,047 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:04:18,075 - ispa_next.appointments.models - DEBUG - Appointment Marc-Oliver Simon UL-XS 94E WMW11DJ0702T73836 ohne Termin.
2025-11-12 05:04:18,096 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:04:18,122 - ispa_next.appointments.models - DEBUG - Appointment Luca Lissona NU-LL 2000 WBA5R11040FH06143 ohne Termin.
2025-11-12 05:04:18,147 - ispa_next.appointments.models - DEBUG - Appointment Carsten Werner NU-C 2705 WBAHF11050WW82664 ohne Termin.
2025-11-12 05:04:18,173 - ispa_next.appointments.models - DEBUG - Appointment Marcel Denis  WBAUX310X0A703707 ohne Termin.
2025-11-12 05:04:18,204 - ispa_next.appointments.models - DEBUG - Appointment Petrut-Marcelius Mindricel NU-KA 1990 WBAUG51020PV22612 ohne Termin.
2025-11-12 05:04:18,230 - ispa_next.appointments.models - DEBUG - Appointment Aline Walcher NU-XR 119 WBATY15050N035959 ohne Termin.
2025-11-12 05:04:18,255 - ispa_next.appointments.models - DEBUG - Appointment Wladislav Wiebe UL-SW 1204 WBAJT31030BV43579 ohne Termin.
2025-11-12 05:04:18,265 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:04:18,288 - ispa_next.appointments.models - DEBUG - Appointment Nadine Annabelle Peter UL-N 7218 WBATY55070N053421 ohne Termin.
2025-11-12 05:04:18,341 - ispa_next.appointments.models - DEBUG - Appointment Bogdan-Mihai Tritean NU-KL 2007 WBAVC31060VG12381 ohne Termin.
2025-11-12 05:04:18,369 - ispa_next.appointments.models - DEBUG - Appointment Günther Egner  WBAHF11090WW62966 ohne Termin.
2025-11-12 05:04:18,400 - ispa_next.appointments.models - DEBUG - Appointment Yannik Mario Missale BL-YM 99 WBA5V71060FH86625 ohne Termin.
2025-11-12 05:04:18,439 - ispa_next.appointments.models - DEBUG - Appointment Daniela Oßwald NU-DO 55 WBAUZ35030N001791 ohne Termin.
2025-11-12 05:04:18,467 - ispa_next.appointments.models - DEBUG - Appointment Dzafer Omerdic UL-DZ 74 WBAJP31070BT73165 ohne Termin.
2025-11-12 05:04:18,492 - ispa_next.appointments.models - DEBUG - Appointment Marcus Hermann BC-MP 307 WBAJP31050BT92541 ohne Termin.
2025-11-12 05:04:18,522 - ispa_next.appointments.models - DEBUG - Appointment   WBA5R11020FK27135 ohne Termin.
2025-11-12 05:04:18,550 - ispa_next.appointments.models - DEBUG - Appointment Ralf Pause NU-PX 88 WBAJM91050BH77340 ohne Termin.
2025-11-12 05:04:18,577 - ispa_next.appointments.models - DEBUG - Appointment Markus Henning UL-ML 35 WBA6L71060FJ55476 ohne Termin.
2025-11-12 05:04:18,607 - ispa_next.appointments.models - DEBUG - Appointment Hajro Gutic  WBAJP31030BT73745 ohne Termin.
2025-11-12 05:04:18,632 - ispa_next.appointments.models - DEBUG - Appointment Romina Reinhardt UL-JR 2202 WBAWY510900A40401 ohne Termin.
2025-11-12 05:04:18,663 - ispa_next.appointments.models - DEBUG - Appointment Emergenda NU-HK 202 WBA2D510805K80209 ohne Termin.
2025-11-12 05:04:18,696 - ispa_next.appointments.models - DEBUG - Appointment Philip Beck MA-LS 102 WBA31DX02LCD85300 ohne Termin.
2025-11-12 05:04:18,739 - ispa_next.appointments.models - DEBUG - Appointment Oula Alhajj BC-OH 2712 WBAVA71000KP97250 ohne Termin.
2025-11-12 05:04:18,766 - ispa_next.appointments.models - DEBUG - Appointment Matthias Hucker NU-CM 105 WBATX35030NE04318 ohne Termin.
2025-11-12 05:04:18,793 - ispa_next.appointments.models - DEBUG - Appointment Gregor Golaski WR-802GF WBA6L71020FJ48038 ohne Termin.
2025-11-12 05:04:18,819 - ispa_next.appointments.models - DEBUG - Appointment PERI SE NU-PE 85 WBA5F31060FK22508 ohne Termin.
2025-11-12 05:04:18,845 - ispa_next.appointments.models - DEBUG - Appointment Zoran Kadric NU-Z 1963 WBAVA71070KR36693 ohne Termin.
2025-11-12 05:04:18,868 - ispa_next.appointments.models - DEBUG - Appointment Demir Burak NU-BD 6 WBA81GE0607U10713 ohne Termin.
2025-11-12 05:04:18,934 - ispa_next.appointments.models - DEBUG - Appointment Dr. Sachs Andreas NU-XV 777 WBA5R71010FJ22363 ohne Termin.
2025-11-12 05:04:18,967 - ispa_next.appointments.models - DEBUG - Appointment Dominic Kreuzpaintner NU-DK 50 WBA71GP0809058750 ohne Termin.
2025-11-12 05:04:18,995 - ispa_next.appointments.models - DEBUG - Appointment Herbert Ronald Eichholz NU-RE 1021 WBA6L51020FJ56533 ohne Termin.
2025-11-12 05:04:19,021 - ispa_next.appointments.models - DEBUG - Appointment Dumitru-Danut Grosu NU-RD 71 WBAJM91040BH80214 ohne Termin.
2025-11-12 05:04:19,046 - ispa_next.appointments.models - DEBUG - Appointment Hasan Dikmen UL-KD 7238 WBA1V710605A67475 ohne Termin.
2025-11-12 05:04:19,073 - ispa_next.appointments.models - DEBUG - Appointment Axel Hansmann NU-DH 525 WBAJN11030BK38677 ohne Termin.
2025-11-12 05:04:19,100 - ispa_next.appointments.models - DEBUG - Appointment BMW Car IT GmbH M-JC 8400E WBY61EF0805419386 ohne Termin.
2025-11-12 05:04:19,129 - ispa_next.appointments.models - DEBUG - Appointment Bernd Schliefer ILL-KB 66 WBAJP31010BT73159 ohne Termin.
2025-11-12 05:04:19,163 - ispa_next.appointments.models - DEBUG - Appointment Max Hentschel NU-ME 2706 WBAJM91060BH38059 ohne Termin.
2025-11-12 05:04:19,186 - ispa_next.appointments.models - DEBUG - Appointment Valdrin Abazi  WBA11DY080FK03855 ohne Termin.
2025-11-12 05:04:19,210 - ispa_next.appointments.models - DEBUG - Appointment Alexander Schmid UL-AS 2220 WBAJP31060BT84111 ohne Termin.
2025-11-12 05:04:19,235 - ispa_next.appointments.models - DEBUG - Appointment Azem Alispahic NU-SL 701 WBAJP31060BT75599 ohne Termin.
2025-11-12 05:04:19,261 - ispa_next.appointments.models - DEBUG - Appointment Verena Wolf NU-BV 777 WBAJT51090CE05828 ohne Termin.
2025-11-12 05:04:19,290 - ispa_next.appointments.models - DEBUG - Appointment Markus Wieland NU-MW 1988 WBA5R110X0FJ58307 ohne Termin.
2025-11-12 05:04:19,317 - ispa_next.appointments.models - DEBUG - Appointment Klara Maria Bühler UL-RK 1606 WBATX35070NC11458 ohne Termin.
2025-11-12 05:04:19,342 - ispa_next.appointments.models - DEBUG - Appointment Eren Dogan UL-ER 462 WBAJN11080BK38366 ohne Termin.
2025-11-12 05:04:19,368 - ispa_next.appointments.models - DEBUG - Appointment Peter Wagner NU-XL 48 WBATY55020N009035 ohne Termin.
2025-11-12 05:04:19,392 - ispa_next.appointments.models - DEBUG - Appointment Sasa Fuchs UL-E 2299 WBA11AS0X0CE79272 ohne Termin.
2025-11-12 05:04:19,418 - ispa_next.appointments.models - DEBUG - Appointment Veselin Dokic NU-VD 443 WBA5V51090FH54319 ohne Termin.
2025-11-12 05:04:19,442 - ispa_next.appointments.models - DEBUG - Appointment Sonnentag Transporte GmbH GP-S 4500 WBAHF31020WW32817 ohne Termin.
2025-11-12 05:04:19,470 - ispa_next.appointments.models - DEBUG - Appointment Helmut Häuptle UL-MH 444 WBAVJ910X09C23552 ohne Termin.
2025-11-12 05:04:19,507 - ispa_next.appointments.models - DEBUG - Appointment Michael Durst BC-JD 2017 WBA6L51060FJ59063 ohne Termin.
2025-11-12 05:04:19,533 - ispa_next.appointments.models - DEBUG - Appointment Ervin Mujagic  WBATX35020NC23615 ohne Termin.
2025-11-12 05:04:19,570 - ispa_next.appointments.models - DEBUG - Appointment Arici Selcuk UL-KY 442 WBAVU31030KY03266 ohne Termin.
2025-11-12 05:04:19,599 - ispa_next.appointments.models - DEBUG - Appointment Jessin Patrick Manai RT-JM 1401 WBA5F380608B42512 ohne Termin.
2025-11-12 05:04:19,623 - ispa_next.appointments.models - DEBUG - Appointment Durna Zeynep Incedayi UL-PX 1 WMWXT710102C14755 ohne Termin.
2025-11-12 05:04:19,651 - ispa_next.appointments.models - DEBUG - Appointment Özlem Sandikci NU-EE 1903 WMWLR910602E68924 ohne Termin.
2025-11-12 05:04:19,667 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:04:19,700 - ispa_next.appointments.models - DEBUG - Appointment Bareiss Prüfgerätebau GmbH UL-CX 288 WBA61EE0705W35665 ohne Termin.
2025-11-12 05:04:19,730 - ispa_next.appointments.models - DEBUG - Appointment Thomas Fundel UL-TF 260 WBA5V71050FH67905 ohne Termin.
2025-11-12 05:04:19,758 - ispa_next.appointments.models - DEBUG - Appointment Leandra Kuschel UL-LQ 13 WBAVB31060VB69085 ohne Termin.
2025-11-12 05:04:19,790 - ispa_next.appointments.models - DEBUG - Appointment Guido Steinhauser BC-G 225 WBAWZ510400S27474 ohne Termin.
2025-11-12 05:04:19,815 - ispa_next.appointments.models - DEBUG - Appointment Daniela Feinäugle  WBA5F31050FJ57747 ohne Termin.
2025-11-12 05:04:19,841 - ispa_next.appointments.models - DEBUG - Appointment Izzet özcelik ILL-Z 57 WBADY31070E827083 ohne Termin.
2025-11-12 05:04:19,870 - ispa_next.appointments.models - DEBUG - Appointment Salih Karadeniz UL-SK 157 WBAJN71010BJ06939 ohne Termin.
2025-11-12 05:04:19,909 - ispa_next.appointments.models - DEBUG - Appointment Marco Troiano UL-MT 386 WBA1R510905L60132 ohne Termin.
2025-11-12 05:04:19,934 - ispa_next.appointments.models - DEBUG - Appointment Dieter Mack UL-DM 822 WBAHF11070WW89910 ohne Termin.
2025-11-12 05:04:19,959 - ispa_next.appointments.models - DEBUG - Appointment Autoforum-Muc NU-M 881 WBA11DX080CE08548 ohne Termin.
2025-11-12 05:04:19,986 - ispa_next.appointments.models - DEBUG - Appointment Hasib Mesic NU-HE 610 WBATX31060LC42685 ohne Termin.
2025-11-12 05:04:20,012 - ispa_next.appointments.models - DEBUG - Appointment Mustafa Iman UL-EE 324 WBAUD71050P268270 ohne Termin.
2025-11-12 05:04:20,039 - ispa_next.appointments.models - DEBUG - Appointment Jessin Patrick Manai RT-JM 1401 WBA5F380608B42512 ohne Termin.
2025-11-12 05:04:20,069 - ispa_next.appointments.models - DEBUG - Appointment Sascha Hankele NU-H 1820 WBAKD91000E653198 ohne Termin.
2025-11-12 05:04:20,101 - ispa_next.appointments.models - DEBUG - Appointment BMW Car IT GmbH M-JC 1039E WBY31AW010FP54558 ohne Termin.
2025-11-12 05:04:20,128 - ispa_next.appointments.models - DEBUG - Appointment Janos Loboda UL-LJ 197 WBAVD91090AE65139 ohne Termin.
2025-11-12 05:04:20,155 - ispa_next.appointments.models - DEBUG - Appointment Hannelore Seidel NU-HS 132 WBAUM510X0VE93058 ohne Termin.
2025-11-12 05:04:20,180 - ispa_next.appointments.models - DEBUG - Appointment Emre Iman UL-EX 323 WBAAM31010AZ47872 ohne Termin.
2025-11-12 05:04:20,213 - ispa_next.appointments.models - DEBUG - Appointment Muharrem Aluc UL-MA 5800 WBA5L31010G484486 ohne Termin.
2025-11-12 05:04:20,272 - ispa_next.main - DEBUG - Found 15 out of 209 appointments to process (configured limit: 15).
2025-11-12 05:04:20,273 - ispa_next.main - DEBUG - Processing 8 fresh appointments.
2025-11-12 05:04:20,273 - ispa_next.main - DEBUG - Processing 7 already visited appointments (w/ RKR not callable).
2025-11-12 05:04:20,273 - ispa_next.main - DEBUG - All appointments: NU-U 711, GA447, NU J 3339, 3508, ul vk1010, UL-ST2016, ILL-GO-67, UL HN 9695, UL-WI 8888, M-JC 234E, UL-K 1058, NU-RU 2509, NU-EL 699E, ILL-MI 11, GZ-CJ 44
2025-11-12 05:04:20,276 - ispa_next.main - DEBUG - 



2025-11-12 05:04:20,276 - ispa_next.main - DEBUG - starting with process 1 (NU-U 711) of 15
2025-11-12 05:04:20,282 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:04:21,434 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:04:22,639 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:04:22,640 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 823
2025-11-12 05:04:24,252 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:04:24,253 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:04:49,133 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:04:58,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:04:58,863 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:04:59,094 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:05:01,012 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:05:01,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:05:01,116 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:05:01,341 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:05:01,348 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:05:04,118 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:05:04,119 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:05:05,083 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:05:07,092 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:05:07,218 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:05:10,403 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:05:10,513 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:05:10,515 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:05:18,971 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:05:19,977 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:05:19,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:05:20,491 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:05:30,599 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 05:05:38,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:05:38,166 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:05:38,167 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 05:05:38,469 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-12 05:05:38,629 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-12 05:05:38,634 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:05:38,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:05:38,739 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:05:38,739 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:05:38,815 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:05:40,148 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:05:40,409 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:05:43,358 - ispa_next.functions - DEBUG - Updated appointment (AE00057143) customer contact data.
2025-11-12 05:05:44,276 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:05:44,279 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:05:44,861 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:05:44,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:05:45,512 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:05:49,977 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:05:49,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:05:50,457 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:05:52,462 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:05:52,668 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:05:52,772 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:05:52,863 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:05:52,864 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:06:04,068 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 05:06:08,240 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:06:08,242 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:06:12,432 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:06:13,441 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:06:13,441 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:06:13,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:06:13,558 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:06:17,653 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:06:17,658 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:06:17,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:06:17,720 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:06:26,435 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 05:06:33,927 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 05:06:33,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:06:34,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:06:34,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:06:35,441 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:06:35,443 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:06:37,928 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:06:37,930 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:06:38,951 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:06:38,954 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:06:38,959 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 05:06:38,961 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:06:38,963 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 05:06:38,965 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 05:06:38,966 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:06:38,968 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:06:38,968 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:06:38,970 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:06:38,972 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:06:38,974 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:06:38,974 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 05:07:01,470 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-12 05:07:01,584 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:07:01,585 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:07:02,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:07:02,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:07:02,884 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 05:07:02,912 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 05:07:05,782 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 05:07:05,786 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:07:06,931 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:07:06,933 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:07:09,764 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:07:09,764 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:07:10,603 - ispa_next.main - DEBUG - Found new Appointment: UL-XS 21
2025-11-12 05:07:10,605 - ispa_next.main - DEBUG - 



2025-11-12 05:07:10,605 - ispa_next.main - DEBUG - starting with process 2 (UL-XS 21) of 16
2025-11-12 05:07:10,611 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:07:11,790 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:07:12,893 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:07:12,894 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:07:14,463 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:07:14,464 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:07:39,284 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:07:41,371 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:07:46,647 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:07:50,581 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:07:50,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:07:50,652 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:07:50,837 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:07:50,841 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:07:53,655 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:07:53,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:07:54,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:07:56,558 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:07:56,666 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:07:56,803 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:07:56,860 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:07:58,998 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 05:08:00,022 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:08:00,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:08:00,577 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:08:12,766 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:08:12,766 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 05:08:17,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:08:17,259 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:08:17,259 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 05:08:17,555 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 05:08:17,558 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:08:17,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:08:17,623 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:08:17,623 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:08:17,655 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:08:17,806 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:08:19,102 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:08:19,404 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:08:21,112 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:08:21,116 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:08:21,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:08:21,998 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:08:23,172 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:08:23,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:08:23,247 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:08:26,845 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:08:26,846 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 05:08:26,850 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:08:26,850 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:08:26,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:08:27,466 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:08:31,659 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 05:08:34,886 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:08:34,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:08:34,967 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:08:35,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:08:35,944 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:08:35,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:08:36,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:08:36,538 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:08:40,157 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:08:40,159 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:08:41,359 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:08:41,361 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:08:41,363 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:08:41,365 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:08:41,369 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 05:08:41,371 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 05:08:41,372 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:08:41,374 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:08:41,374 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:08:41,376 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:08:41,382 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:08:41,386 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:08:41,392 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:08:41,395 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:08:41,397 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:08:41,399 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:08:45,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:08:45,413 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:08:56,801 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:08:56,804 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:08:56,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:08:57,456 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:08:57,544 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:08:57,548 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:09:01,498 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:09:12,967 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:09:13,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:09:13,931 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:09:14,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:09:22,372 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:09:26,618 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:09:31,438 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:09:35,223 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:09:35,224 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:09:36,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:09:36,083 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:09:36,085 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:09:42,326 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 05:09:52,359 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:09:52,738 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 05:09:53,499 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:09:54,697 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:09:54,701 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:09:57,178 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:09:57,178 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:09:57,870 - ispa_next.main - DEBUG - 



2025-11-12 05:09:57,870 - ispa_next.main - DEBUG - starting with process 3 (GA447) of 16
2025-11-12 05:09:57,875 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:09:58,785 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:09:59,906 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:09:59,907 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:10:01,587 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:10:01,589 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:10:33,533 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 05:10:33,546 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 05:10:33,552 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:10:33,956 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:10:33,956 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:10:36,138 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:10:36,139 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:10:36,943 - ispa_next.main - DEBUG - 



2025-11-12 05:10:36,943 - ispa_next.main - DEBUG - starting with process 4 (NU J 3339) of 16
2025-11-12 05:10:36,948 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:10:38,248 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:10:39,466 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:10:39,468 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:10:40,975 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:10:40,977 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:11:12,017 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 05:11:12,027 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 05:11:12,033 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:11:12,664 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:11:12,665 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:11:15,190 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:11:15,190 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:11:16,042 - ispa_next.main - DEBUG - 



2025-11-12 05:11:16,042 - ispa_next.main - DEBUG - starting with process 5 (3508) of 16
2025-11-12 05:11:16,047 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:11:17,202 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:11:18,403 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:11:18,404 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:11:19,990 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:11:19,992 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:11:51,299 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 05:11:51,309 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 05:11:51,315 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:11:51,789 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:11:51,791 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:11:54,581 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:11:54,582 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:11:55,470 - ispa_next.main - DEBUG - 



2025-11-12 05:11:55,470 - ispa_next.main - DEBUG - starting with process 6 (ul vk1010) of 16
2025-11-12 05:11:55,476 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:11:56,767 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:11:58,163 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:11:58,169 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:11:59,755 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:11:59,756 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:12:31,786 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 05:12:31,797 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 05:12:31,803 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:12:32,355 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:12:32,357 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:12:34,837 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:12:34,838 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:12:35,668 - ispa_next.main - DEBUG - 



2025-11-12 05:12:35,668 - ispa_next.main - DEBUG - starting with process 7 (UL-ST2016) of 16
2025-11-12 05:12:35,676 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:12:36,976 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:12:38,181 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:12:38,183 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:12:40,061 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:12:40,062 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:13:12,331 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 05:13:12,343 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 05:13:12,349 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:13:12,979 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:13:12,981 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:13:15,626 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:13:15,626 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:13:16,382 - ispa_next.main - DEBUG - 



2025-11-12 05:13:16,382 - ispa_next.main - DEBUG - starting with process 8 (ILL-GO-67) of 16
2025-11-12 05:13:16,389 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:13:17,355 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:13:18,338 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:13:18,339 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:13:19,826 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:13:19,827 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:13:51,203 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 05:13:51,215 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 05:13:51,221 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:13:51,839 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:13:51,841 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:13:54,548 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:13:54,549 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:13:55,383 - ispa_next.main - DEBUG - 



2025-11-12 05:13:55,383 - ispa_next.main - DEBUG - starting with process 9 (UL HN 9695) of 16
2025-11-12 05:13:55,390 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:13:56,803 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:13:58,152 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:13:58,154 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:13:59,640 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:13:59,642 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:14:32,456 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 05:14:32,468 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 05:14:32,474 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:14:33,080 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:14:33,082 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:14:35,727 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:14:35,728 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:14:36,418 - ispa_next.main - DEBUG - 



2025-11-12 05:14:36,418 - ispa_next.main - DEBUG - starting with process 10 (UL-WI 8888) of 16
2025-11-12 05:14:36,425 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:14:37,326 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:14:38,544 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:14:38,546 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:14:40,141 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:14:40,142 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:15:01,661 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:15:03,712 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:15:09,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:15:12,539 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:15:12,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:15:12,617 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:15:12,801 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:15:12,805 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:15:15,455 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:15:15,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:15:16,417 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:15:18,423 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:15:18,554 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:15:18,645 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:15:18,706 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:15:18,706 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:15:27,067 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:15:28,073 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:15:28,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:15:28,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:15:41,271 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:15:45,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:15:45,779 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:15:45,779 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 05:15:45,937 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 05:15:45,940 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:15:45,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:15:46,009 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:15:46,009 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:15:46,059 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:15:47,277 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:15:48,434 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:15:48,719 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:15:50,036 - ispa_next.functions - DEBUG - Updated appointment (GS00001180) customer contact data.
2025-11-12 05:15:50,957 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:15:50,960 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:15:51,724 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:15:51,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:15:52,525 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:15:56,665 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:15:56,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:15:57,226 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:15:59,231 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:15:59,356 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:15:59,459 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:15:59,528 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:15:59,529 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:16:10,279 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:16:14,348 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:16:14,350 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:16:18,520 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:16:19,528 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:16:19,529 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:16:19,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:16:19,600 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:16:23,740 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:16:23,746 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:16:23,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:16:23,806 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:16:29,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:16:29,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:16:29,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:16:30,621 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:16:30,621 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:16:33,036 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:16:33,038 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:16:33,890 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:16:33,892 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:16:33,894 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:16:33,896 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:16:33,897 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 05:16:33,900 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 05:16:33,902 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:16:33,912 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:16:33,919 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:16:33,920 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:16:33,921 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:16:33,922 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:16:33,926 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:16:33,928 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:16:33,931 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:16:33,934 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:16:36,434 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:16:36,437 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:16:36,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:16:37,083 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:16:37,308 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:16:48,503 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:16:48,509 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:16:51,164 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:17:03,222 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:17:03,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:17:04,334 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:17:04,495 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:17:11,967 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:17:16,433 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:17:20,891 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:17:20,894 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:17:20,896 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:17:21,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:17:21,665 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:17:21,668 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:17:23,731 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:17:32,514 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:17:32,890 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 05:17:33,544 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:17:35,061 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:17:35,061 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:17:37,973 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:17:37,973 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:17:38,913 - ispa_next.main - DEBUG - 



2025-11-12 05:17:38,914 - ispa_next.main - DEBUG - starting with process 11 (M-JC 234E) of 16
2025-11-12 05:17:38,919 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:17:40,167 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:17:41,360 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:17:41,362 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:17:43,140 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:17:43,142 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:18:04,962 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:18:06,499 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:18:11,042 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:18:13,599 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:18:13,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:13,665 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:18:13,897 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:18:13,901 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:18:16,598 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:18:16,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:18:17,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:18:19,564 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:18:19,669 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:18:19,762 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:18:19,820 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:18:19,821 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:18:27,919 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:18:28,925 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:18:28,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:29,429 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:43,609 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:18:47,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:47,571 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:18:47,571 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 05:18:47,702 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 05:18:47,706 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:18:47,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:47,779 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:18:47,779 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:18:47,817 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:18:49,016 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:18:49,228 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:18:51,054 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:18:51,058 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:18:51,922 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:18:51,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:18:52,632 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:18:56,215 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:18:56,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:18:56,733 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:18:58,739 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:18:58,838 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:18:58,938 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:18:59,007 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:18:59,007 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:19:07,698 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:20:07,701 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:20:16,043 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:21:05,046 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:21:13,637 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 05:21:21,055 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 05:21:22,062 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:21:22,064 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:21:22,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:21:22,142 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:21:26,249 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:21:26,253 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:21:26,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:21:26,318 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:21:35,049 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 05:21:48,919 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 05:21:49,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:21:49,857 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:21:49,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:21:50,560 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:21:50,560 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:21:53,058 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:21:53,062 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:21:54,353 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:21:54,354 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:21:54,356 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:21:54,357 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:21:54,359 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 05:21:54,360 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 05:21:54,361 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:21:54,361 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:21:54,363 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:21:54,363 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:21:54,365 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:21:54,374 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:21:54,377 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:21:54,379 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:21:54,381 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:21:57,032 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:21:57,035 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:21:57,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:21:57,813 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:21:58,058 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:22:09,397 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:22:09,399 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:22:12,014 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:22:23,881 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:22:24,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:22:24,919 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:22:25,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:22:32,388 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:22:36,821 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:22:42,040 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:22:42,044 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:22:42,044 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:22:42,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:22:42,828 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:22:42,830 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:22:44,761 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:22:53,211 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:22:53,605 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 05:22:53,863 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:22:56,760 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:22:56,762 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:22:59,653 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:22:59,654 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:23:00,368 - ispa_next.main - DEBUG - 



2025-11-12 05:23:00,368 - ispa_next.main - DEBUG - starting with process 12 (UL-K 1058) of 16
2025-11-12 05:23:00,374 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:23:01,656 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:23:02,885 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:23:02,886 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:23:04,576 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:23:04,578 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:23:35,395 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:23:37,492 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:23:42,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:23:45,193 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:23:45,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:23:45,337 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:23:45,490 - ispa_next.functions - DEBUG - HU date already expired after 1003 days.
2025-11-12 05:23:49,700 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:23:49,704 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:23:52,437 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:23:52,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:23:53,449 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:23:55,455 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:23:55,585 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:23:55,741 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:23:55,815 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:23:55,815 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:24:04,407 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:24:05,411 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:24:05,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:24:05,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:24:19,832 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:24:24,496 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:24:24,573 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:24:24,573 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 05:24:24,726 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-12 05:24:24,882 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-12 05:24:24,890 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:24:24,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:24:24,973 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:24:24,973 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:24:25,021 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:24:25,181 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:24:26,374 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 05:24:27,607 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 05:24:27,948 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:24:29,644 - ispa_next.functions - DEBUG - Updated appointment (FO00001775) customer contact data.
2025-11-12 05:24:30,546 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:24:30,548 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:24:30,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:24:31,438 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:24:32,600 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:24:32,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:24:32,674 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:24:36,336 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:24:36,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:24:36,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:24:38,835 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:24:38,986 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:24:39,078 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:24:39,174 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:24:39,174 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:24:47,497 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:25:47,499 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:25:58,341 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:26:02,752 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:26:02,752 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:26:06,921 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:26:07,930 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:26:07,930 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:26:07,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:26:08,003 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:26:12,110 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:26:12,115 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:26:12,115 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:26:12,173 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:26:12,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:26:13,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:26:13,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:26:13,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:26:13,751 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:26:16,168 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:26:16,170 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:26:17,155 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:26:17,156 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:26:17,159 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:26:17,160 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:26:17,161 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 05:26:17,163 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 05:26:17,165 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:26:17,165 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:26:17,165 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:26:17,167 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:26:17,169 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:26:17,169 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:26:17,173 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:26:17,177 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:26:17,180 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:26:17,186 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:26:19,817 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:26:19,820 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:26:19,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:26:20,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:26:20,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:26:30,737 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:26:30,739 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:26:33,349 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:26:45,858 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:26:46,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:26:46,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:26:46,974 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:26:54,537 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:26:58,895 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:27:03,786 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:27:03,790 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:27:03,791 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:27:04,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:27:04,595 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:27:04,598 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:27:06,652 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:27:15,665 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:27:16,042 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 05:27:16,697 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:27:18,287 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:27:18,287 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:27:21,172 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:27:21,173 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:27:21,810 - ispa_next.main - DEBUG - 



2025-11-12 05:27:21,811 - ispa_next.main - DEBUG - starting with process 13 (NU-RU 2509) of 16
2025-11-12 05:27:21,815 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:27:22,743 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:27:23,753 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:27:23,754 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:27:25,568 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:27:25,570 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:27:58,393 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:28:00,792 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:28:06,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:07,998 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:28:08,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:28:08,074 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:28:08,426 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:28:08,430 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:28:11,307 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:28:11,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:28:12,261 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:28:14,263 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:28:14,368 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:28:14,513 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:28:14,627 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:28:18,857 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 05:28:19,865 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:28:19,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:28:20,373 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:28:32,391 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:28:36,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:28:36,389 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:28:36,389 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 05:28:36,536 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 05:28:36,540 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:28:36,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:28:36,624 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:28:36,626 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:28:36,676 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:28:36,993 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:28:38,220 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:28:38,441 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:28:39,824 - ispa_next.functions - DEBUG - Updated appointment (KG00000183) customer contact data.
2025-11-12 05:28:41,053 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:28:41,055 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:28:41,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:28:41,990 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:28:43,163 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:28:43,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:28:43,235 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:28:46,802 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:28:46,802 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 05:28:46,807 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:28:46,807 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:28:46,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:28:47,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:28:51,452 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:28:51,474 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:28:51,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:28:51,545 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:28:51,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:28:52,391 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:28:52,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:28:53,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:28:53,057 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:28:54,921 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:28:54,922 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:28:55,789 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:28:55,791 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:28:55,792 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:28:55,792 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:28:55,794 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 05:28:55,794 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 05:28:55,796 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:28:55,796 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:28:55,796 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:28:55,798 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:28:55,798 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:28:55,800 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:28:55,807 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:28:55,810 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:28:55,812 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:28:55,817 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:57,757 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:28:57,759 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:28:57,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:28:58,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:28:58,731 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:29:07,850 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:29:07,852 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:29:09,745 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:29:20,329 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:29:20,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:29:21,381 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:29:21,563 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:29:27,923 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:29:32,443 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:29:32,447 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:29:32,449 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:29:33,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:29:33,250 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:29:33,252 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:29:35,233 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:29:42,205 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:29:42,602 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 05:29:43,169 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:29:44,833 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:29:44,833 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:29:47,845 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:29:47,845 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:29:48,654 - ispa_next.main - DEBUG - 



2025-11-12 05:29:48,655 - ispa_next.main - DEBUG - starting with process 14 (NU-EL 699E) of 16
2025-11-12 05:29:48,660 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:29:49,509 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:29:50,543 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:29:50,544 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:29:51,983 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:29:51,984 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:30:14,035 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:30:16,040 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:30:21,814 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:30:23,673 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:30:23,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:23,782 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:30:23,962 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:30:23,966 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:30:26,791 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:30:26,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:30:27,822 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:30:29,828 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:30:29,932 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:30:30,029 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:30:30,140 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:30:34,264 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 05:30:35,273 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:30:35,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:35,826 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:48,025 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:30:48,025 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 05:30:52,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:52,520 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:30:52,520 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 05:30:52,765 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 05:30:52,769 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:30:52,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:52,858 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:30:52,858 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:30:52,909 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:30:54,135 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:30:55,404 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:30:55,620 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:30:57,555 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:30:57,559 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:30:58,557 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:30:58,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:30:59,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:31:03,395 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-12 05:31:03,395 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:31:03,395 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 05:31:03,399 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:31:03,399 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:31:03,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:31:03,909 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:31:08,014 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:31:08,020 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:31:08,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:31:08,084 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:31:13,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:31:14,231 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:31:14,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:31:15,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:31:15,009 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:31:16,920 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:31:16,920 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:31:17,971 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:31:17,973 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:31:17,973 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:31:17,975 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:31:17,977 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 05:31:17,977 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 05:31:17,979 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:31:17,979 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:31:17,981 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:31:17,983 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:31:17,983 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:31:17,985 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:31:17,989 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:31:17,992 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:31:17,995 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:31:18,001 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:31:19,928 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:31:19,931 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:31:19,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:31:20,706 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:31:20,934 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:31:31,349 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:31:31,351 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:31:33,296 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:31:45,514 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:31:46,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:31:46,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:31:46,717 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:31:53,639 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:31:58,427 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:31:58,431 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:31:58,431 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:31:59,148 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:31:59,238 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:31:59,240 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:32:01,352 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:32:09,796 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:32:10,195 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 05:32:10,816 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:32:12,613 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:32:12,615 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:32:15,033 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:32:15,034 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:32:15,718 - ispa_next.main - DEBUG - 



2025-11-12 05:32:15,718 - ispa_next.main - DEBUG - starting with process 15 (ILL-MI 11) of 16
2025-11-12 05:32:15,724 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:32:16,663 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:32:17,565 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:32:17,566 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:32:18,946 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:32:18,947 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:32:42,977 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:32:45,137 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:32:50,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:32:54,093 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:32:54,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:32:54,158 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:32:54,326 - ispa_next.functions - DEBUG - HU date already expired after 2428 days.
2025-11-12 05:32:57,603 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:32:57,606 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:33:00,364 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:33:00,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:33:01,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:33:03,944 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:33:04,059 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:33:04,168 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:33:04,231 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:33:08,387 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 05:33:09,395 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:33:09,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:33:09,877 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:33:22,741 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:33:22,741 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 05:33:27,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:33:27,372 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:33:27,372 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 05:33:27,579 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 05:33:27,583 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:33:27,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:33:27,669 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:33:27,671 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:33:27,727 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:33:27,873 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:33:29,206 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:33:29,445 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:33:30,972 - ispa_next.functions - DEBUG - Updated appointment (AE00056518) customer contact data.
2025-11-12 05:33:31,899 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:33:31,903 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:33:32,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:33:33,351 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:33:34,505 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:33:34,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:33:34,574 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:33:38,584 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 05:33:38,587 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:33:38,587 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 05:33:38,591 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:33:38,591 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:33:38,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:33:39,150 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:33:43,263 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:33:43,273 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:33:43,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:33:43,358 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:33:43,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:33:44,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:33:44,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:33:44,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:33:44,868 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:33:47,863 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:33:47,868 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:33:48,902 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:33:48,904 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:33:48,907 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:33:48,909 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:33:48,911 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 05:33:48,911 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 05:33:48,913 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:33:48,913 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:33:48,915 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:33:48,917 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:33:48,917 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:33:48,918 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:33:48,922 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:33:48,927 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:33:48,929 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:33:48,935 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:33:52,253 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:33:52,257 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:33:52,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:33:53,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:33:53,366 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:34:03,925 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:34:03,931 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:34:07,335 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:34:19,073 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:34:19,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:34:20,191 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:34:20,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:34:29,136 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:34:33,714 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:34:40,067 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:34:44,896 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:34:44,898 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:34:44,899 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:34:45,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:34:45,674 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:34:45,676 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:34:47,876 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:34:56,727 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:34:57,101 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 05:34:57,822 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:34:59,617 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:34:59,619 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:35:02,341 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:35:02,342 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:35:03,160 - ispa_next.main - DEBUG - 



2025-11-12 05:35:03,160 - ispa_next.main - DEBUG - starting with process 16 (GZ-CJ 44) of 16
2025-11-12 05:35:03,165 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:35:04,375 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:35:05,629 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:35:05,630 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:35:07,249 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:35:07,251 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:35:42,274 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:35:44,423 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:35:49,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:35:49,837 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:35:50,026 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:35:52,750 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:35:52,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:35:52,808 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:35:53,000 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:35:53,004 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:35:55,790 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:35:55,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:35:56,943 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:35:58,946 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:35:59,035 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:35:59,139 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:35:59,196 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:35:59,196 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:36:07,554 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:36:08,559 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:36:08,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:36:09,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:36:21,508 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:36:25,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:36:25,934 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:36:25,935 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 05:36:26,105 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 05:36:26,109 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:36:26,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:36:26,185 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:36:26,185 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:36:26,259 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:36:26,412 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:36:27,798 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:36:28,006 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:36:29,949 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:36:29,951 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:36:30,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:36:31,106 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:36:32,203 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:36:32,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:36:32,279 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:36:35,894 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:36:35,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:36:36,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:36:38,438 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:36:38,578 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:36:38,698 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:36:38,823 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:36:38,825 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:36:46,918 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:37:46,920 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:37:55,925 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:38:42,927 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:38:51,422 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 05:38:59,397 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 05:39:00,404 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:39:00,404 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:39:00,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:39:00,518 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:39:04,635 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:39:04,640 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:39:04,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:39:04,741 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:39:05,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:39:05,624 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:39:05,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:39:06,271 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:39:06,273 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:39:08,681 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:39:08,687 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:39:09,692 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:39:09,696 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:39:09,698 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:39:09,700 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:39:09,702 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 05:39:09,719 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 05:39:09,722 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:39:09,722 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:39:09,724 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:39:09,724 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:39:09,726 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:39:09,726 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:39:09,730 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:39:09,735 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:39:09,736 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:39:09,742 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:39:12,810 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:39:12,814 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:39:12,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:39:13,607 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:39:13,646 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:39:13,652 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:39:16,284 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:39:27,624 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:39:28,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:39:28,557 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:39:28,756 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:39:36,345 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:39:40,670 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:39:45,397 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:39:45,401 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:39:45,401 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:39:46,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:39:46,186 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:39:46,188 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:39:48,340 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:39:57,251 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:39:57,629 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 05:39:58,045 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:40:00,299 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2013
2025-11-12 05:40:00,300 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:40:03,160 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1240
2025-11-12 05:40:03,161 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
