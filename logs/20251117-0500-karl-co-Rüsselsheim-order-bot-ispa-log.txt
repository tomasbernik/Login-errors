2025-11-17 05:14:34,183 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 05:14:34,190 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 05:14:46,054 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 05:14:58,496 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 05:15:14,380 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:17:13,927 - ispa_next.app_start.main - DEBUG - Operation already took 107.56 seconds (more than 80 seconds)
2025-11-17 05:17:15,989 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\73782b04ee1f52b3\\tess_5os2zg86_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\73782b04ee1f52b3\\tess_5os2zg86', 'txt']
2025-11-17 05:17:16,268 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 05:17:16,275 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 05:17:16,275 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:19:15,167 - ispa_next.app_start.main - DEBUG - Operation already took 106.55 seconds (more than 80 seconds)
2025-11-17 05:19:17,235 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\73782b04ee1f52b3\\tess_r9842fh5_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\73782b04ee1f52b3\\tess_r9842fh5', 'txt']
2025-11-17 05:19:17,464 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 05:19:17,469 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 05:19:24,407 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 05:19:34,328 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 05:19:44,514 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 05:19:59,967 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:21:57,510 - ispa_next.app_start.main - DEBUG - Operation already took 106.48 seconds (more than 80 seconds)
2025-11-17 05:21:59,578 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\73782b04ee1f52b3\\tess_ebep4h68_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\73782b04ee1f52b3\\tess_ebep4h68', 'txt']
2025-11-17 05:21:59,799 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 05:21:59,804 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 05:21:59,805 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:23:58,411 - ispa_next.app_start.main - DEBUG - Operation already took 106.30 seconds (more than 80 seconds)
2025-11-17 05:24:00,482 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\73782b04ee1f52b3\\tess_u_iex384_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\73782b04ee1f52b3\\tess_u_iex384', 'txt']
2025-11-17 05:24:00,722 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 05:24:00,726 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 05:24:07,562 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 05:24:15,498 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 05:24:25,917 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 05:24:41,371 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:25:15,836 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 05:25:26,853 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 05:25:29,374 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:25:30,336 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-17 05:25:30,338 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 05:25:32,618 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 70
2025-11-17 05:25:32,619 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 05:25:32,620 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 05:25:33,812 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 05:25:34,915 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:25:44,575 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:25:44,576 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:25:44,591 - ispa_next.appointments.models - DEBUG - Appointment Sabine Elisabeth GG-K 629 WBATX35050NC05741 ohne Termin.
2025-11-17 05:25:44,592 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:25:44,607 - ispa_next.appointments.models - DEBUG - Appointment Hasan Ucar GG-UN 93 WBA4E910X0G593327 ohne Termin.
2025-11-17 05:25:44,613 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:25:44,616 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:25:44,619 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:25:44,629 - ispa_next.appointments.models - DEBUG - Appointment Firma La Rosa GmbH GG-DI 2016 WBAJJ310603M78808 ohne Termin.
2025-11-17 05:25:44,638 - ispa_next.appointments.models - DEBUG - Appointment Hiltrud Marx WI-XM 25 WMWWJ910003L15788 ohne Termin.
2025-11-17 05:25:44,645 - ispa_next.appointments.models - DEBUG - Appointment Masoumeh Rashvand Sardari GG-SH 141 WBA2V110009C09071 ohne Termin.
2025-11-17 05:25:44,654 - ispa_next.main - DEBUG - Found 5 out of 33 appointments to process (configured limit: 15).
2025-11-17 05:25:44,654 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-17 05:25:44,654 - ispa_next.main - DEBUG - All appointments: GG-JG 1210, GG-BM 24, GG YA 107, F-S9617, FRI-MK 152
2025-11-17 05:25:44,657 - ispa_next.main - DEBUG - 



2025-11-17 05:25:44,657 - ispa_next.main - DEBUG - starting with process 1 (GG-JG 1210) of 5
2025-11-17 05:25:44,663 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:25:45,786 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:25:46,863 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-17 05:25:46,864 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 70
2025-11-17 05:25:48,088 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:25:48,090 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:26:16,676 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:26:26,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:26:27,386 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:26:27,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:26:27,460 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:26:27,659 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:26:27,661 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:26:27,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:26:27,743 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:26:36,676 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:26:36,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:26:37,586 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:26:39,590 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:26:45,688 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 05:26:51,990 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 05:26:52,993 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:26:52,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:26:53,481 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:26:56,517 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 05:26:56,521 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:26:56,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:26:56,595 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:26:56,595 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:26:56,644 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:26:56,742 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 05:26:57,895 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:26:58,157 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:27:02,401 - ispa_next.functions - DEBUG - Updated appointment (AB00061386) customer contact data.
2025-11-17 05:27:03,301 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:27:03,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:27:03,387 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:27:03,512 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:27:03,516 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:27:03,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:27:04,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:27:05,833 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:27:05,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:27:05,937 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 05:27:09,593 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:27:09,594 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 05:27:09,597 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:27:09,598 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:27:09,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:27:10,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:27:14,212 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 05:27:14,215 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:27:14,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:27:14,276 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:27:14,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:27:15,154 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:27:15,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:27:15,748 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:27:15,749 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:27:17,578 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:27:17,580 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:27:18,470 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:27:18,472 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:27:18,475 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 05:27:18,477 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 05:27:18,479 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:27:18,481 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:27:18,482 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:27:18,482 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:27:18,484 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:27:18,484 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:27:18,486 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:27:18,487 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 05:27:19,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 05:27:19,851 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 05:27:32,267 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 05:27:32,268 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:27:32,269 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:27:32,270 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:27:34,902 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:27:34,903 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:27:34,907 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:27:37,421 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:27:37,422 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:27:37,423 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:27:37,425 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:27:39,990 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:27:53,042 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:27:53,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:27:54,359 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:27:54,489 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:28:02,465 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:28:06,181 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:28:10,616 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:28:10,618 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:28:10,619 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:28:11,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:28:11,331 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:28:11,332 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:28:13,262 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:28:24,306 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:28:24,674 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 05:28:25,324 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:28:25,988 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-17 05:28:25,989 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:28:28,646 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 05:28:28,647 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:28:29,473 - ispa_next.appointments.models - DEBUG - Appointment Halil Karatas GG-NT 2025 WBA4M910009E10267 ohne Termin.
2025-11-17 05:28:29,480 - ispa_next.appointments.models - DEBUG - Appointment Hermann Felski WI-HF 992 WBAJP31020BT93193 ohne Termin.
2025-11-17 05:28:29,480 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:28:29,482 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:28:29,485 - ispa_next.main - DEBUG - 



2025-11-17 05:28:29,485 - ispa_next.main - DEBUG - starting with process 2 (GG-BM 24) of 5
2025-11-17 05:28:29,488 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:28:30,585 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:28:31,417 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-17 05:28:31,418 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 05:28:32,481 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:28:32,482 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:28:54,985 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:29:04,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:29:05,921 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:29:05,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:06,012 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:29:06,240 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:29:06,242 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:29:06,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:06,325 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:29:09,424 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:29:09,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:29:10,389 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:29:12,392 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:29:12,494 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:29:15,779 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:29:15,860 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:29:15,860 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:29:27,003 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:29:28,006 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:29:28,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:28,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:31,712 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 05:29:31,715 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:29:31,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:31,795 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:29:31,795 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:29:31,827 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:29:33,019 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:29:33,262 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:29:37,583 - ispa_next.functions - DEBUG - Updated appointment (AC00064309) customer contact data.
2025-11-17 05:29:38,520 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:29:38,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:38,634 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:29:38,770 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:29:38,771 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:29:39,376 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:29:39,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:29:40,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:29:43,654 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:29:43,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:29:44,132 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:29:46,136 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:29:46,236 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:29:46,364 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:29:46,434 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:29:46,435 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:29:57,479 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:30:57,482 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:31:08,841 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 05:31:15,818 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:31:15,818 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:31:19,992 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:31:20,997 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:31:20,998 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:31:20,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:31:21,061 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:31:25,178 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 05:31:25,182 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:31:25,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:31:25,256 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:31:29,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:31:29,857 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:31:29,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:31:30,605 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:31:30,607 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:31:31,927 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:31:31,930 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:31:32,817 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:31:32,820 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:31:32,822 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 05:31:32,824 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 05:31:32,824 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:31:32,826 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:31:32,827 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:31:32,828 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:31:32,829 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:31:32,830 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:31:32,831 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:31:32,833 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 05:31:33,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 05:31:34,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 05:31:47,035 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 05:31:47,037 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:31:47,039 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:31:47,039 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:31:48,908 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:31:48,909 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:31:48,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:31:50,723 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:31:50,724 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:31:50,726 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:31:50,727 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:31:52,569 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:32:05,108 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:32:05,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:32:06,345 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:32:06,476 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:32:13,912 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:32:18,187 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:32:18,188 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:32:18,189 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:32:18,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:32:18,878 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:32:18,880 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:32:20,698 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:32:28,206 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:32:28,586 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 05:32:29,082 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:32:29,509 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-17 05:32:29,510 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:32:32,022 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 05:32:32,023 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:32:32,791 - ispa_next.appointments.models - DEBUG - Appointment Halil Karatas GG-NT 2025 WBA4M910009E10267 ohne Termin.
2025-11-17 05:32:32,798 - ispa_next.appointments.models - DEBUG - Appointment Hermann Felski WI-HF 992 WBAJP31020BT93193 ohne Termin.
2025-11-17 05:32:32,798 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:32:32,799 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:32:32,802 - ispa_next.main - DEBUG - 



2025-11-17 05:32:32,802 - ispa_next.main - DEBUG - starting with process 3 (GG YA 107) of 5
2025-11-17 05:32:32,805 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:32:33,958 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:32:34,909 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-17 05:32:34,913 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 05:32:36,077 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:32:36,078 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:33:05,905 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:33:06,005 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 05:33:06,009 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:33:06,575 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-17 05:33:06,577 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:33:09,014 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 05:33:09,014 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:33:09,869 - ispa_next.appointments.models - DEBUG - Appointment Halil Karatas GG-NT 2025 WBA4M910009E10267 ohne Termin.
2025-11-17 05:33:09,877 - ispa_next.appointments.models - DEBUG - Appointment Hermann Felski WI-HF 992 WBAJP31020BT93193 ohne Termin.
2025-11-17 05:33:09,877 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:33:09,878 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:33:09,881 - ispa_next.main - DEBUG - 



2025-11-17 05:33:09,881 - ispa_next.main - DEBUG - starting with process 4 (F-S9617) of 5
2025-11-17 05:33:09,884 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:33:11,049 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:33:12,183 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-17 05:33:12,184 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 05:33:13,431 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:33:13,433 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:33:42,703 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:33:42,712 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 05:33:42,716 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:33:43,344 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-17 05:33:43,345 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:33:45,700 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 05:33:45,701 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:33:46,508 - ispa_next.appointments.models - DEBUG - Appointment Halil Karatas GG-NT 2025 WBA4M910009E10267 ohne Termin.
2025-11-17 05:33:46,517 - ispa_next.appointments.models - DEBUG - Appointment Hermann Felski WI-HF 992 WBAJP31020BT93193 ohne Termin.
2025-11-17 05:33:46,518 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:33:46,519 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:33:46,521 - ispa_next.main - DEBUG - 



2025-11-17 05:33:46,521 - ispa_next.main - DEBUG - starting with process 5 (FRI-MK 152) of 5
2025-11-17 05:33:46,524 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:33:47,628 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:33:48,787 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-17 05:33:48,788 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 05:33:50,224 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:33:50,225 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:34:23,192 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:34:23,201 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 05:34:23,204 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:34:23,713 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-17 05:34:23,714 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:34:26,071 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 05:34:26,072 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:34:26,825 - ispa_next.appointments.models - DEBUG - Appointment Halil Karatas GG-NT 2025 WBA4M910009E10267 ohne Termin.
2025-11-17 05:34:26,832 - ispa_next.appointments.models - DEBUG - Appointment Hermann Felski WI-HF 992 WBAJP31020BT93193 ohne Termin.
2025-11-17 05:34:26,832 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:34:26,833 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
