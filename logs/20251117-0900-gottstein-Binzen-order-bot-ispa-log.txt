2025-11-17 09:00:36,384 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 09:00:36,391 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 09:00:45,360 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:00:57,776 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:01:13,311 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:01:46,778 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 09:02:02,924 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 09:02:06,905 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:02:07,830 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2086
2025-11-17 09:02:07,830 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 607
2025-11-17 09:02:09,783 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 440
2025-11-17 09:02:09,784 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 09:02:09,785 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:02:10,642 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:02:11,564 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:03:29,815 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:03:29,816 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:03:29,817 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:03:29,817 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:03:29,828 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:03:29,885 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:03:29,951 - ispa_next.appointments.models - DEBUG - Appointment Elektro Rütten GmbH LÖ-ER 3003 WBS61AY0X0FS27171 ohne Termin.
2025-11-17 09:03:29,983 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:03:30,003 - ispa_next.appointments.models - DEBUG - Appointment Martins Alves Miguel BL 161006 WMW51DK0102S61307 ohne Termin.
2025-11-17 09:03:30,008 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:03:30,037 - ispa_next.appointments.models - DEBUG - Appointment Nasim Gul BS 21650 WBAWX710000G77966 ohne Termin.
2025-11-17 09:03:30,064 - ispa_next.appointments.models - DEBUG - Appointment Werner Osterwalder BL 34340 WBA3T71020PW23796 ohne Termin.
2025-11-17 09:03:30,081 - ispa_next.appointments.models - DEBUG - Appointment Norbert Pogorzelski M-HV 2094E WBA41GV0X0CV22369 ohne Termin.
2025-11-17 09:03:30,104 - ispa_next.appointments.models - DEBUG - Appointment   WBAFF01060L211755 ohne Termin.
2025-11-17 09:03:30,127 - ispa_next.appointments.models - DEBUG - Appointment Walter Schwarz LÖ-WH 97 WBAVP51000VM67447 ohne Termin.
2025-11-17 09:03:30,192 - ispa_next.appointments.models - DEBUG - Appointment Dagmar Klipp BL 181288 WMWXR510102M31464 ohne Termin.
2025-11-17 09:03:30,209 - ispa_next.appointments.models - DEBUG - Appointment Perihan Hasserbetrci BS 31642 WBA11FL08RCR21472 ohne Termin.
2025-11-17 09:03:30,225 - ispa_next.appointments.models - DEBUG - Appointment Kevin Spettl LÖ-K 956 WBS3C91060P708776 ohne Termin.
2025-11-17 09:03:30,259 - ispa_next.main - DEBUG - Found 6 out of 128 appointments to process (configured limit: 15).
2025-11-17 09:03:30,259 - ispa_next.main - DEBUG - Processing 6 fresh appointments.
2025-11-17 09:03:30,259 - ispa_next.main - DEBUG - All appointments: LÖ-AK 435, LÖ-BS 28, LÖ-MP 2005, LÖ-M 50180, LÖ-IK 9781, LÖ-M6H
2025-11-17 09:03:30,262 - ispa_next.main - DEBUG - 



2025-11-17 09:03:30,262 - ispa_next.main - DEBUG - starting with process 1 (LÖ-AK 435) of 6
2025-11-17 09:03:30,266 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:03:31,462 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:03:32,423 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2086
2025-11-17 09:03:32,424 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 440
2025-11-17 09:03:33,935 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:03:33,936 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:03:59,665 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:04:08,776 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:04:10,720 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:04:10,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:04:10,793 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:04:10,995 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:04:10,998 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:04:13,781 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:04:13,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:04:14,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:04:16,575 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:04:16,675 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:04:19,896 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 09:04:27,097 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 09:04:28,104 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:04:28,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:04:28,673 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:04:41,026 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:04:48,607 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:04:48,609 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:04:48,694 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:04:48,696 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:04:48,761 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:04:48,856 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:04:50,059 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:04:50,346 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:04:53,661 - ispa_next.functions - DEBUG - Updated appointment (AC00065275) customer contact data.
2025-11-17 09:04:54,580 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:04:54,582 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:04:54,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:04:55,446 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:04:56,840 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:04:56,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:04:57,016 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:05:00,590 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:05:00,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:05:01,110 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:05:03,118 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:05:03,216 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:05:03,301 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:05:03,419 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:05:07,647 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:05:08,654 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:05:08,657 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:05:08,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:05:08,777 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:05:09,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:05:09,713 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:05:09,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:05:10,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:05:10,479 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:05:12,900 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:05:12,903 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:05:13,856 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:05:13,857 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:05:13,859 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-17 09:05:13,860 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:05:13,862 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:05:13,863 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:05:13,864 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:05:13,866 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:05:13,867 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:05:13,868 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:05:13,870 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:05:14,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 09:05:15,238 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 09:05:24,360 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:05:24,367 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:05:24,369 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:05:24,370 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:05:27,593 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:05:27,596 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:05:27,598 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:05:27,600 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:05:27,603 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:05:27,605 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:05:30,868 - ispa_next.functions - DEBUG - adding material to item=Package(name=Ölwechsel im Doppelkupplungsgetriebe (DKG), source=cart, target=unkown)
2025-11-17 09:05:41,330 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:05:41,332 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:05:41,334 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:05:41,334 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:05:42,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:05:42,597 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:05:42,599 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:05:44,283 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:05:53,251 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:05:53,671 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 09:05:54,037 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:05:56,449 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2086
2025-11-17 09:05:56,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:05:59,205 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 607
2025-11-17 09:05:59,205 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:06:00,149 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:06:00,149 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:06:00,151 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:06:00,151 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:06:00,158 - ispa_next.main - DEBUG - Found new Appointment: B-AV 202
2025-11-17 09:06:00,161 - ispa_next.main - DEBUG - 



2025-11-17 09:06:00,161 - ispa_next.main - DEBUG - starting with process 2 (B-AV 202) of 7
2025-11-17 09:06:00,166 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:06:01,475 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:06:02,634 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2086
2025-11-17 09:06:02,636 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 607
2025-11-17 09:06:04,114 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:06:04,115 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:06:37,218 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:06:46,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:06:47,004 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:06:47,167 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:06:51,772 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:06:51,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:06:51,833 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:06:51,991 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:06:51,994 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:06:54,812 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:06:54,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:06:55,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:06:57,846 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:06:57,972 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:07:01,189 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:07:01,257 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:07:01,258 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:07:06,000 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:07:17,737 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:07:18,741 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:07:18,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:07:19,291 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:07:33,006 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 09:07:40,061 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:07:40,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:07:40,125 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:07:40,125 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:07:40,202 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:07:41,360 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:07:42,437 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:07:42,685 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:07:45,980 - ispa_next.functions - DEBUG - Updated appointment (AC00065274) customer contact data.
2025-11-17 09:07:46,892 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:07:46,895 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:07:47,751 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:07:47,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:07:48,469 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:07:52,058 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:07:52,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:07:52,556 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:07:54,560 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:07:54,663 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:07:54,760 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:07:54,876 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:07:54,878 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:07:59,638 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:08:11,124 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:09:11,133 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:09:22,824 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:09:30,200 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:09:30,202 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:34,956 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:09:37,116 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:09:38,155 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:09:38,160 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:09:38,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:09:38,243 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:09:38,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:09:39,175 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:09:39,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:09:39,923 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:09:39,924 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:09:44,138 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:09:44,140 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:09:45,294 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:09:45,295 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:09:45,297 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:09:45,298 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:09:45,300 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:09:45,301 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:09:45,303 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:09:45,304 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:09:45,312 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:09:45,316 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:09:45,321 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:09:45,323 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:09:45,324 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:49,979 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 09:09:52,638 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:09:52,652 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:09:52,694 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:09:52,697 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:09:52,701 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:09:52,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:57,694 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:09:57,697 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:09:57,699 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:09:57,699 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:09:58,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:09:59,315 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:09:59,317 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:10:01,354 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:10:09,576 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:10:09,965 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 09:10:10,388 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:10:12,807 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2088
2025-11-17 09:10:12,808 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:10:15,693 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 607
2025-11-17 09:10:15,694 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:10:16,401 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
2025-11-17 09:10:16,404 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:10:16,404 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:10:16,405 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:10:16,411 - ispa_next.main - DEBUG - 



2025-11-17 09:10:16,411 - ispa_next.main - DEBUG - starting with process 3 (LÖ-BS 28) of 7
2025-11-17 09:10:16,414 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:10:17,387 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:10:18,369 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2088
2025-11-17 09:10:18,370 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 607
2025-11-17 09:10:19,592 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:10:19,593 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:10:49,445 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:10:59,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:10:59,627 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:10:59,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:11:04,404 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:11:04,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:11:04,490 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:11:04,720 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:11:04,722 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:11:07,628 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:11:07,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:11:08,786 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:11:10,791 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:11:10,907 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:11:14,156 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:11:14,247 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:11:14,248 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:11:18,986 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:11:30,454 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:11:31,459 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:11:31,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:11:31,976 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:11:44,163 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:11:44,163 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 09:11:50,850 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:11:50,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:11:50,920 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:11:50,922 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:11:50,979 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:11:52,165 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:11:52,409 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:11:54,593 - ispa_next.functions - DEBUG - Updated appointment (AC00065270) customer contact data.
2025-11-17 09:11:55,483 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:11:55,485 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:11:56,390 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:11:56,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:11:57,181 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:12:01,796 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:12:01,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:12:02,286 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:12:04,290 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:12:04,411 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:12:04,507 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:12:04,578 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:12:04,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:12:10,049 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:12:21,047 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:12:28,029 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:12:28,031 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:12:33,490 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:12:37,675 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:12:38,683 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:12:38,689 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:12:38,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:12:38,799 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:12:52,922 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 09:12:57,089 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 09:12:57,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:12:57,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:12:57,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:12:58,344 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:12:58,345 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:13:03,086 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:13:03,091 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:13:04,052 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:13:04,052 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:13:04,055 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-17 09:13:04,058 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:13:04,061 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:13:04,064 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:13:04,067 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:13:04,068 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:13:04,069 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:13:04,071 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:13:04,074 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:13:24,181 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:13:24,182 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 09:13:29,405 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:13:29,407 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:13:29,408 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:13:35,631 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:13:35,633 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:13:35,635 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:13:35,637 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:13:35,639 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:13:35,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:13:41,608 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:13:41,611 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:13:41,614 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:13:41,614 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:13:42,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:13:42,902 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:13:42,904 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:13:44,845 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:13:53,068 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:13:53,449 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 09:13:53,759 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:13:56,005 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2088
2025-11-17 09:13:56,006 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:13:58,865 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 607
2025-11-17 09:13:58,866 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:13:59,778 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
2025-11-17 09:13:59,782 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:13:59,782 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:13:59,783 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:13:59,787 - ispa_next.main - DEBUG - 



2025-11-17 09:13:59,788 - ispa_next.main - DEBUG - starting with process 4 (LÖ-MP 2005) of 7
2025-11-17 09:13:59,791 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:14:01,044 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:14:02,304 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2088
2025-11-17 09:14:02,305 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 607
2025-11-17 09:14:03,867 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:14:03,868 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:14:27,278 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:14:37,570 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:14:40,847 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:14:40,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:14:40,910 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:14:41,153 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:14:41,157 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:14:43,998 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:14:43,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:14:45,106 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:14:47,111 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:14:47,245 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:14:50,451 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:14:50,511 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:14:50,512 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:14:53,873 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:15:05,331 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:15:06,336 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:15:06,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:15:07,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:15:16,408 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 09:15:23,755 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:15:23,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:15:23,828 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:15:23,829 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:15:23,869 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:15:25,077 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:15:26,177 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:15:26,435 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:15:28,822 - ispa_next.functions - DEBUG - Updated appointment (AA00111963) customer contact data.
2025-11-17 09:15:29,732 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:15:29,735 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:15:30,577 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:15:30,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:15:31,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:15:35,180 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:15:35,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:15:35,691 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:15:37,694 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:15:37,840 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:15:37,957 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:15:38,062 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:15:38,063 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:15:41,378 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:15:52,585 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:16:52,587 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:17:04,163 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:17:11,298 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:17:11,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:17:14,652 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:17:18,827 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:17:19,835 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:17:19,838 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:17:19,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:17:19,923 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:17:23,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:17:23,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:17:23,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:17:24,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:17:24,691 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:17:27,727 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:17:27,729 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:17:28,756 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:17:28,757 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:17:28,759 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:17:28,761 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:17:28,763 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:17:28,765 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:17:28,766 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:17:28,768 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:17:28,768 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:17:28,770 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:17:28,778 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:17:28,780 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:17:28,780 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:17:32,036 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:17:32,039 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:17:32,042 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:17:32,044 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:17:32,047 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:17:32,049 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:17:35,297 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:17:35,301 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:17:35,305 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:17:35,306 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:17:36,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:17:36,855 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:17:36,857 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:17:38,888 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:17:47,178 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:17:47,572 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 09:17:47,876 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:17:50,638 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2089
2025-11-17 09:17:50,639 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:17:53,662 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 609
2025-11-17 09:17:53,663 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:17:54,658 - ispa_next.appointments.models - DEBUG - Appointment Christian Schütt BL 196851 WBA3D11000J619419 ohne Termin.
2025-11-17 09:17:54,669 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
2025-11-17 09:17:54,671 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:17:54,672 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:17:54,677 - ispa_next.main - DEBUG - 



2025-11-17 09:17:54,677 - ispa_next.main - DEBUG - starting with process 5 (LÖ-M 50180) of 7
2025-11-17 09:17:54,681 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:17:55,959 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:17:57,347 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2089
2025-11-17 09:17:57,349 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 609
2025-11-17 09:17:58,872 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:17:58,873 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:18:29,746 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:18:29,839 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 09:18:29,843 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:18:30,422 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2089
2025-11-17 09:18:30,423 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:18:33,708 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 609
2025-11-17 09:18:33,709 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:18:34,643 - ispa_next.appointments.models - DEBUG - Appointment Christian Schütt BL 196851 WBA3D11000J619419 ohne Termin.
2025-11-17 09:18:34,654 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
2025-11-17 09:18:34,656 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:34,656 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:34,661 - ispa_next.main - DEBUG - 



2025-11-17 09:18:34,661 - ispa_next.main - DEBUG - starting with process 6 (LÖ-IK 9781) of 7
2025-11-17 09:18:34,665 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:18:35,999 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:18:37,596 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2089
2025-11-17 09:18:37,598 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 609
2025-11-17 09:18:39,068 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:18:39,070 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:19:09,884 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:19:09,895 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 09:19:09,899 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:19:10,333 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2089
2025-11-17 09:19:10,334 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:19:13,264 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 609
2025-11-17 09:19:13,265 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:19:14,235 - ispa_next.appointments.models - DEBUG - Appointment Christian Schütt BL 196851 WBA3D11000J619419 ohne Termin.
2025-11-17 09:19:14,246 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
2025-11-17 09:19:14,248 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:19:14,248 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:19:14,253 - ispa_next.main - DEBUG - 



2025-11-17 09:19:14,253 - ispa_next.main - DEBUG - starting with process 7 (LÖ-M6H) of 7
2025-11-17 09:19:14,268 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:19:15,552 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:19:16,532 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2089
2025-11-17 09:19:16,533 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 609
2025-11-17 09:19:17,811 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:19:17,812 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:19:46,797 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:19:46,806 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 09:19:46,809 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:19:47,202 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2089
2025-11-17 09:19:47,203 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:19:49,462 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 609
2025-11-17 09:19:49,462 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:19:50,211 - ispa_next.appointments.models - DEBUG - Appointment Christian Schütt BL 196851 WBA3D11000J619419 ohne Termin.
2025-11-17 09:19:50,222 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
2025-11-17 09:19:50,224 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:19:50,224 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
