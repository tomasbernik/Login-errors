2025-11-17 13:00:38,110 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 13:00:38,117 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 13:00:55,269 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:01:07,014 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:01:22,406 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:03:21,464 - ispa_next.app_start.main - DEBUG - Operation already took 107.39 seconds (more than 80 seconds)
2025-11-17 13:03:23,539 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6c79eca744b473b3\\tess_szbmldfm_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6c79eca744b473b3\\tess_szbmldfm', 'txt']
2025-11-17 13:03:23,856 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 13:03:23,860 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 13:03:23,862 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:05:22,797 - ispa_next.app_start.main - DEBUG - Operation already took 106.53 seconds (more than 80 seconds)
2025-11-17 13:05:24,876 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6c79eca744b473b3\\tess_7d_37g_a_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6c79eca744b473b3\\tess_7d_37g_a', 'txt']
2025-11-17 13:05:25,105 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 13:05:25,111 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 13:05:31,688 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 13:05:39,872 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:05:50,614 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:06:06,169 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:08:04,360 - ispa_next.app_start.main - DEBUG - Operation already took 107.17 seconds (more than 80 seconds)
2025-11-17 13:08:06,470 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6c79eca744b473b3\\tess_5719hvvh_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6c79eca744b473b3\\tess_5719hvvh', 'txt']
2025-11-17 13:08:06,692 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 13:08:06,696 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 13:08:06,698 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:10:05,818 - ispa_next.app_start.main - DEBUG - Operation already took 106.80 seconds (more than 80 seconds)
2025-11-17 13:10:07,906 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6c79eca744b473b3\\tess_obzjjv8__input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6c79eca744b473b3\\tess_obzjjv8_', 'txt']
2025-11-17 13:10:08,153 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 13:10:08,158 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 13:10:14,624 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 13:10:22,812 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:10:33,152 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:10:48,734 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:11:12,733 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 13:11:24,606 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 13:11:27,572 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:28,712 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-17 13:11:28,714 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 36
2025-11-17 13:11:30,827 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 14
2025-11-17 13:11:30,828 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 13:11:30,829 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:11:31,746 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:11:32,649 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:11:33,624 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 13:11:33,631 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
2025-11-17 13:11:33,632 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:11:33,669 - ispa_next.appointments.models - DEBUG - Appointment Firma Dachbau Gradl BUL-GX 42 WBA11CM0308C43879 ohne Termin.
2025-11-17 13:11:33,675 - ispa_next.appointments.models - DEBUG - Appointment Gregor Berki SAD-BK 161 WBA5V51060FH45254 ohne Termin.
2025-11-17 13:11:33,676 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:11:33,680 - ispa_next.main - DEBUG - Found 3 out of 6 appointments to process (configured limit: 15).
2025-11-17 13:11:33,680 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-17 13:11:33,680 - ispa_next.main - DEBUG - All appointments: SAD-MM 193, NAB-BW 440, SAD-HN 606
2025-11-17 13:11:33,683 - ispa_next.main - DEBUG - 



2025-11-17 13:11:33,683 - ispa_next.main - DEBUG - starting with process 1 (SAD-MM 193) of 3
2025-11-17 13:11:33,687 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:11:34,636 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:35,717 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-17 13:11:35,719 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 14
2025-11-17 13:11:37,138 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:11:37,140 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:12:06,976 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:12:16,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:16,607 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:12:16,840 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:18,081 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:12:18,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:18,158 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:12:18,350 - ispa_next.functions - DEBUG - HU date already expired after 384 days.
2025-11-17 13:12:25,112 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:12:25,115 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:12:25,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:25,187 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:12:34,610 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:12:34,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:12:35,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:12:37,701 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:12:37,803 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:12:41,023 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:12:41,091 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:12:41,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:42,313 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:12:53,639 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:12:54,643 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:12:54,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:55,155 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:08,177 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:13:14,465 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:13:14,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:14,552 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:13:14,552 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:13:14,591 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:13:15,826 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:13:16,965 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:13:17,210 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:13:20,977 - ispa_next.functions - DEBUG - Updated appointment (AB00037745) customer contact data.
2025-11-17 13:13:21,881 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:13:21,883 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:13:22,630 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:13:22,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:13:23,302 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:13:26,891 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:13:26,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:13:27,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:13:29,414 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:13:29,552 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:13:29,664 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:13:29,743 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:13:29,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:13:30,960 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:13:41,942 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:14:41,945 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:14:53,187 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:15:00,132 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:15:00,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:01,388 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:15:05,571 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:15:06,576 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:15:06,576 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:15:06,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:15:06,702 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:15:10,821 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:15:10,826 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:15:10,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:15:10,910 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:15:11,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:15:12,248 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:15:12,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:15:13,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:15:13,368 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:15:14,697 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:15:14,699 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:15:15,672 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:15:15,676 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:15:15,680 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Fzg Reinigung, source=from_tab, target=cart)}
2025-11-17 13:15:15,682 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:15:15,686 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:15:15,688 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:15:15,688 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:15:15,690 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:15:15,690 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:15:15,692 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:15:15,694 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:15:15,696 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:15:15,698 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:15:16,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:15:17,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:15:19,345 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:15:19,347 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:15:19,349 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:15:19,349 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:21,277 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:15:21,277 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:15:21,279 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:23,132 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:15:23,132 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 13:15:23,134 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:25,001 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:15:25,001 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:15:25,006 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:26,893 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:15:37,407 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:15:37,409 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:15:37,411 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:15:37,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:15:38,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:15:38,488 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:15:40,210 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:15:49,729 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:15:50,096 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 13:15:50,696 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:15:51,754 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 482
2025-11-17 13:15:51,756 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:15:54,732 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 37
2025-11-17 13:15:54,732 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:15:55,545 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 13:15:55,554 - ispa_next.appointments.models - DEBUG - Appointment Firma Food-SB GmbH NEN-LB 400 WBA11AJ070CL74137 ohne Termin.
2025-11-17 13:15:55,562 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
2025-11-17 13:15:55,566 - ispa_next.main - DEBUG - Found new Appointment: R-NM 61
2025-11-17 13:15:55,569 - ispa_next.main - DEBUG - 



2025-11-17 13:15:55,569 - ispa_next.main - DEBUG - starting with process 2 (R-NM 61) of 4
2025-11-17 13:15:55,572 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:15:56,794 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:15:57,777 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 482
2025-11-17 13:15:57,778 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 37
2025-11-17 13:15:58,885 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:15:58,886 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:16:33,253 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:16:42,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:42,978 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:16:43,263 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:16:44,486 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:16:44,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:44,569 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:16:44,827 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:16:44,829 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:16:44,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:44,915 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:16:54,228 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:16:54,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:16:55,314 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:16:57,321 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:16:57,450 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:17:00,690 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:17:00,758 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:17:00,760 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:01,965 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:17:13,378 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:17:14,381 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:17:14,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:14,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:24,375 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 13:17:31,391 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:17:31,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:31,477 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:17:31,479 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:17:31,512 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:17:31,600 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:17:32,792 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:17:33,031 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:17:36,847 - ispa_next.functions - DEBUG - Updated appointment (AB00037747) customer contact data.
2025-11-17 13:17:37,780 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:17:37,782 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:17:37,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:17:38,752 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:17:40,260 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:17:40,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:17:40,342 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:17:44,315 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:17:44,315 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:17:44,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:17:44,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:17:46,781 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:17:46,908 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:17:47,001 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:17:47,093 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:17:47,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:48,971 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:18:00,358 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:19:00,361 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:19:11,201 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:19:18,308 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:19:18,310 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:20,289 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:19:24,476 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:19:25,483 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:19:25,484 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:19:25,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:19:25,555 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:19:29,694 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:19:29,697 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:19:29,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:19:29,772 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:19:30,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:30,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:30,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:19:31,296 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:19:31,298 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:19:33,174 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:19:33,177 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:19:34,004 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:19:34,004 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:19:34,008 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Fzg Reinigung, source=from_tab, target=cart)}
2025-11-17 13:19:34,008 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:19:34,011 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:19:34,014 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:19:34,017 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:19:34,030 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:19:34,032 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:19:34,036 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:19:34,038 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:19:34,042 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:19:34,064 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:19:34,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:19:35,407 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:19:37,758 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:19:37,759 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:19:37,760 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:19:37,760 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:40,401 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:19:40,401 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:19:40,403 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:42,963 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:19:42,963 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 13:19:42,965 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:45,522 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:19:45,522 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:19:45,524 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:48,075 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:19:59,532 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:19:59,534 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:19:59,536 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:20:00,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:20:00,667 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:20:00,667 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:20:02,303 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:20:10,494 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:20:10,874 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 13:20:11,484 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:20:12,469 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 483
2025-11-17 13:20:12,471 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:20:15,278 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 37
2025-11-17 13:20:15,279 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:20:16,133 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 13:20:16,142 - ispa_next.appointments.models - DEBUG - Appointment Firma Food-SB GmbH NEN-LB 400 WBA11AJ070CL74137 ohne Termin.
2025-11-17 13:20:16,149 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
2025-11-17 13:20:16,153 - ispa_next.main - DEBUG - 



2025-11-17 13:20:16,153 - ispa_next.main - DEBUG - starting with process 3 (NAB-BW 440) of 4
2025-11-17 13:20:16,156 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:20:17,189 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:20:18,244 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 483
2025-11-17 13:20:18,245 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 37
2025-11-17 13:20:19,346 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:20:19,347 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:20:55,575 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:21:05,895 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:21:07,807 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:21:07,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:07,932 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:21:08,204 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:21:08,206 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:21:08,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:08,301 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:21:11,512 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:21:11,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:21:12,388 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:21:14,392 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:21:14,517 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:21:17,727 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:21:17,818 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:21:22,036 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:21:23,041 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:21:23,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:23,528 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:33,844 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:21:33,844 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 13:21:40,545 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:21:40,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:40,650 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:21:40,650 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:21:40,693 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:21:41,884 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:21:42,122 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:21:46,256 - ispa_next.functions - DEBUG - Updated appointment (AB00037744) customer contact data.
2025-11-17 13:21:47,190 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:21:47,190 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:21:47,912 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:21:47,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:21:48,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:21:52,260 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:21:52,262 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:21:52,264 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:21:52,266 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:21:52,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:21:52,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:21:56,910 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:21:57,515 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:22:08,859 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:22:08,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:22:08,955 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:22:09,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:22:09,868 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:22:09,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:22:10,672 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:22:10,674 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:22:12,573 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:22:12,578 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:22:13,934 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:22:13,936 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:22:13,938 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Fzg Reinigung, source=from_tab, target=cart)}
2025-11-17 13:22:13,940 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:22:13,942 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:22:13,944 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:22:13,944 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=manual, target=advice_list)}
2025-11-17 13:22:13,947 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:22:13,956 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:22:13,961 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:22:13,963 - ispa_next.package_manager.main - DEBUG - found packages to update: {Package(name=Bremse hinten, source=cart, target=update)}
2025-11-17 13:22:13,966 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:22:14,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:22:15,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:22:18,154 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:22:18,155 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 13:22:19,073 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:22:23,671 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 13:22:25,924 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:22:26,491 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:22:27,468 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:22:28,068 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:22:28,609 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:22:29,551 - ispa_next.package_manager.helper - DEBUG - _update_parts_in_package
2025-11-17 13:22:35,647 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:22:36,245 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:22:36,783 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:22:37,704 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:22:38,879 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:22:39,855 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:22:40,372 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:22:40,372 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:22:40,374 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:22:43,015 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 13:22:46,193 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:22:46,195 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:22:46,204 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:22:48,971 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:22:48,971 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 13:22:48,973 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:22:51,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:22:52,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:22:57,652 - ispa_next.functions - DEBUG - added beide Bremsscheiben hinten to cart
2025-11-17 13:23:02,087 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:23:02,089 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:23:02,091 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:23:05,442 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:23:24,802 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:23:24,804 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:23:24,804 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:23:25,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:23:26,996 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:23:26,997 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:23:29,553 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:23:39,616 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:23:39,998 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 13:23:41,467 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:23:42,235 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 483
2025-11-17 13:23:42,237 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:23:46,343 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 37
2025-11-17 13:23:46,344 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:23:47,428 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 13:23:47,452 - ispa_next.appointments.models - DEBUG - Appointment Firma Food-SB GmbH NEN-LB 400 WBA11AJ070CL74137 ohne Termin.
2025-11-17 13:23:47,458 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
2025-11-17 13:23:47,462 - ispa_next.main - DEBUG - 



2025-11-17 13:23:47,462 - ispa_next.main - DEBUG - starting with process 4 (SAD-HN 606) of 4
2025-11-17 13:23:47,465 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:23:49,148 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:23:50,798 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 483
2025-11-17 13:23:50,800 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 37
2025-11-17 13:23:52,499 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:23:52,501 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:24:26,917 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:24:38,831 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:24:41,397 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:24:41,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:24:41,497 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:24:41,853 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:24:41,855 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:24:41,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:24:41,945 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:24:45,414 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:24:45,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:24:47,052 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:24:49,054 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:24:49,184 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:24:52,503 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:24:52,634 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:24:52,635 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:24:55,272 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:25:06,940 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:25:07,944 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:25:07,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:25:08,483 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:25:21,836 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:25:31,190 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:25:31,194 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:25:31,291 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:25:31,291 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:25:31,348 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:25:32,751 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:25:34,038 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:25:34,255 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:25:37,479 - ispa_next.functions - DEBUG - Updated appointment (AG00013449) customer contact data.
2025-11-17 13:25:38,467 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:25:38,474 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:25:39,563 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:25:39,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:25:40,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:25:44,935 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:25:44,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:25:45,580 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:25:47,584 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:25:47,734 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:25:47,880 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:25:47,962 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:25:47,963 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:25:51,289 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:26:02,834 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:27:02,836 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:27:14,742 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:27:22,378 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:27:22,379 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:26,066 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:27:30,283 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:27:31,288 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:27:31,289 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:27:31,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:27:31,380 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:27:35,534 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:27:35,537 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:27:35,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:27:35,677 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:27:36,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:27:36,611 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:27:36,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:27:37,367 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:27:37,369 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:27:40,555 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:27:40,555 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:27:41,723 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:27:41,724 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:27:41,726 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Fzg Reinigung, source=from_tab, target=cart)}
2025-11-17 13:27:41,729 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:27:41,736 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:27:41,738 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:27:41,740 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:27:41,740 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:27:41,742 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:27:41,744 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:27:41,745 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:27:41,747 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:27:41,751 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:27:42,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:27:43,475 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:27:46,216 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:27:46,220 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:27:46,222 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:27:46,222 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:50,221 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:27:50,221 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:27:50,223 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:54,211 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:27:54,211 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 13:27:54,214 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:58,148 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:27:58,150 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:27:58,150 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:28:02,088 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:28:16,271 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:28:16,273 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:28:16,273 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:28:17,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:28:17,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:28:17,778 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:28:20,263 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:28:28,408 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:28:32,005 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 13:28:32,008 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:28:32,740 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 483
2025-11-17 13:28:32,742 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:28:36,347 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 37
2025-11-17 13:28:36,348 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:28:37,468 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 13:28:37,476 - ispa_next.appointments.models - DEBUG - Appointment Firma Food-SB GmbH NEN-LB 400 WBA11AJ070CL74137 ohne Termin.
2025-11-17 13:28:37,483 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
