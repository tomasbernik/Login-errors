2025-11-12 10:46:11,773 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:46:11,781 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:46:23,409 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:46:36,705 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:46:52,586 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:47:35,660 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:47:57,495 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:48:00,751 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:48:02,297 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 10:48:02,298 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 142
2025-11-12 10:48:05,514 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 138
2025-11-12 10:48:05,515 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:48:05,516 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:48:07,096 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:48:08,532 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:48:34,978 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:48:35,055 - ispa_next.appointments.models - DEBUG - Appointment Manuel Hermann Jaeger-Lenne GV-MJ 1989 WBAJG11030ED57177 ohne Termin.
2025-11-12 10:48:35,098 - ispa_next.appointments.models - DEBUG - Appointment Armaturen Vertrieb Alms GmbH ME-AA 340E WBY71AW020FT62013 ohne Termin.
2025-11-12 10:48:35,111 - ispa_next.appointments.models - DEBUG - Appointment   WBA11FZ090FR60998 ohne Termin.
2025-11-12 10:48:35,122 - ispa_next.appointments.models - DEBUG - Appointment Bianca Prins VIE-PE 881 WBA11AW010FL84234 ohne Termin.
2025-11-12 10:48:35,132 - ispa_next.appointments.models - DEBUG - Appointment Oliver Berndsen NE-JO 288E WBY31FK070CR63503 ohne Termin.
2025-11-12 10:48:35,147 - ispa_next.appointments.models - DEBUG - Appointment   WBY61EF0105W96493 ohne Termin.
2025-11-12 10:48:35,157 - ispa_next.appointments.models - DEBUG - Appointment Krajnc ME-VV 1979 WBA11EV0209W56488 ohne Termin.
2025-11-12 10:48:35,176 - ispa_next.main - DEBUG - Found 15 out of 29 appointments to process (configured limit: 15).
2025-11-12 10:48:35,177 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-12 10:48:35,178 - ispa_next.main - DEBUG - Processing 10 already visited appointments (w/ RKR not callable).
2025-11-12 10:48:35,178 - ispa_next.main - DEBUG - All appointments: VIE-RJ 766, NE-KM 1932, F-S685E, NE-X 1660, NE-RK 63, D-HW 238, NE-MS 2311, NE-EG 1989, NE-GB 2917, D-NE 397, NE-EY 9, NE-RI 1352, NE-IM 149, KR-HK 6000, NE-IK 4000
2025-11-12 10:48:35,181 - ispa_next.main - DEBUG - 



2025-11-12 10:48:35,181 - ispa_next.main - DEBUG - starting with process 1 (VIE-RJ 766) of 15
2025-11-12 10:48:35,185 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:48:36,667 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:48:38,329 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 10:48:38,330 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 138
2025-11-12 10:48:40,121 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:48:40,123 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:49:24,805 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:49:35,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:35,695 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:49:35,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:49:38,788 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:49:38,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:38,921 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:49:39,181 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:49:39,185 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:49:42,177 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:49:42,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:49:43,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:49:45,479 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:49:45,605 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:49:48,886 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:49:48,968 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:49:48,969 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:49:51,860 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:50:00,425 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:50:01,447 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:50:01,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:50:01,974 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:50:16,509 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:50:25,092 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:50:25,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:50:25,199 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:50:25,200 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:50:25,262 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:50:25,474 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:50:27,318 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:50:27,938 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:50:31,785 - ispa_next.functions - DEBUG - Updated appointment (AA00025031) customer contact data.
2025-11-12 10:50:32,745 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:50:32,747 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:50:32,884 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:50:33,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:50:35,423 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:50:35,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:50:35,602 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:50:39,266 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:50:39,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:50:39,772 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:50:41,774 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:50:41,937 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:50:42,045 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:50:42,152 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:50:42,154 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:50:45,610 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:50:54,288 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:51:54,291 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:52:02,685 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:52:25,688 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:52:34,346 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:52:42,710 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 10:52:43,716 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:52:43,719 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:52:43,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:52:43,839 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:52:44,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:52:44,842 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:52:44,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:52:45,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:52:45,679 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:52:48,894 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:52:48,896 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:52:49,950 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:52:49,952 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:52:49,955 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:52:49,956 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:52:49,957 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:52:49,959 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:52:49,961 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:52:49,962 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:52:49,964 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:52:49,965 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:52:49,968 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:52:49,971 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:52:49,973 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:52:49,974 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:52:53,471 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:52:53,473 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:52:53,476 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:52:56,908 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:52:56,911 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:52:56,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:52:57,805 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:52:57,876 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:52:57,878 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:53:01,300 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:53:13,627 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:53:14,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:53:14,648 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:53:14,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:53:47,713 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:53:52,881 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:53:57,580 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:54:02,405 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:54:02,408 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:54:02,409 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:54:03,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:54:03,269 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:54:03,271 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:54:05,523 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:54:16,944 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:54:17,391 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:54:18,314 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:54:19,095 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 10:54:19,098 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:54:22,987 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 142
2025-11-12 10:54:22,988 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:54:24,055 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 10:54:24,084 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 10:54:24,098 - ispa_next.main - DEBUG - 



2025-11-12 10:54:24,098 - ispa_next.main - DEBUG - starting with process 2 (NE-KM 1932) of 15
2025-11-12 10:54:24,102 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:54:25,575 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:54:27,261 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 10:54:27,263 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 142
2025-11-12 10:54:29,088 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:54:29,089 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:55:04,482 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:55:15,591 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:55:19,710 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:55:19,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:55:19,791 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:55:20,074 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:55:20,078 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:55:23,103 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:55:23,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:55:24,290 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:55:26,292 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:55:26,481 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:55:29,757 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:55:29,921 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:55:34,175 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:55:35,180 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:55:35,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:55:35,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:55:51,894 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:56:00,318 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:56:00,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:56:00,405 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:56:00,406 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:56:00,514 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:56:00,636 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:56:02,331 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:56:02,713 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:56:06,662 - ispa_next.functions - DEBUG - Updated appointment (AA00025025) customer contact data.
2025-11-12 10:56:07,567 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:56:07,569 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:56:07,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:56:08,733 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:56:10,405 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:56:10,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:56:10,603 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:56:14,264 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:56:14,264 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:56:14,267 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:56:14,270 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:56:14,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:56:14,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:56:18,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:56:19,442 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:56:19,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:56:20,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:56:20,163 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:56:24,580 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:56:24,582 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:56:25,622 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:56:25,624 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:56:25,634 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:56:25,637 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:56:25,640 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:56:25,646 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:56:25,647 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:56:25,648 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:56:25,651 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:56:25,652 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:56:25,654 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:56:25,657 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:56:25,659 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:56:25,660 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:56:30,596 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:56:33,598 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:56:33,600 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:56:33,603 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:56:38,454 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:56:38,456 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:56:38,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:56:39,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:56:39,730 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:56:51,726 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:56:51,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:56:56,554 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:57:09,856 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:57:10,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:57:10,996 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:57:11,196 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:57:57,290 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:58:02,303 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:58:07,065 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:58:12,492 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:58:17,293 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:58:22,682 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:58:22,685 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:58:22,685 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:58:23,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:58:23,570 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:58:23,571 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:58:25,749 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:58:35,654 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:58:36,047 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:58:36,736 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:58:37,970 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 10:58:37,971 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:58:42,044 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 142
2025-11-12 10:58:42,045 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:58:43,135 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 10:58:43,147 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 10:58:43,157 - ispa_next.main - DEBUG - 



2025-11-12 10:58:43,157 - ispa_next.main - DEBUG - starting with process 3 (F-S685E) of 15
2025-11-12 10:58:43,161 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:58:44,787 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:58:46,449 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 10:58:46,451 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 142
2025-11-12 10:58:48,303 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:58:48,304 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:59:30,138 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:59:30,288 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:59:30,292 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:59:30,853 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 10:59:30,855 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:59:34,279 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 142
2025-11-12 10:59:34,280 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:59:35,297 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 10:59:35,306 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 10:59:35,314 - ispa_next.main - DEBUG - 



2025-11-12 10:59:35,314 - ispa_next.main - DEBUG - starting with process 4 (NE-X 1660) of 15
2025-11-12 10:59:35,317 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:59:36,813 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:59:38,374 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 10:59:38,375 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 142
2025-11-12 10:59:40,044 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:59:40,046 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:00:10,321 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:00:27,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:00:27,551 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:00:27,747 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:00:35,263 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:00:35,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:00:35,340 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:00:35,727 - ispa_next.functions - DEBUG - HU date soon to be invalid in 4 days.
2025-11-12 11:00:44,031 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:00:44,035 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:00:46,916 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:00:46,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:00:48,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:00:50,578 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:00:50,997 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:00:51,159 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:00:51,299 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:00:51,300 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:00:59,080 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:01:11,049 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:01:16,877 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:01:16,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:01:26,857 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 11:01:30,409 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 11:01:32,652 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:01:35,393 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:01:36,399 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:01:36,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:01:37,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:01:53,977 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:02:03,429 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:02:03,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:02:03,521 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:02:03,522 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:02:03,603 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:02:03,798 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:02:05,748 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:02:06,117 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:02:09,864 - ispa_next.functions - DEBUG - Updated appointment (AC00010688) customer contact data.
2025-11-12 11:02:10,860 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:02:10,863 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:02:11,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:02:12,258 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:02:13,504 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:02:13,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:02:13,600 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:02:17,292 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:02:17,292 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:02:17,295 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:02:17,298 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:02:17,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:02:17,831 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:02:18,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:02:18,798 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:02:18,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:02:19,674 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:02:19,676 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:02:21,373 - ispa_next.package_manager.helper - DEBUG - couldn't retrieve pakage name in cart
2025-11-12 11:02:21,771 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 262, in run
    self._update_cart_content()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 36, in _update_cart_content
    self.containers[Container.CART] = self.ui_helper.get_cart_content(self.base_element)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 140, in get_cart_content
    element=item,
            ^^^^
UnboundLocalError: cannot access local variable 'cart_package_name' where it is not associated with a value

2025-11-12 11:02:21,793 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:02:21,794 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:02:22,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:02:23,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:02:23,485 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 11:02:23,510 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:02:27,274 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:02:27,278 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:27,958 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 11:02:27,960 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:02:32,476 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 142
2025-11-12 11:02:32,477 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:02:33,506 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 11:02:33,527 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 11:02:33,545 - ispa_next.main - DEBUG - 



2025-11-12 11:02:33,545 - ispa_next.main - DEBUG - starting with process 5 (NE-RK 63) of 15
2025-11-12 11:02:33,550 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:02:35,050 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:36,698 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 11:02:36,699 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 142
2025-11-12 11:02:38,396 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:02:38,397 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:03:05,626 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:03:16,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:03:18,800 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:03:18,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:18,934 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:19,146 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:03:19,149 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:03:22,162 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:03:22,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:03:22,444 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 11:03:22,859 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 11:03:22,881 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:03:22,881 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:03:23,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:03:24,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:03:24,363 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 11:03:24,392 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:03:27,533 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:03:27,536 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:03:28,074 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 11:03:28,075 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:03:32,478 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 142
2025-11-12 11:03:32,479 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:03:33,589 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 11:03:33,598 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 11:03:33,608 - ispa_next.main - DEBUG - 



2025-11-12 11:03:33,608 - ispa_next.main - DEBUG - starting with process 6 (D-HW 238) of 15
2025-11-12 11:03:33,612 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:03:35,145 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:03:37,261 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 11:03:37,262 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 142
2025-11-12 11:03:39,086 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:03:39,087 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:04:13,077 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:04:15,187 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:04:20,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:21,122 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:04:21,322 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:23,331 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:04:23,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:23,439 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:04:23,797 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:04:23,801 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:04:26,795 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:04:26,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:28,347 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:04:30,351 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:04:30,501 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:04:30,617 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:04:30,725 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:04:30,726 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:32,787 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:04:41,605 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:04:42,611 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:04:42,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:43,171 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:59,899 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:05:05,072 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:05:05,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:05,218 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:05:05,258 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:05:05,348 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:05:06,844 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:05:07,195 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:05:09,135 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:05:09,137 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:05:10,292 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:05:10,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:05:11,482 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:05:15,135 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:05:15,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:05:15,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:05:17,646 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:05:17,822 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:05:17,972 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:05:18,071 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:05:18,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:20,257 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:05:28,834 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:06:28,839 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:06:37,449 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:07:13,452 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:07:21,930 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:07:30,518 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:07:31,523 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:07:31,527 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:07:31,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:07:31,645 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:07:37,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:37,766 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:37,767 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:07:38,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:07:38,645 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:07:40,610 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:07:40,613 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:07:41,794 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:07:41,796 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:07:41,801 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:07:41,804 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:07:41,807 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:07:41,819 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:07:41,825 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:07:41,828 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:07:41,831 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:07:41,832 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:07:41,835 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:07:41,838 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:07:41,840 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:07:41,841 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:07:43,906 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:07:43,908 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:07:43,910 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:07:45,962 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:07:45,964 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:07:45,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:07:46,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:07:46,994 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:07:46,996 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:07:49,528 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:08:02,229 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:08:02,717 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:08:03,261 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:08:03,473 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:22,577 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:08:28,349 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:08:28,351 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:08:28,352 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:08:29,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:08:29,184 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:08:29,186 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:08:31,440 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:08:41,004 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:08:41,518 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:08:42,594 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:43,460 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 11:08:43,461 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:47,468 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 142
2025-11-12 11:08:47,469 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:48,459 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 11:08:48,468 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 11:08:48,476 - ispa_next.main - DEBUG - 



2025-11-12 11:08:48,476 - ispa_next.main - DEBUG - starting with process 7 (NE-MS 2311) of 15
2025-11-12 11:08:48,479 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:08:49,996 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:51,667 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 11:08:51,669 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 142
2025-11-12 11:08:53,936 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:53,937 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:26,727 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:09:28,986 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:09:34,772 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:36,847 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:09:36,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:37,053 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:09:37,329 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:09:37,332 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:09:40,330 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:09:40,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:09:41,765 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:09:43,768 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:09:43,907 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:09:44,023 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:09:44,165 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:09:48,391 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:09:49,398 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:09:49,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:50,007 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:05,080 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:10:05,082 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:10:10,244 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:10:10,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:10,336 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:10:10,337 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:10:10,421 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:10:11,882 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:10:13,595 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:10:13,951 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:10:16,338 - ispa_next.functions - DEBUG - Updated appointment (AB00014473) customer contact data.
2025-11-12 11:10:17,270 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:10:17,278 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:10:18,337 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:10:18,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:10:19,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:10:23,485 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:10:23,485 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:10:23,486 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:10:23,489 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:10:23,492 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:10:23,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:23,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:10:27,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:28,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:28,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:28,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:10:28,954 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:10:30,990 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:10:30,993 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:10:32,654 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:10:32,655 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:10:32,658 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:10:32,659 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:10:32,661 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:10:32,664 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:10:32,665 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:10:32,666 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:10:32,669 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:10:32,670 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:10:32,672 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:10:32,675 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:10:32,677 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:10:32,678 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:34,735 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:10:34,737 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:10:34,740 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:37,008 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:10:37,010 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:10:37,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:10:38,173 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:10:38,488 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:47,890 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:10:47,894 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:50,071 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:11:03,374 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:11:03,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:11:04,498 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:11:04,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:23,918 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:29,603 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:29,606 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:11:29,607 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:30,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:11:30,448 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:11:30,451 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:11:32,763 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:11:42,177 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:11:42,574 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:11:43,772 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:44,490 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 11:11:44,491 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:48,976 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 142
2025-11-12 11:11:48,978 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:50,160 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 11:11:50,172 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 11:11:50,179 - ispa_next.main - DEBUG - 



2025-11-12 11:11:50,179 - ispa_next.main - DEBUG - starting with process 8 (NE-EG 1989) of 15
2025-11-12 11:11:50,183 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:51,755 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:53,406 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 381
2025-11-12 11:11:53,408 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 142
2025-11-12 11:11:55,342 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:55,343 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:28,068 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:12:30,283 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:12:35,847 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:38,576 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:12:38,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:38,749 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:38,965 - ispa_next.functions - DEBUG - HU date already expired after 808 days.
2025-11-12 11:12:44,015 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:12:44,019 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:12:46,923 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:12:46,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:48,300 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:50,303 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:12:50,480 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:12:50,575 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:12:50,699 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:12:52,917 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:12:53,923 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:12:53,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:54,469 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:10,907 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:13:16,558 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:13:16,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:16,670 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:13:16,671 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:13:16,783 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:13:16,977 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:13:18,647 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:13:18,966 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:13:21,566 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:13:21,627 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:13:21,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:13:22,902 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:13:24,091 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:13:24,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:13:24,189 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:13:27,850 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:13:27,850 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:13:27,853 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:13:27,856 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:13:27,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:28,366 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:13:28,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:29,437 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:29,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:30,240 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:13:30,242 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:13:32,885 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:13:32,887 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:13:34,873 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:13:34,874 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:13:34,877 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:13:34,878 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:13:34,879 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:13:34,882 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:13:34,883 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:13:34,884 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:13:34,887 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:13:34,888 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:13:34,890 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:13:34,894 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:13:34,896 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:13:34,896 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:37,764 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:13:37,766 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:13:37,769 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:40,495 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:13:40,497 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:13:40,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:13:41,548 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:13:41,804 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:51,100 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:13:51,102 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:53,932 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:14:07,331 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:14:07,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:14:08,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:14:08,678 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:14:36,118 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:41,555 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:46,803 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:46,806 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:14:46,807 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:47,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:14:47,713 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:14:47,715 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:14:50,127 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:14:59,519 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:14:59,931 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:15:01,879 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:02,864 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:15:02,865 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:07,281 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 11:15:07,282 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:08,316 - ispa_next.appointments.models - DEBUG - Appointment Peri Vertrieb Deutschland GmbH & CO.KG NU-P 2200 WBA11AJ0X0CJ91461 ohne Termin.
2025-11-12 11:15:08,323 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 11:15:08,332 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 11:15:08,339 - ispa_next.main - DEBUG - 



2025-11-12 11:15:08,339 - ispa_next.main - DEBUG - starting with process 9 (NE-GB 2917) of 15
2025-11-12 11:15:08,343 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:15:09,854 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:11,583 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:15:11,586 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 11:15:13,616 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:13,618 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:44,929 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:15:47,699 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:15:53,263 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:55,959 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:15:55,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:56,144 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:15:56,439 - ispa_next.functions - DEBUG - HU date already expired after 435 days.
2025-11-12 11:16:01,932 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:16:01,935 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:16:04,763 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:16:04,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:16:06,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:16:08,005 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:16:08,176 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:16:08,284 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:16:08,408 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:16:12,692 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:16:13,697 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:16:13,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:14,245 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:31,195 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:16:36,781 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:16:36,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:36,940 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:16:36,954 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:16:37,022 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:16:37,227 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:16:39,008 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:16:39,355 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:16:41,732 - ispa_next.functions - DEBUG - Updated appointment (AC00010673) customer contact data.
2025-11-12 11:16:42,690 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:16:42,692 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:16:42,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:16:43,887 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:16:45,152 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:16:45,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:16:45,281 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:16:49,407 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:16:49,407 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:16:49,410 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:16:49,415 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:16:49,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:16:49,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:16:50,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:50,906 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:50,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:16:51,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:16:51,812 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:16:54,470 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:16:54,472 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:16:55,841 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:16:55,842 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:16:55,845 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:16:55,846 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:16:55,848 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:16:55,851 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:16:55,852 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:16:55,853 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:16:55,855 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:16:55,856 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:16:55,859 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:16:55,862 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:16:55,864 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:16:55,865 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:58,775 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:16:58,776 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:16:58,778 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:01,560 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:17:01,561 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:17:01,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:17:02,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:17:02,737 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:09,168 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:17:09,171 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:11,997 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:17:25,615 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:17:26,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:17:26,684 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:17:26,959 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:54,741 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:00,192 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:05,594 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:05,596 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:18:05,597 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:06,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:06,495 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:18:06,497 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:18:08,834 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:18:18,719 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:18:19,128 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:18:20,314 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:21,684 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:18:21,685 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:25,508 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 11:18:25,508 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:26,963 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 11:18:26,975 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 11:18:26,992 - ispa_next.main - DEBUG - Found new Appointment: NU-P 2200
2025-11-12 11:18:26,994 - ispa_next.main - DEBUG - 



2025-11-12 11:18:26,994 - ispa_next.main - DEBUG - starting with process 10 (NU-P 2200) of 16
2025-11-12 11:18:27,037 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:28,532 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:30,329 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:18:30,330 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 11:18:32,174 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:32,175 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:15,725 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:19:27,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:27,492 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:27,692 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:31,185 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:19:31,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:31,361 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:31,737 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:19:31,741 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:19:34,766 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:34,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:36,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:19:38,521 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:19:38,681 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:19:38,784 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:19:38,921 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:19:38,923 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:42,449 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:19:53,555 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:19:58,334 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:19:58,336 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:01,917 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:20:06,164 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:20:07,170 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:20:07,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:07,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:26,412 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:20:35,766 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:20:35,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:35,922 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:35,923 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:20:36,065 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:20:38,104 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:20:38,526 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:20:42,658 - ispa_next.functions - DEBUG - Updated appointment (AA00025035) customer contact data.
2025-11-12 11:20:43,593 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:20:43,690 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:20:44,597 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:20:44,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:20:45,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:20:49,410 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:20:49,411 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:20:49,415 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:20:49,419 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:20:49,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:49,951 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:50,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:50,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:50,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:51,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:51,852 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:20:55,658 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:20:55,667 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:20:57,029 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:20:57,031 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:57,035 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:20:57,037 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:20:57,038 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:57,041 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:20:57,042 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:20:57,043 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:20:57,045 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:20:57,046 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:20:57,049 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:20:57,052 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:20:57,055 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:20:57,055 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:00,779 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:21:00,781 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:21:00,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:04,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:04,369 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:21:15,034 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:29,166 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:21:29,168 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:21:29,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:21:30,392 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:21:30,799 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:41,531 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:21:41,533 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:44,924 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:21:58,709 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:21:59,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:21:59,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:22:00,060 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:26,763 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:22:26,764 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:27,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:27,680 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:22:27,681 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:22:32,593 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:22:43,201 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:22:43,600 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 11:22:45,555 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:46,566 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:22:46,567 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:51,669 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 11:22:51,670 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:22:52,763 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 11:22:52,775 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 11:22:52,785 - ispa_next.main - DEBUG - 



2025-11-12 11:22:52,785 - ispa_next.main - DEBUG - starting with process 11 (D-NE 397) of 16
2025-11-12 11:22:52,790 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:54,353 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:56,292 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:22:56,294 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 11:22:58,324 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:58,325 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:33,730 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:23:36,697 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:23:42,536 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:48,862 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:23:48,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:48,966 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:49,356 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:23:49,359 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:23:52,453 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:23:52,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:23:53,715 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:23:55,719 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:23:55,889 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:23:56,062 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:23:56,141 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:24:00,384 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:24:01,391 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:24:01,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:02,560 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:18,304 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:24:24,290 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:24:24,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:24,467 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:24:24,468 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:24:24,612 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:24:24,786 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:24:26,298 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:24:26,631 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:24:28,742 - ispa_next.functions - DEBUG - Updated appointment (AA00024911) customer contact data.
2025-11-12 11:24:29,786 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:24:29,788 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:24:29,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:24:31,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:24:33,047 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:24:33,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:24:33,159 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:24:36,844 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:24:36,844 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:24:36,848 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:24:36,852 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:24:36,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:37,427 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:37,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:38,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:38,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:39,220 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:39,222 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:24:44,909 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:24:44,934 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:24:46,190 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:24:46,214 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:24:46,224 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:24:46,226 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:24:46,227 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:24:46,230 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:24:46,231 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:24:46,232 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:24:46,235 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:24:46,236 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:24:46,238 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:24:46,242 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:24:46,244 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:24:46,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:52,852 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:24:52,854 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:24:52,859 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:59,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:59,380 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:25:14,331 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:25:14,333 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:25:14,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:25:15,432 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:25:15,796 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:29,488 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:25:29,490 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:35,779 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:25:49,787 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:25:50,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:25:50,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:25:51,136 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:51,585 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:26:58,548 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:04,311 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:10,791 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:18,119 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:24,706 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:29,906 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:36,974 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:41,475 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:27:41,476 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:27:42,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:27:42,476 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:27:42,478 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:27:48,341 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:27:59,404 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:27:59,800 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 11:28:01,773 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:28:02,873 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:28:02,874 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:28:07,056 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 11:28:07,057 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:28:08,137 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 11:28:08,150 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 11:28:08,166 - ispa_next.main - DEBUG - 



2025-11-12 11:28:08,166 - ispa_next.main - DEBUG - starting with process 12 (NE-EY 9) of 16
2025-11-12 11:28:08,170 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:28:10,487 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:28:12,368 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:28:12,369 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 11:28:14,326 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:28:14,327 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:28:56,767 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:28:59,371 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:29:05,192 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:07,287 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:29:07,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:07,465 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:29:07,840 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:29:07,843 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:29:10,904 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:29:10,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:12,587 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:29:14,590 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:29:14,772 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:29:14,951 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:29:15,077 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:29:19,412 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:29:20,419 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:29:20,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:20,927 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:39,057 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:29:47,144 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:29:47,148 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:47,375 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:29:47,377 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:29:47,509 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:29:48,958 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:29:49,347 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:29:51,514 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:29:51,517 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:29:52,566 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:29:52,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:29:53,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:29:57,530 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:29:57,530 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:29:57,533 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:29:57,536 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:29:57,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:58,066 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:29:58,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:59,548 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:59,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:30:00,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:30:00,656 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:30:02,688 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:30:02,690 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:30:04,100 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:30:04,102 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:30:04,105 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:30:04,106 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:30:04,108 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:30:04,112 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:30:04,113 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:30:04,114 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:30:04,118 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:30:04,120 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:30:04,152 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:30:04,156 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:30:04,158 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:30:04,159 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:06,328 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:30:06,330 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:30:06,334 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:08,471 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:30:08,473 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:30:08,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:30:09,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:30:10,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:19,351 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:30:19,355 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:21,542 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:30:35,656 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:30:36,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:30:36,785 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:30:37,035 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:56,357 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:02,482 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:02,485 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:31:02,486 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:03,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:31:03,378 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:31:03,380 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:31:05,525 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:31:16,114 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:31:16,534 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 11:31:17,985 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:19,029 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:31:19,030 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:31:23,123 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 11:31:23,124 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:24,272 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 11:31:24,281 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 11:31:24,289 - ispa_next.main - DEBUG - 



2025-11-12 11:31:24,289 - ispa_next.main - DEBUG - starting with process 13 (NE-RI 1352) of 16
2025-11-12 11:31:24,292 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:25,880 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:27,733 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:31:27,739 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 11:31:29,645 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:31:29,646 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:32:16,144 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:32:18,574 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:32:24,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:26,397 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:32:26,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:26,507 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:32:26,799 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:32:26,809 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:32:29,876 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:32:29,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:32:31,419 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:32:33,423 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:32:33,549 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:32:33,713 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:32:33,826 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:32:38,038 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:32:39,044 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:32:39,045 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:39,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:57,173 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:33:02,185 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:33:02,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:02,355 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:33:02,356 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:33:02,426 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:33:04,019 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:33:04,388 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:33:06,551 - ispa_next.functions - DEBUG - Updated appointment (AC00010676) customer contact data.
2025-11-12 11:33:07,683 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:33:07,685 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:33:08,633 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:33:08,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:33:09,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:33:14,040 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:33:14,040 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:33:14,041 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:33:14,044 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:33:14,049 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:33:14,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:33:14,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:33:18,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:19,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:19,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:33:20,470 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:33:20,472 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:33:22,548 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:33:22,550 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:33:24,550 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:33:24,551 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:33:24,554 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:33:24,555 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:33:24,556 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:33:24,560 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:33:24,561 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:33:24,562 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:33:24,564 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:33:24,565 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:33:24,568 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:33:24,571 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:33:24,573 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:33:24,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:26,725 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:33:26,727 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:33:26,730 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:28,810 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:33:28,813 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:33:28,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:33:30,142 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:33:30,475 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:40,071 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:33:40,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:42,288 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:33:56,796 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:33:57,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:33:58,101 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:33:58,272 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:34:17,707 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:23,883 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:23,885 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:34:23,886 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:34:24,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:34:24,797 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:34:24,802 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:34:27,106 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:34:38,034 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:34:38,474 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 11:34:39,865 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:34:40,989 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:34:40,991 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:34:45,511 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 11:34:45,512 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:34:46,706 - ispa_next.appointments.models - DEBUG - Appointment heiderbeck Service GmbH & Co. KG FFB-HB 59E WBY71HD040FV48633 ohne Termin.
2025-11-12 11:34:46,717 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 11:34:46,725 - ispa_next.main - DEBUG - 



2025-11-12 11:34:46,725 - ispa_next.main - DEBUG - starting with process 14 (NE-IM 149) of 16
2025-11-12 11:34:46,728 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:34:48,303 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:34:50,129 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:34:50,131 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 11:34:52,077 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:34:52,078 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:35:32,207 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:35:34,882 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:35:40,730 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:43,627 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:35:43,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:43,729 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:35:44,092 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:35:49,479 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:35:49,483 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:35:52,369 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:35:52,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:35:53,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:35:55,984 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:35:56,168 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:35:56,296 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:35:56,454 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:35:58,598 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:35:59,604 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:35:59,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:00,125 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:18,979 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:36:25,281 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:36:25,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:25,388 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:36:25,389 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:36:25,521 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:36:25,686 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:36:27,575 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:36:27,958 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:36:30,135 - ispa_next.functions - DEBUG - Updated appointment (AA00024982) customer contact data.
2025-11-12 11:36:31,050 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:36:31,053 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:36:32,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:36:33,727 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:36:35,023 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:36:35,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:36:35,123 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:36:39,207 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:36:39,207 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:36:39,243 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:36:39,248 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:36:39,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:36:39,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:36:40,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:40,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:40,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:36:41,795 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:36:41,797 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:36:44,357 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:36:44,359 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:36:47,136 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:36:47,139 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:36:47,143 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:36:47,144 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:36:47,145 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:36:47,149 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:36:47,150 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:36:47,151 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:36:47,154 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:36:47,155 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:36:47,157 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:36:47,161 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:36:47,163 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:36:47,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:50,300 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:36:50,302 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:36:50,304 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:53,046 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:36:53,047 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:36:53,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:36:54,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:36:54,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:37:10,079 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:37:10,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:37:12,836 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:37:26,988 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:37:27,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:37:28,262 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:37:28,425 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:37:55,325 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:38:01,258 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:38:07,255 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:38:07,258 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:38:07,259 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:38:08,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:38:08,144 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:38:08,146 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:38:10,505 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:38:22,449 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:38:22,828 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 11:38:24,325 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:38:25,481 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:38:25,482 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:38:30,588 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 143
2025-11-12 11:38:30,588 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:38:31,694 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 11:38:31,702 - ispa_next.main - DEBUG - 



2025-11-12 11:38:31,703 - ispa_next.main - DEBUG - starting with process 15 (KR-HK 6000) of 16
2025-11-12 11:38:31,706 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:38:33,280 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:38:35,062 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:38:35,063 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 143
2025-11-12 11:38:37,268 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:38:37,269 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:39:15,264 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:39:17,762 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:39:24,287 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:28,453 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:39:28,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:39:28,558 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:39:28,876 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:39:28,879 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:39:31,891 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:39:31,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:39:33,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:39:35,682 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:39:35,922 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:39:36,024 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:39:36,116 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:39:40,457 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:39:41,476 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:39:41,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:39:41,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:00,494 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:40:07,289 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:40:07,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:07,461 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:40:07,462 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:40:07,550 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:40:07,749 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:40:09,507 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:40:09,873 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:40:12,145 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:40:12,148 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:40:12,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:40:13,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:40:14,917 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:40:14,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:40:15,113 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:40:18,807 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:40:18,808 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:40:18,812 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:40:18,816 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:40:18,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:40:19,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:40:28,135 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 11:40:40,359 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:40:40,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:41,813 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:41,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:40:42,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:40:42,629 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:40:46,449 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:40:46,453 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:40:48,980 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:40:48,981 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:40:48,985 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:40:48,986 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:40:48,987 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:40:48,993 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:40:48,995 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:40:48,996 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:40:48,999 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:40:49,001 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:40:49,004 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:40:49,007 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:40:49,010 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:40:49,011 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:40:53,543 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:40:53,545 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:40:53,547 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:40:57,861 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:40:57,863 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:40:57,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:40:59,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:40:59,160 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:13,927 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:41:13,929 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:18,156 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:41:31,570 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:41:32,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:41:32,806 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:41:32,969 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:42:14,026 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:42:20,041 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:42:25,653 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:42:31,792 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:42:38,502 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:42:38,504 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:42:38,505 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:42:39,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:42:39,480 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:42:39,482 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:42:42,072 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:42:52,984 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:42:53,465 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 11:42:54,939 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:42:56,111 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:42:56,112 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:43:00,644 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 142
2025-11-12 11:43:00,645 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:43:01,941 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 11:43:01,952 - ispa_next.main - DEBUG - 



2025-11-12 11:43:01,953 - ispa_next.main - DEBUG - starting with process 16 (NE-IK 4000) of 16
2025-11-12 11:43:01,956 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:43:04,352 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:43:06,147 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:43:06,148 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 142
2025-11-12 11:43:08,118 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:43:08,120 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:43:49,424 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:43:51,946 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:43:57,785 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:01,568 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:44:01,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:44:01,723 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:44:02,171 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:44:02,174 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:44:05,174 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:44:05,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:44:06,804 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:44:08,829 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:44:08,952 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:44:09,122 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:44:09,200 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:44:13,442 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:44:14,447 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:44:14,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:44:15,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:44:32,789 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:44:38,675 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:44:38,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:44:38,800 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:44:38,801 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:44:38,961 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:44:39,194 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:44:40,659 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:44:41,048 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:44:43,577 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:44:43,579 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:44:43,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:44:45,086 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:44:46,296 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:44:46,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:44:46,396 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:44:50,054 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:44:50,054 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:44:50,057 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:44:50,060 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:44:50,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:44:50,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:44:55,394 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:45:06,294 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:45:06,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:45:07,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:45:07,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:45:08,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:45:08,382 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:45:11,648 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:45:11,651 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:45:12,875 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:45:12,876 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:45:12,879 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 11:45:12,880 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:45:12,881 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:45:12,885 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:45:12,886 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:45:12,888 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:45:12,891 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:45:12,893 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:45:12,896 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:45:12,900 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:45:12,902 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:45:12,903 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:45:16,474 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:45:16,476 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:45:16,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:45:19,909 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:45:19,912 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:45:19,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:45:21,195 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:45:21,519 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:45:30,739 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:45:30,741 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:45:34,250 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:45:48,643 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:45:49,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:45:50,056 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:45:50,242 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:24,291 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:46:30,509 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:46:36,831 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:46:43,450 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:46:43,452 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:46:43,453 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:46:44,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:46:44,380 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:46:44,382 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:46:46,937 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:46:57,577 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:46:57,979 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 11:46:59,493 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:47:00,575 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 382
2025-11-12 11:47:00,576 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:47:05,973 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 142
2025-11-12 11:47:05,974 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:47:07,130 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
