2025-11-17 15:14:37,619 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 15:14:37,626 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 15:14:47,724 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 15:14:58,253 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 15:15:14,134 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:15:38,233 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 15:15:50,059 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 15:15:53,309 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:15:54,579 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 569
2025-11-17 15:15:54,580 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 118
2025-11-17 15:15:57,197 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 81
2025-11-17 15:15:57,198 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 15:15:57,199 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:15:58,345 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:15:59,180 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:16:11,189 - ispa_next.appointments.models - DEBUG - Appointment Doris Gastreich-Rode MZ-R 5915E WBA31EF0005417777 ohne Termin.
2025-11-17 15:16:11,197 - ispa_next.appointments.models - DEBUG - Appointment Mohamed Alah Haffar GG-AR 840 WBAJP310X0CD44613 ohne Termin.
2025-11-17 15:16:11,203 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:16:11,215 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:16:11,218 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:16:11,221 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:16:11,231 - ispa_next.appointments.models - DEBUG - Appointment Firma La Rosa GmbH GG-DI 2016 WBAJJ310603M78808 ohne Termin.
2025-11-17 15:16:11,240 - ispa_next.appointments.models - DEBUG - Appointment Hiltrud Marx WI-XM 25 WMWWJ910003L15788 ohne Termin.
2025-11-17 15:16:11,246 - ispa_next.appointments.models - DEBUG - Appointment Masoumeh Rashvand Sardari GG-SH 141 WBA2V110009C09071 ohne Termin.
2025-11-17 15:16:11,254 - ispa_next.main - DEBUG - Found 1 out of 28 appointments to process (configured limit: 15).
2025-11-17 15:16:11,254 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-17 15:16:11,254 - ispa_next.main - DEBUG - All appointments: GG-CT 223E
2025-11-17 15:16:11,256 - ispa_next.main - DEBUG - 



2025-11-17 15:16:11,256 - ispa_next.main - DEBUG - starting with process 1 (GG-CT 223E) of 1
2025-11-17 15:16:11,260 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:16:12,291 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:16:13,575 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 569
2025-11-17 15:16:13,576 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 81
2025-11-17 15:16:14,763 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:16:14,764 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:16:53,999 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:17:03,906 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:17:07,819 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:17:07,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:07,888 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:08,088 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:17:08,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:08,192 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:12,313 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:17:12,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:12,391 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:15,405 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:17:15,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:17:16,421 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:17:18,427 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:17:18,538 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:17:18,638 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:17:18,717 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:17:18,717 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:17:29,778 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:17:30,782 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:17:30,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:31,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:44,698 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:17:52,212 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:17:52,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:52,299 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:52,300 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:17:52,375 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:17:53,632 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:17:54,858 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:17:55,152 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:18:00,632 - ispa_next.functions - DEBUG - Updated appointment (AE00049918) customer contact data.
2025-11-17 15:18:01,538 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:18:01,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:18:01,653 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:18:01,796 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 15:18:01,798 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:18:02,662 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:18:02,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:18:03,369 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:18:07,826 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:18:07,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:18:08,339 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:18:10,344 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:18:10,464 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:18:10,594 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:18:10,665 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:18:10,666 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:18:22,078 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 15:18:29,464 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:18:29,464 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:18:33,668 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:18:34,674 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:18:34,675 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:18:34,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:18:34,795 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:18:38,886 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 15:18:39,699 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 15:18:51,115 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:18:51,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:18:51,230 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:19:01,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:19:02,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:19:02,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:02,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:19:02,941 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:19:07,766 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:19:07,772 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:19:09,221 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:19:09,222 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:19:09,224 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 15:19:09,226 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 15:19:09,227 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:19:09,228 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 15:19:09,230 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:19:09,231 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:19:09,233 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:19:09,243 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:19:09,247 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:19:09,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 15:19:10,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 15:19:24,780 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:19:24,781 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 15:19:27,764 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:19:28,316 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:19:29,264 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:19:29,881 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:19:30,427 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:19:31,353 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:19:31,971 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:19:32,532 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:19:33,447 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:19:34,003 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:19:34,554 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:19:35,525 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:19:36,140 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:19:36,671 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:19:37,600 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:19:38,171 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:19:38,721 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:19:39,655 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:19:40,235 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:19:40,789 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:19:42,280 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:19:42,895 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:19:43,432 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:19:44,369 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:19:45,763 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:19:46,732 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:19:47,648 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:19:47,654 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:19:47,657 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:53,148 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:19:53,149 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:19:53,152 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:58,536 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:19:58,538 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:19:58,540 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:19:58,542 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:03,965 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:20:22,318 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:20:23,068 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:23,912 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:20:24,181 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:34,145 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:20:38,675 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:20:44,249 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:20:51,159 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:20:51,160 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:20:51,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:52,001 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:20:52,002 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:20:55,986 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:21:08,264 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:21:08,660 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 15:21:10,369 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:21:11,232 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 569
2025-11-17 15:21:11,234 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:21:15,782 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 118
2025-11-17 15:21:15,783 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:21:16,760 - ispa_next.appointments.models - DEBUG - Appointment Doris Gastreich-Rode MZ-R 5915E WBA31EF0005417777 ohne Termin.
2025-11-17 15:21:16,770 - ispa_next.appointments.models - DEBUG - Appointment Mohamed Alah Haffar GG-AR 840 WBAJP310X0CD44613 ohne Termin.
