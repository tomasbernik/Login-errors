2025-11-12 10:00:31,910 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:00:31,920 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:00:44,870 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:00:55,731 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:01:11,259 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:01:44,422 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:01:57,058 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:02:00,548 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:02:01,570 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:02:01,571 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 473
2025-11-12 10:02:03,895 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 419
2025-11-12 10:02:03,896 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:02:03,897 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:02:04,901 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:02:06,023 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:10,131 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Voller Herr M-GR 727E WBY41DU000S263527 ohne Termin.
2025-11-12 10:03:10,143 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:03:10,157 - ispa_next.appointments.models - DEBUG - Appointment Ratko Kos-Igel Herr M-E 5984 WBAJN31060B378248 ohne Termin.
2025-11-12 10:03:10,175 - ispa_next.appointments.models - DEBUG - Appointment Franz-Michael von Morenhoffen Herr M-VM 1945 WMW11GD0602W56385 ohne Termin.
2025-11-12 10:03:10,193 - ispa_next.appointments.models - DEBUG - Appointment Andreas Pletschacher Herr M-S 7268 WMW11GA0607N78892 ohne Termin.
2025-11-12 10:03:10,200 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:03:10,219 - ispa_next.appointments.models - DEBUG - Appointment ZEBE-Zeichenbüro Ebersberg Frau EBE-ZB 999 WMWJZ31040TP30810 ohne Termin.
2025-11-12 10:03:10,237 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:03:10,258 - ispa_next.appointments.models - DEBUG - Appointment Erich Pudelko Herr EBE-EP 11 WBA21EA0307N15581 ohne Termin.
2025-11-12 10:03:10,306 - ispa_next.appointments.models - DEBUG - Appointment Markus Deppe Herr M-MD 6407 WMWLV310802U83186 ohne Termin.
2025-11-12 10:03:10,326 - ispa_next.appointments.models - DEBUG - Appointment Petra Wichert Frau M-PW 2302 WBAUH31030E525919 ohne Termin.
2025-11-12 10:03:10,339 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Trepte Herr STA-GW 131 WBA2A51000V427342 ohne Termin.
2025-11-12 10:03:10,350 - ispa_next.appointments.models - DEBUG - Appointment Firma Open Text Software GmbH M-M 1684E WBA21GV030CW39508 ohne Termin.
2025-11-12 10:03:10,362 - ispa_next.appointments.models - DEBUG - Appointment Herbert Kuhn Herr M-KT 4350 WBAEJ11080AF78090 ohne Termin.
2025-11-12 10:03:10,398 - ispa_next.appointments.models - DEBUG - Appointment Firma curare - Verein zur Förderung EBE-C 204 WBA21EA0307L92610 ohne Termin.
2025-11-12 10:03:10,410 - ispa_next.appointments.models - DEBUG - Appointment Hans-Dieter Krill Herr M-DK 2695 WBA3U11040J871366 ohne Termin.
2025-11-12 10:03:10,421 - ispa_next.appointments.models - DEBUG - Appointment Aldin Hecimovic Herr EBE-AD 216 WBA2E510305G50482 ohne Termin.
2025-11-12 10:03:10,432 - ispa_next.appointments.models - DEBUG - Appointment Firma Global Concerts GmbH M-SZ 1171 WBA21EF0605018576 ohne Termin.
2025-11-12 10:03:10,442 - ispa_next.appointments.models - DEBUG - Appointment Brigitte Fertich Frau EBE-FJ 111 WBAXB31040DW54269 ohne Termin.
2025-11-12 10:03:10,451 - ispa_next.appointments.models - DEBUG - Appointment Daniela Felbrich Frau ED-JS 396 WBY8P210207F54741 ohne Termin.
2025-11-12 10:03:10,461 - ispa_next.appointments.models - DEBUG - Appointment Patrick Gaßler Herr TS-GP 2299 WBA4C31090G785518 ohne Termin.
2025-11-12 10:03:10,472 - ispa_next.appointments.models - DEBUG - Appointment Firma MT Treuhand München M-MN 48 WBSUJ010209G32986 ohne Termin.
2025-11-12 10:03:10,484 - ispa_next.main - DEBUG - Found 11 out of 60 appointments to process (configured limit: 15).
2025-11-12 10:03:10,485 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 10:03:10,485 - ispa_next.main - DEBUG - Processing 8 already visited appointments (w/ RKR not callable).
2025-11-12 10:03:10,485 - ispa_next.main - DEBUG - All appointments: EBE-CP 214, M-X 8740, EBE-XC 42, WS BJ 2015, EBE-FM 57, M-ZE 1903, WS-M 505, EBE-AS 109, M-MV 6001, EBE-XV 60, EBE-AU 51
2025-11-12 10:03:10,487 - ispa_next.main - DEBUG - 



2025-11-12 10:03:10,487 - ispa_next.main - DEBUG - starting with process 1 (EBE-CP 214) of 11
2025-11-12 10:03:10,490 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:03:11,309 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:03:12,093 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:03:12,095 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 419
2025-11-12 10:03:13,080 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:03:13,081 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:37,256 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:03:46,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:03:47,300 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:03:47,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:03:47,396 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:03:47,690 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:03:47,695 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:03:47,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:03:47,784 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:03:57,675 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:03:57,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:03:58,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:04:00,594 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:04:00,691 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:04:00,786 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:04:00,849 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:04:05,009 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:04:06,013 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:04:06,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:06,474 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:17,749 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:04:17,749 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:04:24,849 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:04:24,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:24,924 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:04:24,926 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:04:25,002 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:04:26,278 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:04:27,471 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:04:27,681 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:04:31,650 - ispa_next.functions - DEBUG - Updated appointment (AO00010648) customer contact data.
2025-11-12 10:04:32,558 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:04:32,560 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:04:33,267 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:04:33,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:04:34,017 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:04:37,599 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:04:37,600 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:04:37,604 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:04:37,605 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:04:37,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:04:38,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:04:42,314 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:04:42,326 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:04:42,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:04:42,423 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:04:42,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:43,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:43,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:04:43,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:04:43,947 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:04:45,222 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:04:45,223 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:04:46,049 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:04:46,050 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:04:46,051 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:04:46,052 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:04:46,053 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:04:46,054 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:04:46,055 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:04:46,056 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:04:46,056 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:04:46,058 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:04:46,058 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:04:46,060 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:04:46,062 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:04:46,064 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:04:46,064 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:04:47,285 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:04:47,286 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:04:47,288 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:04:48,446 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:04:48,446 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:04:48,448 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:04:49,641 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:04:49,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:04:50,321 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:04:50,624 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:04:58,342 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:04:58,343 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:04:59,597 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:05:09,223 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:05:09,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:05:10,178 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:05:10,284 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:05:21,921 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:05:21,923 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:05:21,925 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:05:22,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:05:22,582 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:05:22,584 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:05:24,318 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:05:33,528 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:05:33,901 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:05:34,396 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:05:36,006 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:05:36,007 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:05:38,820 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 10:05:38,821 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:05:39,670 - ispa_next.main - DEBUG - Found new Appointment: M-GR 727E
2025-11-12 10:05:39,672 - ispa_next.main - DEBUG - 



2025-11-12 10:05:39,672 - ispa_next.main - DEBUG - starting with process 2 (M-GR 727E) of 12
2025-11-12 10:05:39,675 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:05:40,844 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:05:42,034 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:05:42,036 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 10:05:43,278 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:05:43,280 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:06:10,631 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:06:19,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:20,023 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:06:20,183 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:06:22,720 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:06:22,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:22,798 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:06:22,988 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:06:22,990 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:06:22,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:23,089 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:06:26,267 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:06:26,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:06:27,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:06:29,220 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:06:29,378 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:06:29,475 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:06:29,559 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:06:29,561 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:06:40,867 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:06:45,053 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:06:45,053 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:06:49,248 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:06:50,253 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:06:50,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:50,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:07:01,494 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:07:01,494 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:07:08,356 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:07:08,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:07:08,441 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:07:08,441 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:07:08,487 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:07:09,869 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:07:10,078 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:07:14,142 - ispa_next.functions - DEBUG - Updated appointment (AJ00018148) customer contact data.
2025-11-12 10:07:15,057 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:07:15,059 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:07:15,866 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:07:15,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:07:16,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:07:20,481 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:07:20,481 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:07:20,482 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:07:20,484 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:07:20,486 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:07:20,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:07:20,982 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:07:25,090 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:07:25,094 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:07:25,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:07:25,176 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:07:28,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:07:29,525 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:07:29,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:07:30,209 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:07:30,209 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:07:33,250 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:07:33,252 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:07:34,108 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:07:34,110 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:07:34,112 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:07:34,114 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:07:34,114 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:07:34,117 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:07:34,118 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 10:07:34,119 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:07:34,121 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:07:34,123 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:07:34,124 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:07:34,126 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 10:07:36,119 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:07:36,666 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:07:37,603 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 10:07:38,183 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:07:38,703 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:07:39,612 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 10:07:40,185 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:07:40,708 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:07:41,634 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 10:07:42,210 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:07:42,784 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:07:44,287 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 10:07:45,341 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:07:46,288 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 10:07:46,712 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:07:46,753 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:07:46,758 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:49,311 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:07:49,313 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:07:49,315 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:51,860 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:07:51,860 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:07:51,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:54,478 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:07:54,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:07:55,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:07:55,204 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:08:08,329 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:08:08,330 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:08:10,920 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:08:21,429 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:08:21,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:08:22,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:08:22,501 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:08:46,950 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:08:50,906 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:08:55,423 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:08:55,425 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:08:55,427 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:08:55,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:08:56,033 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:08:56,034 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:08:57,613 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:09:05,238 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:09:05,661 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:09:06,218 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:08,110 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:09:08,110 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:09:10,763 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 10:09:10,764 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:09:11,452 - ispa_next.main - DEBUG - 



2025-11-12 10:09:11,452 - ispa_next.main - DEBUG - starting with process 3 (M-X 8740) of 12
2025-11-12 10:09:11,457 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:09:12,222 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:13,035 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:09:13,036 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 10:09:14,129 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:09:14,130 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:09:31,507 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:09:41,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:09:43,485 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:09:43,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:43,563 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:09:43,806 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:09:43,808 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:09:43,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:43,872 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:09:58,133 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:09:58,134 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:09:58,395 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 10:09:59,154 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 10:09:59,171 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:09:59,172 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:09:59,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:10:00,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:10:00,487 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 10:10:00,524 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 10:10:02,517 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:10:02,520 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:03,955 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:10:03,956 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:10:06,287 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 10:10:06,290 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:07,005 - ispa_next.main - DEBUG - 



2025-11-12 10:10:07,005 - ispa_next.main - DEBUG - starting with process 4 (EBE-XC 42) of 12
2025-11-12 10:10:07,009 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:10:08,142 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:09,185 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:10:09,186 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 10:10:10,618 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:10:10,620 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:28,096 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:10:37,265 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:10:38,472 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:10:38,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:38,592 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:10:38,768 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:10:38,770 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:10:38,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:38,866 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:10:52,647 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:10:52,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:10:52,864 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 10:10:53,173 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 10:10:53,186 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:10:53,188 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:10:53,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:10:54,594 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:10:54,595 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 10:10:54,619 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 10:10:56,945 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:10:56,948 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:58,901 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:10:58,901 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:01,101 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 10:11:01,102 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:01,749 - ispa_next.main - DEBUG - 



2025-11-12 10:11:01,749 - ispa_next.main - DEBUG - starting with process 5 (WS BJ 2015) of 12
2025-11-12 10:11:01,765 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:11:02,638 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:03,514 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:11:03,516 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 10:11:04,827 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:04,829 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:45,186 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:11:45,197 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:11:45,199 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:45,645 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:11:45,646 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:48,177 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 10:11:48,177 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:49,045 - ispa_next.main - DEBUG - 



2025-11-12 10:11:49,045 - ispa_next.main - DEBUG - starting with process 6 (EBE-FM 57) of 12
2025-11-12 10:11:49,048 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:11:49,984 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:50,957 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:11:50,958 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 10:11:52,281 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:52,283 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:12:15,127 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:12:17,150 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:12:22,044 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:24,601 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:12:24,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:24,665 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:12:24,888 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:12:28,210 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:12:28,212 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:12:28,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:28,289 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:12:31,229 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:12:31,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:32,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:12:34,286 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:12:34,430 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:12:34,496 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:12:34,584 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:12:38,777 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:12:39,784 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:12:39,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:40,296 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:50,871 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:12:50,871 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:12:53,950 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:12:53,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:54,047 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:12:54,047 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:12:54,082 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:12:55,272 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:12:56,445 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:12:56,658 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:12:58,325 - ispa_next.functions - DEBUG - Updated appointment (AB00084453) customer contact data.
2025-11-12 10:12:59,210 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:12:59,210 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:12:59,805 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:12:59,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:13:00,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:13:04,622 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:13:04,622 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:13:04,626 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:13:04,626 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:13:04,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:13:05,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:13:09,330 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:13:09,333 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:13:09,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:13:09,401 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:13:15,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:15,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:15,586 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:13:16,300 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:13:16,302 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:13:18,791 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:13:18,795 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:13:20,107 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:13:20,109 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:13:20,111 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:13:20,113 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:13:20,115 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:13:20,117 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:13:20,120 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:13:20,122 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:13:20,122 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:13:20,125 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:13:20,129 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:13:20,134 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:13:20,142 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:13:20,148 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:13:20,148 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:22,732 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:13:22,732 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:13:22,734 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:25,437 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:13:25,437 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:13:25,438 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:27,990 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:13:27,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:13:28,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:13:28,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:40,438 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:13:40,444 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:43,046 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:13:53,831 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:13:54,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:13:54,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:13:54,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:19,382 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:23,436 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:27,119 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:27,121 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:14:27,121 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:27,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:14:27,612 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:14:27,612 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:14:28,869 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:14:35,805 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:14:36,178 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:14:36,790 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:38,063 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:14:38,065 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:40,820 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 10:14:40,821 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:14:41,706 - ispa_next.main - DEBUG - 



2025-11-12 10:14:41,707 - ispa_next.main - DEBUG - starting with process 7 (M-ZE 1903) of 12
2025-11-12 10:14:41,710 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:42,978 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:44,247 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1011
2025-11-12 10:14:44,248 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 10:14:45,726 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:45,731 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:15:15,774 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:15:17,277 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:15:22,240 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:24,129 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:15:24,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:24,212 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:15:24,393 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:15:24,395 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:15:24,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:24,464 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:15:27,629 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:15:27,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:28,798 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:15:30,801 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:15:30,895 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:15:30,993 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:15:31,048 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:15:35,244 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:15:36,249 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:15:36,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:36,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:47,637 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:15:47,637 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:15:51,040 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:15:51,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:51,117 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:15:51,119 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:15:51,170 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:15:52,365 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:15:52,576 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:15:54,270 - ispa_next.functions - DEBUG - Updated appointment (AE00032707) customer contact data.
2025-11-12 10:15:55,176 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:15:55,178 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:15:55,717 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:15:55,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:15:56,404 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:16:00,449 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:16:00,449 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:16:00,450 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:16:00,452 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:16:00,452 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:16:00,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:16:00,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:16:05,087 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:16:05,092 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:16:05,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:16:05,174 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:16:14,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:14,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:14,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:16:15,678 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:16:15,678 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:16:17,596 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:16:17,600 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:16:18,592 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:16:18,593 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:16:18,595 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:16:18,597 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:16:18,599 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:16:18,602 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:16:18,605 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:16:18,606 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:16:18,607 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:16:18,608 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:16:18,609 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:16:18,609 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:16:18,612 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:16:18,613 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:16:18,614 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:20,514 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:16:20,516 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:16:20,520 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:22,406 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:16:22,406 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:16:22,412 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:24,279 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:16:24,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:16:24,999 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:16:25,219 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:35,896 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:16:35,898 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:37,828 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:16:47,341 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:16:47,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:16:48,393 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:16:48,539 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:17:06,378 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:17:10,550 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:17:10,552 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:17:10,552 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:17:11,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:17:11,226 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:17:11,227 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:17:13,027 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:17:20,300 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:17:20,676 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 10:17:21,220 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:17:22,598 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-12 10:17:22,599 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:17:25,373 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 464
2025-11-12 10:17:25,373 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:17:26,154 - ispa_next.main - DEBUG - 



2025-11-12 10:17:26,154 - ispa_next.main - DEBUG - starting with process 8 (WS-M 505) of 12
2025-11-12 10:17:26,164 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:17:27,408 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:17:28,506 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-12 10:17:28,507 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 464
2025-11-12 10:17:29,789 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:17:29,790 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:17:52,516 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:17:54,197 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:17:58,894 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:02,126 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:18:02,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:02,199 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:18:02,405 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:18:02,407 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:18:02,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:02,475 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:18:08,675 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:18:08,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:09,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:11,922 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:18:12,115 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:18:12,451 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:18:12,522 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:18:16,728 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:18:17,737 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:18:17,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:18,207 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:31,289 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:18:34,343 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:18:34,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:34,443 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:18:34,444 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:18:34,493 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:18:35,645 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:18:37,037 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:18:37,236 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:18:39,045 - ispa_next.functions - DEBUG - Updated appointment (AJ00017350) customer contact data.
2025-11-12 10:18:39,957 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:18:39,960 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:18:40,619 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:18:40,621 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:18:41,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:18:45,357 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:18:45,357 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:18:45,360 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:18:45,361 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:18:45,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:45,872 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:49,995 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 10:18:53,358 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:18:53,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:53,421 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:18:53,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:54,325 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:54,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:54,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:54,986 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:18:57,951 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:18:57,955 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:18:58,832 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:18:58,834 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:18:58,835 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:18:58,836 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:18:58,836 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:18:58,837 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:18:58,839 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:18:58,840 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:18:58,841 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:18:58,845 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:18:58,848 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:18:58,851 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:18:58,859 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:18:58,861 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:18:58,861 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:02,234 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:19:04,684 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:19:04,715 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:19:04,741 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:08,191 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:19:08,191 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:19:08,195 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:11,486 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:19:11,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:19:12,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:19:12,467 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:22,919 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:19:22,921 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:26,295 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:19:37,979 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:19:38,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:19:39,045 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:19:39,204 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:20:10,908 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:20:15,064 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:20:19,103 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:20:23,348 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:20:23,350 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:20:23,352 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:20:23,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:20:24,075 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:20:24,078 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:20:25,821 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:20:32,567 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:20:32,955 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 10:20:33,612 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:34,950 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-12 10:20:34,952 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:20:37,228 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 464
2025-11-12 10:20:37,228 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:20:37,945 - ispa_next.main - DEBUG - 



2025-11-12 10:20:37,945 - ispa_next.main - DEBUG - starting with process 9 (EBE-AS 109) of 12
2025-11-12 10:20:37,950 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:20:38,841 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:39,590 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-12 10:20:39,592 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 464
2025-11-12 10:20:40,880 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:20:40,881 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:09,089 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:21:10,713 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:21:15,440 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:15,530 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:21:15,730 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:25,874 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:21:25,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:25,939 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:21:26,127 - ispa_next.functions - DEBUG - HU date already expired after 19 days.
2025-11-12 10:21:30,047 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:21:30,050 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:21:30,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:30,147 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:21:37,541 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:21:37,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:21:38,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:21:40,525 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:21:40,659 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:21:40,754 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:21:40,815 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:21:40,816 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:21:49,525 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:21:50,542 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:21:50,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:51,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:57,257 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 10:21:57,261 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:21:57,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:57,336 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:21:57,337 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:21:57,391 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:21:57,485 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:21:58,627 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:21:59,800 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:22:00,142 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:22:02,264 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:22:02,266 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:22:02,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:22:03,188 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:22:04,235 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:22:04,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:22:04,305 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:22:07,904 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:22:07,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:22:08,513 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:22:10,525 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:22:10,668 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:22:10,778 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:22:10,848 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:22:10,849 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:22:19,659 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:23:19,661 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:23:28,104 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:24:09,107 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:24:17,536 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:24:25,343 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 10:24:26,348 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:24:26,349 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:24:26,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:24:26,445 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:24:30,584 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:24:30,588 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:24:30,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:24:30,690 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:24:31,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:31,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:31,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:24:32,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:24:32,261 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:24:41,054 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:24:41,056 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:24:42,896 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 263, in run
    self._update_advice_list_content()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 40, in _update_advice_list_content
    self.containers[Container.ADVICE_LIST] = self.ui_helper.get_advice_list_content(self.base_element)
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 168, in get_advice_list_content
    cart_package_name = item.get_first_child().get_value()
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 346, in get_first_child
    found = m.get_first_child(
            ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 639, in get_first_child
    _raise_not_found_error()
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 630, in _raise_not_found_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'GetFirstChildElement' didn't return an Element pointer.


2025-11-12 10:24:42,914 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:24:42,918 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:24:43,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:24:44,377 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:24:44,379 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 10:24:44,405 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 10:24:46,993 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 10:24:46,995 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:24:47,830 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-12 10:24:47,832 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:24:50,117 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 464
2025-11-12 10:24:50,118 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:24:50,844 - ispa_next.main - DEBUG - 



2025-11-12 10:24:50,844 - ispa_next.main - DEBUG - starting with process 10 (M-MV 6001) of 12
2025-11-12 10:24:50,854 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:24:51,755 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:24:52,512 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-12 10:24:52,513 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 464
2025-11-12 10:24:53,730 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:24:53,734 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:16,165 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:25:18,009 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:25:22,745 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:24,598 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:25:24,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:24,675 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:25:24,866 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:25:24,868 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:25:24,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:24,952 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:25:28,203 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:25:28,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:25:29,334 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:25:31,337 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:25:31,450 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:25:31,536 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:25:31,642 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:25:35,832 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:25:36,837 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:25:36,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:37,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:46,687 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:25:50,880 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:25:50,882 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:50,978 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:25:50,980 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:25:51,025 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:25:52,267 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:25:52,482 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:25:54,352 - ispa_next.functions - DEBUG - Updated appointment (AB00085497) customer contact data.
2025-11-12 10:25:55,277 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:25:55,279 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:25:56,048 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:25:56,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:25:56,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:26:00,432 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:26:00,432 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:26:00,436 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:26:00,436 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:26:00,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:00,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:26:05,051 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:26:05,054 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:26:05,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:05,131 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:26:10,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:11,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:11,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:12,106 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:26:12,107 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:26:14,059 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:26:14,063 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:26:15,782 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:26:15,784 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:26:15,784 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:26:15,786 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:26:15,788 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:26:15,788 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:26:15,790 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:26:15,790 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:26:15,792 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:26:15,794 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:26:15,794 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:26:15,796 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:26:15,800 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:26:15,800 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:26:15,802 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:17,784 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:26:17,784 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:26:17,786 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:19,727 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:26:19,727 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:26:19,732 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:21,694 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:26:21,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:26:22,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:26:22,780 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:37,006 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:26:37,008 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:38,962 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:26:49,772 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:26:50,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:26:50,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:26:50,898 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:27:09,333 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:13,645 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:13,647 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:27:13,649 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:27:14,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:27:14,295 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:27:14,296 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:27:16,010 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:27:23,608 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:27:23,982 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 10:27:24,659 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:27:25,934 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-12 10:27:25,935 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:27:28,936 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 464
2025-11-12 10:27:28,936 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:27:29,583 - ispa_next.main - DEBUG - 



2025-11-12 10:27:29,583 - ispa_next.main - DEBUG - starting with process 11 (EBE-XV 60) of 12
2025-11-12 10:27:29,587 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:27:30,405 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:27:31,317 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-12 10:27:31,318 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 464
2025-11-12 10:27:32,515 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:27:32,516 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:27:57,152 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:27:58,678 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:28:03,787 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:07,801 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:28:07,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:07,869 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:28:08,130 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:28:08,137 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:28:08,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:08,270 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:28:15,079 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:28:15,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:28:16,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:28:18,650 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:28:18,772 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:28:18,863 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:28:18,929 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:28:23,176 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:28:24,180 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:28:24,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:24,615 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:35,053 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:28:35,053 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:28:38,301 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:28:38,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:38,400 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:28:38,402 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:28:38,443 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:28:38,584 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:28:40,171 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:28:40,385 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:28:42,319 - ispa_next.functions - DEBUG - Updated appointment (AF00027213) customer contact data.
2025-11-12 10:28:43,265 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:28:43,267 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:28:43,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:28:44,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:28:45,211 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:28:45,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:28:45,284 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:28:48,901 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:28:48,901 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:28:48,904 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:28:48,904 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:28:48,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:28:49,406 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:28:53,518 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:28:53,524 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:28:53,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:28:53,647 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:28:54,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:54,654 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:54,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:28:55,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:28:55,377 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:28:58,941 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:28:58,943 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:29:00,397 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:29:00,399 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:29:00,401 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:29:00,406 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:29:00,408 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:29:00,410 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:29:00,414 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:29:00,414 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:29:00,416 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:29:00,418 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:29:00,420 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:29:00,422 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:29:00,426 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:29:00,426 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:29:00,428 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:04,493 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:29:04,502 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:29:04,506 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:08,444 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:29:08,444 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:29:08,447 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:12,459 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:29:12,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:29:13,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:29:13,499 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:24,642 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:29:24,642 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:28,589 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:29:39,868 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:29:40,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:29:40,908 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:29:41,072 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:19,428 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:30:23,445 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:30:27,326 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:30:31,216 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:30:36,348 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:30:36,350 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:30:36,350 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:30:36,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:30:37,036 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:30:37,038 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:30:38,795 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:30:45,747 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:30:46,138 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 10:30:46,817 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:30:48,057 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-12 10:30:48,059 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:30:50,739 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 463
2025-11-12 10:30:50,739 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:30:51,367 - ispa_next.main - DEBUG - 



2025-11-12 10:30:51,367 - ispa_next.main - DEBUG - starting with process 12 (EBE-AU 51) of 12
2025-11-12 10:30:51,376 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:30:52,417 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:30:53,581 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-12 10:30:53,582 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 463
2025-11-12 10:30:54,928 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:30:54,929 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:31:29,290 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:31:31,187 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:31:36,143 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:40,804 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:31:40,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:31:40,867 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:31:41,045 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:31:41,047 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:31:41,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:31:41,109 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:31:44,073 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:31:44,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:31:45,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:31:47,052 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:31:47,161 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:31:47,239 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:31:47,297 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:31:51,454 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:31:52,460 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:31:52,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:31:52,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:03,012 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:32:03,012 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:32:06,469 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:32:06,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:06,544 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:32:06,544 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:32:06,647 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:32:07,889 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:32:08,095 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:32:10,005 - ispa_next.functions - DEBUG - Updated appointment (AZ00004184) customer contact data.
2025-11-12 10:32:10,922 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:32:10,923 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:32:11,545 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:32:11,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:32:12,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:32:15,992 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:32:15,992 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:32:15,997 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:32:15,997 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:32:15,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:32:16,477 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:32:20,610 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:32:20,614 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:32:20,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:32:20,675 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:32:29,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:30,003 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:30,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:32:30,673 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:32:30,673 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:32:34,830 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:32:34,830 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:32:36,049 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:32:36,050 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:32:36,052 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:32:36,053 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:32:36,064 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:32:36,066 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:32:36,069 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:32:36,070 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:32:36,070 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:32:36,072 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:32:36,074 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:32:36,078 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:32:36,078 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:32:36,080 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:32:40,723 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:32:42,980 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:32:42,988 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:32:43,134 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:32:47,851 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:32:47,851 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:32:47,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:32:52,560 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:32:52,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:32:53,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:32:53,599 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:33:05,419 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:33:05,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:33:10,030 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:33:19,690 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:33:20,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:33:20,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:33:20,827 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:06,058 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:34:10,345 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:34:14,224 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:34:18,483 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:34:22,451 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:34:27,843 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:34:27,845 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:34:27,846 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:34:28,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:34:28,513 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:34:28,515 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:34:30,113 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:34:37,460 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:34:37,855 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 10:34:38,603 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:34:39,829 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-12 10:34:39,831 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:34:42,757 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 463
2025-11-12 10:34:42,758 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
