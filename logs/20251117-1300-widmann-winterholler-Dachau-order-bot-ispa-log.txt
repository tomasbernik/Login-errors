2025-11-17 13:00:38,957 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 13:00:38,967 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 13:00:52,043 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:01:02,823 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:01:18,448 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:01:42,995 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 13:01:59,341 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 13:02:03,533 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:02:04,504 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1236
2025-11-17 13:02:04,505 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 156
2025-11-17 13:02:06,654 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 119
2025-11-17 13:02:06,655 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 13:02:06,655 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:02:07,568 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:02:08,794 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:02:27,597 - ispa_next.appointments.models - DEBUG - Appointment Agnes Bauer M-AM 9090 WMWZM31030T036630 ohne Termin.
2025-11-17 13:02:27,606 - ispa_next.appointments.models - DEBUG - Appointment Hans Albu Sanmiguel GmbH M-HA 5676 WMW11GD0X02W92838 ohne Termin.
2025-11-17 13:02:27,623 - ispa_next.appointments.models - DEBUG - Appointment bwp Burggraf + Weber M-MG 2206 E WBY41AW070FS23336 ohne Termin.
2025-11-17 13:02:27,651 - ispa_next.appointments.models - DEBUG - Appointment Adam Szulc DAH-QX 230 WBA5K11060D943181 ohne Termin.
2025-11-17 13:02:27,664 - ispa_next.appointments.models - DEBUG - Appointment Robert Charles Armin FS-NA 42 WMWYT910303D93360 ohne Termin.
2025-11-17 13:02:27,677 - ispa_next.appointments.models - DEBUG - Appointment Benedikt Burger FFB-XG 87 WBS11DM0708D97738 ohne Termin.
2025-11-17 13:02:27,685 - ispa_next.appointments.models - DEBUG - Appointment Timon Wohlfarth  WMWXU710402M05502 ohne Termin.
2025-11-17 13:02:27,692 - ispa_next.appointments.models - DEBUG - Appointment Chi Chung Nguyen M-HC 2737 WBACR61070LJ18143 ohne Termin.
2025-11-17 13:02:27,701 - ispa_next.appointments.models - DEBUG - Appointment Ingrid Berger M-MB 525 WBAFF41030L117517 ohne Termin.
2025-11-17 13:02:27,701 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:02:27,702 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:02:27,702 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:02:27,704 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:02:27,712 - ispa_next.appointments.models - DEBUG - Appointment Brigitte Lang DAH-U 904 WMW21DL0703N66211 ohne Termin.
2025-11-17 13:02:27,719 - ispa_next.appointments.models - DEBUG - Appointment Franziska Scheitler DAH-FS 242 WBA31DZ040FJ93655 ohne Termin.
2025-11-17 13:02:27,727 - ispa_next.appointments.models - DEBUG - Appointment NovaTaste Germany GmbH BGL-NT 303 WBA41EG0005X32470 ohne Termin.
2025-11-17 13:02:27,735 - ispa_next.appointments.models - DEBUG - Appointment Sieglinde Wasmeier PAN-SW 11 WBA21BX0907N85009 ohne Termin.
2025-11-17 13:02:27,743 - ispa_next.appointments.models - DEBUG - Appointment REWE Markt GmbH FS-RE 208 WBA71AC0505R28464 ohne Termin.
2025-11-17 13:02:27,751 - ispa_next.appointments.models - DEBUG - Appointment Christos Michalopoulos DAH-GR 517 WBATX95050ND73284 ohne Termin.
2025-11-17 13:02:27,760 - ispa_next.appointments.models - DEBUG - Appointment Hiller DAH-LH 258 WBAWY510600E18805 ohne Termin.
2025-11-17 13:02:27,768 - ispa_next.appointments.models - DEBUG - Appointment Johannes Nist DAH-VN 66 WBA11GR0209Z99162 ohne Termin.
2025-11-17 13:02:27,777 - ispa_next.appointments.models - DEBUG - Appointment Annemarie Eichhorn DAH-AE 279 WBA71AC0405V15516 ohne Termin.
2025-11-17 13:02:27,787 - ispa_next.appointments.models - DEBUG - Appointment Ezmin Tanjic RE-EZA 1 WBACV61030LJ72146 ohne Termin.
2025-11-17 13:02:27,796 - ispa_next.appointments.models - DEBUG - Appointment PRK GmbH Kunststoffverarbeitung  WMW61DL0903S22669 ohne Termin.
2025-11-17 13:02:27,807 - ispa_next.appointments.models - DEBUG - Appointment Härtetechnik Redak GmbH & Co. KG DAH-MC 510 WBS41AY030FM13870 ohne Termin.
2025-11-17 13:02:27,817 - ispa_next.appointments.models - DEBUG - Appointment Volksbank Raiffeisenbank Dachau eG DAH-VR 86 E WBA81CY050FS22937 ohne Termin.
2025-11-17 13:02:27,830 - ispa_next.appointments.models - DEBUG - Appointment Dirk Ullrich RN-M 500E WBS81GV040CV92768 ohne Termin.
2025-11-17 13:02:27,846 - ispa_next.appointments.models - DEBUG - Appointment Jörg Rolfes OAL-AR 191 WBAUZ35010N015446 ohne Termin.
2025-11-17 13:02:27,860 - ispa_next.appointments.models - DEBUG - Appointment Andreas Christmann M-AK 1539E WMW11GC05RTA37157 ohne Termin.
2025-11-17 13:02:27,868 - ispa_next.appointments.models - DEBUG - Appointment Christian Ettenberger FFB-CE 56E WMW11DJ0602T37216 ohne Termin.
2025-11-17 13:02:27,878 - ispa_next.appointments.models - DEBUG - Appointment Baader Bank AG M-V 7427 WBA41EG0X05Y35735 ohne Termin.
2025-11-17 13:02:27,887 - ispa_next.appointments.models - DEBUG - Appointment Dr. Nicola Steiner DAH-LS 855 WMWXU71010TN14283 ohne Termin.
2025-11-17 13:02:27,896 - ispa_next.appointments.models - DEBUG - Appointment Rita Oberrecht-Schwarz DAH-RA 13 WBA11AB01N5T43220 ohne Termin.
2025-11-17 13:02:27,905 - ispa_next.appointments.models - DEBUG - Appointment Rolf Ludwig Hagert DAH-AR 678 WBA2E310705D82895 ohne Termin.
2025-11-17 13:02:27,917 - ispa_next.appointments.models - DEBUG - Appointment Rainer Tobias Möller DAH-ST 807 WBA6V31070EB10798 ohne Termin.
2025-11-17 13:02:27,927 - ispa_next.appointments.models - DEBUG - Appointment Dr. Norbert Metz STA-M 2828 WBA6X310405T68381 ohne Termin.
2025-11-17 13:02:27,938 - ispa_next.appointments.models - DEBUG - Appointment Franz Rockinger FFB-FR 267 WBA31BX0807R25447 ohne Termin.
2025-11-17 13:02:27,949 - ispa_next.appointments.models - DEBUG - Appointment Dario Zandonella Maiucco DAH-DZ 73 WBAXA51050C586150 ohne Termin.
2025-11-17 13:02:27,959 - ispa_next.appointments.models - DEBUG - Appointment Anna Gushchina M-AG 7192 WMWRC310X0TB89348 ohne Termin.
2025-11-17 13:02:27,967 - ispa_next.appointments.models - DEBUG - Appointment Radloff DAH-RA 238 WBY71AW050FR88400 ohne Termin.
2025-11-17 13:02:27,976 - ispa_next.appointments.models - DEBUG - Appointment Augusto Fracasso DAH-GF 289 WBA11AB0005N66647 ohne Termin.
2025-11-17 13:02:27,982 - ispa_next.main - DEBUG - Found 1 out of 48 appointments to process (configured limit: 15).
2025-11-17 13:02:27,982 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-17 13:02:27,982 - ispa_next.main - DEBUG - All appointments: M-BM 173E
2025-11-17 13:02:27,985 - ispa_next.main - DEBUG - 



2025-11-17 13:02:27,985 - ispa_next.main - DEBUG - starting with process 1 (M-BM 173E) of 1
2025-11-17 13:02:27,990 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:02:29,288 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:02:30,712 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1236
2025-11-17 13:02:30,713 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 119
2025-11-17 13:02:32,554 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:02:32,556 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:02:59,767 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:03:09,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:03:11,091 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:03:11,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:03:11,158 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:03:11,353 - ispa_next.functions - DEBUG - HU date soon to be invalid in 2 days.
2025-11-17 13:03:18,468 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:03:18,471 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:03:21,181 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:03:21,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:03:21,353 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 13:03:22,134 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\ProgramData\robocorp\ht\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 13:03:22,151 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:03:22,152 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:03:22,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:03:23,334 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:03:23,335 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 13:03:23,359 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:03:25,352 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 13:03:25,354 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:03:27,399 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1236
2025-11-17 13:03:27,400 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:03:29,827 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 156
2025-11-17 13:03:29,827 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:03:30,556 - ispa_next.appointments.models - DEBUG - Appointment Agnes Bauer M-AM 9090 WMWZM31030T036630 ohne Termin.
2025-11-17 13:03:30,563 - ispa_next.appointments.models - DEBUG - Appointment Hans Albu Sanmiguel GmbH M-HA 5676 WMW11GD0X02W92838 ohne Termin.
