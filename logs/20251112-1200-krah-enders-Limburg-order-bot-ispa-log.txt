2025-11-12 12:14:35,328 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 12:14:35,333 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 12:14:44,871 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:14:55,032 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:15:11,013 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:15:34,907 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 12:15:45,879 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 12:15:48,482 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:15:49,620 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 552
2025-11-12 12:15:49,622 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 127
2025-11-12 12:15:51,886 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 95
2025-11-12 12:15:51,887 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 12:15:51,887 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:15:53,040 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:15:54,201 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:16:06,831 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:16:06,880 - ispa_next.main - DEBUG - Found 5 out of 42 appointments to process (configured limit: 15).
2025-11-12 12:16:06,880 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 12:16:06,880 - ispa_next.main - DEBUG - Processing 2 already visited appointments (w/ RKR not callable).
2025-11-12 12:16:06,880 - ispa_next.main - DEBUG - All appointments: LM-XM 55 E, ENS-MP-48, LM MM 585, LM-R 890, D-CG 5193 E
2025-11-12 12:16:06,882 - ispa_next.main - DEBUG - 



2025-11-12 12:16:06,883 - ispa_next.main - DEBUG - starting with process 1 (LM-XM 55 E) of 5
2025-11-12 12:16:06,886 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:16:07,659 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:16:08,506 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 552
2025-11-12 12:16:08,507 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 95
2025-11-12 12:16:09,546 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:16:09,547 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:16:34,021 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:16:42,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:16:42,686 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:16:42,871 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:16:44,824 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:16:44,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:16:44,887 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:16:45,086 - ispa_next.functions - DEBUG - HU date already expired after 664 days.
2025-11-12 12:16:51,630 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:16:51,635 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:16:51,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:16:51,709 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:17:01,964 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:17:01,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:17:02,771 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:17:04,773 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:17:04,883 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:17:08,062 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:17:08,125 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:17:08,126 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:17:16,360 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:17:17,369 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:17:17,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:17:17,899 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:17:27,108 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 12:17:33,944 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:17:33,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:17:34,042 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:17:34,042 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:17:34,079 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:17:34,199 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:17:35,384 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:17:35,635 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:17:39,307 - ispa_next.functions - DEBUG - Updated appointment (AB00018699) customer contact data.
2025-11-12 12:17:40,219 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:17:40,221 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:17:40,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:17:41,208 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:17:42,626 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:17:42,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:17:42,694 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:17:47,194 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:17:47,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:17:47,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:17:49,728 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:17:49,876 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:17:50,051 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:17:50,119 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:17:50,119 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:17:58,279 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:18:58,281 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:19:09,545 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 12:19:15,187 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:19:15,187 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:19:17,915 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:19:18,921 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:19:18,922 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:19:18,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:19,021 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:19:23,166 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:19:23,869 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:19:38,972 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:19:38,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:39,066 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:19:39,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:40,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:40,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:40,931 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:19:40,932 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:19:45,841 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:19:45,843 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:19:47,823 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:19:47,828 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:19:47,832 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart)}
2025-11-12 12:19:47,834 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:19:47,836 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 12:19:47,837 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:19:47,839 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:19:47,840 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:19:47,842 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:19:47,845 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 12:19:48,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:19:49,306 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:20:03,598 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:20:03,599 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 12:20:06,409 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:20:06,937 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:20:08,558 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:20:09,189 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:20:09,737 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:20:10,675 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:20:11,287 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:20:11,830 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:20:12,759 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:20:13,345 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:20:13,891 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:20:14,813 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:20:15,418 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:20:15,961 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:20:16,903 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:20:17,471 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:20:18,043 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:20:19,001 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:20:19,598 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:20:20,128 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:20:21,060 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:20:21,633 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:20:22,187 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:20:23,173 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:20:24,694 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:20:25,607 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:20:26,217 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:20:27,124 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:20:27,723 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:20:28,672 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:20:29,669 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:20:29,674 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:20:29,678 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:35,108 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:20:35,110 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:20:35,113 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:40,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:41,029 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:20:53,350 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:20:53,351 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:20:53,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:20:54,113 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:20:54,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:12,260 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:21:12,265 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:17,684 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:21:32,907 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:38,447 - ispa_next.common.mail - INFO - Successfully sent an email to 3 recipients
2025-11-12 12:21:38,452 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:21:38,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:21:39,730 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:21:39,999 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:49,657 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:21:54,236 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:21:59,191 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:22:06,402 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:22:06,403 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:22:07,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:22:07,241 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:22:07,243 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:22:10,681 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:22:23,677 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:22:24,058 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 12:22:26,078 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:22:26,891 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 553
2025-11-12 12:22:26,892 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:22:30,808 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 128
2025-11-12 12:22:30,809 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:22:31,785 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:22:31,788 - ispa_next.main - DEBUG - Found new Appointment: EMS-C 2062
2025-11-12 12:22:31,789 - ispa_next.main - DEBUG - 



2025-11-12 12:22:31,789 - ispa_next.main - DEBUG - starting with process 2 (EMS-C 2062) of 6
2025-11-12 12:22:31,793 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:22:33,087 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:22:34,319 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 553
2025-11-12 12:22:34,320 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 128
2025-11-12 12:22:35,899 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:22:35,901 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:23:13,883 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:23:26,294 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:31,713 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:23:31,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:31,830 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:23:32,160 - ispa_next.functions - DEBUG - HU date already expired after 275 days.
2025-11-12 12:23:41,344 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:23:41,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:41,433 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:23:59,171 - ispa_next.common.mail - INFO - Successfully sent an email to 6 recipients
2025-11-12 12:23:59,175 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:23:59,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:59,253 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:24:12,339 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:24:12,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:24:13,612 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:24:15,616 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:24:15,763 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:24:19,052 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:24:19,235 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:24:23,509 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:24:24,514 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:24:24,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:24:25,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:24:41,664 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:24:51,397 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:24:51,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:24:51,504 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:24:51,505 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:24:51,601 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:24:51,758 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:24:53,054 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:24:53,274 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:24:57,322 - ispa_next.functions - DEBUG - Updated appointment (AB00018712) customer contact data.
2025-11-12 12:24:58,276 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:24:58,278 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:24:58,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:24:59,566 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:25:01,184 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:25:01,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:25:01,270 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:25:04,853 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:25:04,853 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:25:04,856 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:25:04,856 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:25:04,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:25:05,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:25:09,568 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:25:10,738 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:25:20,889 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:25:20,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:25:21,018 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:25:24,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:25:25,414 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:25:25,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:25:26,155 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:25:26,156 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:25:31,269 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:25:31,272 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:25:33,016 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:25:33,017 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:25:33,019 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart)}
2025-11-12 12:25:33,019 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:25:33,021 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:25:33,023 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:25:33,024 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:25:33,025 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:25:33,027 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:25:33,029 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:25:33,030 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 12:25:33,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:25:34,530 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:25:48,590 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:25:48,592 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:25:48,593 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:25:48,594 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:25:54,633 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 12:25:58,255 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:25:58,257 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:25:58,261 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:04,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:26:04,959 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:26:15,566 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:26:15,568 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:26:15,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:26:16,388 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:26:16,473 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:26:16,476 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:22,498 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:26:37,349 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:26:37,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:26:38,397 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:26:38,580 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:49,954 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:26:55,717 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:27:03,845 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:27:03,846 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:27:04,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:27:05,016 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:27:05,018 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:27:09,207 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:27:20,412 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:27:20,807 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 12:27:22,982 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:27:23,891 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 553
2025-11-12 12:27:23,892 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:27:28,222 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 128
2025-11-12 12:27:28,223 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:27:29,356 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:27:29,360 - ispa_next.main - DEBUG - 



2025-11-12 12:27:29,361 - ispa_next.main - DEBUG - starting with process 3 (ENS-MP-48) of 6
2025-11-12 12:27:29,364 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:27:30,897 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:27:32,596 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 553
2025-11-12 12:27:32,597 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 128
2025-11-12 12:27:34,529 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:27:34,531 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:28:20,357 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:28:20,448 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 12:28:20,452 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:28:21,217 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 553
2025-11-12 12:28:21,218 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:28:24,781 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 128
2025-11-12 12:28:24,782 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:28:25,857 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:28:25,861 - ispa_next.main - DEBUG - 



2025-11-12 12:28:25,861 - ispa_next.main - DEBUG - starting with process 4 (LM MM 585) of 6
2025-11-12 12:28:25,864 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:28:27,546 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:28:29,300 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 553
2025-11-12 12:28:29,302 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 128
2025-11-12 12:28:31,269 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:28:31,271 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:29:07,666 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:29:07,676 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 12:29:07,680 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:29:08,338 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 553
2025-11-12 12:29:08,339 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:29:12,345 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 128
2025-11-12 12:29:12,346 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:29:13,494 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:29:13,498 - ispa_next.main - DEBUG - 



2025-11-12 12:29:13,499 - ispa_next.main - DEBUG - starting with process 5 (LM-R 890) of 6
2025-11-12 12:29:13,503 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:29:15,312 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:29:17,000 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 553
2025-11-12 12:29:17,002 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 128
2025-11-12 12:29:18,912 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:29:18,913 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:29:47,504 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:29:50,270 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:29:56,460 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:29:59,080 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:29:59,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:29:59,193 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:29:59,519 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:29:59,522 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:29:59,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:29:59,669 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:30:07,503 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:30:07,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:30:09,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:30:11,115 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:30:11,276 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:30:11,441 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:30:11,538 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:30:15,755 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:30:16,760 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:30:16,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:17,230 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:29,151 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:30:34,672 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:30:34,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:34,760 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:30:34,765 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:30:34,880 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:30:36,371 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:30:37,633 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:30:37,840 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:30:39,795 - ispa_next.functions - DEBUG - Updated appointment (AC00019071) customer contact data.
2025-11-12 12:30:40,758 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:30:40,775 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:30:41,912 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:30:41,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:30:43,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:30:46,819 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:30:46,819 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:30:46,823 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:30:46,825 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:30:46,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:30:47,427 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:30:51,599 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:30:51,604 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:30:51,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:30:51,692 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:30:52,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:52,610 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:52,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:30:53,421 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:30:53,422 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:30:55,912 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:30:55,917 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:30:57,837 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:30:57,839 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:30:57,841 - ispa_next.package_manager.main - DEBUG - Cannot place FAHRZEUGWÄSCHE BASIS: active placement guards
2025-11-12 12:30:57,843 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug Innenraum saugen: active placement guards
2025-11-12 12:30:57,845 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:30:57,847 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:30:57,857 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:30:57,860 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:30:57,863 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:30:57,866 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:30:57,867 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:30:57,869 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:30:57,872 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:30:57,873 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:30:57,874 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:31:00,490 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:31:00,492 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:31:00,494 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:31:03,115 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:31:03,117 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:31:03,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:31:04,233 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:31:04,507 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:31:19,044 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:31:19,048 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:31:21,679 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:31:36,358 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:31:36,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:31:37,525 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:31:37,738 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:31:44,620 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:31:49,819 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:31:49,821 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:31:49,822 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:31:50,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:31:50,538 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:31:50,540 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:31:52,426 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:32:01,100 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:32:01,492 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 12:32:02,998 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:32:03,869 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 553
2025-11-12 12:32:03,870 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:32:07,921 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 128
2025-11-12 12:32:07,922 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:32:09,186 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:32:09,190 - ispa_next.main - DEBUG - 



2025-11-12 12:32:09,190 - ispa_next.main - DEBUG - starting with process 6 (D-CG 5193 E) of 6
2025-11-12 12:32:09,193 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:32:10,942 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:32:12,686 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 553
2025-11-12 12:32:12,688 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 128
2025-11-12 12:32:14,631 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:32:14,633 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:32:53,148 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:32:55,626 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:33:01,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:01,748 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:33:02,029 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:33:03,962 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:33:03,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:04,047 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:33:04,516 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 12:33:10,025 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:33:10,028 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:33:10,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:10,124 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:33:13,637 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:33:13,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:33:14,934 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:33:16,936 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:33:17,131 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:33:17,257 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:33:17,374 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:33:17,374 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:33:26,112 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:33:27,117 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:33:27,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:27,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:41,967 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:33:46,197 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:33:46,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:46,280 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:33:46,281 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:33:46,335 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:33:47,886 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:33:48,092 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:33:49,960 - ispa_next.functions - DEBUG - Updated appointment (AB00018687) customer contact data.
2025-11-12 12:33:50,871 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:33:50,874 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:33:52,081 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:33:52,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:33:52,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:33:57,047 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:33:57,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:33:57,587 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:33:59,590 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:33:59,736 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:33:59,888 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:34:00,056 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:34:00,056 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:34:08,939 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:35:08,945 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:35:17,512 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:35:53,515 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:36:02,493 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:36:11,176 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 12:36:12,183 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:36:12,184 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:36:12,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:36:12,283 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:36:16,470 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:36:16,475 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:36:16,475 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 12:36:16,476 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:36:18,374 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:36:18,376 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:36:19,935 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:36:19,937 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:36:19,940 - ispa_next.package_manager.main - DEBUG - Cannot place FAHRZEUGWÄSCHE BASIS: active placement guards
2025-11-12 12:36:19,950 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug Innenraum saugen: active placement guards
2025-11-12 12:36:19,959 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:36:19,960 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:36:19,963 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:36:19,965 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:36:19,967 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:36:19,980 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:36:19,998 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:36:20,002 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:36:20,016 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:36:20,017 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:36:20,018 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:21,919 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:36:21,920 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:36:21,923 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:23,837 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:36:23,839 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:36:23,840 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:36:24,749 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:36:24,812 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:36:24,815 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:26,705 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:36:38,698 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:36:39,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:36:39,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:36:39,930 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:47,692 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:36:47,694 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:36:47,695 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:36:48,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:36:48,697 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:36:48,699 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:36:51,195 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:37:01,210 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:37:01,584 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 12:37:02,877 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:37:03,745 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 554
2025-11-12 12:37:03,747 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:37:08,013 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 129
2025-11-12 12:37:08,014 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:37:08,996 - ispa_next.appointments.models - DEBUG - Appointment Rolf Slatter LM-EL 65 WBA51AT090CM92155 ohne Termin.
