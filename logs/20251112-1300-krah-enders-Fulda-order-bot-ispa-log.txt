2025-11-12 13:07:34,791 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 13:07:34,796 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 13:07:43,856 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:07:54,253 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:08:09,821 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:10:08,015 - ispa_next.app_start.main - DEBUG - Operation already took 106.86 seconds (more than 80 seconds)
2025-11-12 13:10:10,093 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\b006da48984546d1\\tess_1ao7d8j5_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\b006da48984546d1\\tess_1ao7d8j5', 'txt']
2025-11-12 13:10:10,349 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:10:10,354 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:10:10,355 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:10:35,941 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 13:10:47,805 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 13:10:50,322 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:10:51,306 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 943
2025-11-12 13:10:51,306 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 286
2025-11-12 13:10:53,698 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 78
2025-11-12 13:10:53,699 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 13:10:53,700 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:10:54,935 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:10:56,049 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:11:07,523 - ispa_next.appointments.models - DEBUG - Appointment Luisa Hirsch FD-LS 815 WBAVN11040VL07747 ohne Termin.
2025-11-12 13:11:07,542 - ispa_next.appointments.models - DEBUG - Appointment Daniel Tin FD-T 115 WBAJP310X0BT73435 ohne Termin.
2025-11-12 13:11:07,543 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:11:07,550 - ispa_next.appointments.models - DEBUG - Appointment Edgar Blum VB-EB 903 WBA5V51090AE18702 ohne Termin.
2025-11-12 13:11:07,550 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:11:07,552 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:11:07,557 - ispa_next.appointments.models - DEBUG - Appointment Sarah Rockel VB-SR 4592 WBAJF31060WW33714 ohne Termin.
2025-11-12 13:11:07,565 - ispa_next.appointments.models - DEBUG - Appointment Edwin Schneider VB-CF 8691 WBATX31040LC42233 ohne Termin.
2025-11-12 13:11:07,570 - ispa_next.appointments.models - DEBUG - Appointment Rudolf Panzner FD-BR 42 WBAUJ710209C56237 ohne Termin.
2025-11-12 13:11:07,575 - ispa_next.appointments.models - DEBUG - Appointment Mahmut Odabasi FD-IL 1983 WBAJP31070BT73358 ohne Termin.
2025-11-12 13:11:07,581 - ispa_next.appointments.models - DEBUG - Appointment Elisabeth Jonas FD-M 100 WBAJF31050WW40413 ohne Termin.
2025-11-12 13:11:07,582 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:11:07,583 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:11:07,589 - ispa_next.appointments.models - DEBUG - Appointment Andreas Dumler FD-ED 2206 WBA6L51070FJ14696 ohne Termin.
2025-11-12 13:11:07,590 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:11:07,590 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:11:07,590 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:11:07,591 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:11:07,591 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:11:07,591 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:11:07,596 - ispa_next.main - DEBUG - Found 3 out of 17 appointments to process (configured limit: 15).
2025-11-12 13:11:07,596 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-12 13:11:07,596 - ispa_next.main - DEBUG - Processing 2 already visited appointments (w/ RKR not callable).
2025-11-12 13:11:07,596 - ispa_next.main - DEBUG - All appointments: FD-PM 79, FD-SO 15, FD-ED 885 E
2025-11-12 13:11:07,599 - ispa_next.main - DEBUG - 



2025-11-12 13:11:07,599 - ispa_next.main - DEBUG - starting with process 1 (FD-PM 79) of 3
2025-11-12 13:11:07,602 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:11:08,430 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:11:09,287 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 943
2025-11-12 13:11:09,288 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 78
2025-11-12 13:11:10,351 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:11:10,352 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:11:45,225 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:11:54,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:11:54,090 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:11:54,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:11:56,170 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:11:56,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:11:56,259 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:11:56,424 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:11:56,425 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:11:59,177 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:11:59,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:12:00,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:12:02,206 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:12:02,329 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:12:02,409 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:12:02,463 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:12:02,465 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:12:04,332 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:12:15,594 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:12:19,877 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:12:19,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:12:21,789 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:12:25,947 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:12:26,952 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:12:26,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:27,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:38,107 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:12:38,107 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:12:45,669 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:12:45,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:45,734 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:12:45,734 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:12:45,783 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:12:47,006 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:12:48,138 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:12:48,350 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:12:52,361 - ispa_next.functions - DEBUG - Updated appointment (AC00069126) customer contact data.
2025-11-12 13:12:53,276 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:12:53,283 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:12:54,101 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:12:54,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:12:54,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:12:58,423 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:12:58,423 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:12:58,425 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:12:58,427 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:12:58,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:12:58,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:13:03,081 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:13:03,086 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:13:03,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:03,153 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:13:12,508 - ispa_next.wipers - DEBUG - valid contract found: BMW Service Plus
2025-11-12 13:13:18,818 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 13:13:18,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:19,335 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:19,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:20,030 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:13:20,032 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:13:21,878 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:13:21,880 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:13:22,799 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:13:22,801 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:13:22,805 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart), Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-12 13:13:22,807 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:13:22,811 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:13:22,817 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:13:22,817 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:13:22,821 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:13:22,823 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:13:22,825 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:13:22,835 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:13:23,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 13:13:24,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 13:14:30,734 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:14:30,735 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-12 13:14:38,139 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:14:38,141 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:14:38,143 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:42,063 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:14:42,065 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:14:42,069 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:46,064 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:14:46,064 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:14:46,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:14:46,532 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:14:46,778 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:57,811 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:14:57,812 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:14:57,813 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:14:57,815 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:14:57,815 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:14:58,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:14:59,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:14:59,043 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:15:00,700 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:15:17,361 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 13:15:17,363 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:15:17,364 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:15:18,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:15:18,356 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:15:18,357 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:15:21,232 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:15:28,385 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 13:15:28,387 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:15:28,388 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:15:29,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:15:29,472 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:15:29,472 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:15:33,518 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-12 13:15:33,549 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 13:15:36,079 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 13:15:36,081 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:15:36,489 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 943
2025-11-12 13:15:36,491 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:15:38,824 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 286
2025-11-12 13:15:38,825 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:15:39,632 - ispa_next.appointments.models - DEBUG - Appointment Luisa Hirsch FD-LS 815 WBAVN11040VL07747 ohne Termin.
2025-11-12 13:15:39,640 - ispa_next.appointments.models - DEBUG - Appointment Andrea Mathes FD-A 1071 WMW11DJ0702R69402 ohne Termin.
2025-11-12 13:15:39,646 - ispa_next.appointments.models - DEBUG - Appointment Firma Marotech GmbH FD-MT 3101 WBA5V71070FH18348 ohne Termin.
2025-11-12 13:15:39,653 - ispa_next.appointments.models - DEBUG - Appointment Luisa Hirsch FD-LS 815 WBAVN11040VL07747 ohne Termin.
2025-11-12 13:15:39,659 - ispa_next.main - DEBUG - 



2025-11-12 13:15:39,659 - ispa_next.main - DEBUG - starting with process 2 (FD-SO 15) of 3
2025-11-12 13:15:39,663 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:15:40,838 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:15:42,029 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 943
2025-11-12 13:15:42,031 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 286
2025-11-12 13:15:43,300 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:15:43,301 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:16:06,081 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:16:08,122 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:16:13,274 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:16:15,164 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:16:15,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:15,246 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:16:15,401 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:16:15,403 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:16:18,124 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:16:18,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:16:19,051 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:16:21,055 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:16:21,152 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:16:21,255 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:16:21,312 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:16:25,509 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:16:26,512 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:16:26,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:27,004 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:38,603 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:16:38,633 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:16:42,695 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:16:42,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:42,778 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:16:42,780 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:16:42,855 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:16:44,130 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:16:45,323 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:16:45,569 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:16:47,340 - ispa_next.functions - DEBUG - Updated appointment (AC00069109) customer contact data.
2025-11-12 13:16:48,277 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:16:48,277 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:16:49,220 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:16:49,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:16:49,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:16:53,483 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:16:53,483 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:16:53,486 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:16:53,486 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:16:53,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:16:54,005 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:16:58,101 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:16:58,103 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:16:58,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:16:58,214 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:17:02,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:17:02,871 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:17:02,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:17:03,513 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:17:03,515 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:17:05,390 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:17:05,392 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:17:07,353 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:17:07,354 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:17:07,355 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:17:07,357 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:17:07,359 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:17:07,361 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:17:07,363 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:17:07,366 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:17:07,369 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:17:07,370 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:17:07,372 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:17:07,373 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:17:07,373 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:17:09,239 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:17:09,240 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:17:09,242 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:17:11,054 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:17:11,054 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:17:11,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:17:11,678 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:17:11,942 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:17:28,570 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:17:28,572 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:17:28,574 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:17:28,575 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:17:28,576 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:17:29,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:17:29,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:17:29,805 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:17:31,677 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:17:40,072 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:17:40,439 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 13:17:41,100 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:17:41,865 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 943
2025-11-12 13:17:41,865 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:17:44,878 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 286
2025-11-12 13:17:44,879 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:17:45,719 - ispa_next.appointments.models - DEBUG - Appointment Luisa Hirsch FD-LS 815 WBAVN11040VL07747 ohne Termin.
2025-11-12 13:17:45,725 - ispa_next.appointments.models - DEBUG - Appointment Andrea Mathes FD-A 1071 WMW11DJ0702R69402 ohne Termin.
2025-11-12 13:17:45,732 - ispa_next.appointments.models - DEBUG - Appointment Firma Marotech GmbH FD-MT 3101 WBA5V71070FH18348 ohne Termin.
2025-11-12 13:17:45,740 - ispa_next.appointments.models - DEBUG - Appointment Luisa Hirsch FD-LS 815 WBAVN11040VL07747 ohne Termin.
2025-11-12 13:17:45,746 - ispa_next.main - DEBUG - 



2025-11-12 13:17:45,747 - ispa_next.main - DEBUG - starting with process 3 (FD-ED 885 E) of 3
2025-11-12 13:17:45,750 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:17:46,959 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:17:48,283 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 943
2025-11-12 13:17:48,285 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 286
2025-11-12 13:17:49,758 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:17:49,760 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:18:14,675 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:18:16,184 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:18:21,006 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:18:25,625 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:18:25,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:25,696 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:18:25,884 - ispa_next.functions - DEBUG - HU date already expired after 25 days.
2025-11-12 13:18:29,831 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:18:29,833 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:18:32,526 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:18:32,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:18:33,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:18:35,542 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:18:35,649 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:18:35,746 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:18:35,848 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:18:38,101 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:18:39,106 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:18:39,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:39,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:50,918 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:18:54,764 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:18:54,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:54,849 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:18:54,849 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:18:54,915 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:18:56,128 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:18:57,259 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:18:57,474 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:18:59,086 - ispa_next.functions - DEBUG - Updated appointment (AE00023378) customer contact data.
2025-11-12 13:19:00,001 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:19:00,011 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:19:00,582 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:19:00,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:19:01,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:19:05,106 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:19:05,106 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:19:05,110 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:19:05,110 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:19:05,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:05,649 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:19:09,756 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 13:19:13,235 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:19:13,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:13,342 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:19:13,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:14,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:14,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:14,932 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:19:14,932 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:19:19,106 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:19:19,110 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:19:20,880 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:19:20,880 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:19:20,882 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:19:20,882 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:19:20,884 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:19:20,887 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:19:20,892 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:19:20,895 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:19:20,898 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:19:20,900 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:19:20,901 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:19:20,902 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:19:25,624 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 13:19:27,812 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:19:27,814 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:19:27,816 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:19:32,463 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:19:32,465 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:19:32,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:19:33,177 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:19:33,395 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:19:48,647 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:19:48,649 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:19:48,651 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:19:48,653 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:19:48,653 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:19:49,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:19:49,926 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:19:49,928 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:19:51,945 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:20:00,301 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:20:00,719 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 13:20:01,739 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:20:02,507 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 943
2025-11-12 13:20:02,508 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:20:05,646 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 286
2025-11-12 13:20:05,646 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:20:06,368 - ispa_next.appointments.models - DEBUG - Appointment Luisa Hirsch FD-LS 815 WBAVN11040VL07747 ohne Termin.
2025-11-12 13:20:06,374 - ispa_next.appointments.models - DEBUG - Appointment Andrea Mathes FD-A 1071 WMW11DJ0702R69402 ohne Termin.
2025-11-12 13:20:06,379 - ispa_next.appointments.models - DEBUG - Appointment Firma Marotech GmbH FD-MT 3101 WBA5V71070FH18348 ohne Termin.
2025-11-12 13:20:06,385 - ispa_next.appointments.models - DEBUG - Appointment Luisa Hirsch FD-LS 815 WBAVN11040VL07747 ohne Termin.
