2025-11-12 05:15:33,133 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 05:15:33,141 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 05:15:53,524 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 05:16:08,440 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 05:16:26,120 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:18:43,495 - ispa_next.app_start.main - DEBUG - Operation already took 123.37 seconds (more than 80 seconds)
2025-11-12 05:18:45,590 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\011b773ef2ca37a6\\tess_dw6pb0a6_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\011b773ef2ca37a6\\tess_dw6pb0a6', 'txt']
2025-11-12 05:18:45,616 - ispa_next.app_start.main - DEBUG - Exception occurred: tesseract is not installed or it's not in your PATH. See README file for more information.
2025-11-12 05:18:45,618 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:20:46,905 - ispa_next.app_start.main - DEBUG - Operation already took 108.91 seconds (more than 80 seconds)
2025-11-12 05:20:48,994 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\011b773ef2ca37a6\\tess_s6hy1s03_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\011b773ef2ca37a6\\tess_s6hy1s03', 'txt']
2025-11-12 05:20:49,007 - ispa_next.app_start.main - DEBUG - Exception occurred: tesseract is not installed or it's not in your PATH. See README file for more information.
2025-11-12 05:20:53,323 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 05:21:03,840 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 05:21:14,636 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 05:21:30,534 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:23:30,501 - ispa_next.app_start.main - DEBUG - Operation already took 108.83 seconds (more than 80 seconds)
2025-11-12 05:23:32,587 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\011b773ef2ca37a6\\tess_3znfwsdy_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\011b773ef2ca37a6\\tess_3znfwsdy', 'txt']
2025-11-12 05:23:32,608 - ispa_next.app_start.main - DEBUG - Exception occurred: tesseract is not installed or it's not in your PATH. See README file for more information.
2025-11-12 05:23:32,609 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:25:14,101 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 05:25:34,454 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 05:25:37,489 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:25:38,956 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:25:38,958 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 05:25:42,090 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 135
2025-11-12 05:25:42,091 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 05:25:42,092 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 05:25:43,476 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 05:25:44,867 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:26:10,086 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:26:10,152 - ispa_next.appointments.models - DEBUG - Appointment Manuel Hermann Jaeger-Lenne GV-MJ 1989 WBAJG11030ED57177 ohne Termin.
2025-11-12 05:26:10,173 - ispa_next.appointments.models - DEBUG - Appointment Armaturen Vertrieb Alms GmbH ME-AA 340E WBY71AW020FT62013 ohne Termin.
2025-11-12 05:26:10,190 - ispa_next.appointments.models - DEBUG - Appointment   WBA11FZ090FR60998 ohne Termin.
2025-11-12 05:26:10,218 - ispa_next.appointments.models - DEBUG - Appointment Bianca Prins VIE-PE 881 WBA11AW010FL84234 ohne Termin.
2025-11-12 05:26:10,229 - ispa_next.appointments.models - DEBUG - Appointment Oliver Berndsen NE-JO 288E WBY31FK070CR63503 ohne Termin.
2025-11-12 05:26:10,243 - ispa_next.appointments.models - DEBUG - Appointment   WBY61EF0105W96493 ohne Termin.
2025-11-12 05:26:10,251 - ispa_next.appointments.models - DEBUG - Appointment Krajnc ME-VV 1979 WBA11EV0209W56488 ohne Termin.
2025-11-12 05:26:10,267 - ispa_next.main - DEBUG - Found 15 out of 27 appointments to process (configured limit: 15).
2025-11-12 05:26:10,268 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 05:26:10,268 - ispa_next.main - DEBUG - Processing 12 already visited appointments (w/ RKR not callable).
2025-11-12 05:26:10,268 - ispa_next.main - DEBUG - All appointments: F-S685E, NE-X 1660, NE-RK 63, NE-MS 2311, NE-EG 1989, NE-GB 2917, D-NE 397, NE-EY 9, NE-RI 1352, NE-IM 149, KR-HK 6000, NE-IK 4000, F-CG 723, NE-BN 2510, D-CM 3200E
2025-11-12 05:26:10,271 - ispa_next.main - DEBUG - 



2025-11-12 05:26:10,271 - ispa_next.main - DEBUG - starting with process 1 (F-S685E) of 15
2025-11-12 05:26:10,275 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:26:11,666 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:26:13,241 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:26:13,242 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 135
2025-11-12 05:26:14,834 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:26:14,835 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:27:02,128 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 05:27:02,313 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 05:27:02,318 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:27:02,810 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:27:02,812 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:27:06,086 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 05:27:06,087 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:27:07,048 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:27:07,054 - ispa_next.main - DEBUG - 



2025-11-12 05:27:07,054 - ispa_next.main - DEBUG - starting with process 2 (NE-X 1660) of 15
2025-11-12 05:27:07,058 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:27:08,449 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:27:09,894 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:27:09,895 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 05:27:11,662 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:27:11,664 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:27:46,299 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:27:57,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:27:57,709 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:27:57,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:05,480 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:28:05,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:28:05,683 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:28:05,974 - ispa_next.functions - DEBUG - HU date soon to be invalid in 4 days.
2025-11-12 05:28:16,677 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:28:16,680 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:28:19,591 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:28:19,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:28:21,034 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:28:23,044 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:28:23,175 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:28:23,316 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:28:23,477 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:28:23,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:31,280 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:28:43,092 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 05:28:50,823 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:28:50,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:29:00,805 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 05:29:04,236 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 05:29:06,238 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:29:08,945 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:29:09,949 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:29:09,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:29:10,559 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:29:27,034 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:29:36,075 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:29:36,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:29:36,206 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:29:36,208 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:29:36,303 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:29:36,483 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:29:38,500 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:29:39,192 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:29:43,147 - ispa_next.functions - DEBUG - Updated appointment (AC00010688) customer contact data.
2025-11-12 05:29:44,140 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:29:44,142 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:29:44,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:29:45,135 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:29:46,326 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:29:46,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:29:46,443 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:29:50,224 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:29:50,224 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 05:29:50,227 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:29:50,230 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:29:50,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:29:50,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:29:51,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:29:51,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:29:51,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:29:52,683 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:29:52,684 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:29:54,481 - ispa_next.package_manager.helper - DEBUG - couldn't retrieve pakage name in cart
2025-11-12 05:29:54,861 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 262, in run
    self._update_cart_content()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 36, in _update_cart_content
    self.containers[Container.CART] = self.ui_helper.get_cart_content(self.base_element)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 141, in get_cart_content
    name=cart_package_name,
         ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'cart_package_name' where it is not associated with a value

2025-11-12 05:29:54,884 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:29:54,885 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:29:55,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:29:56,523 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:29:56,525 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 05:29:56,552 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 05:30:00,231 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 05:30:00,236 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:30:00,881 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:30:00,882 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:30:04,986 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 05:30:04,987 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:30:06,063 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:30:06,072 - ispa_next.main - DEBUG - 



2025-11-12 05:30:06,072 - ispa_next.main - DEBUG - starting with process 3 (NE-RK 63) of 15
2025-11-12 05:30:06,077 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:30:07,556 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:30:09,442 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:30:09,444 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 05:30:11,077 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:30:11,079 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:30:36,901 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:30:47,431 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:30:49,522 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:30:49,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:49,630 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:30:49,926 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:30:49,928 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:30:52,816 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:30:52,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:30:53,124 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 05:30:53,576 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 05:30:53,602 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:30:53,603 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:30:54,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:30:55,157 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:30:55,159 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 05:30:55,211 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 05:30:58,325 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 05:30:58,329 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:30:58,835 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:30:58,836 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:31:02,847 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 05:31:02,848 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:31:04,017 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:31:04,025 - ispa_next.main - DEBUG - 



2025-11-12 05:31:04,025 - ispa_next.main - DEBUG - starting with process 4 (NE-MS 2311) of 15
2025-11-12 05:31:04,030 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:31:05,540 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:31:07,153 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:31:07,155 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 05:31:09,034 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:31:09,036 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:31:39,748 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:31:42,073 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:31:47,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:31:49,484 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:31:49,485 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:31:49,618 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:31:49,910 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:31:49,914 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:31:52,890 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:31:52,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:31:54,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:31:56,277 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:31:56,406 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:31:56,537 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:31:56,726 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:31:56,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:31:58,735 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:32:08,109 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:32:09,114 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:32:09,115 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:32:09,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:32:32,430 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:32:32,431 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 05:32:37,264 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:32:37,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:32:37,376 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:32:37,377 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:32:37,435 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:32:38,863 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:32:40,495 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:32:40,868 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:32:42,556 - ispa_next.functions - DEBUG - Updated appointment (AB00014473) customer contact data.
2025-11-12 05:32:43,494 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:32:43,496 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:32:44,315 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:32:44,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:32:45,359 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:32:49,682 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 05:32:49,682 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:32:49,684 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:32:50,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:32:52,206 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:32:52,339 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:32:52,485 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:32:52,618 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:32:52,620 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:32:54,670 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:33:05,604 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:33:10,133 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:33:10,134 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:33:12,178 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:33:16,461 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:33:17,467 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:33:17,470 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:33:17,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:33:17,554 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:33:21,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:33:21,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:33:21,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:33:22,612 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:33:22,614 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:33:24,695 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:33:24,697 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:33:26,301 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:33:26,304 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:33:26,308 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 05:33:26,309 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:33:26,311 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:33:26,314 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:33:26,315 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:33:26,316 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:33:26,319 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:33:26,320 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:33:26,323 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:33:26,326 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:33:26,328 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:33:26,329 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:33:28,493 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:33:28,495 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:33:28,497 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:33:30,562 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:33:30,564 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:33:30,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:33:31,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:33:31,913 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:33:41,135 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:33:41,139 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:33:43,191 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:33:56,022 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:33:56,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:33:57,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:33:57,300 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:34:16,281 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:34:21,770 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:34:21,774 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:34:21,774 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:34:22,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:34:22,681 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:34:22,683 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:34:24,967 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:34:37,347 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:34:37,741 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 05:34:38,921 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:34:39,736 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:34:39,738 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:34:43,884 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 05:34:43,885 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:34:44,984 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:34:44,993 - ispa_next.main - DEBUG - 



2025-11-12 05:34:44,993 - ispa_next.main - DEBUG - starting with process 5 (NE-EG 1989) of 15
2025-11-12 05:34:44,997 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:34:46,493 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:34:48,248 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:34:48,249 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 05:34:50,378 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:34:50,379 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:35:21,964 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:35:24,144 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:35:29,717 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:35:32,393 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:35:32,394 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:35:32,551 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:35:32,807 - ispa_next.functions - DEBUG - HU date already expired after 808 days.
2025-11-12 05:35:37,890 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:35:37,893 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:35:40,746 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:35:40,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:35:42,036 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:35:44,040 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:35:44,218 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:35:44,372 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:35:44,467 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:35:44,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:35:47,278 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:35:56,290 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:35:57,296 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:35:57,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:35:57,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:36:14,320 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:36:19,187 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:36:19,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:36:19,357 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:36:19,359 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:36:19,482 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:36:19,599 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:36:21,290 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:36:21,694 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:36:23,656 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:36:23,658 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:36:23,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:36:25,223 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:36:26,407 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:36:26,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:36:26,592 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:36:30,252 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:36:30,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:36:30,756 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:36:32,758 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:36:32,941 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:36:33,137 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:36:33,265 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:36:33,267 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:36:36,080 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:36:44,569 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:37:44,572 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:37:53,444 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:38:22,447 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:38:33,397 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:38:40,053 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:38:40,055 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:38:45,043 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 05:38:48,590 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:38:51,129 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:38:52,135 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:38:52,138 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:38:52,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:38:52,298 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:38:52,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:38:53,255 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:38:53,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:38:54,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:38:54,059 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:38:56,663 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:38:56,666 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:38:58,812 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:38:58,814 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:38:58,817 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 05:38:58,818 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:38:58,819 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:38:58,821 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:38:58,822 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:38:58,824 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:38:58,826 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:38:58,827 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:38:58,830 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:38:58,833 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:38:58,835 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:38:58,836 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:39:01,551 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:39:01,553 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:39:01,554 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:39:04,273 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:39:04,275 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:39:04,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:39:05,221 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:39:05,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:39:14,770 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:39:14,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:39:17,589 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:39:30,616 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:39:31,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:39:31,725 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:39:31,894 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:39:59,152 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:40:04,935 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:40:10,088 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:40:10,091 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:40:10,092 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:40:10,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:40:10,960 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:40:10,962 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:40:13,112 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:40:23,067 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:40:23,520 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 05:40:24,669 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:40:25,486 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:40:25,487 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:40:29,766 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 05:40:29,766 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:40:30,845 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:40:30,856 - ispa_next.main - DEBUG - 



2025-11-12 05:40:30,856 - ispa_next.main - DEBUG - starting with process 6 (NE-GB 2917) of 15
2025-11-12 05:40:30,861 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:40:32,342 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:40:34,344 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:40:34,346 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 05:40:36,144 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:40:36,146 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:41:05,481 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:41:07,567 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:41:13,078 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:41:15,730 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:41:15,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:41:15,913 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:41:16,275 - ispa_next.functions - DEBUG - HU date already expired after 435 days.
2025-11-12 05:41:21,306 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:41:21,308 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:41:24,155 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:41:24,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:41:25,331 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:41:27,335 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:41:27,496 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:41:27,688 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:41:27,768 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:41:27,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:41:30,702 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:41:39,318 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:41:40,323 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:41:40,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:41:40,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:41:57,672 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:42:02,603 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:42:02,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:42:02,780 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:42:02,781 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:42:02,840 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:42:03,020 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:42:04,756 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:42:05,168 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:42:06,955 - ispa_next.functions - DEBUG - Updated appointment (AC00010673) customer contact data.
2025-11-12 05:42:07,929 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:42:07,932 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:42:08,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:42:09,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:42:10,641 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:42:10,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:42:10,747 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:42:14,853 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:42:14,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:42:15,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:42:17,526 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:42:17,713 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:42:17,843 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:42:18,015 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:42:18,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:42:20,889 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:42:29,362 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:43:29,365 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:43:40,669 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:43:45,225 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:43:45,227 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:43:48,000 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:43:52,256 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:43:53,262 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:43:53,265 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:43:53,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:43:53,372 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:43:53,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:43:54,321 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:43:54,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:43:55,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:43:55,113 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:43:57,826 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:43:57,829 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:43:59,223 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:43:59,225 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:43:59,229 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 05:43:59,232 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:43:59,234 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:43:59,240 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:43:59,242 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:43:59,244 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:43:59,247 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:43:59,249 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:43:59,251 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:43:59,254 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:43:59,256 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:43:59,257 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:44:02,063 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:44:02,065 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:44:02,084 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:44:04,809 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:44:04,811 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:44:04,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:44:05,648 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:44:05,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:44:12,079 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:44:12,083 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:44:14,843 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:44:27,455 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:44:27,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:44:28,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:44:28,669 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:44:55,838 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:45:00,943 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:45:06,158 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:45:06,160 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:45:06,161 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:45:06,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:45:07,032 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:45:07,034 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:45:09,130 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:45:18,677 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:45:19,065 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 05:45:20,120 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:45:20,958 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:45:20,960 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:45:24,976 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 05:45:24,977 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:45:26,076 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:45:26,081 - ispa_next.main - DEBUG - 



2025-11-12 05:45:26,081 - ispa_next.main - DEBUG - starting with process 7 (D-NE 397) of 15
2025-11-12 05:45:26,084 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:45:27,528 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:45:29,071 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:45:29,072 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 05:45:31,043 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:45:31,045 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:46:12,377 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:46:14,641 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:46:20,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:46:26,338 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:46:26,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:46:26,481 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:46:26,727 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:46:26,730 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:46:29,560 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:46:29,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:46:30,732 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:46:32,735 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:46:32,923 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:46:33,066 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:46:33,147 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:46:33,148 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:46:39,495 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:46:48,045 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:46:49,050 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:46:49,051 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:46:49,565 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:47:03,715 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:47:08,732 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:47:08,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:47:08,842 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:47:08,843 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:47:08,969 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:47:09,175 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:47:10,933 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:47:11,298 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:47:13,152 - ispa_next.functions - DEBUG - Updated appointment (AA00024911) customer contact data.
2025-11-12 05:47:14,088 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:47:14,100 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:47:14,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:47:15,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:47:16,917 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:47:16,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:47:17,067 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:47:20,684 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:47:20,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:47:21,168 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:47:23,173 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:47:23,314 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:47:23,528 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:47:23,667 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:47:23,668 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:47:30,004 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:47:38,522 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:48:38,525 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:48:50,085 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:48:55,330 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:48:55,331 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:49:01,687 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:49:05,906 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:49:06,911 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:49:06,915 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:49:06,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:49:07,110 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:49:07,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:49:08,069 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:49:08,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:49:08,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:49:08,785 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:49:14,383 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:49:14,386 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:49:15,650 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:49:15,677 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:49:15,680 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 05:49:15,682 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:49:15,704 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:49:15,708 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:49:15,709 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:49:15,710 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:49:15,716 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:49:15,717 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:49:15,720 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:49:15,723 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:49:15,725 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:49:15,726 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:49:22,136 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:49:22,137 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:49:22,140 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:49:28,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:49:28,506 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:49:42,930 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:49:42,932 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:49:42,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:49:43,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:49:44,256 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:49:57,641 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:49:57,643 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:50:03,813 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:50:17,671 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:50:18,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:50:18,723 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:50:19,283 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:51:19,074 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:25,161 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:30,496 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:36,037 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:42,629 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:48,486 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:53,196 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:59,303 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:52:03,618 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:52:03,622 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:52:04,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:52:04,517 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:52:04,519 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:52:09,910 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 05:52:19,975 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:52:20,358 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 05:52:22,020 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:52:22,874 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:52:22,875 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:52:27,098 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 05:52:27,099 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:52:28,157 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:52:28,165 - ispa_next.main - DEBUG - 



2025-11-12 05:52:28,166 - ispa_next.main - DEBUG - starting with process 8 (NE-EY 9) of 15
2025-11-12 05:52:28,171 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:52:29,605 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:52:31,246 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:52:31,247 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 05:52:33,222 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:52:33,223 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:53:12,874 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:53:15,127 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:53:20,639 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:53:22,631 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:53:22,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:53:22,742 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:53:23,069 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:53:23,072 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:53:26,096 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:53:26,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:53:27,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:53:29,587 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:53:29,748 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:53:29,912 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:53:29,993 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:53:29,994 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:53:32,069 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:53:40,737 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:53:41,743 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:53:41,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:53:42,249 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:53:59,045 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:54:04,075 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:54:04,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:54:04,248 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:54:04,249 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:54:04,295 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:54:05,827 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:54:06,182 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:54:08,261 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:54:08,263 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:54:09,264 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:54:09,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:54:10,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:54:14,025 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:54:14,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:54:14,529 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:54:16,532 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:54:16,678 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:54:16,923 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:54:17,392 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:54:17,394 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:54:19,525 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:54:28,160 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:55:28,163 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:55:39,897 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:55:44,268 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:55:44,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:55:47,359 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:55:51,592 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:55:52,599 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:55:52,602 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:55:52,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:55:52,725 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:55:53,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:55:53,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:55:53,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:55:54,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:55:54,645 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:55:56,689 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:55:56,693 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:55:57,838 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:55:57,841 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:55:57,843 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 05:55:57,844 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:55:57,845 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:55:57,848 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:55:57,849 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:55:57,850 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:55:57,852 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:55:57,853 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:55:57,856 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:55:57,859 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:55:57,861 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:55:57,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:55:59,969 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:55:59,971 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:55:59,973 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:56:02,057 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:56:02,059 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:56:02,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:56:03,262 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:56:03,547 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:56:12,859 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:56:12,860 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:56:14,894 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:56:28,232 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:56:28,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:56:29,394 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:56:29,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:56:48,340 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:56:54,033 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:56:54,035 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:56:54,036 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:56:54,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:56:54,883 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:56:54,885 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:56:56,902 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:57:06,459 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:57:06,868 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 05:57:08,101 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:57:09,541 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:57:09,542 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:57:13,362 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 05:57:13,363 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:57:14,988 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:57:14,995 - ispa_next.main - DEBUG - 



2025-11-12 05:57:14,995 - ispa_next.main - DEBUG - starting with process 9 (NE-RI 1352) of 15
2025-11-12 05:57:15,059 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:57:16,526 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:57:18,231 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 05:57:18,232 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 05:57:20,053 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:57:20,055 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:57:54,721 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:57:57,524 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:58:03,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:58:05,073 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:58:05,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:58:05,181 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:58:05,413 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:58:05,416 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:58:08,420 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:58:08,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:58:09,939 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:58:11,942 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:58:12,103 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:58:12,278 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:58:12,353 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:58:12,355 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:58:14,483 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:58:23,607 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:58:24,612 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:58:24,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:58:25,090 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:58:42,124 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:58:47,329 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:58:47,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:58:47,499 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:58:47,500 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:58:47,597 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:58:49,058 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:58:49,438 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:58:52,490 - ispa_next.functions - DEBUG - Updated appointment (AC00010676) customer contact data.
2025-11-12 05:58:53,748 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:58:53,750 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:58:55,627 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:58:55,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:58:57,303 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:59:01,525 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 05:59:01,526 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:59:01,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:59:02,285 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:59:04,288 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:59:04,537 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:59:04,767 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:59:05,055 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:59:05,057 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:59:07,737 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:59:18,976 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:59:23,988 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:59:23,989 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:59:26,540 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:59:30,933 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:59:31,939 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:59:31,943 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:59:31,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:59:32,141 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:59:36,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:59:36,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:59:36,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:59:37,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:59:37,654 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:59:40,048 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:59:40,071 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:59:42,376 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:59:42,378 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:59:42,382 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 05:59:42,384 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:59:42,387 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:59:42,403 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:59:42,406 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:59:42,407 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:59:42,410 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:59:42,414 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:59:42,416 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:59:42,420 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:59:42,421 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:59:42,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:59:44,895 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:59:44,897 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:59:44,900 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:59:47,251 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:59:47,252 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:59:47,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 05:59:48,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 05:59:49,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:00:00,272 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:00:00,280 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:00:02,488 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:00:18,097 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:00:18,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:00:19,468 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:00:19,675 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:00:40,722 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:00:49,651 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:00:49,654 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:00:49,654 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:00:50,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:00:50,761 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:00:50,763 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:00:53,650 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 06:01:06,126 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:01:06,530 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 06:01:08,255 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:01:09,705 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:01:09,707 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:01:16,991 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 06:01:16,992 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:01:18,659 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:01:18,666 - ispa_next.main - DEBUG - 



2025-11-12 06:01:18,666 - ispa_next.main - DEBUG - starting with process 10 (NE-IM 149) of 15
2025-11-12 06:01:18,823 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:01:20,646 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:01:23,142 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:01:23,144 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 06:01:25,085 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:01:25,086 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:02:08,376 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:02:10,640 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:02:16,145 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:02:18,910 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:02:18,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:02:19,120 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:02:19,382 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 06:02:24,116 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:02:24,119 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:02:27,060 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:02:27,062 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:02:28,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:02:30,449 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:02:30,628 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:02:30,728 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:02:30,849 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:02:30,851 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:02:33,650 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:02:42,422 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 06:02:43,427 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:02:43,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:02:43,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:03:00,333 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 06:03:05,253 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:03:05,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:03:05,332 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:03:05,378 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:03:05,429 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:03:05,670 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 06:03:07,681 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:03:08,265 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:03:10,308 - ispa_next.functions - DEBUG - Updated appointment (AA00024982) customer contact data.
2025-11-12 06:03:11,260 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:03:11,310 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:03:11,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:03:12,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:03:13,914 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:03:13,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:03:14,992 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 06:03:19,023 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:03:19,025 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:03:19,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:03:21,659 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:03:21,830 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:03:21,987 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:03:22,094 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:03:22,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:03:24,998 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:03:33,604 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 06:04:33,606 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:04:42,510 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 06:05:08,513 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:05:19,577 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 06:05:26,637 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 06:05:26,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:05:31,979 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 06:05:35,490 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:05:37,710 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 06:05:38,715 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:05:38,718 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:05:38,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:05:38,853 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:05:39,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:05:39,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:05:39,764 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:05:40,614 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:05:40,616 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:05:43,279 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:05:43,282 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:05:45,634 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:05:45,636 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:05:45,638 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 06:05:45,640 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:05:45,641 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:05:45,644 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:05:45,646 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:05:45,647 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:05:45,649 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:05:45,650 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:05:45,652 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:05:45,656 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:05:45,658 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:05:45,658 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:05:48,582 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:05:48,584 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:05:48,611 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:05:51,351 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:05:51,353 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:05:51,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 06:05:52,495 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 06:05:52,915 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:06:08,034 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:06:08,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:06:10,840 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:06:24,425 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:06:24,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:06:25,534 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:06:25,719 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:06:52,010 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:06:58,352 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:07:03,852 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:07:03,854 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:07:03,855 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:07:04,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:07:04,704 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:07:04,706 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:07:06,661 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 06:07:16,469 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:07:16,900 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 06:07:18,103 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:07:18,967 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:07:18,969 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:07:23,613 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 06:07:23,614 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:07:24,701 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:07:24,710 - ispa_next.main - DEBUG - 



2025-11-12 06:07:24,711 - ispa_next.main - DEBUG - starting with process 11 (KR-HK 6000) of 15
2025-11-12 06:07:24,714 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:07:26,213 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:07:27,817 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:07:27,819 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 06:07:29,769 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:07:29,771 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:08:13,826 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:08:16,028 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:08:21,576 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:08:25,793 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:08:25,794 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:08:25,924 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:08:26,270 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:08:26,274 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:08:29,325 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:08:29,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:08:30,735 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:08:32,739 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:08:32,914 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:08:33,062 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:08:33,174 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:08:37,433 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 06:08:38,439 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:08:38,440 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:08:38,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:08:55,914 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 06:09:00,941 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:09:00,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:09:01,077 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:09:01,078 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:09:01,189 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:09:01,379 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 06:09:03,033 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:09:03,440 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:09:05,792 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:09:05,794 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:09:05,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:09:07,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:09:08,264 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:09:08,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:09:08,358 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 06:09:11,990 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:09:11,991 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 06:09:11,995 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:09:12,001 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:09:12,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:09:12,508 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:09:21,897 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 06:09:33,224 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 06:09:33,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:09:35,315 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:09:35,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:09:36,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:09:36,090 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:09:39,907 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:09:39,910 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:09:42,207 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:09:42,232 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:09:42,236 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 06:09:42,259 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:09:42,266 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:09:42,270 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:09:42,271 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:09:42,272 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:09:42,275 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:09:42,276 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:09:42,279 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:09:42,282 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:09:42,284 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:09:42,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:09:46,761 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:09:46,762 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:09:46,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:09:50,910 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:09:50,912 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:09:50,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 06:09:51,902 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 06:09:52,054 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:10:06,244 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:10:06,246 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:10:10,313 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:10:23,046 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:10:23,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:10:24,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:10:24,340 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:11:05,125 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:11:10,727 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:11:16,451 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:11:22,030 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:11:28,519 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:11:28,521 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:11:28,522 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:11:29,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:11:29,455 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:11:29,456 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:11:31,648 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 06:11:42,035 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:11:42,410 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 06:11:43,789 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:11:44,783 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:11:44,786 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:11:49,642 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 06:11:49,643 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:11:50,715 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:11:50,720 - ispa_next.main - DEBUG - 



2025-11-12 06:11:50,720 - ispa_next.main - DEBUG - starting with process 12 (NE-IK 4000) of 15
2025-11-12 06:11:50,724 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:11:52,265 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:11:53,938 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:11:53,939 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 06:11:55,966 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:11:55,967 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:12:29,942 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:12:32,715 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:12:38,293 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:12:41,841 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:12:41,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:12:41,947 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:12:42,237 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:12:42,240 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:12:45,080 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:12:45,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:12:46,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:12:48,500 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:12:48,693 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:12:48,908 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:12:48,985 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:12:48,988 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:12:52,560 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:13:01,239 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 06:13:02,243 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:13:02,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:13:02,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:13:19,499 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 06:13:25,413 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:13:25,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:13:25,503 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:13:25,504 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:13:25,595 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:13:25,896 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 06:13:27,316 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:13:27,693 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:13:30,579 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:13:30,582 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:13:30,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:13:32,034 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:13:33,268 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:13:33,269 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:13:33,380 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 06:13:37,048 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:13:37,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:13:37,586 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:13:39,589 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:13:39,720 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:13:39,891 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:13:39,998 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:13:39,999 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:13:43,537 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:13:52,237 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 06:14:52,239 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:15:03,319 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 06:15:07,548 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 06:15:07,549 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:15:11,072 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:15:15,299 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 06:15:16,306 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:15:16,309 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:15:16,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:15:16,449 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:15:20,348 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 06:15:30,474 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 06:15:31,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:15:32,631 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:15:32,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:15:33,445 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:15:33,447 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:15:36,798 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:15:36,805 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:15:37,811 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:15:37,814 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:15:37,825 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 06:15:37,830 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:15:37,832 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:15:37,835 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:15:37,836 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:15:37,837 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:15:37,839 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:15:37,840 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:15:37,844 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:15:37,847 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:15:37,849 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:15:37,850 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:15:41,350 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:15:41,352 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:15:41,356 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:15:44,765 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:15:44,768 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:15:44,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 06:15:45,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 06:15:46,302 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:15:55,731 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:15:55,733 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:15:59,254 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:16:12,843 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:16:13,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:16:13,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:16:14,167 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:16:47,528 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:16:53,200 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:16:58,242 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:17:04,311 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:17:04,314 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:17:04,314 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:17:05,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:17:05,199 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:17:05,201 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:17:07,462 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 06:17:18,504 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:17:18,880 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 06:17:20,158 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:17:21,200 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:17:21,201 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:17:26,216 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 06:17:26,217 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:17:27,361 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:17:27,369 - ispa_next.main - DEBUG - 



2025-11-12 06:17:27,369 - ispa_next.main - DEBUG - starting with process 13 (F-CG 723) of 15
2025-11-12 06:17:27,374 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:17:28,884 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:17:30,540 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:17:30,541 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 06:17:32,473 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:17:32,475 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:18:06,723 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:18:09,644 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:18:15,214 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:18:17,232 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:18:17,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:18:17,310 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:18:17,672 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:18:17,676 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:18:20,664 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:18:20,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:18:22,222 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:18:24,227 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:18:24,385 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:18:24,509 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:18:24,633 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:18:28,861 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 06:18:29,866 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:18:29,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:18:30,381 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:18:48,101 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 06:18:54,239 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:18:54,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:18:54,392 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:18:54,393 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:18:54,497 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:18:56,035 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:18:56,655 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:18:59,148 - ispa_next.functions - DEBUG - Updated appointment (AB00014549) customer contact data.
2025-11-12 06:19:00,098 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:19:00,100 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:19:01,989 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:19:01,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:19:03,303 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:19:06,983 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:19:06,983 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 06:19:06,989 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:19:06,994 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:19:06,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:19:07,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:19:16,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:19:16,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:19:16,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:19:17,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:19:17,706 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:19:19,858 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:19:19,861 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:19:21,422 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:19:21,424 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:19:21,426 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 06:19:21,428 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:19:21,429 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:19:21,432 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:19:21,433 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:19:21,434 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:19:21,437 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:19:21,438 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:19:21,440 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:19:21,444 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:19:21,446 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:19:21,447 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:19:23,532 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:19:23,534 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:19:23,536 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:19:25,626 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:19:25,628 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:19:25,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 06:19:26,742 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 06:19:27,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:19:42,808 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:19:42,811 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:19:44,910 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:19:58,503 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:19:59,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:19:59,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:19:59,936 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:20:19,603 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:20:25,524 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:20:25,526 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:20:25,527 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:20:26,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:20:26,374 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:20:26,378 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:20:28,656 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 06:20:38,386 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:20:38,816 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 06:20:40,212 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:20:41,938 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:20:41,940 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:20:46,248 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 06:20:46,249 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:20:47,318 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:20:47,323 - ispa_next.main - DEBUG - 



2025-11-12 06:20:47,323 - ispa_next.main - DEBUG - starting with process 14 (NE-BN 2510) of 15
2025-11-12 06:20:47,326 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:20:48,875 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:20:51,347 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:20:51,348 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 06:20:53,510 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:20:53,512 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:21:28,980 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:21:32,111 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:21:37,758 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:21:40,525 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:21:40,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:21:40,660 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:21:40,962 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:21:40,965 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:21:43,922 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:21:43,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:21:45,615 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:21:47,619 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:21:47,747 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:21:47,867 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:21:48,014 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:21:52,234 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 06:21:53,238 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:21:53,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:21:53,711 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:22:11,705 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 06:22:17,520 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:22:17,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:22:17,691 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:22:17,692 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:22:17,822 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:22:18,002 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 06:22:19,793 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:22:20,131 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:22:22,371 - ispa_next.functions - DEBUG - Updated appointment (AA00024791) customer contact data.
2025-11-12 06:22:23,424 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:22:23,426 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:22:23,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:22:24,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:22:26,814 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:22:26,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:22:26,939 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 06:22:30,587 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:22:30,587 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 06:22:30,590 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:22:30,593 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:22:30,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:22:31,145 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:22:31,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:22:32,322 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:22:32,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:22:33,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:22:33,205 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:22:35,830 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:22:35,833 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:22:36,922 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:22:36,924 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:22:36,928 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 06:22:36,930 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:22:36,933 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:22:36,938 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:22:36,941 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:22:36,945 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:22:36,948 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:22:36,950 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:22:36,952 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:22:36,955 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:22:36,957 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:22:36,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:22:39,753 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:22:39,755 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:22:39,759 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:22:42,566 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:22:42,568 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:22:42,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 06:22:43,891 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 06:22:44,263 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:22:54,440 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:22:54,442 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:22:57,172 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:23:10,591 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:23:11,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:23:11,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:23:12,048 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:23:38,153 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:23:43,872 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:23:49,567 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:23:49,570 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:23:49,570 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:23:50,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:23:50,445 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:23:50,447 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:23:52,733 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 06:24:02,669 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:24:03,072 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 06:24:04,446 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:24:06,715 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:24:06,717 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:24:10,946 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 06:24:10,947 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:24:12,916 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:24:12,920 - ispa_next.main - DEBUG - 



2025-11-12 06:24:12,921 - ispa_next.main - DEBUG - starting with process 15 (D-CM 3200E) of 15
2025-11-12 06:24:12,925 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:24:14,503 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:24:16,278 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:24:16,280 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 06:24:18,322 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:24:18,324 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:24:54,847 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:24:59,850 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:25:06,446 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:25:09,901 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:25:09,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:25:10,093 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:25:10,468 - ispa_next.functions - DEBUG - HU date already expired after 9 days.
2025-11-12 06:25:15,582 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:25:15,586 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:25:18,539 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:25:18,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:25:20,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:25:22,073 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:25:22,218 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:25:22,418 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:25:22,503 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:25:26,856 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 06:25:27,862 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:25:27,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:25:28,391 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:25:46,195 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 06:25:52,506 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:25:52,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:25:52,681 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:25:52,683 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:25:52,813 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:25:52,928 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 06:25:54,587 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:25:55,204 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:25:57,431 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:25:57,434 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:25:57,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:25:58,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:26:00,201 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:26:00,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:26:00,324 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 06:26:03,980 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:26:03,980 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 06:26:03,985 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:26:03,989 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:26:03,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:26:05,320 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:26:14,160 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 06:26:28,718 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 06:26:29,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:26:30,296 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:26:30,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:26:31,058 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:26:31,061 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:26:34,412 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:26:34,414 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:26:37,671 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:26:37,673 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:26:37,675 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 06:26:37,677 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:26:37,678 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:26:37,681 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:26:37,682 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:26:37,685 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:26:37,686 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:26:37,689 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:26:37,693 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:26:37,695 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:26:37,696 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:26:41,344 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:26:41,345 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:26:41,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:26:44,835 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:26:44,838 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:26:44,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 06:26:46,153 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 06:26:46,502 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:26:57,081 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:26:57,085 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:27:00,606 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:27:14,184 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:27:14,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:27:15,430 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:27:15,627 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:27:50,681 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:27:56,513 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:28:01,808 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:28:08,584 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:28:08,587 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:28:08,588 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:28:09,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:28:09,514 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:28:09,516 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:28:11,943 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 06:28:22,894 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:28:24,345 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 06:28:25,738 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:28:26,998 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 06:28:26,999 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:28:31,864 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 06:28:31,865 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:28:32,964 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
