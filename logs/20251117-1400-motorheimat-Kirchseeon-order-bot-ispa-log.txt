2025-11-17 14:00:37,244 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 14:00:37,255 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 14:00:45,460 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:00:56,482 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:01:11,988 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:01:36,409 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 14:01:49,971 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 14:01:53,803 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:01:55,066 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 948
2025-11-17 14:01:55,068 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 432
2025-11-17 14:01:57,414 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 378
2025-11-17 14:01:57,414 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 14:01:57,415 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:01:58,573 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:01:59,533 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:02:59,383 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:02:59,425 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:02:59,451 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:02:59,471 - ispa_next.appointments.models - DEBUG - Appointment Franz-Michael von Morenhoffen Herr M-VM 1945 WMW11GD0602W56385 ohne Termin.
2025-11-17 14:02:59,487 - ispa_next.appointments.models - DEBUG - Appointment Andreas Pletschacher Herr M-S 7268 WMW11GA0607N78892 ohne Termin.
2025-11-17 14:02:59,491 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:02:59,507 - ispa_next.appointments.models - DEBUG - Appointment ZEBE-Zeichenbüro Ebersberg Frau EBE-ZB 999 WMWJZ31040TP30810 ohne Termin.
2025-11-17 14:02:59,532 - ispa_next.appointments.models - DEBUG - Appointment Erich Pudelko Herr EBE-EP 11 WBA21EA0307N15581 ohne Termin.
2025-11-17 14:02:59,560 - ispa_next.appointments.models - DEBUG - Appointment Markus Deppe Herr M-MD 6407 WMWLV310802U83186 ohne Termin.
2025-11-17 14:02:59,573 - ispa_next.appointments.models - DEBUG - Appointment Petra Wichert Frau M-PW 2302 WBAUH31030E525919 ohne Termin.
2025-11-17 14:02:59,584 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Trepte Herr STA-GW 131 WBA2A51000V427342 ohne Termin.
2025-11-17 14:02:59,598 - ispa_next.appointments.models - DEBUG - Appointment Firma Open Text Software GmbH M-M 1684E WBA21GV030CW39508 ohne Termin.
2025-11-17 14:02:59,610 - ispa_next.appointments.models - DEBUG - Appointment Herbert Kuhn Herr M-KT 4350 WBAEJ11080AF78090 ohne Termin.
2025-11-17 14:02:59,623 - ispa_next.appointments.models - DEBUG - Appointment Firma curare - Verein zur Förderung EBE-C 204 WBA21EA0307L92610 ohne Termin.
2025-11-17 14:02:59,635 - ispa_next.appointments.models - DEBUG - Appointment Hans-Dieter Krill Herr M-DK 2695 WBA3U11040J871366 ohne Termin.
2025-11-17 14:02:59,647 - ispa_next.appointments.models - DEBUG - Appointment Aldin Hecimovic Herr EBE-AD 216 WBA2E510305G50482 ohne Termin.
2025-11-17 14:02:59,657 - ispa_next.appointments.models - DEBUG - Appointment Firma Global Concerts GmbH M-SZ 1171 WBA21EF0605018576 ohne Termin.
2025-11-17 14:02:59,670 - ispa_next.appointments.models - DEBUG - Appointment Brigitte Fertich Frau EBE-FJ 111 WBAXB31040DW54269 ohne Termin.
2025-11-17 14:02:59,681 - ispa_next.appointments.models - DEBUG - Appointment Daniela Felbrich Frau ED-JS 396 WBY8P210207F54741 ohne Termin.
2025-11-17 14:02:59,694 - ispa_next.appointments.models - DEBUG - Appointment Patrick Gaßler Herr TS-GP 2299 WBA4C31090G785518 ohne Termin.
2025-11-17 14:02:59,704 - ispa_next.main - DEBUG - Found 5 out of 55 appointments to process (configured limit: 15).
2025-11-17 14:02:59,704 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-17 14:02:59,704 - ispa_next.main - DEBUG - All appointments: DD-IC 8000, M-J 2413, M-SO 466, RO-FT 227, EBE-XC 42
2025-11-17 14:02:59,712 - ispa_next.main - DEBUG - 



2025-11-17 14:02:59,712 - ispa_next.main - DEBUG - starting with process 1 (DD-IC 8000) of 5
2025-11-17 14:02:59,716 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:03:00,511 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:03:01,195 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 948
2025-11-17 14:03:01,196 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 378
2025-11-17 14:03:02,262 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:03:02,263 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:03:32,348 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:03:41,565 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:46,117 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:03:46,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:46,191 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:03:46,449 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:03:46,451 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:03:46,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:46,567 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:03:49,719 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:03:49,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:03:51,069 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:03:53,073 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:03:53,175 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:03:53,314 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:03:53,418 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:03:57,598 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:03:58,627 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:03:58,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:59,102 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:08,252 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 14:04:15,432 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:04:15,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:15,510 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:04:15,511 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:04:15,552 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:04:16,846 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:04:18,045 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:04:18,269 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:04:22,072 - ispa_next.functions - DEBUG - Updated appointment (AJ00018652) customer contact data.
2025-11-17 14:04:22,972 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:04:22,972 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:04:23,502 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:04:23,504 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:04:24,109 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:04:28,532 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:04:28,532 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:04:28,536 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:04:28,537 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:04:28,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:29,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:04:33,193 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:04:33,197 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:04:33,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:33,324 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:04:42,127 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 14:04:51,375 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 14:04:51,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:51,961 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:51,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:52,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:04:52,692 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:04:57,653 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:04:57,655 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:04:58,619 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:04:58,621 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:04:58,623 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:04:58,625 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:04:58,627 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 14:04:58,629 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:04:58,630 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:04:58,634 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:04:58,645 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:04:58,648 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:04:58,656 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:04:58,662 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:04:58,664 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:05:20,648 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:05:20,649 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 14:05:25,859 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:05:25,861 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:05:25,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:31,896 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:05:31,899 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:05:31,903 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:37,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:05:37,878 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:05:49,060 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:04,650 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:06:04,650 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 14:06:04,653 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:10,648 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:06:10,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:06:11,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:06:12,054 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:26,963 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:06:26,965 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:33,045 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:06:45,470 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:06:45,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:06:46,466 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:06:46,597 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:45,210 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:07:50,733 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:07:55,114 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:07:59,552 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:08:03,305 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:08:07,681 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:08:11,475 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:08:15,709 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:08:15,711 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:08:15,711 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:08:16,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:08:16,300 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:08:16,301 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:08:17,828 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:08:27,138 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:08:27,534 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 14:08:28,398 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:08:29,985 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 949
2025-11-17 14:08:29,986 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:08:32,053 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 433
2025-11-17 14:08:32,053 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:08:32,657 - ispa_next.appointments.models - DEBUG - Appointment Luis Schlager Herr RO-LS 1806 WBA1R91080VA07455 ohne Termin.
2025-11-17 14:08:32,662 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:08:32,668 - ispa_next.main - DEBUG - Found new Appointment: EBE-PH 700
2025-11-17 14:08:32,671 - ispa_next.main - DEBUG - 



2025-11-17 14:08:32,671 - ispa_next.main - DEBUG - starting with process 2 (EBE-PH 700) of 6
2025-11-17 14:08:32,676 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:08:33,455 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:08:34,463 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 949
2025-11-17 14:08:34,465 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 433
2025-11-17 14:08:35,948 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:08:35,949 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:09:14,131 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:09:24,284 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:28,267 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:09:28,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:28,345 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:09:28,535 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:09:28,537 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:09:28,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:28,644 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:09:38,054 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:09:38,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:09:39,173 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:09:41,179 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:09:41,294 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:09:44,537 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:09:44,643 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:09:44,645 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:09:55,947 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:09:56,951 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:09:56,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:57,451 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:08,865 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:10:16,067 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:10:16,068 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:16,146 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:10:16,146 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:10:16,197 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:10:17,434 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:10:17,647 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:10:21,408 - ispa_next.functions - DEBUG - Updated appointment (AJ00018654) customer contact data.
2025-11-17 14:10:22,343 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:10:22,344 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:10:22,960 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:10:22,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:10:23,552 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:10:27,135 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:10:27,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:10:27,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:10:29,657 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:10:29,767 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:10:29,878 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:10:29,948 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:10:29,948 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:10:41,315 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:11:41,318 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:11:52,354 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:12:14,356 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:12:25,658 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:12:32,838 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:12:33,846 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:12:33,847 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:12:33,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:12:33,929 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:12:38,069 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:12:38,811 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:12:50,418 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:12:50,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:12:50,522 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:12:54,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:12:54,601 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:12:54,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:12:55,448 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:12:55,448 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:12:59,087 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:12:59,090 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:13:00,591 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:13:00,595 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:13:00,597 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:13:00,599 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:13:00,611 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:13:00,613 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:13:00,616 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:13:00,619 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:13:00,621 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:13:00,622 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:13:00,623 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:13:00,624 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:13:00,628 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:13:00,630 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:13:00,631 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:04,746 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:13:04,750 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:13:04,752 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:08,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:13:08,850 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:13:18,096 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:33,674 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:13:33,674 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 14:13:33,676 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:37,649 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:13:37,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:13:38,585 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:13:38,796 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:50,208 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:13:50,210 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:54,187 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:14:09,813 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:14:10,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:14:10,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:14:11,240 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:14:50,680 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:14:57,920 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:15:03,567 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:15:09,442 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:15:15,761 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:15:15,763 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:15:15,765 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:15:16,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:15:16,883 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:15:16,885 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:15:19,476 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:15:31,205 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:15:31,600 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 14:15:32,884 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:15:36,325 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 949
2025-11-17 14:15:36,327 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:15:41,187 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 432
2025-11-17 14:15:41,188 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:15:42,325 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:15:42,331 - ispa_next.main - DEBUG - Found new Appointment: RO-LS 1806
2025-11-17 14:15:42,332 - ispa_next.main - DEBUG - 



2025-11-17 14:15:42,333 - ispa_next.main - DEBUG - starting with process 3 (RO-LS 1806) of 7
2025-11-17 14:15:42,338 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:15:44,071 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:15:45,806 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 949
2025-11-17 14:15:45,809 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 432
2025-11-17 14:15:47,914 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:15:47,915 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:16:35,144 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:16:46,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:16:49,312 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:16:49,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:16:49,438 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:16:49,755 - ispa_next.functions - DEBUG - HU date already expired after 1222 days.
2025-11-17 14:16:57,746 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:16:57,748 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:16:57,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:16:57,839 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:17:10,097 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:17:10,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:11,513 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:17:13,518 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:17:13,693 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:17:17,034 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:17:17,116 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:17:17,116 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:17:29,612 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:17:30,617 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:17:30,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:31,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:41,560 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 14:17:50,661 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:17:50,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:50,734 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:17:50,735 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:17:50,802 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:17:52,120 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:17:52,342 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:17:56,437 - ispa_next.functions - DEBUG - Updated appointment (AJ00018655) customer contact data.
2025-11-17 14:17:57,378 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:17:57,411 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:17:58,588 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:17:58,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:17:59,366 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:18:03,007 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:18:03,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:18:03,543 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:18:05,547 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:18:05,705 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:18:05,849 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:18:05,951 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:18:05,951 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:18:17,713 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:19:17,716 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:19:29,582 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:19:37,131 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:19:37,131 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:19:41,311 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:19:42,317 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:19:42,318 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:19:42,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:19:42,437 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:19:46,561 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:19:47,477 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:19:57,545 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:19:57,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:19:57,668 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:20:01,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:01,743 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:01,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:20:02,626 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:20:02,628 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:20:05,097 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:20:05,103 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:20:06,536 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:20:06,540 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:20:06,543 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:20:06,547 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart)}
2025-11-17 14:20:06,551 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:20:06,553 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:20:06,555 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:20:06,555 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:20:06,557 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:20:06,559 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:20:06,559 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:20:06,563 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:20:36,946 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:20:36,948 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:20:36,951 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:20:36,953 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:20:40,545 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:20:40,550 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:20:40,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:20:43,795 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:20:43,795 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 14:20:43,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:20:47,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:20:47,200 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:20:52,812 - ispa_next.functions - DEBUG - added beide Bremsscheiben hinten to advice_list
2025-11-17 14:20:56,818 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:20:56,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:20:58,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:20:58,811 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:08,093 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:21:08,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:11,384 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:21:25,227 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:21:25,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:21:26,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:21:26,520 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:45,125 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:21:45,125 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:21:45,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:21:45,918 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:21:45,920 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:21:49,299 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:21:59,647 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:22:00,023 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 14:22:01,095 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:22:04,388 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 950
2025-11-17 14:22:04,390 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:22:08,597 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 433
2025-11-17 14:22:08,597 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:22:09,736 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:22:09,740 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:22:09,745 - ispa_next.main - DEBUG - 



2025-11-17 14:22:09,745 - ispa_next.main - DEBUG - starting with process 4 (M-J 2413) of 7
2025-11-17 14:22:09,752 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:22:11,429 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:22:13,192 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 950
2025-11-17 14:22:13,194 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 433
2025-11-17 14:22:15,318 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:22:15,320 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:22:55,192 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:23:07,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:23:07,239 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:23:07,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:08,725 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:23:08,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:23:08,834 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:23:09,138 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:23:09,142 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:23:09,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:23:09,281 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:23:21,469 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:23:21,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:23:23,137 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:23:25,142 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:23:25,280 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:23:25,475 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:23:25,607 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:23:25,609 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:23:37,249 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:23:45,071 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:23:45,071 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:23:49,307 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:23:50,314 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:23:50,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:23:50,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:05,141 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:24:05,141 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:24:14,238 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:24:14,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:14,341 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:24:14,343 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:24:14,454 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:24:15,807 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:24:17,219 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:24:17,450 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:24:21,827 - ispa_next.functions - DEBUG - Updated appointment (AJ00018651) customer contact data.
2025-11-17 14:24:22,742 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:24:22,743 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:24:23,690 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:24:23,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:24:24,626 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:24:28,680 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 14:24:28,680 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:24:28,680 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:24:28,683 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:24:28,684 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:24:28,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:24:29,233 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:24:33,446 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:24:33,450 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:24:33,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:24:33,529 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:24:33,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:34,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:34,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:24:35,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:24:35,363 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:24:36,745 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:24:36,747 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:24:38,078 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:24:38,079 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:24:38,081 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:24:38,081 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:24:38,082 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:24:38,083 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:24:38,085 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:24:38,086 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:24:38,086 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:24:38,088 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:24:38,089 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:24:38,091 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:24:38,093 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:24:38,095 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:24:38,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:39,361 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:24:39,363 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:24:39,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:40,582 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:24:40,582 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 14:24:40,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:41,883 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:24:41,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:24:43,005 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:24:43,278 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:51,800 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:24:51,802 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:53,082 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:25:07,203 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:25:07,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:25:08,451 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:25:08,666 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:21,513 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:25:21,515 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:25:21,517 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:25:22,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:25:22,311 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:25:22,313 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:25:24,778 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:25:34,323 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:25:34,708 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 14:25:35,495 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:25:39,361 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 950
2025-11-17 14:25:39,361 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:25:44,111 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 433
2025-11-17 14:25:44,112 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:25:45,168 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:25:45,172 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:25:45,177 - ispa_next.main - DEBUG - 



2025-11-17 14:25:45,177 - ispa_next.main - DEBUG - starting with process 5 (M-SO 466) of 7
2025-11-17 14:25:45,181 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:25:46,868 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:25:48,606 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 950
2025-11-17 14:25:48,608 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 433
2025-11-17 14:25:50,748 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:25:50,750 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:26:38,182 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:26:50,531 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:51,778 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:26:51,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:51,893 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:26:52,306 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:26:52,310 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:26:52,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:52,423 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:26:55,889 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:26:55,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:26:57,681 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:26:59,685 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:26:59,842 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:26:59,992 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:27:00,149 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:27:04,432 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:27:05,441 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:27:05,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:05,954 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:19,672 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:27:19,672 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:27:28,565 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:27:28,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:28,643 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:27:28,644 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:27:28,725 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:27:30,063 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:27:31,475 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:27:31,707 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:27:36,188 - ispa_next.functions - DEBUG - Updated appointment (AJ00018647) customer contact data.
2025-11-17 14:27:37,086 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:27:37,098 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:27:38,332 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:27:38,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:27:39,258 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:27:42,875 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:27:42,876 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:27:42,880 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:27:42,882 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:27:42,882 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:27:43,426 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:27:47,682 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:27:47,687 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:27:47,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:27:47,776 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:27:56,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:57,236 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:57,238 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:27:58,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:27:58,219 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:27:59,502 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:27:59,508 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:28:00,925 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:28:00,925 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:28:00,927 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:28:00,928 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:28:00,931 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:28:00,931 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:28:00,933 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:28:00,935 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:28:00,935 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:28:00,945 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:28:00,949 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:28:00,951 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:28:00,953 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:28:00,955 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:28:00,957 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:02,223 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:28:02,225 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:28:02,229 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:03,474 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:28:03,474 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 14:28:03,478 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:04,781 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:28:04,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:28:05,953 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:28:06,291 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:16,440 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:28:16,444 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:17,737 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:28:31,176 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:28:31,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:28:32,273 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:28:32,421 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:45,731 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:28:45,733 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:28:45,735 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:28:46,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:28:46,810 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:28:46,812 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:28:49,039 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:28:58,254 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:28:58,644 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 14:28:59,595 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:29:03,277 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 950
2025-11-17 14:29:03,279 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:29:07,514 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 433
2025-11-17 14:29:07,515 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:29:08,626 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:29:08,629 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:29:08,632 - ispa_next.main - DEBUG - 



2025-11-17 14:29:08,632 - ispa_next.main - DEBUG - starting with process 6 (RO-FT 227) of 7
2025-11-17 14:29:08,636 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:29:10,039 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:29:11,773 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 950
2025-11-17 14:29:11,774 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 433
2025-11-17 14:29:14,229 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:29:14,231 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:29:59,832 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:30:10,550 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:30:11,840 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:30:11,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:11,932 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:30:12,213 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:30:12,215 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:30:12,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:12,356 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:30:15,803 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:30:15,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:30:17,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:30:19,217 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:30:19,358 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:30:19,515 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:30:19,680 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:30:23,867 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:30:24,872 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:30:24,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:25,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:37,861 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:30:37,861 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:30:46,490 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:30:46,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:46,611 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:30:46,613 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:30:46,669 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:30:48,051 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:30:48,290 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:30:52,889 - ispa_next.functions - DEBUG - Updated appointment (AJ00018619) customer contact data.
2025-11-17 14:30:53,844 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:30:53,856 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:30:55,065 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:30:55,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:30:56,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:30:59,717 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:30:59,718 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:30:59,721 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:30:59,722 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:30:59,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:00,226 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:31:04,434 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:31:04,438 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:31:04,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:04,527 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:31:10,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:10,929 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:10,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:11,869 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:31:11,869 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:31:13,174 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:31:13,175 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:31:14,467 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:31:14,471 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:31:14,474 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:31:14,476 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:31:14,478 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:31:14,481 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:31:14,482 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:31:14,484 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:31:14,485 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:31:14,485 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:31:14,488 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:31:14,490 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:31:14,492 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:31:14,494 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:31:14,495 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:15,735 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:31:15,735 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:31:15,737 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:16,969 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:31:16,969 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 14:31:16,973 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:18,235 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:31:18,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:31:19,320 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:31:19,602 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:29,838 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:31:29,840 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:31,058 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:31:45,805 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:31:46,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:31:47,034 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:31:47,232 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:01,541 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:32:01,543 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:32:01,543 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:32:02,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:32:02,523 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:32:02,525 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:32:05,013 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:32:17,235 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:32:17,612 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 14:32:18,481 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:32:23,026 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 950
2025-11-17 14:32:23,027 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:32:27,731 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 433
2025-11-17 14:32:27,731 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:32:28,926 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:32:28,928 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:32:28,932 - ispa_next.main - DEBUG - 



2025-11-17 14:32:28,932 - ispa_next.main - DEBUG - starting with process 7 (EBE-XC 42) of 7
2025-11-17 14:32:28,937 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:32:30,553 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:32:32,293 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 950
2025-11-17 14:32:32,295 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 433
2025-11-17 14:32:34,415 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:32:34,416 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:33:02,826 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:33:13,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:33:15,034 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:33:15,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:33:15,128 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:33:15,449 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:33:15,451 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:33:15,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:33:15,536 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:33:33,772 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:33:33,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:33:34,121 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 14:33:35,037 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 14:33:35,056 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:33:35,057 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:33:36,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:33:36,909 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:33:36,911 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:33:36,943 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:33:39,704 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 14:33:39,706 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:33:43,026 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 950
2025-11-17 14:33:43,028 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:33:47,417 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 433
2025-11-17 14:33:47,418 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:33:48,404 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:33:48,407 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
