2025-11-13 05:00:35,330 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-13 05:00:35,336 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-13 05:00:44,751 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-13 05:00:57,057 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-13 05:01:12,628 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-13 05:01:37,342 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-13 05:01:49,184 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-13 05:01:51,541 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:01:52,652 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:01:52,654 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:01:55,023 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 178
2025-11-13 05:01:55,025 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-13 05:01:55,025 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-13 05:01:56,191 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-13 05:01:57,296 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:02:23,731 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:02:23,743 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-13 05:02:23,803 - ispa_next.appointments.models - DEBUG - Appointment Ulrich Franz WW-SC 91 WBA5V71020FH87156 ohne Termin.
2025-11-13 05:02:23,838 - ispa_next.appointments.models - DEBUG - Appointment Firma AKC Angersbach & Kaiser  WBA65GP080N366928 ohne Termin.
2025-11-13 05:02:23,855 - ispa_next.appointments.models - DEBUG - Appointment   WBA11GV080CW64111 ohne Termin.
2025-11-13 05:02:23,866 - ispa_next.appointments.models - DEBUG - Appointment Marcel Werner Hohmann FD-MH 1306 WBAJN71050BS67908 ohne Termin.
2025-11-13 05:02:23,875 - ispa_next.appointments.models - DEBUG - Appointment   WBA32EE0805469799 ohne Termin.
2025-11-13 05:02:23,887 - ispa_next.appointments.models - DEBUG - Appointment Dino Keshishi HU-MD 1991 WBA8T31040GB33829 ohne Termin.
2025-11-13 05:02:23,896 - ispa_next.appointments.models - DEBUG - Appointment Edat Bayram GN-XM 1996 WBA7C41070BR92361 ohne Termin.
2025-11-13 05:02:23,906 - ispa_next.appointments.models - DEBUG - Appointment Firma MARL Seafood GmbH OF-AL 4545 WBA41EU0609Z08046 ohne Termin.
2025-11-13 05:02:23,953 - ispa_next.main - DEBUG - Found 15 out of 156 appointments to process (configured limit: 15).
2025-11-13 05:02:23,953 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-13 05:02:23,953 - ispa_next.main - DEBUG - All appointments: GN-BB 156, GN-MB 1994, MKK-Z 1001, MKK-PJ 77, MKK-NC 91 E, HU-EX 335, HN-LF 507, HU-MS 535, MKK-MG 366, BÜD-JX 2, F-BF 400, MKK-AM 806, OF Z 6061, BÜD XP 42, FCG1203
2025-11-13 05:02:23,956 - ispa_next.main - DEBUG - 



2025-11-13 05:02:23,956 - ispa_next.main - DEBUG - starting with process 1 (GN-BB 156) of 15
2025-11-13 05:02:23,962 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:02:25,109 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:02:26,184 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:02:26,185 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 178
2025-11-13 05:02:27,640 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:02:27,642 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:03:10,066 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-13 05:03:10,184 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-13 05:03:10,188 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:03:10,696 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:03:10,696 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:03:13,064 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:03:13,065 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:03:13,895 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:03:13,906 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:03:13,913 - ispa_next.main - DEBUG - 



2025-11-13 05:03:13,913 - ispa_next.main - DEBUG - starting with process 2 (GN-MB 1994) of 15
2025-11-13 05:03:13,917 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:03:15,023 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:03:16,146 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:03:16,147 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:03:17,535 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:03:17,537 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:03:41,508 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:03:44,674 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:03:46,605 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:03:46,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:03:46,694 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:03:46,903 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:03:46,907 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:03:46,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:03:47,037 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:03:53,438 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:03:53,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:03:54,120 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:03:56,123 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:03:56,235 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:03:56,322 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:03:56,401 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:03:56,403 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:03:58,289 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:04:09,384 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-13 05:04:10,389 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:04:10,394 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:04:10,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:04:10,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:04:10,926 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:04:10,971 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:04:11,073 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-13 05:04:12,155 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:04:12,455 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:04:13,967 - ispa_next.functions - DEBUG - Updated appointment (AF00016206) customer contact data.
2025-11-13 05:04:14,902 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:04:14,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:04:14,987 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:04:15,105 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-13 05:04:15,107 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:04:15,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:04:15,895 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:04:16,761 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:04:16,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:04:16,846 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-13 05:04:20,413 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:04:20,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:04:20,955 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:04:22,958 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:04:23,129 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:04:23,270 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:04:23,341 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:04:23,343 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:04:25,268 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:04:36,430 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-13 05:05:36,431 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:05:47,708 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-13 05:05:54,798 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-13 05:05:54,800 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:06:01,585 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-13 05:06:04,031 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Zündkerzen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-13 05:06:06,695 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-13 05:06:09,126 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Luftfiltereinsatz' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-13 05:06:11,594 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Standardumfang' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-13 05:06:13,835 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motoröl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-13 05:06:15,512 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-13 05:06:19,875 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-13 05:06:20,881 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:06:20,882 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:06:20,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:06:20,990 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:06:25,091 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-13 05:06:28,249 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:06:28,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:06:28,317 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:06:28,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:06:29,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:06:29,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:06:29,867 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:06:29,867 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:06:31,723 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:06:31,725 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:06:34,733 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:06:34,734 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:06:34,735 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:06:34,737 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:06:34,738 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-13 05:06:34,739 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-13 05:06:34,740 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:06:34,741 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:06:34,742 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:06:34,743 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:06:34,746 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:06:34,749 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:06:34,750 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:06:36,735 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:06:36,737 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:06:36,739 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:06:38,617 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:06:38,620 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:06:38,623 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:06:38,625 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:06:40,521 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:06:40,523 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:06:41,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:06:41,926 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:06:42,065 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:07:00,053 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:07:04,322 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:07:04,325 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:07:04,326 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:07:04,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:07:05,079 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:07:05,081 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:07:07,081 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-13 05:07:15,707 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:07:16,086 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-13 05:07:16,275 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:07:17,093 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:07:17,094 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:07:19,710 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:07:19,711 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:07:20,606 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:07:20,618 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:07:20,626 - ispa_next.main - DEBUG - 



2025-11-13 05:07:20,626 - ispa_next.main - DEBUG - starting with process 3 (MKK-Z 1001) of 15
2025-11-13 05:07:20,630 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:07:21,842 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:07:23,089 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:07:23,090 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:07:24,573 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:07:24,578 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:07:46,744 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:07:49,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:07:52,498 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:07:52,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:07:52,555 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:07:52,749 - ispa_next.functions - DEBUG - HU date soon to be invalid in 6 days.
2025-11-13 05:07:55,651 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:07:55,654 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:07:55,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:07:55,717 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:07:58,666 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:07:58,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:07:59,514 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:08:01,518 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:08:01,657 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:08:01,768 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:08:01,872 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:08:01,873 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:08:04,471 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:08:15,790 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-13 05:08:16,796 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:08:16,800 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:08:16,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:08:17,298 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:08:17,298 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:08:17,374 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:08:18,525 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:08:18,759 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:08:20,510 - ispa_next.functions - DEBUG - Updated appointment (AD00021157) customer contact data.
2025-11-13 05:08:21,401 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:08:21,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:08:21,466 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:08:21,621 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-13 05:08:21,624 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:08:22,660 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:08:22,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:08:23,383 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:08:27,438 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:08:27,440 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:08:27,966 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:08:29,991 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:08:30,089 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:08:30,211 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:08:30,303 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:08:30,304 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:08:32,956 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:08:44,477 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-13 05:09:44,480 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:09:55,393 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-13 05:10:02,427 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-13 05:10:02,429 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:10:07,830 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-13 05:10:10,216 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-13 05:10:12,086 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-13 05:10:16,716 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-13 05:10:17,724 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:10:17,724 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:10:17,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:10:17,841 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:10:21,932 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-13 05:10:25,445 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:10:25,446 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:10:25,513 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:10:25,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:10:26,424 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:10:26,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:10:27,081 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:10:27,082 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:10:29,522 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:10:29,523 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:10:31,622 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:10:31,623 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:10:31,626 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:10:31,628 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:10:31,632 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-13 05:10:31,633 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-13 05:10:31,635 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:10:31,637 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:10:31,641 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:10:31,644 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:10:31,648 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:10:31,650 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:10:31,651 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:10:34,224 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:10:34,227 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:10:34,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:10:37,006 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:10:37,009 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:10:37,012 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:10:37,015 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:10:39,537 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:10:39,541 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:10:40,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:10:40,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:10:41,046 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:11:06,184 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:11:10,452 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:11:14,255 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:11:14,258 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:11:14,259 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:11:14,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:11:14,756 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:11:14,758 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:11:16,200 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-13 05:11:22,858 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:11:23,254 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-13 05:11:23,858 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:11:24,476 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:11:24,478 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:11:27,221 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:11:27,221 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:11:28,013 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:11:28,024 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:11:28,032 - ispa_next.main - DEBUG - 



2025-11-13 05:11:28,032 - ispa_next.main - DEBUG - starting with process 4 (MKK-PJ 77) of 15
2025-11-13 05:11:28,037 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:11:29,182 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:11:30,365 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:11:30,366 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:11:31,767 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:11:31,769 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:12:02,377 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:12:05,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:12:05,485 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:12:05,692 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:12:07,548 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:12:07,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:12:07,619 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:12:07,771 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:12:07,774 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:12:07,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:12:07,839 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:12:14,469 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:12:14,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:12:15,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:12:17,680 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:12:23,699 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-13 05:12:27,020 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-13 05:12:28,024 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:12:28,029 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:12:28,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:12:28,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:12:28,516 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:12:28,544 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:12:28,640 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-13 05:12:29,729 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:12:29,950 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:12:31,634 - ispa_next.functions - DEBUG - Updated appointment (AD00021152) customer contact data.
2025-11-13 05:12:32,525 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:12:32,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:12:32,622 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:12:34,335 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:12:34,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:12:35,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:12:36,035 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:12:36,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:12:36,113 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-13 05:12:40,114 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-13 05:12:40,115 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:12:40,115 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-13 05:12:40,119 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:12:40,120 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:12:40,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:12:40,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:12:44,746 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-13 05:12:44,750 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:12:44,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:12:44,810 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:12:45,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:12:45,665 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:12:45,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:12:46,280 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:12:46,281 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:12:48,123 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:12:48,125 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:12:49,206 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:12:49,208 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:12:49,209 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:12:49,210 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:12:49,211 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-13 05:12:49,212 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-13 05:12:49,213 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:12:49,214 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:12:49,215 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:12:49,216 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:12:49,220 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:12:49,223 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:12:49,224 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:12:51,088 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:12:51,091 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:12:51,094 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:12:53,009 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:12:53,012 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:12:53,015 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:12:53,016 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:12:54,848 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:12:54,851 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:12:55,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:12:56,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:12:56,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:13:13,700 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:13:17,911 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:13:17,914 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:13:17,915 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:13:18,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:13:18,638 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:13:18,641 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:13:20,555 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-13 05:13:27,765 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:13:28,145 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-13 05:13:28,653 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:13:29,374 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:13:29,375 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:13:31,731 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:13:31,731 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:13:32,425 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:13:32,435 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:13:32,442 - ispa_next.main - DEBUG - 



2025-11-13 05:13:32,442 - ispa_next.main - DEBUG - starting with process 5 (MKK-NC 91 E) of 15
2025-11-13 05:13:32,447 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:13:33,304 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:13:34,126 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:13:34,127 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:13:35,328 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:13:35,329 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:14:05,646 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:14:08,741 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:14:10,601 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:14:10,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:14:10,681 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:14:10,880 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:14:10,885 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:14:10,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:14:10,949 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:14:17,703 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:14:17,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:14:18,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:14:20,768 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:14:20,879 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:14:21,013 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:14:21,076 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:14:21,077 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:14:23,014 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:14:34,047 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-13 05:14:35,052 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:14:35,057 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:14:35,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:14:35,545 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:14:35,546 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:14:35,650 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:14:36,834 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:14:37,049 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:14:38,707 - ispa_next.functions - DEBUG - Updated appointment (AD00021143) customer contact data.
2025-11-13 05:14:39,618 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:14:39,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:14:39,682 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:14:39,848 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-13 05:14:39,851 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:14:40,652 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:14:40,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:14:41,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:14:45,409 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:14:45,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:14:45,950 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:14:47,981 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:14:48,090 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:14:48,184 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:14:48,266 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:14:48,268 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:14:50,191 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:15:01,657 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-13 05:16:01,659 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:16:12,404 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-13 05:16:19,597 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-13 05:16:19,598 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:16:22,295 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-13 05:16:26,461 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-13 05:16:27,469 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:16:27,470 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:16:27,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:16:27,542 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:16:31,680 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-13 05:16:31,685 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:16:31,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:16:31,784 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:16:35,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:16:35,825 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:16:35,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:16:36,625 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:16:36,625 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:16:39,314 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:16:39,319 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:16:40,352 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:16:40,354 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:16:40,356 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:16:40,362 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:16:40,366 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-13 05:16:40,369 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:16:40,370 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:16:40,374 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:16:40,391 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:16:40,394 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-13 05:16:42,375 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-13 05:16:42,914 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-13 05:16:43,851 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-13 05:16:44,418 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-13 05:16:44,950 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-13 05:16:45,865 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-13 05:16:46,421 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-13 05:16:46,951 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-13 05:16:48,320 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-13 05:16:49,557 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-13 05:16:50,482 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-13 05:16:50,927 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:16:50,936 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:16:50,937 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:16:52,859 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:16:52,862 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:16:52,864 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:16:54,731 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:16:54,734 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:16:54,736 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:16:54,737 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:16:56,622 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:16:56,625 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:16:57,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:16:57,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:16:58,098 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:17:17,710 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:17:22,241 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:17:22,244 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:17:22,245 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:17:22,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:17:22,994 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:17:22,996 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:17:25,002 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-13 05:17:32,154 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:17:32,550 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-13 05:17:32,897 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:17:33,828 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:17:33,829 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:17:36,856 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:17:36,857 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:17:37,692 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:17:37,704 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:17:37,713 - ispa_next.main - DEBUG - 



2025-11-13 05:17:37,713 - ispa_next.main - DEBUG - starting with process 6 (HU-EX 335) of 15
2025-11-13 05:17:37,730 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:17:38,892 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:17:40,277 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:17:40,278 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:17:41,676 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:17:41,678 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:18:13,582 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:18:16,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:18:16,775 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:18:16,984 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:18:18,889 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:18:18,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:18:18,989 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:18:19,283 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:18:19,286 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:18:19,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:18:19,389 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:18:26,261 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:18:26,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:18:27,236 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:18:29,242 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:18:35,207 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-13 05:18:39,143 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-13 05:18:40,149 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:18:40,167 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:18:40,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:18:40,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:18:40,776 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:18:40,863 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:18:40,968 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-13 05:18:42,093 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:18:42,314 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:18:43,981 - ispa_next.functions - DEBUG - Updated appointment (AD00021139) customer contact data.
2025-11-13 05:18:44,895 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:18:44,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:18:44,999 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:18:45,157 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-13 05:18:45,160 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:18:45,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:18:45,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:18:47,041 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:18:47,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:18:47,116 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-13 05:18:51,130 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-13 05:18:51,130 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:18:51,130 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-13 05:18:51,133 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:18:51,134 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:18:51,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:18:51,858 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:18:55,992 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-13 05:18:55,997 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:18:55,997 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-13 05:18:55,998 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:18:57,851 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:18:57,854 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:18:58,891 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:18:58,892 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:18:58,893 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:18:58,894 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:18:58,895 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-13 05:18:58,896 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-13 05:18:58,897 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:18:58,898 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:18:58,899 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:18:58,901 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:18:58,904 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:18:58,906 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:18:58,908 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:19:00,871 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:19:00,885 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:19:00,888 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:19:02,775 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:19:02,777 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:19:02,794 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:19:02,798 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:19:04,670 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:19:04,672 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:19:05,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:19:06,052 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:19:06,246 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:19:24,182 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:19:28,671 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:19:28,674 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:19:28,675 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:19:29,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:19:29,348 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:19:29,354 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:19:31,209 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-13 05:19:38,242 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:19:38,611 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-13 05:19:39,138 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:19:39,836 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:19:39,837 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:19:42,127 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:19:42,127 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:19:42,831 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:19:42,841 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:19:42,848 - ispa_next.main - DEBUG - 



2025-11-13 05:19:42,849 - ispa_next.main - DEBUG - starting with process 7 (HN-LF 507) of 15
2025-11-13 05:19:42,853 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:19:43,770 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:19:44,621 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:19:44,622 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:19:45,837 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:19:45,838 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:20:06,089 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:20:09,063 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:20:10,959 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:20:10,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:20:11,028 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:20:11,219 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:20:11,222 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:20:11,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:20:11,308 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:20:14,458 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:20:14,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:20:15,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:20:17,403 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:20:17,512 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:20:17,645 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:20:17,714 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:20:17,716 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:20:19,624 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:20:31,155 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-13 05:20:32,168 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:20:32,173 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:20:32,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:20:32,747 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:20:32,748 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:20:32,801 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:20:33,987 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:20:34,210 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:20:35,865 - ispa_next.functions - DEBUG - Updated appointment (AO00009706) customer contact data.
2025-11-13 05:20:36,769 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:20:36,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:20:36,841 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:20:37,065 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-13 05:20:37,068 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:20:37,906 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:20:37,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:20:38,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:20:42,634 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:20:42,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:20:43,143 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:20:45,146 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:20:45,314 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:20:45,455 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:20:45,549 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:20:45,550 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:20:47,469 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:20:58,244 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-13 05:21:05,521 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-13 05:21:05,522 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:21:07,445 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-13 05:21:11,615 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-13 05:21:12,629 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:21:12,629 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:21:12,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:21:12,691 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:21:16,834 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-13 05:21:16,838 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:21:16,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:21:16,903 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:21:22,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:21:23,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:21:23,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:21:23,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:21:23,740 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:21:25,620 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:21:25,626 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:21:26,578 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:21:26,580 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:21:26,581 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:21:26,583 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:21:26,586 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-13 05:21:26,587 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-13 05:21:26,589 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:21:26,608 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:21:26,610 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:21:26,612 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:21:26,616 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:21:26,618 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:21:26,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:21:28,480 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:21:28,482 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:21:28,484 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:21:30,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:21:30,451 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:21:41,432 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:21:52,794 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:21:52,796 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:21:52,798 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:21:52,800 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:21:54,689 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:21:54,692 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:21:55,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:21:56,114 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:21:56,310 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:22:14,853 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:22:19,492 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:22:19,496 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:22:19,496 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:22:20,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:22:20,238 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:22:20,241 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:22:22,205 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-13 05:22:30,312 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:22:30,703 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-13 05:22:31,641 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:22:32,297 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:22:32,298 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:22:35,326 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:22:35,328 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:22:36,255 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:22:36,267 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:22:36,274 - ispa_next.main - DEBUG - 



2025-11-13 05:22:36,274 - ispa_next.main - DEBUG - starting with process 8 (HU-MS 535) of 15
2025-11-13 05:22:36,279 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:22:37,400 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:22:38,479 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:22:38,481 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:22:39,888 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:22:39,889 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:23:09,736 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:23:12,982 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:23:14,217 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:23:14,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:23:14,300 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:23:14,475 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:23:14,479 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:23:14,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:23:14,568 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:23:21,680 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:23:21,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:23:22,869 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:23:24,874 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:23:24,970 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:23:25,082 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:23:25,141 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:23:25,142 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:23:26,421 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:23:37,965 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-13 05:23:38,981 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:23:38,985 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:23:38,989 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:23:39,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:23:39,510 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:23:39,570 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:23:40,799 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:23:41,009 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:23:42,808 - ispa_next.functions - DEBUG - Updated appointment (AD00021135) customer contact data.
2025-11-13 05:23:43,728 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:23:43,729 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:23:43,820 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:23:43,950 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-13 05:23:43,953 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:23:44,719 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:23:44,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:23:45,519 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:23:49,515 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-13 05:23:49,515 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:23:49,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:23:50,039 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:23:52,043 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:23:52,163 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:23:52,260 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:23:52,337 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:23:52,339 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:23:53,600 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:24:04,976 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-13 05:25:04,980 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:25:16,068 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-13 05:25:23,292 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-13 05:25:23,294 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:25:24,531 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-13 05:25:28,707 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-13 05:25:29,732 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:25:29,732 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:25:29,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:25:29,804 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:25:33,895 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-13 05:25:33,899 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:25:33,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:25:33,990 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:25:38,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:25:38,599 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:25:38,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:25:39,322 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:25:39,323 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:25:40,651 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:25:40,653 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:25:41,714 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:25:41,719 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:25:41,721 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:25:41,723 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:25:41,726 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-13 05:25:41,727 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-13 05:25:41,728 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:25:41,729 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:25:41,730 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:25:41,732 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:25:41,735 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:25:41,738 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:25:41,739 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:25:42,984 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:25:42,988 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:25:42,991 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:25:44,202 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:25:44,205 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:25:44,208 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:25:44,210 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:25:45,406 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:25:45,408 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:25:46,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:25:47,019 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:25:47,205 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:26:00,588 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:26:00,591 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:26:00,591 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:26:01,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:26:01,268 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:26:01,271 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:26:03,105 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-13 05:26:10,827 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:26:11,202 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-13 05:26:11,874 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:26:12,573 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:26:12,574 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:26:15,599 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:26:15,600 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:26:16,398 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:26:16,409 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:26:16,421 - ispa_next.main - DEBUG - 



2025-11-13 05:26:16,422 - ispa_next.main - DEBUG - starting with process 9 (MKK-MG 366) of 15
2025-11-13 05:26:16,426 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:26:17,608 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:26:18,724 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:26:18,726 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:26:20,068 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:26:20,069 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:26:54,136 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:26:57,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:27:02,664 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:27:02,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:27:02,801 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:27:03,272 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:27:03,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:27:03,383 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:27:11,125 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:27:11,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:27:11,378 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:27:18,773 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:27:18,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:27:19,842 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:27:21,848 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:27:28,012 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-13 05:27:32,091 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-13 05:27:33,096 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:27:33,100 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:27:33,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:27:33,624 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:27:33,625 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:27:33,661 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:27:33,801 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-13 05:27:35,250 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:27:35,447 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:27:37,117 - ispa_next.functions - DEBUG - Updated appointment (AD00021124) customer contact data.
2025-11-13 05:27:38,016 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:27:38,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:27:38,082 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:27:40,247 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:27:40,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:27:41,160 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:27:42,145 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:27:42,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:27:42,223 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-13 05:27:46,293 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-13 05:27:46,294 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:27:46,294 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-13 05:27:46,297 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:27:46,298 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:27:46,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:27:46,813 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:27:50,926 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-13 05:27:54,652 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:27:54,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:27:54,716 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:27:55,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:27:55,625 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:27:55,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:27:56,291 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:27:56,291 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:28:00,988 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:28:00,992 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:28:02,078 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:28:02,079 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:28:02,080 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:28:02,081 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:28:02,082 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-13 05:28:02,083 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-13 05:28:02,084 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:28:02,085 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:28:02,086 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:28:02,094 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:28:02,100 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:28:02,103 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:28:02,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:28:07,436 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:28:07,439 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:28:07,443 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:28:12,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:28:12,881 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:28:24,899 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:28:24,901 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:28:24,903 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:28:24,915 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:28:30,256 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:28:30,258 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:28:30,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:28:31,602 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:28:31,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:29:09,079 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:29:09,079 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:29:09,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:29:09,842 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:29:09,845 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:29:13,492 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-13 05:29:21,707 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:29:22,081 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-13 05:29:22,980 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:29:23,665 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:29:23,667 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:29:26,444 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:29:26,445 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:29:27,220 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:29:27,230 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:29:27,237 - ispa_next.main - DEBUG - 



2025-11-13 05:29:27,237 - ispa_next.main - DEBUG - starting with process 10 (BÜD-JX 2) of 15
2025-11-13 05:29:27,242 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:29:28,409 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:29:29,562 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:29:29,564 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:29:31,052 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:29:31,053 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:30:04,544 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:30:07,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:30:09,060 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:30:09,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:30:09,130 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:30:09,328 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:30:09,331 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:30:09,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:30:09,412 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:30:12,799 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:30:12,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:30:13,911 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:30:15,917 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:30:16,037 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:30:16,141 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:30:16,212 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:30:16,213 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:30:17,449 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:30:28,933 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-13 05:30:29,938 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:30:29,942 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:30:29,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:30:30,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:30:30,485 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:30:30,546 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:30:31,796 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-13 05:30:33,082 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:30:33,312 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:30:35,093 - ispa_next.functions - DEBUG - Updated appointment (AD00021122) customer contact data.
2025-11-13 05:30:36,019 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:30:36,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:30:36,080 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:30:36,273 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-13 05:30:36,275 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:30:37,021 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:30:37,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:30:37,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:30:41,430 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:30:41,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:30:41,911 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:30:43,921 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:30:44,038 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:30:44,126 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:30:44,232 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:30:44,233 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:30:45,416 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:30:56,866 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-13 05:31:56,868 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:32:08,069 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-13 05:32:15,259 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-13 05:32:15,260 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:32:16,510 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-13 05:32:20,703 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-13 05:32:21,709 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:32:21,710 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:32:21,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:32:21,815 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:32:25,922 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-13 05:32:25,926 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:32:25,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:32:26,018 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:32:34,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:32:35,321 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:32:35,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:32:36,041 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:32:36,041 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:32:37,328 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:32:37,329 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:32:38,220 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:32:38,222 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:32:38,223 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:32:38,224 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:32:38,225 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-13 05:32:38,226 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-13 05:32:38,227 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:32:38,229 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:32:38,230 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:32:38,231 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:32:38,235 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:32:38,237 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:32:38,238 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:32:39,443 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:32:39,445 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:32:39,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:32:40,660 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:32:40,663 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:32:40,665 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:32:40,667 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:32:41,882 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:32:41,885 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:32:42,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:32:43,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:32:43,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:32:57,059 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:32:57,062 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:32:57,062 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:32:57,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:32:57,836 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:32:57,838 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:32:59,791 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-13 05:33:07,645 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:33:08,010 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-13 05:33:08,360 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:33:09,434 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:33:09,435 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:33:12,407 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:33:12,408 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:33:13,323 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:33:13,334 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:33:13,343 - ispa_next.main - DEBUG - 



2025-11-13 05:33:13,343 - ispa_next.main - DEBUG - starting with process 11 (F-BF 400) of 15
2025-11-13 05:33:13,347 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:33:14,623 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:33:15,857 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:33:15,859 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:33:17,488 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:33:17,489 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:33:41,978 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:33:45,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:33:47,097 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:33:47,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:33:47,195 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:33:47,346 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:33:47,351 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:33:47,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:33:47,443 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:33:50,672 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:33:50,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:33:51,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:33:53,700 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:33:53,823 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:33:53,917 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:33:53,990 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:33:53,991 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:33:55,891 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:34:07,212 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-13 05:34:08,218 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:34:08,223 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:34:08,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:34:08,721 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:34:08,722 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:34:08,768 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:34:09,981 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-13 05:34:11,112 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-13 05:34:11,320 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:34:13,529 - ispa_next.functions - DEBUG - Updated appointment (AD00021115) customer contact data.
2025-11-13 05:34:14,426 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:34:14,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:34:14,504 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:34:14,653 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-13 05:34:14,656 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:34:15,520 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:34:15,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:34:16,441 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:34:20,486 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-13 05:34:20,486 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:34:20,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:34:20,990 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:34:23,003 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:34:23,103 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-13 05:34:23,203 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-13 05:34:23,304 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-13 05:34:23,305 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:34:25,238 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:34:37,015 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-13 05:35:37,016 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-13 05:35:47,892 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-13 05:35:54,996 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-13 05:35:54,998 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:35:56,957 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-13 05:36:01,108 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-13 05:36:02,131 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:36:02,132 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:36:02,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:36:02,253 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:36:06,422 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-13 05:36:10,097 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:36:10,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:36:10,211 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:36:10,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:36:11,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:36:11,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:36:11,823 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:36:11,823 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:36:13,958 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:36:13,968 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:36:14,997 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:36:14,998 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:36:15,001 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:36:15,003 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:36:15,004 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-13 05:36:15,004 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-13 05:36:15,005 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:36:15,006 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:36:15,007 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:36:15,008 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:36:15,012 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:36:15,014 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:36:15,015 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:36:16,929 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-13 05:36:19,481 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:36:19,484 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:36:19,487 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:36:21,588 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:36:21,591 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:36:21,593 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:36:21,596 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:36:23,487 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:36:23,490 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:36:24,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:36:24,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:36:24,974 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:36:43,248 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:36:50,287 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:36:50,290 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:36:50,291 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:36:50,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:36:50,955 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:36:50,962 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:36:52,676 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-13 05:37:00,983 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:37:01,354 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-13 05:37:02,065 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:37:02,831 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:37:02,833 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:37:05,827 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:37:05,828 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:37:06,707 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:37:06,718 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:37:06,726 - ispa_next.main - DEBUG - 



2025-11-13 05:37:06,726 - ispa_next.main - DEBUG - starting with process 12 (MKK-AM 806) of 15
2025-11-13 05:37:06,730 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:37:07,874 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:37:09,052 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:37:09,053 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:37:10,492 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:37:10,493 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:37:34,494 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-13 05:37:37,701 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:37:40,348 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-13 05:37:40,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:37:40,439 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:37:40,776 - ispa_next.functions - DEBUG - HU date already expired after 3734 days.
2025-11-13 05:37:44,658 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-13 05:37:44,662 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-13 05:37:44,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:37:44,730 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:37:51,845 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:37:51,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:37:52,889 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:37:54,892 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-13 05:38:01,004 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-13 05:38:04,807 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-13 05:38:05,813 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-13 05:38:05,818 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-13 05:38:05,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:38:06,315 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:38:06,316 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-13 05:38:06,380 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-13 05:38:06,474 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-13 05:38:07,952 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-13 05:38:09,147 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-13 05:38:09,445 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-13 05:38:11,382 - ispa_next.functions - DEBUG - Updated appointment (AF00016204) customer contact data.
2025-11-13 05:38:12,292 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-13 05:38:12,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:38:12,382 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-13 05:38:12,502 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-13 05:38:12,504 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-13 05:38:12,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:38:13,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-13 05:38:14,695 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-13 05:38:14,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-13 05:38:14,817 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-13 05:38:18,841 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-13 05:38:18,842 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-13 05:38:18,842 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-13 05:38:18,845 - ispa_next.functions - DEBUG - generate_attachments
2025-11-13 05:38:18,846 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-13 05:38:18,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:38:19,362 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:38:23,452 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-13 05:38:23,456 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-13 05:38:23,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:38:23,547 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-13 05:38:23,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-13 05:38:24,405 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-13 05:38:24,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-13 05:38:25,019 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-13 05:38:25,020 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-13 05:38:27,454 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-13 05:38:27,455 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-13 05:38:28,489 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-13 05:38:28,494 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:38:28,496 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-13 05:38:28,498 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-13 05:38:28,501 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-13 05:38:28,502 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-13 05:38:28,503 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-13 05:38:28,504 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-13 05:38:28,505 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-13 05:38:28,506 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-13 05:38:28,511 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-13 05:38:28,514 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-13 05:38:28,515 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:38:31,141 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-13 05:38:31,143 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-13 05:38:31,145 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:38:33,738 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-13 05:38:33,741 - ispa_next.functions - DEBUG - process_check_control
2025-11-13 05:38:33,743 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-13 05:38:33,749 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:38:36,271 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-13 05:38:36,274 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-13 05:38:36,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:38:37,781 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-13 05:38:37,984 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-13 05:39:02,955 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:39:06,695 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:39:11,111 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-13 05:39:11,113 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-13 05:39:11,114 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:39:11,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-13 05:39:11,840 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-13 05:39:11,843 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-13 05:39:13,586 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-13 05:39:21,832 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-13 05:39:22,239 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-13 05:39:22,929 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:39:23,700 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:39:23,702 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:39:26,671 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:39:26,672 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:39:27,564 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:39:27,583 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:39:27,595 - ispa_next.main - DEBUG - 



2025-11-13 05:39:27,595 - ispa_next.main - DEBUG - starting with process 13 (OF Z 6061) of 15
2025-11-13 05:39:27,610 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:39:28,787 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:39:30,050 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:39:30,051 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:39:31,631 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:39:31,632 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:40:04,530 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-13 05:40:04,567 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-13 05:40:04,570 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:40:05,074 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:40:05,075 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:40:08,125 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:40:08,126 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:40:08,901 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:40:08,912 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:40:08,920 - ispa_next.main - DEBUG - 



2025-11-13 05:40:08,920 - ispa_next.main - DEBUG - starting with process 14 (BÜD XP 42) of 15
2025-11-13 05:40:08,924 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:40:10,062 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:40:11,298 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:40:11,299 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:40:12,859 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:40:12,860 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:40:47,490 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-13 05:40:47,500 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-13 05:40:47,505 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:40:47,952 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:40:47,954 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:40:50,612 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:40:50,613 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:40:51,510 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:40:51,521 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
2025-11-13 05:40:51,529 - ispa_next.main - DEBUG - 



2025-11-13 05:40:51,529 - ispa_next.main - DEBUG - starting with process 15 (FCG1203) of 15
2025-11-13 05:40:51,533 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-13 05:40:52,778 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:40:53,917 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:40:53,919 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-13 05:40:55,447 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-13 05:40:55,449 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:41:27,874 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-13 05:41:27,885 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-13 05:41:27,890 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-13 05:41:28,449 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 726
2025-11-13 05:41:28,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-13 05:41:31,190 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 221
2025-11-13 05:41:31,191 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-13 05:41:32,015 - ispa_next.appointments.models - DEBUG - Appointment Kenan Kapar HU-L 1042 WBAUG31060JU18695 ohne Termin.
2025-11-13 05:41:32,026 - ispa_next.appointments.models - DEBUG - Appointment Danyal Jalili HU-JD 7777 WBA1A11090E924832 ohne Termin.
