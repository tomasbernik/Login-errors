2025-11-12 13:14:37,135 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 13:14:37,148 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 13:15:05,055 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:15:16,173 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:15:31,819 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:15:57,032 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 13:16:10,349 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 13:16:14,521 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:16:15,472 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:16:15,473 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 13:16:17,520 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 347
2025-11-12 13:16:17,521 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 13:16:17,521 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:16:18,326 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:16:19,312 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:17:12,652 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:17:12,665 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:17:12,674 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:17:12,684 - ispa_next.appointments.models - DEBUG - Appointment Bogdan-Laurentiu Turcu ED-BT 315 WBA5U91000FK31617 ohne Termin.
2025-11-12 13:17:12,695 - ispa_next.appointments.models - DEBUG - Appointment Ute Mätzig M-U 7573 WBA81GE0007T32557 ohne Termin.
2025-11-12 13:17:12,703 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Miotorenwerke Akti M-NK 3548 WBA15GR030N352507 ohne Termin.
2025-11-12 13:17:12,713 - ispa_next.appointments.models - DEBUG - Appointment Rainer Kollenda ED-XX 24 WBAMT11020C298608 ohne Termin.
2025-11-12 13:17:12,723 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-12 13:17:12,732 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-12 13:17:12,746 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Fiedler ED-F 1818 WBA25DP090N149286 ohne Termin.
2025-11-12 13:17:12,795 - ispa_next.appointments.models - DEBUG - Appointment Fitim Kucani ED-FF 2723 WBAUE11050PZ54416 ohne Termin.
2025-11-12 13:17:12,796 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:17:12,807 - ispa_next.appointments.models - DEBUG - Appointment Sami Polat ED-N 4423 WBA21BY0907N23883 ohne Termin.
2025-11-12 13:17:12,823 - ispa_next.appointments.models - DEBUG - Appointment Daniel Raphael ED-RD 212 WBA6T510607D45067 ohne Termin.
2025-11-12 13:17:12,838 - ispa_next.appointments.models - DEBUG - Appointment Firma Bucher Hydraulics Erding GmbH ED-BH 186 WBA5V7105LFH57377 ohne Termin.
2025-11-12 13:17:12,851 - ispa_next.appointments.models - DEBUG - Appointment Katerina Werner M-W 7091 WBA11EV0809V62969 ohne Termin.
2025-11-12 13:17:12,857 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:17:12,871 - ispa_next.appointments.models - DEBUG - Appointment Benedikt Friedl ED-SE 225 WBA61CA0X09V93186 ohne Termin.
2025-11-12 13:17:12,880 - ispa_next.appointments.models - DEBUG - Appointment Harald Kümmet ED-H 110 WMWSS91020WN99113 ohne Termin.
2025-11-12 13:17:12,886 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:17:12,904 - ispa_next.appointments.models - DEBUG - Appointment Josefine Hintermeier ED-AD 71 WMWZM31080T767604 ohne Termin.
2025-11-12 13:17:12,919 - ispa_next.appointments.models - DEBUG - Appointment Thomas Ralf Olaf Buer ED-B 880 5UXWX7C54EL983484 ohne Termin.
2025-11-12 13:17:12,961 - ispa_next.appointments.models - DEBUG - Appointment Alen Halidowicz ED-HA 910 WBA6E41080G692725 ohne Termin.
2025-11-12 13:17:12,979 - ispa_next.appointments.models - DEBUG - Appointment Martina Bauer ED-Z 1988 WBADS41020GU95176 ohne Termin.
2025-11-12 13:17:12,994 - ispa_next.appointments.models - DEBUG - Appointment Ludwig Schönhuber FS-M 2909 WBAHF31040WX45135 ohne Termin.
2025-11-12 13:17:12,995 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:17:13,008 - ispa_next.appointments.models - DEBUG - Appointment Alois Obermaier ED-AO 67 WBA35BG040N074618 ohne Termin.
2025-11-12 13:17:13,019 - ispa_next.appointments.models - DEBUG - Appointment Karl-Heinz Baris ED-JA 828 WBA8J91020A190670 ohne Termin.
2025-11-12 13:17:13,029 - ispa_next.appointments.models - DEBUG - Appointment Rainer Wieder FS-RW 606 WBAJP310X0CD36205 ohne Termin.
2025-11-12 13:17:13,031 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:17:13,043 - ispa_next.appointments.models - DEBUG - Appointment Firma Büro der Fachärzte ED-BF 811 WBAPY71050C023350 ohne Termin.
2025-11-12 13:17:13,068 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Wildried Rademann ED-JR 900 WBAJP31030BT83692 ohne Termin.
2025-11-12 13:17:13,079 - ispa_next.appointments.models - DEBUG - Appointment Markus Christian Geyer M-CG 3388 WBA3Z910X0D367242 ohne Termin.
2025-11-12 13:17:13,090 - ispa_next.appointments.models - DEBUG - Appointment Levente Gergely ED-GL 71 WBA4X31050AA80192 ohne Termin.
2025-11-12 13:17:13,100 - ispa_next.appointments.models - DEBUG - Appointment Markus Kerndlbacher ED-MK 135 WBAUC71000VE99305 ohne Termin.
2025-11-12 13:17:13,110 - ispa_next.appointments.models - DEBUG - Appointment Firma VR-Bank Erding eG ED-VR 530 WBA5D31040GV81033 ohne Termin.
2025-11-12 13:17:13,127 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Scheid ED-P 1307 WBATX35020NC37837 ohne Termin.
2025-11-12 13:17:13,138 - ispa_next.appointments.models - DEBUG - Appointment Jakob Angermaier ED-AJ 44 WBAHS910105F51976 ohne Termin.
2025-11-12 13:17:13,149 - ispa_next.appointments.models - DEBUG - Appointment Almperto Kyriazis ED-AK 1994 WBA1A11020J903022 ohne Termin.
2025-11-12 13:17:13,172 - ispa_next.appointments.models - DEBUG - Appointment Firma Cleaning Express Gebäudedienst ED-BS 887 WBA41BX0707N24573 ohne Termin.
2025-11-12 13:17:13,196 - ispa_next.appointments.models - DEBUG - Appointment Bianca-Viviana Huber FS-H 162 E WBY8P210507H82040 ohne Termin.
2025-11-12 13:17:13,207 - ispa_next.appointments.models - DEBUG - Appointment Katharina Eichinger ED-LE 236 WMW11BR0903N74463 ohne Termin.
2025-11-12 13:17:13,218 - ispa_next.appointments.models - DEBUG - Appointment Firma BayWa Aktiengesellschaft M-GH 7766 WBA15BZ000N166569 ohne Termin.
2025-11-12 13:17:13,229 - ispa_next.appointments.models - DEBUG - Appointment Firma Privatbr. ERDINGER Weißbräu ED-EW 332 WBA41EG0005X82947 ohne Termin.
2025-11-12 13:17:13,229 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:17:13,239 - ispa_next.appointments.models - DEBUG - Appointment Carmen Berndt ED-CP 1725 WBAYN110X05T94356 ohne Termin.
2025-11-12 13:17:13,249 - ispa_next.appointments.models - DEBUG - Appointment Luigi Fazio  WBAKS410500C30478 ohne Termin.
2025-11-12 13:17:13,259 - ispa_next.appointments.models - DEBUG - Appointment Zhensheng Guo ED-SG 8888 WBA5L31030G122160 ohne Termin.
2025-11-12 13:17:13,269 - ispa_next.appointments.models - DEBUG - Appointment Christine Ertel ED-C 1272 WMW31DH0802W00594 ohne Termin.
2025-11-12 13:17:13,282 - ispa_next.appointments.models - DEBUG - Appointment Daniel Franke LA-EB 308 WBA1V71070V616601 ohne Termin.
2025-11-12 13:17:13,291 - ispa_next.appointments.models - DEBUG - Appointment Paul Valerian Mona MM 23 MON WBA5E51090G100007 ohne Termin.
2025-11-12 13:17:13,301 - ispa_next.appointments.models - DEBUG - Appointment Eduard Gehl FS-EG 174 WBAJN31090B095696 ohne Termin.
2025-11-12 13:17:13,311 - ispa_next.appointments.models - DEBUG - Appointment Firma Lear Corporation GmbH GG-LC 292E WBA81CY000FS44344 ohne Termin.
2025-11-12 13:17:13,349 - ispa_next.main - DEBUG - Found 20 out of 149 appointments to process (configured limit: 20).
2025-11-12 13:17:13,350 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-12 13:17:13,350 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 13:17:13,350 - ispa_next.main - DEBUG - All appointments: ED-FM 115 E, ED-MS 182E, GG-LC 221, FS-MS 633, ED-RG133, ED-DY 9 E, ED-EL 31, ED M 2304, ED RU 101, MNK3076, ED-MH-171, ED-A1024, ED-K2010, ED-AL59, M-ED-2001, EBE-AB 202, ED-CT 178, ED-O 1909, ED-RD 212, ED-WI 283
2025-11-12 13:17:13,353 - ispa_next.main - DEBUG - 



2025-11-12 13:17:13,353 - ispa_next.main - DEBUG - starting with process 1 (ED-FM 115 E) of 20
2025-11-12 13:17:13,361 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:17:14,194 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:17:15,450 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:17:15,451 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 347
2025-11-12 13:17:16,716 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:17:16,717 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:17:50,760 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:17:50,861 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 13:17:50,868 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:17:51,328 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:17:51,329 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:17:53,605 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 13:17:53,606 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:17:54,500 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:17:54,509 - ispa_next.main - DEBUG - 



2025-11-12 13:17:54,509 - ispa_next.main - DEBUG - starting with process 2 (ED-MS 182E) of 20
2025-11-12 13:17:54,514 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:17:55,417 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:17:56,299 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:17:56,300 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 13:17:57,347 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:17:57,348 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:18:18,200 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:18:28,119 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:18:30,726 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:18:30,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:30,807 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:18:31,007 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:18:37,317 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:18:37,321 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:18:40,067 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:18:40,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:18:41,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:18:43,013 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:18:43,135 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:18:46,389 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:18:46,452 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:18:46,453 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:18:54,683 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:18:55,688 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:18:55,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:56,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:58,987 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 13:18:58,994 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:18:58,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:59,058 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:18:59,059 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:18:59,100 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:19:00,254 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:19:01,472 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:19:01,787 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:19:04,676 - ispa_next.functions - DEBUG - Updated appointment (AG00009922) customer contact data.
2025-11-12 13:19:05,630 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:19:05,633 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:19:06,579 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:19:06,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:19:07,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:19:11,342 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:19:11,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:11,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:19:13,846 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:19:13,982 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:19:14,101 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:19:14,228 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:19:14,229 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:19:25,532 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:19:29,727 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:19:29,727 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:19:33,946 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:19:34,955 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:19:34,960 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:19:34,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:35,024 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:19:40,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:41,084 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:41,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:41,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:19:41,879 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:19:44,293 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:19:44,296 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:19:45,159 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:19:45,160 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:19:45,162 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:19:45,163 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:19:45,165 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:19:45,168 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:19:45,169 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:19:45,177 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:19:45,179 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:19:45,181 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:19:45,187 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:19:45,190 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:19:45,190 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:19:47,760 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:19:47,763 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:19:47,777 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:19:50,324 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:19:50,327 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:19:50,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:19:50,979 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:19:51,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:20:02,536 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:20:02,540 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:20:05,106 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:20:15,186 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:20:15,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:20:16,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:20:16,323 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:20:40,915 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:20:44,578 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:20:48,760 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:20:48,763 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:20:48,764 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:20:49,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:20:49,560 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:20:49,562 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:20:51,459 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:21:02,370 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:21:02,751 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 13:21:03,063 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:21:04,721 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:21:04,722 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:21:07,786 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 13:21:07,787 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:21:08,567 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:21:08,576 - ispa_next.main - DEBUG - 



2025-11-12 13:21:08,576 - ispa_next.main - DEBUG - starting with process 3 (GG-LC 221) of 20
2025-11-12 13:21:08,581 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:21:09,795 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:21:10,983 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:21:10,984 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 13:21:12,341 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:21:12,343 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:21:44,429 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:21:53,497 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:21:59,394 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:21:59,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:21:59,476 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:21:59,648 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:21:59,652 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:22:02,546 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:22:02,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:22:03,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:22:05,582 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:22:05,696 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:22:08,906 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:22:08,991 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:22:11,160 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:22:12,166 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:22:12,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:22:12,622 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:22:23,534 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:22:30,805 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:22:30,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:22:30,915 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:22:30,916 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:22:30,979 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:22:31,080 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:22:32,270 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 13:22:33,408 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 13:22:33,829 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:22:36,176 - ispa_next.functions - DEBUG - Updated appointment (AA00022455) customer contact data.
2025-11-12 13:22:37,066 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:22:37,068 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:22:37,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:22:37,745 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:22:39,165 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:22:39,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:22:39,226 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:22:43,217 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:22:43,217 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:22:43,221 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:22:43,225 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:22:43,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:22:43,683 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:22:52,788 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 13:22:57,308 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 13:22:57,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:22:57,873 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:22:57,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:22:58,550 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:22:58,551 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:23:03,807 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:23:03,808 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:23:05,228 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:23:05,232 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:23:05,237 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-12 13:23:05,241 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:23:05,243 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:23:05,244 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:23:05,245 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:23:05,247 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:23:05,248 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:23:05,249 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:23:05,251 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:23:47,117 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:23:47,117 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-12 13:23:53,099 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:23:53,102 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:23:53,103 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:24:00,414 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:24:00,418 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:24:00,423 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:24:07,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:24:07,991 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:24:17,380 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:24:33,801 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:24:33,804 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:24:33,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:24:34,495 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:24:34,571 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:24:34,572 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:24:41,829 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:24:53,595 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:24:54,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:24:54,582 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:24:54,692 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:06,351 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:26:10,207 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:26:15,462 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:26:15,463 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:26:15,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:26:16,081 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:26:16,084 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:26:18,868 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:26:26,269 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:26:26,655 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 13:26:27,219 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:26:28,715 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:26:28,716 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:26:31,181 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:26:31,182 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:26:31,869 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:26:31,877 - ispa_next.main - DEBUG - 



2025-11-12 13:26:31,877 - ispa_next.main - DEBUG - starting with process 4 (FS-MS 633) of 20
2025-11-12 13:26:31,882 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:26:32,858 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:26:33,816 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:26:33,817 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:26:35,079 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:26:35,081 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:05,499 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:27:05,512 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 13:27:05,515 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:06,149 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:27:06,150 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:08,729 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:27:08,730 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:09,512 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:27:09,521 - ispa_next.main - DEBUG - 



2025-11-12 13:27:09,521 - ispa_next.main - DEBUG - starting with process 5 (ED-RG133) of 20
2025-11-12 13:27:09,526 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:27:10,821 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:12,073 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:27:12,074 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:27:13,538 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:13,539 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:44,731 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:27:44,741 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 13:27:44,747 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:45,146 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:27:45,147 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:47,130 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:27:47,131 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:47,821 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:27:47,835 - ispa_next.main - DEBUG - 



2025-11-12 13:27:47,835 - ispa_next.main - DEBUG - starting with process 6 (ED-DY 9 E) of 20
2025-11-12 13:27:47,839 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:27:48,700 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:49,752 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:27:49,755 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:27:50,979 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:50,980 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:28:22,115 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:28:22,124 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 13:28:22,128 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:28:22,445 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:28:22,447 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:28:24,473 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:28:24,473 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:28:25,176 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:28:25,183 - ispa_next.main - DEBUG - 



2025-11-12 13:28:25,183 - ispa_next.main - DEBUG - starting with process 7 (ED-EL 31) of 20
2025-11-12 13:28:25,187 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:28:25,995 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:28:27,004 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:28:27,005 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:28:28,343 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:28:28,345 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:28:50,061 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:28:59,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:01,230 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:29:01,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:01,303 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:29:01,503 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:29:07,219 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:29:07,223 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:29:10,017 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:29:10,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:29:11,052 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:29:13,057 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:29:13,176 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:29:16,403 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:29:16,509 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:29:16,509 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:29:24,957 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:29:25,962 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:29:25,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:26,468 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:29,899 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 13:29:29,904 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:29:29,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:30,005 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:29:30,006 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:29:30,036 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:29:30,110 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:29:31,248 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:29:31,476 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:29:34,298 - ispa_next.functions - DEBUG - Updated appointment (AA00022380) customer contact data.
2025-11-12 13:29:35,188 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:29:35,191 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:29:35,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:29:36,091 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:29:37,781 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:29:37,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:29:37,848 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:29:41,860 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:29:41,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:29:42,373 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:29:44,376 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:29:44,488 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:29:44,616 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:29:44,678 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:29:44,679 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:29:52,814 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:30:52,815 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:31:03,821 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:31:08,089 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:31:08,089 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:31:12,284 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:31:13,291 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:31:13,294 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:31:13,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:13,395 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:31:13,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:14,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:14,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:14,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:31:14,993 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:31:16,875 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:31:16,876 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:31:18,286 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:31:18,293 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:31:18,296 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:31:18,299 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:31:18,302 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:31:18,304 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:31:18,305 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:31:18,306 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:31:18,307 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:31:18,309 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:31:18,313 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:31:18,315 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:31:18,316 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:20,252 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:31:20,255 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:31:20,257 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:22,195 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:31:22,198 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:31:22,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:31:23,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:31:23,226 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:42,851 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:31:42,857 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:44,792 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:31:55,753 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:31:56,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:31:56,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:31:56,906 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:14,816 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:32:19,140 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:32:19,142 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:32:19,143 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:32:19,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:32:19,832 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:32:19,834 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:32:21,672 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:32:29,384 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:32:29,777 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 13:32:30,184 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:32:32,431 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:32:32,432 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:32:35,634 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:32:35,634 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:32:36,444 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:32:36,451 - ispa_next.main - DEBUG - 



2025-11-12 13:32:36,451 - ispa_next.main - DEBUG - starting with process 8 (ED M 2304) of 20
2025-11-12 13:32:36,456 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:32:37,667 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:32:38,830 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:32:38,832 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:32:40,201 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:32:40,203 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:33:16,643 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:33:16,654 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 13:33:16,658 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:17,128 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:33:17,129 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:19,525 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:33:19,526 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:33:20,153 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:33:20,160 - ispa_next.main - DEBUG - 



2025-11-12 13:33:20,160 - ispa_next.main - DEBUG - starting with process 9 (ED RU 101) of 20
2025-11-12 13:33:20,164 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:33:21,104 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:22,413 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:33:22,414 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:33:23,778 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:23,779 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:33:53,644 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:33:53,655 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 13:33:53,660 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:54,078 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:33:54,080 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:56,531 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:33:56,532 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:33:57,463 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:33:57,470 - ispa_next.main - DEBUG - 



2025-11-12 13:33:57,471 - ispa_next.main - DEBUG - starting with process 10 (MNK3076) of 20
2025-11-12 13:33:57,475 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:33:58,624 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:59,652 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:33:59,653 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:34:00,788 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:34:00,789 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:34:34,068 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:34:34,077 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 13:34:34,080 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:34:34,410 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:34:34,411 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:34:36,543 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:34:36,544 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:34:37,176 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:34:37,183 - ispa_next.main - DEBUG - 



2025-11-12 13:34:37,183 - ispa_next.main - DEBUG - starting with process 11 (ED-MH-171) of 20
2025-11-12 13:34:37,187 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:34:37,988 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:34:38,801 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:34:38,802 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:34:40,015 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:34:40,016 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:35:10,827 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:35:10,835 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 13:35:10,839 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:35:11,176 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:35:11,177 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:35:13,129 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:35:13,130 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:35:13,767 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:35:13,773 - ispa_next.main - DEBUG - 



2025-11-12 13:35:13,773 - ispa_next.main - DEBUG - starting with process 12 (ED-A1024) of 20
2025-11-12 13:35:13,777 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:35:14,889 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:35:15,680 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:35:15,681 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:35:16,856 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:35:16,857 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:35:47,490 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:35:47,498 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 13:35:47,502 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:35:47,817 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:35:47,818 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:35:49,769 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:35:49,770 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:35:50,437 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:35:50,447 - ispa_next.main - DEBUG - 



2025-11-12 13:35:50,447 - ispa_next.main - DEBUG - starting with process 13 (ED-K2010) of 20
2025-11-12 13:35:50,453 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:35:51,591 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:35:52,754 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:35:52,755 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:35:54,121 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:35:54,123 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:36:25,268 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:36:25,278 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 13:36:25,283 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:36:25,742 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:36:25,743 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:36:28,424 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:36:28,425 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:36:29,342 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:36:29,350 - ispa_next.main - DEBUG - 



2025-11-12 13:36:29,350 - ispa_next.main - DEBUG - starting with process 14 (ED-AL59) of 20
2025-11-12 13:36:29,355 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:36:30,499 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:36:31,711 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:36:31,713 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:36:32,959 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:36:32,960 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:37:03,652 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:37:03,662 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 13:37:03,667 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:04,084 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:37:04,085 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:06,413 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:37:06,414 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:37:07,236 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:37:07,243 - ispa_next.main - DEBUG - 



2025-11-12 13:37:07,243 - ispa_next.main - DEBUG - starting with process 15 (M-ED-2001) of 20
2025-11-12 13:37:07,247 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:08,416 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:09,655 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:37:09,656 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:37:10,987 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:10,989 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:37:42,293 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:37:42,302 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 13:37:42,306 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:42,629 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:37:42,630 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:44,630 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:37:44,630 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:37:45,319 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:37:45,329 - ispa_next.main - DEBUG - 



2025-11-12 13:37:45,329 - ispa_next.main - DEBUG - starting with process 16 (EBE-AB 202) of 20
2025-11-12 13:37:45,333 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:46,197 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:47,009 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:37:47,010 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:37:48,132 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:48,133 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:38:09,831 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:38:11,499 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:38:16,437 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:38:17,694 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:38:17,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:17,804 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:38:17,991 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:38:17,994 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:38:20,703 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:38:20,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:21,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:38:23,840 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:38:23,952 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:38:24,057 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:38:24,183 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:38:28,373 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:38:29,380 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:38:29,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:29,823 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:40,347 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:38:40,347 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:38:43,791 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:38:43,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:43,873 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:38:43,874 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:38:43,969 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:38:44,073 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:38:45,283 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:38:45,548 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:38:47,174 - ispa_next.functions - DEBUG - Updated appointment (AB00024097) customer contact data.
2025-11-12 13:38:48,090 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:38:48,092 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:38:48,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:38:49,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:38:50,256 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:38:50,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:38:50,337 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:38:54,452 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-12 13:38:54,453 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:38:54,453 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:38:54,456 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:38:54,461 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:38:54,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:54,980 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:38:55,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:55,816 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:55,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:56,566 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:38:56,566 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:38:57,833 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:38:57,836 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:38:59,469 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:38:59,471 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:38:59,481 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:38:59,483 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:38:59,486 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:38:59,487 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:38:59,488 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:38:59,490 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:38:59,490 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:38:59,491 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:38:59,495 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:38:59,497 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:38:59,498 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:00,704 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:39:00,706 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:39:00,708 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:01,962 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:39:01,964 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:39:01,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:39:02,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:39:02,857 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:10,583 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:39:10,584 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:11,805 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:39:21,790 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:39:22,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:39:22,822 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:39:22,943 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:33,868 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:39:33,871 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:39:33,872 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:39:34,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:39:34,525 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:39:34,528 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:39:36,352 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:39:43,608 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:39:43,991 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 13:39:44,452 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:39:46,367 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:39:46,369 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:39:49,531 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:39:49,532 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:39:50,286 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:39:50,296 - ispa_next.main - DEBUG - 



2025-11-12 13:39:50,296 - ispa_next.main - DEBUG - starting with process 17 (ED-CT 178) of 20
2025-11-12 13:39:50,301 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:39:51,208 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:39:52,198 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:39:52,199 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:39:53,716 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:39:53,717 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:40:15,296 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:40:17,044 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:40:21,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:40:23,670 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:40:23,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:23,752 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:40:23,933 - ispa_next.functions - DEBUG - HU date already expired after 591 days.
2025-11-12 13:40:26,882 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:40:26,885 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:40:29,553 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:40:29,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:40:30,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:40:32,483 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:40:32,628 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:40:32,715 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:40:32,826 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:40:36,997 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:40:38,003 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:40:38,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:38,489 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:49,367 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:40:53,163 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:40:53,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:53,247 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:40:53,248 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:40:53,280 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:40:53,420 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:40:54,534 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 13:40:55,931 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 13:40:56,245 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:40:57,985 - ispa_next.functions - DEBUG - Updated appointment (AB00024324) customer contact data.
2025-11-12 13:40:58,901 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:40:58,904 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:40:59,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:40:59,785 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:41:00,724 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:41:00,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:41:00,809 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:41:04,815 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:41:04,815 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:41:04,818 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:41:04,823 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:41:04,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:41:05,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:41:05,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:06,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:06,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:41:06,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:41:06,866 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:41:08,745 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:41:08,746 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:41:10,039 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:41:10,042 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:41:10,044 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:41:10,046 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:41:10,048 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:41:10,049 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:41:10,051 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:41:10,052 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:41:10,053 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:41:10,054 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:41:10,058 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:41:10,060 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:41:10,061 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:11,962 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:41:11,965 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:41:11,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:13,800 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:41:13,802 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:41:13,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:41:14,582 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:41:14,818 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:23,863 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:41:23,865 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:25,787 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:41:36,520 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:41:36,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:41:37,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:41:37,622 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:55,382 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:41:59,538 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:41:59,540 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:41:59,541 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:42:00,051 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:42:00,139 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:42:00,142 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:42:01,912 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:42:08,310 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:42:08,708 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 13:42:09,049 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:42:10,678 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:42:10,679 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:42:13,516 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:42:13,517 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:42:14,340 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:42:14,349 - ispa_next.main - DEBUG - 



2025-11-12 13:42:14,349 - ispa_next.main - DEBUG - starting with process 18 (ED-O 1909) of 20
2025-11-12 13:42:14,353 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:42:15,341 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:42:16,218 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:42:16,219 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:42:17,571 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:42:17,572 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:42:43,195 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:42:45,147 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:42:50,524 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:42:55,915 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:42:55,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:42:55,985 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:42:56,156 - ispa_next.functions - DEBUG - HU date already expired after 13 days.
2025-11-12 13:42:59,416 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:42:59,419 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:43:02,215 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:43:02,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:43:03,806 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:43:05,809 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:43:05,915 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:43:06,047 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:43:06,117 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:43:08,276 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:43:09,283 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:43:09,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:43:09,787 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:43:13,180 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 13:43:13,185 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:43:13,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:43:13,246 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:43:13,247 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:43:13,278 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:43:14,492 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:43:15,647 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:43:15,857 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:43:17,670 - ispa_next.functions - DEBUG - Updated appointment (AA00022415) customer contact data.
2025-11-12 13:43:18,633 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:43:18,635 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:43:19,679 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:43:19,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:43:20,581 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:43:24,190 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:43:24,190 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:43:24,193 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:43:24,197 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:43:24,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:43:24,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:43:34,178 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 13:43:40,959 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 13:43:40,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:43:41,892 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:43:41,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:43:42,665 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:43:42,666 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:43:47,402 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:43:47,404 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:43:48,521 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:43:48,524 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:43:48,528 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:43:48,529 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:43:48,531 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:43:48,540 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:43:48,543 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:43:48,546 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:43:48,547 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:43:48,551 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:43:48,561 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:43:48,564 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:43:48,565 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:43:53,908 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:43:53,909 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:43:53,915 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:43:59,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:43:59,304 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:44:08,696 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:23,235 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:44:23,238 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:44:23,238 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:44:24,150 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:44:24,415 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:36,924 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:44:36,926 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:42,312 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:44:53,624 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:44:54,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:44:54,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:44:54,758 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:45:11,501 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:45:11,502 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:45:12,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:45:12,212 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:45:12,215 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:45:15,233 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:45:23,271 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:45:23,645 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 13:45:24,388 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:45:25,512 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:45:25,514 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:45:28,771 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 13:45:28,772 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:45:29,604 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:45:29,612 - ispa_next.main - DEBUG - 



2025-11-12 13:45:29,612 - ispa_next.main - DEBUG - starting with process 19 (ED-RD 212) of 20
2025-11-12 13:45:29,616 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:45:30,808 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:45:32,107 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 13:45:32,108 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 13:45:33,553 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:45:33,554 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:45:56,310 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:45:57,949 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:46:03,209 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:46:05,801 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:46:05,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:46:05,869 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:46:06,027 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:46:06,031 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:46:08,837 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:46:08,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:46:10,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:46:12,018 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:46:12,121 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:46:12,227 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:46:12,294 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:46:16,431 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:46:17,437 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:46:17,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:46:17,915 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:46:29,307 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:46:33,500 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:46:33,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:46:33,572 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:46:33,573 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:46:33,616 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:46:33,796 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:46:34,966 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:46:35,167 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:46:37,016 - ispa_next.functions - DEBUG - Updated appointment (AB00024344) customer contact data.
2025-11-12 13:46:37,945 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:46:37,948 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:46:38,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:46:38,880 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:46:39,891 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:46:39,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:46:39,988 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:46:43,563 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:46:43,563 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:46:43,567 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:46:43,571 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:46:43,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:46:44,074 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:46:44,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:46:44,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:46:44,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:46:45,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:46:45,655 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:46:48,251 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:46:48,256 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:46:49,688 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:46:49,692 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:46:49,695 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:46:49,697 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:46:49,699 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:46:49,701 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:46:49,702 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:46:49,703 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:46:49,704 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:46:49,706 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:46:49,710 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:46:49,713 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:46:49,713 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:46:52,294 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:46:52,297 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:46:52,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:46:54,836 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:46:54,839 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:46:54,840 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:46:55,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:46:55,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:47:04,820 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:47:04,824 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:47:07,457 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:47:17,810 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:47:18,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:47:18,907 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:47:19,107 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:47:44,110 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:48,117 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:52,608 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:52,611 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:47:52,612 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:47:53,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:47:53,323 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:47:53,325 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:47:54,881 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:48:02,483 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:48:02,862 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 13:48:03,347 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:48:05,315 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 13:48:05,317 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:48:08,259 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 13:48:08,260 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:48:08,998 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 13:48:09,006 - ispa_next.main - DEBUG - 



2025-11-12 13:48:09,006 - ispa_next.main - DEBUG - starting with process 20 (ED-WI 283) of 20
2025-11-12 13:48:09,011 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:48:10,072 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:48:10,936 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 13:48:10,937 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 13:48:12,217 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:48:12,220 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:48:36,687 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:48:38,513 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:48:43,810 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:48:46,435 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:48:46,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:48:46,493 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:48:46,650 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:48:46,653 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:48:49,433 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:48:49,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:48:50,589 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:48:52,604 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:48:52,744 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:48:52,845 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:48:52,929 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:48:57,087 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:48:58,092 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:48:58,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:48:58,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:12,365 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:49:16,537 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:49:16,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:16,617 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:49:16,618 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:49:16,650 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:49:16,842 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:49:18,059 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:49:18,277 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:49:20,286 - ispa_next.functions - DEBUG - Updated appointment (AB00024334) customer contact data.
2025-11-12 13:49:21,229 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:49:21,231 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:49:21,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:49:22,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:49:23,654 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:49:23,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:49:23,738 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:49:27,375 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:49:27,375 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:49:27,387 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:49:27,391 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:49:27,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:49:27,884 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:49:28,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:28,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:28,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:49:29,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:49:29,552 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:49:31,990 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:49:31,991 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:49:33,357 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:49:33,358 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:49:33,359 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:49:33,360 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:49:33,362 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:49:33,363 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:49:33,363 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:49:33,365 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:49:33,366 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:49:33,367 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:49:33,371 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:49:33,374 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:49:33,375 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:36,002 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:49:36,004 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:49:36,007 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:38,648 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:49:38,651 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:49:38,652 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:49:39,646 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:49:39,859 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:49,558 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:49:49,561 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:52,155 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:50:02,700 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:50:03,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:50:03,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:50:03,883 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:50:28,879 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:50:32,920 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:50:37,464 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:50:37,466 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:50:37,467 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:50:38,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:50:38,115 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:50:38,118 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:50:39,972 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:50:47,336 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:50:47,735 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-12 13:50:48,211 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:50:50,463 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 13:50:50,464 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:50:53,388 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 13:50:53,389 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:50:54,168 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
