2025-11-17 14:15:24,571 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 14:15:24,576 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 14:15:40,107 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:15:52,245 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:16:08,343 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:16:33,786 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 14:16:52,550 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 14:16:57,242 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:16:58,983 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 947
2025-11-17 14:16:58,984 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 87
2025-11-17 14:17:03,151 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 60
2025-11-17 14:17:03,152 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 14:17:03,152 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:17:04,768 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:17:06,344 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:17:17,229 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:17:17,234 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:17:17,242 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:17:17,244 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:17:17,254 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:17:17,291 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:17:17,292 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:17:17,300 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:17:17,302 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:17:17,310 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:17:17,310 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:17:17,331 - ispa_next.main - DEBUG - Found 10 out of 43 appointments to process (configured limit: 15).
2025-11-17 14:17:17,331 - ispa_next.main - DEBUG - Processing 10 fresh appointments.
2025-11-17 14:17:17,332 - ispa_next.main - DEBUG - All appointments: HOG-LD 711, HG-SB 805, MTK-T 131E, SWA-HP 906, F-TZ 2103, MTK-SK 198, F-UN 5714, HG-DR 1887, HG TH 118, F-CK 390
2025-11-17 14:17:17,335 - ispa_next.main - DEBUG - 



2025-11-17 14:17:17,335 - ispa_next.main - DEBUG - starting with process 1 (HOG-LD 711) of 10
2025-11-17 14:17:17,366 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:17:18,957 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:17:21,239 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 947
2025-11-17 14:17:21,241 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 60
2025-11-17 14:17:23,300 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:17:23,302 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:18:10,956 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:18:23,597 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:24,976 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:18:24,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:25,126 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:18:25,470 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:18:25,475 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:18:28,493 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:18:28,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:18:30,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:18:32,093 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:18:32,322 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:18:35,639 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:18:35,784 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:18:35,786 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:37,202 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:18:49,673 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:18:50,682 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:18:50,683 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:51,231 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:56,565 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 14:18:56,574 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:18:56,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:56,701 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:18:56,703 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:18:56,789 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:18:58,348 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:18:59,888 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:19:00,334 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:19:03,577 - ispa_next.functions - DEBUG - Updated appointment (AB00036914) customer contact data.
2025-11-17 14:19:04,516 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:19:04,522 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:19:05,740 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:19:05,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:19:06,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:19:10,337 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:19:10,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:19:10,851 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:19:12,859 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:19:13,081 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:19:13,207 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:19:13,346 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:19:13,348 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:14,821 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:19:26,833 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:19:34,907 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:19:34,909 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:36,307 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:19:40,533 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:19:41,540 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:19:41,541 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:19:41,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:19:41,668 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:19:45,811 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:19:45,816 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:19:45,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:19:45,965 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:19:46,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:19:46,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:19:46,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:19:47,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:19:47,811 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:19:49,343 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:19:49,346 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:19:51,150 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:19:51,152 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:19:51,154 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:19:51,155 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:19:51,157 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:19:51,158 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:19:51,159 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:19:51,160 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:19:51,162 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:19:51,164 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:19:51,167 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:19:51,169 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:19:51,170 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:52,502 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:19:52,505 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:19:52,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:53,927 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:19:53,931 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:19:53,934 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:19:53,963 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:55,551 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:20:15,534 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:20:16,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:20:17,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:20:17,836 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:20:25,623 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:20:34,091 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:20:34,092 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:20:35,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:20:35,241 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:20:35,243 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:20:45,229 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:20:59,874 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:21:00,390 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 14:21:01,223 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:21:03,136 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 947
2025-11-17 14:21:03,137 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:21:07,586 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 87
2025-11-17 14:21:07,587 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:21:08,946 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 14:21:08,955 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 14:21:08,966 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 14:21:08,973 - ispa_next.main - DEBUG - 



2025-11-17 14:21:08,973 - ispa_next.main - DEBUG - starting with process 2 (HG-SB 805) of 10
2025-11-17 14:21:08,977 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:21:10,792 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:21:12,824 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 947
2025-11-17 14:21:12,826 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 87
2025-11-17 14:21:15,433 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:21:15,440 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:21:55,411 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:22:08,931 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:22:10,227 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:22:10,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:10,389 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:22:10,812 - ispa_next.functions - DEBUG - HU date already expired after 445 days.
2025-11-17 14:22:20,500 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:22:20,504 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:22:23,462 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:22:23,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:25,113 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:22:27,115 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:22:27,713 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:22:31,171 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:22:43,269 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 14:22:44,296 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:22:44,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:44,927 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:49,783 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 14:22:49,786 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:22:49,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:49,869 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:22:49,870 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:22:49,951 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:22:51,535 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:22:52,061 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:22:54,123 - ispa_next.functions - DEBUG - Updated appointment (AB00036907) customer contact data.
2025-11-17 14:22:55,166 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:22:55,179 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:22:56,411 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:22:56,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:22:57,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:23:02,128 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:23:02,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:23:02,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:23:05,020 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:23:05,272 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:23:05,526 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:23:05,631 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:23:05,633 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:07,130 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:23:19,388 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:24:19,391 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:24:31,723 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:24:55,726 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:25:06,655 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:25:14,419 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:25:14,421 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:18,573 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremse vorn' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 14:25:22,799 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:25:27,510 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:25:28,516 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:25:28,517 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:25:28,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:25:28,598 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:25:32,844 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:25:34,113 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:25:51,624 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:25:51,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:25:51,762 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:25:52,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:52,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:52,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:25:54,061 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:25:54,062 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:25:55,555 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:25:55,560 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:25:59,232 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:25:59,234 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:25:59,235 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:25:59,237 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:25:59,239 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:25:59,241 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:25:59,243 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:25:59,244 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:25:59,246 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:25:59,247 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:25:59,251 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:25:59,254 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:25:59,255 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:00,876 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:26:00,879 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:26:00,882 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:02,333 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:26:02,336 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:26:02,339 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:26:02,342 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:03,827 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:26:37,828 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:26:38,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:26:40,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:26:40,928 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:52,802 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:27:06,835 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:27:06,836 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:27:08,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:27:08,875 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:27:08,878 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:27:23,802 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:27:48,370 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:27:48,821 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 14:27:50,597 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:27:54,276 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 947
2025-11-17 14:27:54,278 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:28:01,334 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 87
2025-11-17 14:28:01,335 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:28:03,398 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 14:28:03,407 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 14:28:03,416 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 14:28:03,423 - ispa_next.main - DEBUG - 



2025-11-17 14:28:03,423 - ispa_next.main - DEBUG - starting with process 3 (MTK-T 131E) of 10
2025-11-17 14:28:03,426 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:28:06,383 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:28:09,960 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 947
2025-11-17 14:28:09,962 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 87
2025-11-17 14:28:13,942 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:28:13,944 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:29:18,770 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:29:39,986 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:29:42,058 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:29:42,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:29:42,254 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:29:42,925 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 14:29:58,014 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:29:58,017 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:30:01,392 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:30:01,394 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:30:03,927 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:30:05,938 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:30:06,193 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:30:06,432 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:30:06,604 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:30:11,069 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:30:12,077 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:30:12,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:12,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:34,227 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:30:51,778 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:30:51,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:51,961 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:30:51,962 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:30:52,036 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:30:53,746 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:30:55,645 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:30:56,069 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:30:59,596 - ispa_next.functions - DEBUG - Updated appointment (AB00036905) customer contact data.
2025-11-17 14:31:00,874 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:31:00,878 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:31:03,202 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:31:03,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:31:04,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:31:08,178 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:31:08,178 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:31:08,181 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:31:08,182 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:31:08,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:08,797 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:31:13,073 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:31:13,082 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:31:13,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:13,319 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:31:19,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:19,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:19,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:21,632 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:31:21,633 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:31:23,944 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:31:23,948 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:31:26,271 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:31:26,274 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:31:26,282 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:31:26,284 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:31:26,286 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:31:26,287 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:31:26,289 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:31:26,290 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:31:26,293 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:31:26,296 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:31:26,299 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:31:26,302 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:31:26,303 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:28,920 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:31:28,922 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:31:28,924 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:31,331 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:31:31,359 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:31:31,362 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:31:31,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:33,719 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:32:06,683 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:32:07,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:32:09,126 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:32:09,732 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:22,749 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:32:36,682 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:32:36,683 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:32:38,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:32:38,792 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:32:38,795 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:32:51,689 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:33:14,949 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:33:15,418 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 14:33:16,634 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:33:20,236 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 947
2025-11-17 14:33:20,238 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:33:27,535 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 87
2025-11-17 14:33:27,536 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:33:29,514 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 14:33:29,523 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 14:33:29,533 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 14:33:29,537 - ispa_next.main - DEBUG - 



2025-11-17 14:33:29,537 - ispa_next.main - DEBUG - starting with process 4 (SWA-HP 906) of 10
2025-11-17 14:33:29,541 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:33:32,536 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:33:36,133 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 947
2025-11-17 14:33:36,136 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 87
2025-11-17 14:33:40,412 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:33:40,414 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:34:47,804 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:35:07,972 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:35:10,768 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:35:10,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:35:11,029 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:35:11,648 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:35:11,653 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:35:15,166 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:35:15,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:35:18,004 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:35:20,006 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:35:20,273 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:35:20,555 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:35:20,773 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:35:20,777 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:35:23,748 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:35:38,127 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:35:39,132 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:35:39,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:35:39,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:35:59,824 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:36:16,801 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:36:16,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:36:17,001 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:36:17,003 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:36:17,090 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:36:19,011 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:36:19,424 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:36:23,307 - ispa_next.functions - DEBUG - Updated appointment (AB00036924) customer contact data.
2025-11-17 14:36:24,418 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:36:24,505 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:36:26,971 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:36:26,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:36:28,559 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:36:32,209 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:36:32,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:36:32,801 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:36:34,804 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:36:35,025 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:36:35,323 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:36:35,601 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:36:35,603 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:36:38,646 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:36:53,120 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:37:48,123 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:38:02,001 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:38:19,185 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:38:20,192 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:38:20,193 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:38:20,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:38:20,355 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:38:24,591 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:38:26,789 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:38:44,924 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:38:44,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:38:45,106 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:38:48,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:38:49,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:38:49,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:38:50,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:38:50,846 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:38:53,643 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:38:53,647 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:38:56,340 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:38:56,342 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:38:56,344 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:38:56,345 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:38:56,348 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:38:56,349 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:38:56,351 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:38:56,353 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:38:56,355 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:38:56,357 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:38:56,363 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:38:56,365 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:38:56,366 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:38:59,692 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:38:59,694 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:38:59,698 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:39:02,570 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:39:02,574 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:39:02,576 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:39:02,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:39:05,652 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:39:43,044 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:39:44,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:39:45,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:39:46,433 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:39:59,548 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:40:14,315 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:40:14,316 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:40:16,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:40:16,437 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:40:16,440 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:40:29,410 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:40:53,559 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:40:54,027 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 14:40:55,074 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:40:58,823 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 948
2025-11-17 14:40:58,825 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:41:06,076 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-17 14:41:06,077 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:41:08,397 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 14:41:08,407 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 14:41:08,416 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 14:41:08,423 - ispa_next.main - DEBUG - 



2025-11-17 14:41:08,423 - ispa_next.main - DEBUG - starting with process 5 (F-TZ 2103) of 10
2025-11-17 14:41:08,428 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:41:11,507 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:41:15,059 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 948
2025-11-17 14:41:15,061 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-17 14:41:18,923 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:41:18,925 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:42:28,983 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:42:48,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:49,019 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:42:49,438 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:42:53,016 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:42:53,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:53,976 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:42:54,801 - ispa_next.functions - DEBUG - HU date already expired after 874 days.
2025-11-17 14:43:10,623 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:43:10,627 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:43:14,051 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:43:14,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:43:16,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:43:18,666 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:43:18,923 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:43:19,181 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:43:19,407 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:43:19,410 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:43:23,341 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:43:37,789 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:43:38,794 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:43:38,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:43:39,470 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:00,416 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:44:20,544 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:44:20,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:20,724 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:44:20,725 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:44:20,811 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:44:22,574 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:44:22,955 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:44:28,478 - ispa_next.functions - DEBUG - Updated appointment (AB00036897) customer contact data.
2025-11-17 14:44:29,716 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:44:29,745 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:44:32,702 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:44:32,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:44:34,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:44:37,926 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:44:37,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:44:38,549 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:44:40,570 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:44:40,862 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:44:41,106 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:44:41,248 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:44:41,250 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:44:45,228 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:44:59,310 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:45:29,313 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:45:43,852 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:46:01,695 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:46:02,705 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:46:02,706 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:46:02,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:46:02,870 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:46:07,189 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:46:07,195 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:46:07,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:46:07,405 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:46:07,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:46:08,666 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:46:08,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:46:10,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:46:10,028 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:46:13,582 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:46:13,585 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:46:15,896 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:46:15,900 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:46:15,902 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:46:15,903 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:46:15,906 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:46:15,907 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:46:15,908 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:46:15,910 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:46:15,911 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:46:15,913 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:46:15,917 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:46:15,920 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:46:15,921 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:46:19,817 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 14:46:25,757 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:46:25,825 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:46:25,829 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:46:30,323 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:46:30,325 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:46:30,327 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:46:30,330 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:46:34,163 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:47:07,261 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:47:08,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:47:09,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:47:10,489 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:47:24,777 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:47:39,138 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:47:39,140 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:47:41,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:47:41,567 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:47:41,569 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:47:55,225 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:48:18,774 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:48:19,166 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 14:48:20,795 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:48:24,206 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 948
2025-11-17 14:48:24,209 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:48:32,082 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-17 14:48:32,083 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:48:34,390 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 14:48:34,400 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 14:48:34,409 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 14:48:34,416 - ispa_next.main - DEBUG - 



2025-11-17 14:48:34,416 - ispa_next.main - DEBUG - starting with process 6 (MTK-SK 198) of 10
2025-11-17 14:48:34,420 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:48:37,441 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:48:40,838 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 948
2025-11-17 14:48:40,840 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-17 14:48:44,732 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:48:44,734 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:49:56,638 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:50:16,404 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:50:18,658 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:50:18,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:18,840 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:50:19,413 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 14:50:35,116 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:50:35,120 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:50:38,528 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:50:38,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:50:41,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:50:43,579 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:50:43,907 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:50:44,113 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:50:44,317 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:50:48,724 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:50:49,730 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:50:49,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:50,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:59,412 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 14:50:59,416 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:50:59,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:59,576 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:50:59,577 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:50:59,743 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:51:01,413 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:51:01,810 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:51:06,378 - ispa_next.functions - DEBUG - Updated appointment (AB00036899) customer contact data.
2025-11-17 14:51:08,529 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:51:08,533 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:51:11,000 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:51:11,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:51:12,774 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:51:16,460 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:51:16,463 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:51:16,469 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:51:16,470 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:51:16,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:51:17,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:51:21,371 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:51:21,375 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:51:21,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:51:21,608 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:51:25,717 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:51:26,409 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:51:26,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:51:27,594 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:51:27,594 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:51:29,798 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:51:29,801 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:51:31,982 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:51:31,991 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:51:31,993 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:51:31,995 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:51:31,998 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:51:31,999 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:51:32,000 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:51:32,002 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:51:32,004 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:51:32,005 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:51:32,009 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:51:32,015 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:51:32,019 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:51:34,284 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:51:34,287 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:51:34,290 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:51:36,503 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:51:36,505 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:51:36,509 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:51:36,531 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:51:38,801 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:52:13,102 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:52:14,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:52:15,785 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:52:16,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:52:28,728 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:52:42,829 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:52:42,830 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:52:44,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:52:44,923 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:52:44,934 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:52:58,117 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:53:22,163 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:53:22,543 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 14:53:24,002 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:53:28,618 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 949
2025-11-17 14:53:28,622 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:53:36,616 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 82
2025-11-17 14:53:36,617 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:53:38,903 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 14:53:38,914 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 14:53:38,927 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 14:53:38,938 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 14:53:38,941 - ispa_next.main - DEBUG - Found new Appointment: FB-C 2831
2025-11-17 14:53:38,943 - ispa_next.main - DEBUG - 



2025-11-17 14:53:38,943 - ispa_next.main - DEBUG - starting with process 7 (FB-C 2831) of 11
2025-11-17 14:53:38,947 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:53:42,078 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:53:45,507 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 949
2025-11-17 14:53:45,509 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 82
2025-11-17 14:53:49,704 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:53:49,706 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:55:04,520 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:55:24,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:55:25,810 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:55:25,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:26,048 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:55:26,809 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:55:26,814 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:55:30,436 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:55:30,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:55:32,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:55:34,844 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:55:35,044 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:55:38,587 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:55:38,764 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:55:43,118 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:55:44,123 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:55:44,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:45,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:55,232 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 14:55:55,236 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:55:55,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:55,441 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:55:55,443 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:55:55,543 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:55:55,834 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:55:57,771 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:55:58,186 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:56:04,015 - ispa_next.functions - DEBUG - Updated appointment (AB00036926) customer contact data.
2025-11-17 14:56:05,086 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:56:05,092 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:56:05,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:56:07,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:56:10,535 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:56:10,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:56:10,995 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:56:14,862 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:56:14,862 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:56:14,867 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:56:14,868 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:56:14,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:56:15,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:56:19,752 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:56:19,757 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:56:19,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:56:19,985 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:56:20,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:56:21,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:56:21,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:56:22,582 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:56:22,583 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:56:24,325 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:56:24,327 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:56:26,862 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:56:26,890 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:56:26,921 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:56:26,926 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:56:26,928 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:56:26,930 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:56:26,931 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:56:26,932 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:56:26,934 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:56:26,935 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:56:26,940 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:56:26,942 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:56:26,943 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:56:28,686 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:56:28,689 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:56:28,706 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:56:30,273 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:56:30,276 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:56:30,278 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:56:30,296 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:56:31,841 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:57:05,399 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:57:06,506 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:57:07,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:57:08,477 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:57:21,614 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:57:36,557 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:57:36,557 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:57:38,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:57:38,700 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:57:38,702 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:57:51,708 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:58:16,641 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:58:17,154 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 14:58:18,639 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:58:22,322 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 949
2025-11-17 14:58:22,324 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:58:29,691 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 80
2025-11-17 14:58:29,692 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:58:31,770 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 14:58:31,779 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 14:58:31,788 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 14:58:31,798 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 14:58:31,803 - ispa_next.main - DEBUG - 



2025-11-17 14:58:31,803 - ispa_next.main - DEBUG - starting with process 8 (F-UN 5714) of 11
2025-11-17 14:58:31,806 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:58:34,926 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:58:38,539 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 949
2025-11-17 14:58:38,542 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 80
2025-11-17 14:58:42,965 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:58:42,967 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:59:57,675 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:00:19,225 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:00:22,110 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:00:22,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:00:22,280 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:00:22,951 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 15:00:39,042 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:00:39,050 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:00:42,524 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:00:42,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:00:45,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:00:47,208 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:00:47,476 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:00:47,715 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:00:48,032 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:00:50,442 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:00:51,476 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:00:51,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:00:53,034 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:01:14,125 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:01:32,508 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:01:32,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:01:32,696 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:01:32,698 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:01:32,784 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:01:34,553 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:01:36,431 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:01:36,826 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:01:41,933 - ispa_next.functions - DEBUG - Updated appointment (AE00016650) customer contact data.
2025-11-17 15:01:43,312 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:01:43,316 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:01:46,280 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:01:46,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:01:48,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:01:53,181 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:01:53,181 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:01:54,017 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:01:54,087 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:01:54,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:01:54,854 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:01:59,118 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 15:02:01,668 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 15:02:21,611 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:02:21,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:02:21,769 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:02:27,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:02:28,478 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:02:28,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:02:29,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:02:29,994 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:02:33,112 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:02:33,115 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:02:35,945 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:02:35,947 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:02:35,949 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:02:35,950 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:02:35,952 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:02:35,954 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:02:35,955 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:02:35,957 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:02:35,958 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:02:35,960 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:02:35,964 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:02:35,967 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:02:35,968 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:02:39,200 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:02:39,202 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:02:39,205 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:02:42,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:02:42,451 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:02:56,109 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:03:14,642 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:03:14,646 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:03:14,648 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:03:14,652 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:03:17,581 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 15:03:33,115 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:04:06,848 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:04:08,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:04:09,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:04:10,070 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:04:24,154 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:04:40,479 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:04:40,480 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:04:42,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:04:42,699 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:04:42,701 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:04:55,738 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:05:21,071 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:05:21,574 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 15:05:25,255 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:05:27,343 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 949
2025-11-17 15:05:27,345 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:05:35,031 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 79
2025-11-17 15:05:35,032 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:05:37,259 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 15:05:37,273 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 15:05:37,287 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 15:05:37,302 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 15:05:37,307 - ispa_next.main - DEBUG - 



2025-11-17 15:05:37,307 - ispa_next.main - DEBUG - starting with process 9 (HG-DR 1887) of 11
2025-11-17 15:05:37,311 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:05:40,481 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:05:46,408 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 949
2025-11-17 15:05:46,411 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 79
2025-11-17 15:05:51,498 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:05:51,500 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:07:06,866 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:07:28,401 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:33,595 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:07:33,596 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:07:33,796 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:07:34,383 - ispa_next.functions - DEBUG - HU date already expired after 51 days.
2025-11-17 15:07:54,945 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:07:54,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:07:55,090 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:08:30,065 - ispa_next.common.mail - INFO - Successfully sent an email to 3 recipients
2025-11-17 15:08:30,075 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:08:33,533 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:08:33,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:08:36,362 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:08:38,366 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:08:38,676 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:08:38,892 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:08:39,134 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:08:43,528 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:08:44,534 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:08:44,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:08:45,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:09:07,151 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:09:26,551 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:09:26,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:09:26,708 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:09:26,709 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:09:26,824 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:09:28,604 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:09:29,005 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:09:34,786 - ispa_next.functions - DEBUG - Updated appointment (AN00014684) customer contact data.
2025-11-17 15:09:36,073 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:09:36,113 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:09:38,980 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:09:38,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:09:41,110 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:09:44,764 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:09:44,764 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:09:44,767 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:09:44,768 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:09:44,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:09:45,376 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:09:49,624 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 15:09:51,994 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 15:10:12,016 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:10:12,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:10:12,210 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:10:16,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:10:17,220 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:10:17,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:10:18,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:10:18,822 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:10:24,128 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:10:24,135 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:10:26,833 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:10:26,836 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:10:26,837 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:10:26,839 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:10:26,842 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:10:26,843 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:10:26,845 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:10:26,847 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:10:26,848 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:10:26,850 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:10:26,853 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:10:26,864 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:10:26,865 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:10:32,438 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:10:32,446 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:10:32,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:10:37,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:10:37,933 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:10:49,891 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:10:49,894 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:10:49,897 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:10:49,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:10:55,253 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 15:11:11,218 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:11:50,976 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:11:52,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:11:53,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:11:54,540 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:12:10,801 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:12:26,962 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:12:26,963 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:12:29,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:12:29,240 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:12:29,242 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:12:46,798 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:13:12,369 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:13:12,934 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 15:13:16,650 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:13:19,410 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 951
2025-11-17 15:13:19,412 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:13:26,986 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 79
2025-11-17 15:13:26,987 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:13:29,012 - ispa_next.appointments.models - DEBUG - Appointment Leonard Louis Hoffmann HG-HM 140 WBA1S91000VG39869 ohne Termin.
2025-11-17 15:13:29,026 - ispa_next.appointments.models - DEBUG - Appointment Katja Möhrle HG-LE 216 WMWYW110X03L60135 ohne Termin.
2025-11-17 15:13:29,044 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 15:13:29,058 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 15:13:29,072 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 15:13:29,086 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 15:13:29,091 - ispa_next.main - DEBUG - 



2025-11-17 15:13:29,091 - ispa_next.main - DEBUG - starting with process 10 (HG TH 118) of 11
2025-11-17 15:13:29,094 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:13:32,196 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:13:35,885 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 951
2025-11-17 15:13:35,887 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 79
2025-11-17 15:13:40,021 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:13:40,023 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:14:56,894 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:15:18,883 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:15:20,329 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:15:20,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:15:20,543 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:15:21,309 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 15:15:38,504 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:15:38,507 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:15:41,984 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:15:41,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:15:44,747 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:15:46,751 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:15:46,979 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:15:47,313 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:15:47,458 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:15:47,460 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:15:49,102 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:16:04,540 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:16:05,545 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:16:05,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:06,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:15,549 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 15:16:15,554 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:16:15,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:15,713 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:16:15,714 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:16:15,795 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:16:17,505 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:16:17,937 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:16:23,589 - ispa_next.functions - DEBUG - Updated appointment (AE00016634) customer contact data.
2025-11-17 15:16:24,688 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:16:24,811 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:16:27,180 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:16:27,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:16:29,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:16:32,731 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:16:32,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:16:33,315 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:16:35,318 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:16:35,599 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:16:35,860 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:16:36,113 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:16:36,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:16:37,734 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:16:52,959 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:17:52,962 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:18:06,869 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 15:18:25,744 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 15:18:26,750 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:18:26,751 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:18:26,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:18:26,907 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:18:31,212 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:18:31,218 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:18:31,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:18:31,409 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:18:40,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:18:41,292 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:18:41,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:18:42,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:18:42,708 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:18:44,207 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:18:44,210 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:18:46,889 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:18:46,911 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:18:46,914 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:18:46,915 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:18:46,918 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:18:46,920 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:18:46,921 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:18:46,923 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:18:46,924 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:18:46,926 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:18:46,930 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:18:46,933 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:18:46,934 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:18:48,495 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:18:48,498 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:18:48,501 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:18:50,002 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:18:50,006 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:18:50,008 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:18:50,011 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:18:51,507 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:19:26,854 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:19:28,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:19:29,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:19:30,502 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:47,222 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:20:03,072 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:20:03,074 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:20:05,119 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:05,276 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:20:05,279 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:20:19,225 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:20:38,322 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 15:20:38,325 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:20:38,327 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:20:40,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:40,750 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:20:40,752 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:20:45,995 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 15:20:46,037 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:20:52,906 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 15:20:52,911 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:21:02,421 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 951
2025-11-17 15:21:02,423 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:21:10,183 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 78
2025-11-17 15:21:10,184 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:21:12,417 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 15:21:12,431 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 15:21:12,446 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 15:21:12,469 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 15:21:12,487 - ispa_next.appointments.models - DEBUG - Appointment Pure Tax & Law Partnerschaftsgesellschaft mbB F-BR 1710E WBA41EU0909Y38493 ohne Termin.
2025-11-17 15:21:12,492 - ispa_next.main - DEBUG - Found new Appointment: HG-LE 216
2025-11-17 15:21:12,494 - ispa_next.main - DEBUG - 



2025-11-17 15:21:12,494 - ispa_next.main - DEBUG - starting with process 11 (HG-LE 216) of 12
2025-11-17 15:21:12,498 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:21:15,761 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:21:19,910 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 951
2025-11-17 15:21:19,912 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 78
2025-11-17 15:21:24,153 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:21:24,155 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:22:29,493 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:22:51,028 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:22:52,426 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:22:52,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:52,621 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:22:53,223 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 15:23:10,503 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:23:10,507 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:23:13,919 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:23:13,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:23:16,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:23:18,526 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:23:18,802 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:23:22,174 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:23:22,388 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:23:26,692 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:23:27,698 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:23:27,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:28,377 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:48,714 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:23:48,714 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:24:06,712 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:24:06,716 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:06,904 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:24:06,905 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:24:07,008 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:24:07,291 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:24:09,307 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 15:24:11,143 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 15:24:11,937 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:24:17,645 - ispa_next.functions - DEBUG - Updated appointment (AB00036928) customer contact data.
2025-11-17 15:24:18,807 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:24:18,810 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:24:19,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:24:22,304 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:24:25,577 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:24:25,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:24:25,775 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:24:30,263 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:24:30,263 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:24:30,268 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:24:30,269 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:24:30,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:30,929 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:24:35,247 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:24:35,254 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:24:35,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:35,422 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:24:39,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:40,250 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:40,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:41,593 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:24:41,594 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:24:43,173 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:24:43,178 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:24:46,166 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:24:46,168 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:24:46,170 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:24:46,172 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:24:46,173 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:24:46,175 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:24:46,176 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:24:46,178 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:24:46,180 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:24:46,181 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:24:46,185 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:24:46,188 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:24:46,189 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:24:47,717 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:24:47,720 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:24:47,727 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:24:49,330 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:24:49,333 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:24:49,335 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:24:49,352 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:24:50,934 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:25:23,340 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:25:24,468 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:25:26,099 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:25:26,626 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:40,100 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:25:55,369 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:25:55,370 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:25:57,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:25:57,563 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:25:57,566 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:26:12,141 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:26:29,780 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 15:26:29,784 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:26:29,785 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:32,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:26:32,360 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:26:32,363 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:26:38,516 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 15:26:38,551 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:26:46,763 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 15:26:46,768 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:26:48,505 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 951
2025-11-17 15:26:48,508 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:26:56,667 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 76
2025-11-17 15:26:56,668 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:26:58,747 - ispa_next.appointments.models - DEBUG - Appointment Blumenthal & Partner Rechtsanw HG-CB 747 WBA11EV0509T37733 ohne Termin.
2025-11-17 15:26:58,756 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 15:26:58,766 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 15:26:58,775 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 15:26:58,786 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 15:26:58,792 - ispa_next.main - DEBUG - 



2025-11-17 15:26:58,792 - ispa_next.main - DEBUG - starting with process 12 (F-CK 390) of 12
2025-11-17 15:26:58,796 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:27:02,089 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:27:05,770 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 951
2025-11-17 15:27:05,772 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 76
2025-11-17 15:27:10,417 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:27:10,420 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:28:23,341 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:28:46,138 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:28:49,190 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:28:49,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:28:49,491 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:28:50,221 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 15:29:07,315 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:29:07,319 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:29:10,857 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:29:10,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:29:13,589 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:29:15,592 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:29:15,828 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:29:16,049 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:29:16,367 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:29:20,766 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:29:21,771 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:29:21,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:29:22,498 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:29:34,520 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 15:29:34,524 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:29:34,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:29:34,677 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:29:34,678 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:29:34,780 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:29:36,516 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:29:38,352 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:29:38,771 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:29:43,988 - ispa_next.functions - DEBUG - Updated appointment (AC00024699) customer contact data.
2025-11-17 15:29:45,134 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:29:45,196 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:29:47,742 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:29:47,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:29:49,934 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:29:54,774 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:29:54,774 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:29:55,456 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:29:55,457 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:29:55,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:29:56,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:30:01,210 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 15:30:03,414 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 15:30:24,848 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:30:24,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:30:25,026 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:30:25,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:30:26,350 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:30:26,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:30:28,062 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:30:28,063 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:30:32,898 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:30:32,901 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:30:36,718 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:30:36,720 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:30:36,721 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:30:36,725 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:30:36,728 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:30:36,729 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:30:36,730 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:30:36,732 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:30:36,734 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:30:36,735 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:30:36,740 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:30:36,742 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:30:36,743 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:30:39,961 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 15:30:46,547 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:30:46,616 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:30:46,684 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:30:50,105 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:30:50,108 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:30:50,111 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:30:50,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:30:53,110 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:31:27,413 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:31:28,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:31:30,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:31:31,923 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:31:46,984 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:32:04,508 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:32:04,509 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:32:06,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:32:06,759 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:32:06,761 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:32:20,574 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:32:46,380 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:32:46,846 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 15:32:48,186 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:32:52,584 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 952
2025-11-17 15:32:52,600 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:33:00,912 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 77
2025-11-17 15:33:00,913 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:33:03,441 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 15:33:03,496 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 15:33:03,514 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 15:33:03,544 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 15:33:03,552 - ispa_next.main - DEBUG - Found new Appointment: MTK-TK 87
2025-11-17 15:33:03,552 - ispa_next.main - DEBUG - Found new Appointment: HG-CB 747
2025-11-17 15:33:03,555 - ispa_next.main - DEBUG - 



2025-11-17 15:33:03,555 - ispa_next.main - DEBUG - starting with process 13 (MTK-TK 87) of 14
2025-11-17 15:33:03,560 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:33:06,844 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:33:11,129 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 952
2025-11-17 15:33:11,131 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 77
2025-11-17 15:33:15,934 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:33:15,937 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:34:27,830 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:34:50,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:34:52,216 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:34:52,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:34:52,559 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:34:53,168 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 15:35:10,173 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:35:10,176 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:35:13,723 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:35:13,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:35:16,682 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:35:18,687 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:35:18,937 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:35:22,377 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:35:22,584 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:35:26,950 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:35:27,955 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:35:27,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:28,766 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:50,172 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:36:10,208 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:36:10,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:36:10,431 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:36:10,432 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:36:10,541 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:36:12,440 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:36:12,873 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:36:19,203 - ispa_next.functions - DEBUG - Updated appointment (AL00015127) customer contact data.
2025-11-17 15:36:20,384 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:36:20,531 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:36:23,976 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:36:23,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:36:26,927 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:36:30,790 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:36:30,790 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:36:30,793 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:36:30,794 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:36:30,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:36:31,591 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:36:35,805 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:36:35,810 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:36:35,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:36:35,961 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:36:41,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:36:42,841 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:36:42,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:36:44,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:36:44,140 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:36:45,719 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:36:45,721 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:36:48,214 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:36:48,218 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:36:48,221 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:36:48,225 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:36:48,237 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:36:48,241 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:36:48,246 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:36:48,249 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:36:48,253 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:36:48,255 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:36:48,259 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:36:48,267 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:36:48,271 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:49,755 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:36:49,757 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:36:49,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:51,343 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:36:51,345 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:36:51,347 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:36:51,349 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:52,934 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:37:28,748 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:37:29,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:37:31,797 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:37:32,417 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:37:46,963 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:38:03,157 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:38:03,158 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:38:05,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:38:05,352 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:38:05,354 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:38:19,467 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:38:45,363 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:38:45,899 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 15:38:47,315 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:38:51,746 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-17 15:38:51,748 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:39:00,478 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 78
2025-11-17 15:39:00,480 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:39:02,787 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 15:39:02,797 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 15:39:02,806 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 15:39:02,812 - ispa_next.main - DEBUG - Found new Appointment: HG-JS 61
2025-11-17 15:39:02,813 - ispa_next.main - DEBUG - 



2025-11-17 15:39:02,813 - ispa_next.main - DEBUG - starting with process 14 (HG-JS 61) of 15
2025-11-17 15:39:02,817 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:39:05,980 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:39:09,827 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-17 15:39:09,829 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 78
2025-11-17 15:39:14,837 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:39:14,839 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:40:27,382 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:40:50,314 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:40:52,639 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:40:52,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:40:52,775 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:40:53,635 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:40:53,639 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:40:57,289 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:40:57,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:41:00,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:41:02,793 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:41:03,086 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:41:03,372 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:41:03,550 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:41:07,980 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:41:08,986 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:41:08,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:41:09,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:41:34,382 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:41:34,382 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:41:52,396 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:41:52,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:41:52,676 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:41:52,677 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:41:52,787 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:41:53,138 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:41:55,195 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:41:55,562 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:42:03,546 - ispa_next.functions - DEBUG - Updated appointment (AB00036930) customer contact data.
2025-11-17 15:42:04,734 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:42:04,740 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:42:05,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:42:07,883 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:42:11,916 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:42:11,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:42:12,570 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:42:16,351 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:42:16,351 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:42:16,354 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:42:16,356 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:42:16,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:42:17,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:42:21,358 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:42:21,363 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:42:21,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:42:21,540 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:42:26,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:42:27,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:42:27,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:42:29,150 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:42:29,151 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:42:31,565 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:42:31,567 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:42:34,688 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:42:34,689 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:42:34,691 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:42:34,693 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:42:34,718 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:42:34,720 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:42:34,721 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:42:34,723 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:42:34,725 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:42:34,726 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:42:34,730 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:42:34,733 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:42:34,734 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:42:37,228 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:42:37,231 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:42:37,234 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:42:39,488 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:42:39,492 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:42:39,494 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:42:39,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:42:41,907 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:43:16,027 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:43:17,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:43:19,145 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:43:19,734 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:43:34,808 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:43:51,335 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:43:51,336 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:43:53,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:43:53,566 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:43:53,568 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:44:09,221 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:44:34,003 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:44:34,481 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 15:44:36,202 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:44:40,974 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-17 15:44:40,976 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:44:49,179 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 78
2025-11-17 15:44:49,181 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:44:51,515 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 15:44:51,527 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 15:44:51,537 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 15:44:51,542 - ispa_next.main - DEBUG - 



2025-11-17 15:44:51,543 - ispa_next.main - DEBUG - starting with process 15 (HG-CB 747) of 15
2025-11-17 15:44:51,546 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:44:54,811 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:44:58,654 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 953
2025-11-17 15:44:58,656 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 78
2025-11-17 15:45:03,491 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:45:03,493 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:46:19,704 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:46:44,125 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:46:46,405 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:46:46,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:46:46,653 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:46:47,469 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 15:47:04,368 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:47:04,371 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:47:08,020 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:47:08,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:47:11,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:47:13,416 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:47:13,656 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:47:17,133 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:47:17,340 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:47:21,766 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:47:22,771 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:47:22,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:47:23,591 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:47:43,228 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 15:48:01,822 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:48:01,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:48:01,982 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:48:01,983 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:48:02,125 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:48:04,095 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:48:05,981 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:48:06,384 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:48:14,823 - ispa_next.functions - DEBUG - Updated appointment (AB00036929) customer contact data.
2025-11-17 15:48:15,936 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:48:16,175 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:48:18,712 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:48:18,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:48:20,976 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:48:24,662 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:48:24,662 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:48:24,666 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:48:24,667 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:48:24,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:48:25,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:48:29,641 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:48:29,647 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:48:29,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:48:29,897 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:48:36,099 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:48:36,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:48:36,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:48:38,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:48:38,648 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:48:40,943 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:48:40,947 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:48:43,917 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:48:43,941 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:48:43,971 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:48:43,972 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:48:43,990 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:48:43,996 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:48:44,000 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:48:44,002 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:48:44,003 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:48:44,005 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:48:44,009 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:48:44,012 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:48:44,013 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:48:46,440 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:48:46,442 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:48:46,453 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:48:48,901 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:48:48,903 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:48:48,905 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:48:48,907 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:48:51,266 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:49:26,879 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:49:28,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:49:29,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:49:30,404 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:49:45,054 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:50:01,459 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:50:01,460 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:50:03,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:50:03,695 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:50:03,697 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:50:17,166 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:50:43,628 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:50:44,063 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 15:50:46,290 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:50:50,236 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 955
2025-11-17 15:50:50,238 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:50:59,130 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 78
2025-11-17 15:50:59,132 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:51:01,608 - ispa_next.appointments.models - DEBUG - Appointment Bernd Damm GI-BD 2003 WBA11EV0X09013550 ohne Termin.
2025-11-17 15:51:01,637 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 15:51:01,653 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 15:51:01,670 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
