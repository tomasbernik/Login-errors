2025-11-17 13:00:39,862 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 13:00:39,883 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 13:00:49,390 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:01:02,633 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:01:18,204 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:01:42,509 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 13:01:55,213 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 13:01:58,198 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:01:59,480 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 605
2025-11-17 13:01:59,481 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 326
2025-11-17 13:02:02,055 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 144
2025-11-17 13:02:02,055 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 13:02:02,056 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:02:03,031 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:02:03,983 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:02:26,325 - ispa_next.appointments.models - DEBUG - Appointment Mariya Aleksandrovna OS-UA 81 WBA4C11010G273031 ohne Termin.
2025-11-17 13:02:26,335 - ispa_next.appointments.models - DEBUG - Appointment Öezlem Cicek HF-OZ 84 WBA31AX010FP86133 ohne Termin.
2025-11-17 13:02:26,343 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-17 13:02:26,351 - ispa_next.appointments.models - DEBUG - Appointment Karlheinz Böttger HF-EK 2016 WBA2X71000V366813 ohne Termin.
2025-11-17 13:02:26,355 - ispa_next.main - DEBUG - Found 4 out of 22 appointments to process (configured limit: 15).
2025-11-17 13:02:26,355 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-17 13:02:26,355 - ispa_next.main - DEBUG - All appointments: SB 066AH, HF-PH 795, HF-LF 3030, HF-X 1020
2025-11-17 13:02:26,358 - ispa_next.main - DEBUG - 



2025-11-17 13:02:26,358 - ispa_next.main - DEBUG - starting with process 1 (SB 066AH) of 4
2025-11-17 13:02:26,361 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:02:27,432 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:02:28,488 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 605
2025-11-17 13:02:28,489 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 144
2025-11-17 13:02:29,785 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:02:29,787 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:03:00,217 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:03:09,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:03:09,803 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:03:09,935 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:03:13,183 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:03:13,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:03:13,293 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:03:13,477 - ispa_next.functions - DEBUG - HU date already expired after 983 days.
2025-11-17 13:03:20,462 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:03:20,464 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:03:20,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:03:20,563 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:03:30,357 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:03:30,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:03:31,359 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:03:33,363 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:03:33,485 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:03:36,740 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:03:36,829 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:03:36,830 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:03:48,275 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:03:49,292 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:03:49,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:03:49,804 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:03,239 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:04:11,181 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:04:11,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:11,265 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:04:11,266 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:04:11,344 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:04:12,643 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:04:13,746 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:04:13,977 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:04:17,311 - ispa_next.functions - DEBUG - Updated appointment (AA00044761) customer contact data.
2025-11-17 13:04:18,240 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:04:18,242 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:04:19,080 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:04:19,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:04:19,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:04:24,202 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:04:24,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:04:24,745 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:04:26,758 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:04:26,862 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:04:26,977 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:04:27,048 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:04:27,048 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:04:38,324 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:05:38,326 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:05:49,942 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:05:57,117 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:05:57,118 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:05:59,241 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:06:00,260 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:06:00,264 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:06:00,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:06:00,346 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:06:00,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:06:01,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:06:01,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:06:01,800 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:06:01,802 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:06:05,446 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:06:05,449 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:06:06,434 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:06:06,438 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:06:06,441 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:06:06,444 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=from_aw_package, target=cart)}
2025-11-17 13:06:06,446 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:06:06,448 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:06:06,450 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:06:06,452 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:06:06,453 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:06:06,455 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:06:06,457 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:06:06,458 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:06:21,232 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 366, in _add_to_container_from_aw
    raise RuntimeError("Button 'Warenkorb' and 'Beratungsliste' are disabled")
RuntimeError: Button 'Warenkorb' and 'Beratungsliste' are disabled

2025-11-17 13:06:21,312 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:06:21,313 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:06:22,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:06:22,909 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:06:22,910 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 13:06:22,935 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:06:25,611 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 13:06:25,614 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:06:26,164 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-17 13:06:26,166 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:06:29,226 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 327
2025-11-17 13:06:29,227 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:06:30,102 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:06:30,110 - ispa_next.main - DEBUG - 



2025-11-17 13:06:30,110 - ispa_next.main - DEBUG - starting with process 2 (HF-PH 795) of 4
2025-11-17 13:06:30,114 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:06:31,255 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:06:32,440 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-17 13:06:32,441 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 327
2025-11-17 13:06:33,934 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:06:33,935 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:07:12,326 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:07:22,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:07:28,123 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:07:28,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:07:28,199 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:07:28,391 - ispa_next.functions - DEBUG - HU date already expired after 726 days.
2025-11-17 13:07:34,939 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:07:34,941 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:07:34,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:07:35,006 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:07:37,970 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:07:37,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:07:39,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:07:41,107 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:07:41,200 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:07:44,472 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:07:44,597 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:07:44,597 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:07:56,186 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:07:57,191 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:07:57,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:07:57,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:09,823 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:08:16,984 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:08:16,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:17,062 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:08:17,063 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:08:17,117 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:08:18,390 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:08:18,610 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:08:22,173 - ispa_next.functions - DEBUG - Updated appointment (AA00044755) customer contact data.
2025-11-17 13:08:23,090 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:08:23,091 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:08:23,761 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:08:23,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:08:24,554 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:08:28,151 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:08:28,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:08:28,660 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:08:30,666 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:08:30,789 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:08:30,916 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:08:30,999 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:08:30,999 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:08:42,204 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:08:49,598 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:08:49,599 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:08:53,802 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:08:54,808 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:08:54,810 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:08:54,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:08:54,918 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:08:59,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:59,639 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:59,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:09:00,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:09:00,362 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:09:05,168 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:09:05,170 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:09:06,357 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:09:06,358 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:09:06,361 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:09:06,363 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:09:06,365 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=HU/AU Dekra Lemgo, source=from_tab, target=cart)}
2025-11-17 13:09:06,366 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:09:06,376 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:09:06,379 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:09:06,385 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:09:06,388 - ispa_next.package_manager.main - DEBUG - found packages to delete: {Package(name=§ Fahrzeuguntersuchung, source=cart, target=trash)}
2025-11-17 13:09:06,390 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:09:06,392 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:09:06,395 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:09:07,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:09:07,883 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:09:25,029 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:09:25,030 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 13:09:27,525 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:09:28,046 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:09:28,985 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:09:29,538 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:09:30,059 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:09:31,841 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:09:32,399 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:09:32,933 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:09:33,850 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:09:34,418 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:09:34,952 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:09:35,918 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:09:36,535 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:09:37,062 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:09:37,983 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:09:38,554 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:09:39,135 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:09:40,053 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:09:40,632 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:09:41,165 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:09:42,120 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:09:42,721 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:09:43,257 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:09:44,188 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:09:44,739 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:09:45,318 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:09:46,269 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:09:47,279 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:09:47,342 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:09:47,349 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:09:53,396 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:09:53,398 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:09:53,409 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:09:59,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:09:59,922 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:10:11,211 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:10:27,352 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:10:27,353 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:10:27,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:10:28,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:10:28,418 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:10:28,421 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:10:34,380 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:10:34,382 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:10:34,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:10:35,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:10:35,648 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:10:46,178 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:10:50,231 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:10:55,349 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:11:01,122 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:11:01,123 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:11:01,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:11:01,722 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:11:01,723 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:11:05,034 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:11:14,167 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:11:14,554 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 13:11:15,562 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:16,083 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-17 13:11:16,084 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:11:19,252 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 327
2025-11-17 13:11:19,253 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:11:19,985 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:11:19,991 - ispa_next.main - DEBUG - 



2025-11-17 13:11:19,991 - ispa_next.main - DEBUG - starting with process 3 (HF-LF 3030) of 4
2025-11-17 13:11:19,996 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:11:20,925 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:21,815 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-17 13:11:21,817 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 327
2025-11-17 13:11:23,150 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:11:23,151 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:11:59,870 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:12:08,973 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:16,330 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:12:16,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:16,399 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:12:16,739 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:12:16,742 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:12:16,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:16,866 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:12:20,107 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:12:20,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:12:21,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:12:23,222 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:12:23,417 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:12:26,648 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:12:26,788 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:12:26,789 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:12:38,268 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:12:39,271 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:12:39,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:39,726 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:51,235 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:12:51,236 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 13:12:57,645 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:12:57,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:57,750 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:12:57,751 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:12:57,795 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:12:59,420 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:13:00,624 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:13:00,856 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:13:04,112 - ispa_next.functions - DEBUG - Updated appointment (AA00044696) customer contact data.
2025-11-17 13:13:05,052 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:13:05,054 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:13:05,888 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:13:05,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:13:06,644 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:13:10,494 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:13:10,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:13:11,006 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:13:13,009 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:13:13,128 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:13:13,257 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:13:13,398 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:13:13,398 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:13:24,397 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 13:13:31,794 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:13:31,794 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:13:35,953 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:13:36,959 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:13:36,961 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:13:36,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:13:37,042 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:13:37,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:38,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:38,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:13:38,732 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:13:38,733 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:13:45,762 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:13:45,766 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:13:46,988 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:13:46,991 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:13:46,995 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:13:46,998 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:13:47,002 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:13:47,004 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:13:47,007 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:13:47,008 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:13:47,010 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:13:47,011 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:13:47,012 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:13:47,015 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:13:47,017 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:13:47,019 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:13:47,019 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:13:55,255 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:13:55,256 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:13:55,258 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:03,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:03,351 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:14:12,278 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:30,366 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:14:30,368 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:14:30,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:14:31,315 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:14:31,578 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:53,188 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:14:53,192 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:01,259 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:15:01,262 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:15:01,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:15:02,378 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:15:02,516 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:15,900 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:15:21,027 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:15:27,698 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:15:27,699 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:15:28,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:15:28,603 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:15:28,604 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:15:32,161 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:15:40,996 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:15:41,384 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 13:15:42,406 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:15:42,954 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-17 13:15:42,955 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:15:45,956 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 327
2025-11-17 13:15:45,957 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:15:46,885 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:15:46,895 - ispa_next.main - DEBUG - 



2025-11-17 13:15:46,895 - ispa_next.main - DEBUG - starting with process 4 (HF-X 1020) of 4
2025-11-17 13:15:46,899 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:15:48,011 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:15:49,039 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-17 13:15:49,040 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 327
2025-11-17 13:15:50,308 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:15:50,309 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:16:23,892 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:16:34,937 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:16:43,126 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:16:43,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:43,207 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:16:43,402 - ispa_next.functions - DEBUG - HU date already expired after 78 days.
2025-11-17 13:16:51,336 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:16:51,339 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:16:51,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:51,406 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:17:01,753 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:17:01,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:17:03,036 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:17:05,039 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:17:05,175 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:17:08,468 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:17:15,555 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 13:17:16,559 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:17:16,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:17,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:31,183 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:17:38,727 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:17:38,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:38,817 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:17:38,818 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:17:38,892 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:17:40,168 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:17:41,371 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 13:17:42,622 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 13:17:42,984 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:17:46,017 - ispa_next.functions - DEBUG - Updated appointment (AA00044542) customer contact data.
2025-11-17 13:17:46,942 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:17:46,943 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:17:47,662 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:17:47,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:17:48,397 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:17:52,481 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:17:52,482 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:17:52,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:17:52,994 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:17:54,997 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:17:55,108 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:17:55,218 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:17:55,351 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:17:55,352 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:18:07,083 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:19:07,085 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:19:18,278 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:19:24,279 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:19:35,800 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:19:44,272 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 13:19:45,287 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:19:45,292 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:19:45,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:19:45,388 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:19:45,764 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:46,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:46,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:19:47,121 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:19:47,122 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:19:54,322 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:19:54,324 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:19:55,515 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:19:55,516 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:19:55,518 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart), Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=from_aw_package, target=cart)}
2025-11-17 13:19:55,524 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:19:55,528 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:19:55,531 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:19:55,534 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:19:55,536 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:19:55,538 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:19:55,539 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:19:55,541 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:20:09,569 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 366, in _add_to_container_from_aw
    raise RuntimeError("Button 'Warenkorb' and 'Beratungsliste' are disabled")
RuntimeError: Button 'Warenkorb' and 'Beratungsliste' are disabled

2025-11-17 13:20:09,583 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:20:09,585 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:20:10,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:20:11,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:20:11,027 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 13:20:11,048 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:20:13,992 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 13:20:13,995 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:20:14,550 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 606
2025-11-17 13:20:14,551 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:20:18,009 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 327
2025-11-17 13:20:18,010 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:20:18,934 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
