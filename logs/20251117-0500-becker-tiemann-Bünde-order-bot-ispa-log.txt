2025-11-17 05:00:36,121 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 05:00:36,161 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 05:00:49,600 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 05:01:03,823 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 05:01:19,652 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:03:17,854 - ispa_next.app_start.main - DEBUG - Operation already took 106.48 seconds (more than 80 seconds)
2025-11-17 05:03:19,938 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_jznebhtt_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_jznebhtt', 'txt']
2025-11-17 05:03:20,256 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 05:03:20,260 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 05:03:20,261 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:05:19,373 - ispa_next.app_start.main - DEBUG - Operation already took 106.75 seconds (more than 80 seconds)
2025-11-17 05:05:21,435 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_213cq65b_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_213cq65b', 'txt']
2025-11-17 05:05:21,675 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 05:05:21,679 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 05:05:29,673 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 05:05:38,760 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 05:05:49,012 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 05:06:04,480 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:08:02,386 - ispa_next.app_start.main - DEBUG - Operation already took 106.79 seconds (more than 80 seconds)
2025-11-17 05:08:04,466 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_9l9hsr00_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_9l9hsr00', 'txt']
2025-11-17 05:08:04,736 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 05:08:04,741 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 05:08:04,742 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:10:03,417 - ispa_next.app_start.main - DEBUG - Operation already took 106.30 seconds (more than 80 seconds)
2025-11-17 05:10:05,495 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess__yntlbgf_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess__yntlbgf', 'txt']
2025-11-17 05:10:05,720 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 05:10:05,724 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 05:10:13,746 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 05:10:21,200 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 05:10:32,251 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 05:10:47,840 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:12:45,346 - ispa_next.app_start.main - DEBUG - Operation already took 106.40 seconds (more than 80 seconds)
2025-11-17 05:12:47,403 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_pztrvrj8_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_pztrvrj8', 'txt']
2025-11-17 05:12:47,654 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 05:12:47,659 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 05:12:47,659 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:14:46,086 - ispa_next.app_start.main - DEBUG - Operation already took 106.11 seconds (more than 80 seconds)
2025-11-17 05:14:48,150 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_o74i979r_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_o74i979r', 'txt']
2025-11-17 05:14:48,380 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 05:14:48,384 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 05:14:56,106 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-17 05:15:04,849 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 05:15:16,559 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 05:15:32,164 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:17:29,802 - ispa_next.app_start.main - DEBUG - Operation already took 106.55 seconds (more than 80 seconds)
2025-11-17 05:17:31,868 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_415tnqi7_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_415tnqi7', 'txt']
2025-11-17 05:17:32,140 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 05:17:32,145 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 05:17:32,146 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:19:31,047 - ispa_next.app_start.main - DEBUG - Operation already took 106.58 seconds (more than 80 seconds)
2025-11-17 05:19:33,147 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_pmndzz35_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\3a202419e6af6f93\\tess_pmndzz35', 'txt']
2025-11-17 05:19:33,370 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 05:19:33,375 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 05:19:40,666 - ispa_next.main - DEBUG - ISPA Next attempt (5 / 5)
2025-11-17 05:19:49,676 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 05:19:59,965 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 05:20:15,364 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:20:56,862 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 05:21:11,792 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 05:21:15,292 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:21:16,317 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:21:16,319 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 05:21:18,496 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-17 05:21:18,498 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 05:21:18,499 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 05:21:19,616 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 05:21:20,712 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:21:41,549 - ispa_next.appointments.models - DEBUG - Appointment Mariya Aleksandrovna OS-UA 81 WBA4C11010G273031 ohne Termin.
2025-11-17 05:21:41,562 - ispa_next.appointments.models - DEBUG - Appointment Öezlem Cicek HF-OZ 84 WBA31AX010FP86133 ohne Termin.
2025-11-17 05:21:41,571 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-17 05:21:41,579 - ispa_next.appointments.models - DEBUG - Appointment Karlheinz Böttger HF-EK 2016 WBA2X71000V366813 ohne Termin.
2025-11-17 05:21:41,591 - ispa_next.main - DEBUG - Found 8 out of 41 appointments to process (configured limit: 15).
2025-11-17 05:21:41,592 - ispa_next.main - DEBUG - Processing 8 fresh appointments.
2025-11-17 05:21:41,592 - ispa_next.main - DEBUG - All appointments: HF-XN44, HF-X 1020, BÜNDE, HF-LB-222, HF L 1612, OS-CW177, HF-BT 540, BÜNDE
2025-11-17 05:21:41,595 - ispa_next.main - DEBUG - 



2025-11-17 05:21:41,595 - ispa_next.main - DEBUG - starting with process 1 (HF-XN44) of 8
2025-11-17 05:21:41,599 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:21:42,769 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:21:43,990 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:21:43,991 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-17 05:21:45,298 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:21:45,299 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:22:27,353 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:22:27,451 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 05:22:27,455 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:22:28,016 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:22:28,018 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:22:30,302 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 05:22:30,302 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:22:30,999 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Niedziela BI-HN 2212 WBA51EG0105X28500 ohne Termin.
2025-11-17 05:22:31,004 - ispa_next.main - DEBUG - Found new Appointment: HN-SB 580E
2025-11-17 05:22:31,004 - ispa_next.main - DEBUG - Found new Appointment: BI-KF 1204
2025-11-17 05:22:31,004 - ispa_next.main - DEBUG - Found new Appointment: HF-II 4
2025-11-17 05:22:31,005 - ispa_next.main - DEBUG - Found new Appointment: HF MC 912
2025-11-17 05:22:31,006 - ispa_next.main - DEBUG - 



2025-11-17 05:22:31,006 - ispa_next.main - DEBUG - starting with process 2 (HN-SB 580E) of 12
2025-11-17 05:22:31,010 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:22:32,051 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:22:33,049 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:22:33,050 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 05:22:34,284 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:22:34,285 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:22:56,806 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:23:06,506 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:23:09,031 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:23:09,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:23:09,093 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:23:09,279 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:23:09,281 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:23:09,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:23:09,361 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:23:12,647 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:23:12,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:23:13,660 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:23:15,668 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:23:15,796 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:23:15,913 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:23:16,027 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:23:16,028 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:23:27,221 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:23:28,224 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:23:28,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:23:28,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:23:37,943 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 05:23:44,924 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:23:44,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:23:45,004 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:23:45,005 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:23:45,043 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:23:46,246 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:23:46,534 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:23:49,687 - ispa_next.functions - DEBUG - Updated appointment (AA00044691) customer contact data.
2025-11-17 05:23:50,621 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:23:50,623 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:23:51,266 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:23:51,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:23:52,024 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:23:55,631 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:23:55,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:23:56,106 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:23:58,113 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:23:58,241 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:23:58,342 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:23:58,411 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:23:58,412 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:24:09,584 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:24:16,684 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:24:16,685 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:24:20,874 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:24:21,879 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:24:21,888 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:24:21,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:24:21,968 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:24:31,224 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 05:24:35,870 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 05:24:35,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:24:36,373 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:24:36,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:24:37,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:24:37,080 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:24:39,564 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:24:39,566 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:24:40,566 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:24:40,568 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:24:40,573 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 05:24:40,577 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 05:24:40,579 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-17 05:24:40,580 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:24:40,582 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:24:40,584 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:24:40,585 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:24:40,587 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:24:40,588 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:24:40,589 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:24:40,591 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 05:25:02,624 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-17 05:25:02,650 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:25:02,652 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:25:03,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:25:04,230 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:25:04,231 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 05:25:04,255 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 05:25:06,867 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 05:25:06,870 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:25:07,317 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:25:07,318 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:25:10,118 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 05:25:10,119 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:25:10,971 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Niedziela BI-HN 2212 WBA51EG0105X28500 ohne Termin.
2025-11-17 05:25:10,977 - ispa_next.main - DEBUG - 



2025-11-17 05:25:10,978 - ispa_next.main - DEBUG - starting with process 3 (BI-KF 1204) of 12
2025-11-17 05:25:10,981 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:25:12,137 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:25:13,209 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:25:13,211 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 05:25:14,589 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:25:14,591 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:25:36,408 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:25:38,615 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-17 05:25:43,578 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:25:46,790 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:25:46,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:25:46,861 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:25:47,216 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:25:47,218 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:25:47,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:25:47,346 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:25:50,356 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:25:50,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:25:51,376 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:25:53,378 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:25:53,475 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:25:53,598 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:25:53,688 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:25:53,688 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:26:04,874 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:26:05,878 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:26:05,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:26:06,440 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:26:15,605 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 05:26:18,872 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:26:18,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:26:18,987 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:26:18,988 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:26:19,017 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:26:20,213 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:26:20,497 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:26:21,682 - ispa_next.functions - DEBUG - Updated appointment (AD00025060) customer contact data.
2025-11-17 05:26:22,619 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:26:22,620 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:26:23,154 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:26:23,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:26:23,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:26:27,442 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:26:27,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:26:27,969 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:26:29,972 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:26:30,068 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:26:30,193 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:26:30,264 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:26:30,264 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:26:40,942 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:26:48,171 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:26:48,172 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:26:52,342 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:26:53,349 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:26:53,351 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:26:53,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:26:53,423 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:27:02,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:27:02,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:27:02,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:27:03,404 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:27:03,405 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:27:06,419 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:27:06,421 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:27:07,434 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:27:07,435 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:27:07,437 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 05:27:07,438 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 05:27:07,439 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:27:07,441 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:27:07,448 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:27:07,450 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:27:07,453 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:27:07,454 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:27:07,456 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:27:07,457 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:27:07,461 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:27:07,462 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:27:07,463 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:27:10,713 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:27:10,715 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:27:10,717 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:27:13,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:27:14,025 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:27:24,893 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:27:37,724 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:27:37,725 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:27:37,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 05:27:38,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 05:27:38,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:27:49,298 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:27:49,302 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:27:52,493 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:27:52,494 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:27:52,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:27:53,536 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:27:53,656 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:28:01,279 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:28:04,457 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:28:04,458 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:28:04,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:28:05,023 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:28:05,024 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:28:07,519 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 05:28:17,746 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:28:18,117 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 05:28:19,024 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:28:19,613 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:28:19,615 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:28:22,298 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 05:28:22,299 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:28:23,121 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Niedziela BI-HN 2212 WBA51EG0105X28500 ohne Termin.
2025-11-17 05:28:23,131 - ispa_next.main - DEBUG - 



2025-11-17 05:28:23,131 - ispa_next.main - DEBUG - starting with process 4 (HF-II 4) of 12
2025-11-17 05:28:23,249 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:28:24,144 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:28:25,107 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:28:25,108 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 05:28:26,427 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:28:26,428 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:28:50,608 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:28:52,562 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-17 05:28:57,669 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:29:03,109 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:29:03,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:03,178 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:29:03,393 - ispa_next.functions - DEBUG - HU date already expired after 874 days.
2025-11-17 05:29:06,742 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:29:06,744 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:29:06,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:06,809 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:29:13,001 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:29:13,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:29:14,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:29:16,048 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:29:16,171 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:29:16,264 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:29:16,338 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:29:16,338 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:29:27,283 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:29:28,298 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:29:28,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:28,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:39,765 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 05:29:43,773 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:29:43,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:43,841 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:29:43,844 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:29:43,891 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:29:44,004 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 05:29:45,251 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:29:45,509 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:29:46,833 - ispa_next.functions - DEBUG - Updated appointment (AD00025056) customer contact data.
2025-11-17 05:29:47,743 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:29:47,745 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:29:47,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:29:48,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:29:49,550 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:29:49,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:29:49,623 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 05:29:53,191 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:29:53,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:29:53,673 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:29:55,676 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:29:55,812 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:29:55,954 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:29:56,026 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:29:56,027 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:30:07,273 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:31:07,275 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:31:18,510 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:31:51,512 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:32:02,825 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 05:32:10,017 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 05:32:11,023 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:32:11,025 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:32:11,025 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:32:11,122 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:32:11,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:32:11,994 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:32:11,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:32:12,671 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:32:12,672 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:32:17,454 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:32:17,456 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:32:18,760 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:32:18,761 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:32:18,763 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 05:32:18,763 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 05:32:18,764 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:32:18,765 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:32:18,767 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:32:18,767 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:32:18,768 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:32:18,770 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:32:18,770 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:32:18,772 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:32:18,774 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:32:18,775 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:32:18,776 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:32:23,997 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:32:23,998 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:32:24,000 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:32:29,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:32:29,352 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:32:38,084 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:32:52,872 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:32:52,873 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:32:52,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 05:32:53,631 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 05:32:53,851 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:33:09,241 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:33:09,243 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:33:14,441 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:33:14,442 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:33:14,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:33:15,417 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:33:15,559 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:33:24,503 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:33:28,509 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:33:33,217 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:33:36,353 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:33:36,354 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:33:36,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:33:37,041 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:33:37,042 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:33:39,759 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 05:33:47,444 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:33:47,833 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 05:33:48,860 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:33:49,399 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:33:49,400 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:33:52,261 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 05:33:52,262 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:33:53,005 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Niedziela BI-HN 2212 WBA51EG0105X28500 ohne Termin.
2025-11-17 05:33:53,016 - ispa_next.main - DEBUG - 



2025-11-17 05:33:53,016 - ispa_next.main - DEBUG - starting with process 5 (HF MC 912) of 12
2025-11-17 05:33:53,019 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:33:54,154 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:33:55,276 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:33:55,277 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 05:33:56,602 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:33:56,603 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:34:38,792 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:34:38,805 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 05:34:38,810 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:34:39,218 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:34:39,218 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:34:41,641 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 05:34:41,642 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:34:42,395 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Niedziela BI-HN 2212 WBA51EG0105X28500 ohne Termin.
2025-11-17 05:34:42,400 - ispa_next.main - DEBUG - 



2025-11-17 05:34:42,400 - ispa_next.main - DEBUG - starting with process 6 (HF-X 1020) of 12
2025-11-17 05:34:42,403 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:34:43,634 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:34:44,702 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:34:44,703 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 05:34:45,951 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:34:45,952 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:35:11,802 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:35:22,242 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:35:30,210 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:35:30,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:35:30,273 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:35:30,531 - ispa_next.functions - DEBUG - HU date already expired after 78 days.
2025-11-17 05:35:37,839 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:35:37,841 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:35:37,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:35:37,970 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:35:48,196 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:35:48,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:35:49,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:35:51,222 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:35:51,325 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:35:54,525 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:35:54,584 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:35:54,585 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:36:05,869 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:36:06,873 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:36:06,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:36:07,414 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:36:21,596 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 05:36:29,200 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:36:29,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:36:29,278 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:36:29,279 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:36:29,364 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:36:30,623 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 05:36:31,750 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 05:36:32,930 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 05:36:33,295 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:36:35,890 - ispa_next.functions - DEBUG - Updated appointment (AA00044542) customer contact data.
2025-11-17 05:36:36,942 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:36:36,947 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:36:37,897 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:36:37,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:36:38,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:36:42,620 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 05:36:42,620 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:36:42,621 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:36:43,104 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:36:45,106 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:36:45,217 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:36:45,326 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:36:45,416 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:36:45,417 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:36:56,728 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:37:56,729 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:38:07,878 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:38:11,885 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:38:22,800 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:38:30,288 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:38:30,288 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:38:32,431 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:38:33,439 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:38:33,441 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:38:33,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:38:33,497 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:38:33,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:38:34,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:38:34,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:38:35,366 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:38:35,367 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:38:43,640 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:38:43,641 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:38:44,850 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:38:44,851 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:38:44,854 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=from_aw_package, target=cart), Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart)}
2025-11-17 05:38:44,856 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:38:44,858 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:38:44,859 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:38:44,860 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:38:44,861 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:38:44,862 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:38:44,864 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:38:44,866 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 05:39:43,311 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 05:39:43,312 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:39:43,314 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:39:43,314 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:39:54,098 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 05:39:59,777 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:39:59,778 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:39:59,780 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:40:10,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:40:10,632 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:40:20,854 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:40:41,384 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:40:41,385 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:40:41,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 05:40:42,156 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 05:40:42,240 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:40:55,119 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:40:55,121 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:41:05,820 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:41:05,821 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:41:06,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:41:06,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:41:06,876 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:41:18,770 - ispa_next.common.utils - DEBUG - Attempt 1/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 05:41:18,770 - ispa_next.common.utils - DEBUG - Attempt 1/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 1.0s
2025-11-17 05:41:21,196 - ispa_next.common.utils - DEBUG - Attempt 2/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 05:41:21,196 - ispa_next.common.utils - DEBUG - Attempt 2/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 2.0s
2025-11-17 05:41:24,567 - ispa_next.common.utils - DEBUG - Attempt 3/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 05:41:24,568 - ispa_next.common.utils - DEBUG - Attempt 3/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 4.0s
2025-11-17 05:41:29,960 - ispa_next.common.utils - DEBUG - Attempt 4/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 05:41:29,960 - ispa_next.common.utils - DEBUG - Attempt 4/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 8.0s
2025-11-17 05:41:39,298 - ispa_next.common.utils - DEBUG - Attempt 5/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 05:41:39,299 - ispa_next.common.utils - DEBUG - Attempt 5/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 16.0s
2025-11-17 05:41:56,674 - ispa_next.common.utils - DEBUG - Attempt 6/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 05:41:56,980 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 126, in process_appointment
    f.check_cart_packages_for_parts_service_and_parts_availability(app, appointment, state)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\functions.py", line 390, in check_cart_packages_for_parts_service_and_parts_availability
    retry_ui_action(open_job_details_view, condition=job_details_view_exists, base_delay=1.0)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\utils.py", line 254, in retry_ui_action
    raise RetryUiActionError(f"UI action failed after {max_attempts} attempts: Condition never satisfied")
ispa_next.exceptions.RetryUiActionError: UI action failed after 6 attempts: Condition never satisfied

2025-11-17 05:41:56,994 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:41:56,995 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:41:57,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:41:57,754 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:41:57,755 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 05:41:57,778 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 05:42:00,850 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 05:42:00,852 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:42:01,393 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:42:01,395 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:42:04,179 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 05:42:04,179 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:42:05,018 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Niedziela BI-HN 2212 WBA51EG0105X28500 ohne Termin.
2025-11-17 05:42:05,023 - ispa_next.main - DEBUG - 



2025-11-17 05:42:05,023 - ispa_next.main - DEBUG - starting with process 7 (BÜNDE) of 12
2025-11-17 05:42:05,026 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:42:06,145 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:42:07,297 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:42:07,298 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 05:42:08,829 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:42:08,831 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:42:39,824 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:42:39,835 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 05:42:39,838 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:42:40,291 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:42:40,292 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:42:43,028 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 05:42:43,029 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:42:43,798 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Niedziela BI-HN 2212 WBA51EG0105X28500 ohne Termin.
2025-11-17 05:42:43,803 - ispa_next.main - DEBUG - 



2025-11-17 05:42:43,803 - ispa_next.main - DEBUG - starting with process 8 (HF-LB-222) of 12
2025-11-17 05:42:43,806 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:42:44,916 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:42:46,383 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:42:46,384 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 05:42:47,675 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:42:47,676 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:43:29,861 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:43:29,871 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 05:43:29,873 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:43:30,414 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:43:30,416 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:43:32,865 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 05:43:32,866 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:43:33,645 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Niedziela BI-HN 2212 WBA51EG0105X28500 ohne Termin.
2025-11-17 05:43:33,650 - ispa_next.main - DEBUG - 



2025-11-17 05:43:33,650 - ispa_next.main - DEBUG - starting with process 9 (HF L 1612) of 12
2025-11-17 05:43:33,654 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:43:34,822 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:43:35,898 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:43:35,899 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 05:43:37,270 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:43:37,271 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:44:08,284 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:44:08,298 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 05:44:08,311 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:44:08,757 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:44:08,758 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:44:11,057 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 05:44:11,058 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:44:12,183 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Niedziela BI-HN 2212 WBA51EG0105X28500 ohne Termin.
2025-11-17 05:44:12,189 - ispa_next.main - DEBUG - 



2025-11-17 05:44:12,189 - ispa_next.main - DEBUG - starting with process 10 (OS-CW177) of 12
2025-11-17 05:44:12,192 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:44:13,374 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:44:14,383 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:44:14,384 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 05:44:15,571 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:44:15,572 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:44:51,890 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:44:51,899 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 05:44:51,902 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:44:52,299 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:44:52,300 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:44:54,714 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 05:44:54,714 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:44:55,515 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Niedziela BI-HN 2212 WBA51EG0105X28500 ohne Termin.
2025-11-17 05:44:55,520 - ispa_next.main - DEBUG - 



2025-11-17 05:44:55,520 - ispa_next.main - DEBUG - starting with process 11 (HF-BT 540) of 12
2025-11-17 05:44:55,523 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:44:56,611 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:44:57,815 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:44:57,817 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 05:44:59,447 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:44:59,449 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:45:22,667 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:45:32,681 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:45:36,627 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:45:36,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:45:36,740 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:45:36,899 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:45:36,901 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:45:36,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:45:36,976 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:45:40,047 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:45:40,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:45:41,177 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:45:43,183 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:45:43,406 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:45:46,784 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:45:46,843 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:45:46,843 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:45:58,107 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:45:59,112 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:45:59,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:45:59,632 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:46:11,805 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 05:46:11,805 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 05:46:19,220 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:46:19,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:46:19,286 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:46:19,287 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:46:19,369 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:46:20,610 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:46:20,856 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:46:24,500 - ispa_next.functions - DEBUG - Updated appointment (AE00024535) customer contact data.
2025-11-17 05:46:25,422 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:46:25,424 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:46:26,256 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:46:26,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:46:27,084 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:46:30,682 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:46:30,684 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:46:31,157 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:46:33,161 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:46:33,251 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:46:33,383 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:46:33,444 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:46:33,444 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:46:44,619 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:46:51,966 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:46:51,967 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:46:56,207 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:46:57,213 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:46:57,216 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:46:57,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:46:57,333 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:47:06,670 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 05:47:12,100 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 05:47:12,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:47:12,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:47:12,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:47:13,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:47:13,339 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:47:16,946 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:47:16,948 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:47:17,983 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:47:17,984 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:47:17,986 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 05:47:17,987 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 05:47:17,988 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-17 05:47:17,989 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:47:17,991 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:47:17,992 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:47:17,993 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:47:18,000 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:47:18,003 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:47:18,007 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:47:18,010 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 05:47:40,518 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-17 05:47:40,545 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:47:40,546 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:47:41,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:47:42,224 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:47:42,225 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 05:47:42,247 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 05:47:45,020 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 05:47:45,023 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:47:45,464 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:47:45,465 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:47:48,209 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 05:47:48,210 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:47:49,278 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Niedziela BI-HN 2212 WBA51EG0105X28500 ohne Termin.
2025-11-17 05:47:49,285 - ispa_next.main - DEBUG - 



2025-11-17 05:47:49,285 - ispa_next.main - DEBUG - starting with process 12 (BÜNDE) of 12
2025-11-17 05:47:49,291 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:47:50,377 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:47:51,586 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:47:51,587 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 05:47:52,884 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:47:52,885 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:48:33,598 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:48:33,609 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 05:48:33,612 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:48:34,027 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 583
2025-11-17 05:48:34,028 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:48:36,346 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 05:48:36,347 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:48:37,159 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Niedziela BI-HN 2212 WBA51EG0105X28500 ohne Termin.
