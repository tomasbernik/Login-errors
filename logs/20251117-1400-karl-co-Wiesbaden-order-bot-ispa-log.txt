2025-11-17 14:07:37,880 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 14:07:37,889 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 14:07:48,644 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:07:58,942 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:08:14,399 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:10:12,623 - ispa_next.app_start.main - DEBUG - Operation already took 106.94 seconds (more than 80 seconds)
2025-11-17 14:10:14,679 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e26a5e6121cc561f\\tess_50b_e8eb_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e26a5e6121cc561f\\tess_50b_e8eb', 'txt']
2025-11-17 14:10:14,920 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 14:10:14,925 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 14:10:14,926 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:10:41,985 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 14:10:54,016 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 14:10:57,152 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:10:58,209 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1363
2025-11-17 14:10:58,209 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 60
2025-11-17 14:11:00,807 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 57
2025-11-17 14:11:00,808 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 14:11:00,808 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:11:02,192 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:11:03,584 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:11:10,748 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:11:10,752 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:11:10,753 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:11:10,753 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:11:10,754 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:11:10,754 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:11:10,754 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:11:10,760 - ispa_next.main - DEBUG - Found 5 out of 11 appointments to process (configured limit: 15).
2025-11-17 14:11:10,760 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-17 14:11:10,760 - ispa_next.main - DEBUG - All appointments: M-SD 2265, F-MM 6900E, F-WP 94, LG-MY 777, Gl-I 8008
2025-11-17 14:11:10,778 - ispa_next.main - DEBUG - 



2025-11-17 14:11:10,778 - ispa_next.main - DEBUG - starting with process 1 (M-SD 2265) of 5
2025-11-17 14:11:10,782 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:11:12,062 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:11:13,342 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1363
2025-11-17 14:11:13,344 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 57
2025-11-17 14:11:14,929 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:11:14,932 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:11:55,780 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:12:06,038 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:12:06,113 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:12:06,298 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:12:07,557 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:12:07,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:12:07,646 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:12:07,861 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:12:07,864 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:12:10,629 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:12:10,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:12:11,708 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:12:13,714 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:12:13,849 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:12:17,096 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:12:17,206 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:12:17,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:12:18,526 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:12:29,683 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:12:30,687 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:12:30,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:12:31,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:12:41,948 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:12:48,643 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:12:48,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:12:48,707 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:12:48,707 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:12:48,801 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:12:50,122 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:12:50,364 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:12:55,867 - ispa_next.functions - DEBUG - Updated appointment (AE00049891) customer contact data.
2025-11-17 14:12:56,789 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:12:56,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:12:56,995 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:12:58,778 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:12:59,334 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:12:59,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:12:59,943 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:13:03,507 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:13:03,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:13:04,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:13:06,006 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:13:06,097 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:13:06,222 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:13:06,295 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:13:06,296 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:07,602 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:13:19,150 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:13:26,499 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:13:26,501 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:27,801 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:13:32,003 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:13:33,010 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:13:33,012 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:13:33,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:13:33,122 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:13:37,262 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:13:37,266 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:13:37,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:13:37,329 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:13:42,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:13:43,397 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:13:43,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:13:44,098 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:13:44,098 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:13:45,437 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:13:45,439 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:13:46,411 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:13:46,415 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:13:46,417 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 14:13:46,420 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 14:13:46,422 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:13:46,426 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:13:46,426 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:13:46,428 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:13:46,428 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:13:46,430 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:13:46,432 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:13:46,432 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:13:47,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:13:47,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:13:59,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:14:00,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:14:13,629 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:14:13,630 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:14:13,632 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:14:13,632 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:14:16,224 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:14:16,226 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:14:16,228 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:14:18,722 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:14:18,724 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:14:18,747 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:14:18,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:14:21,323 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:14:35,252 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:14:35,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:14:36,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:14:36,693 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:14:48,918 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:14:48,918 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:14:49,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:14:49,821 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:14:49,821 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:14:55,579 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:15:06,616 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:15:06,994 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 14:15:09,264 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:15:10,247 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1364
2025-11-17 14:15:10,249 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:15:13,421 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 60
2025-11-17 14:15:13,422 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:15:14,297 - ispa_next.main - DEBUG - 



2025-11-17 14:15:14,298 - ispa_next.main - DEBUG - starting with process 2 (F-MM 6900E) of 5
2025-11-17 14:15:14,302 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:15:15,594 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:15:17,069 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1364
2025-11-17 14:15:17,070 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 60
2025-11-17 14:15:18,782 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:15:18,784 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:15:45,854 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:15:54,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:55,046 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:15:55,244 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:15:56,475 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:15:56,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:56,560 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:15:56,757 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:15:56,759 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:15:59,661 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:15:59,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:16:00,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:16:02,875 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:16:03,011 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:16:06,269 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:16:06,337 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:16:06,376 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:16:07,621 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:16:19,239 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:16:20,244 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:16:20,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:16:20,771 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:16:32,798 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:16:40,828 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:16:40,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:16:40,893 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:16:40,895 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:16:40,933 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:16:42,247 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:16:43,471 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:16:43,718 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:16:49,185 - ispa_next.functions - DEBUG - Updated appointment (AE00049890) customer contact data.
2025-11-17 14:16:50,089 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:16:50,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:16:50,171 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:16:51,776 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:16:52,419 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:16:52,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:16:53,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:16:56,600 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:16:56,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:16:57,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:16:59,111 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:16:59,248 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:16:59,361 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:16:59,426 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:16:59,427 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:17:00,669 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:17:11,395 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:17:18,751 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:17:18,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:17:20,018 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:17:24,223 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:17:25,229 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:17:25,231 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:17:25,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:25,340 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:17:29,469 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:17:29,473 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:17:29,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:29,546 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:17:39,660 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 14:17:44,993 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 14:17:45,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:45,537 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:45,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:46,261 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:17:46,263 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:17:47,567 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:17:47,569 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:17:48,530 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:17:48,533 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:17:48,537 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 14:17:48,547 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 14:17:48,556 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:17:48,560 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:17:48,561 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=advice_list)}
2025-11-17 14:17:48,562 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:17:48,564 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:17:48,564 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:17:48,569 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:17:48,574 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:17:49,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:17:49,964 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:18:01,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:18:02,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:18:15,433 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:18:15,435 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 14:18:35,536 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:18:35,538 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 14:18:41,363 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:18:41,365 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:18:41,366 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:44,112 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:18:44,114 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:18:44,115 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:46,634 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:18:46,636 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:18:46,636 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:18:46,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:49,204 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:19:03,403 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:19:04,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:19:04,794 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:19:05,032 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:18,185 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:19:18,185 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:19:18,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:19:18,892 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:19:18,892 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:19:24,269 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:19:33,380 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:19:33,775 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 14:19:35,171 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:19:36,097 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1364
2025-11-17 14:19:36,099 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:19:39,454 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 60
2025-11-17 14:19:39,455 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:19:40,329 - ispa_next.main - DEBUG - 



2025-11-17 14:19:40,329 - ispa_next.main - DEBUG - starting with process 3 (F-WP 94) of 5
2025-11-17 14:19:40,336 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:19:41,704 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:19:43,138 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1364
2025-11-17 14:19:43,141 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 60
2025-11-17 14:19:44,653 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:19:44,654 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:20:12,928 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:20:23,848 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:20:26,450 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:20:26,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:26,517 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:20:26,899 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:20:26,901 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:20:29,609 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:20:29,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:20:30,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:20:32,521 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:20:32,632 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:20:32,739 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:20:32,804 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:20:37,035 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:20:38,041 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:20:38,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:38,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:50,354 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:20:50,355 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:20:58,237 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:20:58,238 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:58,311 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:20:58,313 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:20:58,359 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:20:59,595 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:20:59,813 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:21:05,364 - ispa_next.functions - DEBUG - Updated appointment (AE00049883) customer contact data.
2025-11-17 14:21:06,274 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:21:06,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:06,423 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:06,585 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 14:21:06,586 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:21:07,386 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:21:07,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:21:08,134 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:21:11,754 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:21:11,754 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:21:11,765 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:21:11,765 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:21:11,767 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:21:12,269 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:21:16,377 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:21:17,024 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:21:29,234 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:21:29,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:21:29,384 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:21:39,019 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 14:21:44,443 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 14:21:44,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:44,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:44,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:21:45,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:21:45,771 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:21:48,262 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:21:48,264 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:21:49,606 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:21:49,610 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:21:49,614 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 14:21:49,616 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 14:21:49,618 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:21:49,622 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:21:49,624 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=advice_list)}
2025-11-17 14:21:49,624 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:21:49,627 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:21:49,628 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:21:49,630 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:21:49,632 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:21:50,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:21:51,225 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:22:04,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:22:05,475 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:22:19,344 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:22:19,345 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 14:22:39,921 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:22:39,923 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 14:22:47,026 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:22:47,028 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:22:47,029 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:22:51,191 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:22:51,192 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:22:51,197 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:22:55,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:55,813 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:23:04,868 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:20,385 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:23:20,387 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:23:20,389 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:23:20,392 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:24,453 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:23:43,296 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:23:44,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:23:44,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:23:45,179 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:13,024 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:24:13,024 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:24:14,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:24:14,334 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:24:14,336 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:24:20,936 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:24:32,266 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:24:32,646 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 14:24:35,082 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:24:35,996 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1364
2025-11-17 14:24:35,998 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:24:40,336 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 60
2025-11-17 14:24:40,337 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:24:41,556 - ispa_next.main - DEBUG - 



2025-11-17 14:24:41,556 - ispa_next.main - DEBUG - starting with process 4 (LG-MY 777) of 5
2025-11-17 14:24:41,560 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:24:43,503 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:24:45,491 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1364
2025-11-17 14:24:45,494 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 60
2025-11-17 14:24:47,629 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:24:47,630 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:25:09,474 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 14:25:09,607 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 14:25:09,613 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:25:10,628 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1364
2025-11-17 14:25:10,629 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:25:14,674 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 60
2025-11-17 14:25:14,675 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:25:16,343 - ispa_next.main - DEBUG - 



2025-11-17 14:25:16,343 - ispa_next.main - DEBUG - starting with process 5 (Gl-I 8008) of 5
2025-11-17 14:25:16,356 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:25:18,303 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:25:20,065 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1364
2025-11-17 14:25:20,068 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 60
2025-11-17 14:25:21,922 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:25:21,923 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:25:58,637 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:26:12,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:18,562 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:26:18,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:18,654 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:26:19,060 - ispa_next.functions - DEBUG - HU date already expired after 29 days.
2025-11-17 14:26:29,311 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:26:29,314 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:26:32,206 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:26:32,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:26:33,806 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:26:35,810 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:26:35,950 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:26:36,080 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:26:36,234 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:26:36,234 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:42,566 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:26:53,659 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:27:01,591 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:27:01,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:27:07,972 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:27:12,248 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:27:13,264 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:27:13,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:13,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:31,376 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:27:41,315 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:27:41,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:41,433 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:27:41,433 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:27:41,480 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:27:42,933 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:27:43,220 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:27:49,684 - ispa_next.functions - DEBUG - Updated appointment (AE00049841) customer contact data.
2025-11-17 14:27:50,658 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:27:50,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:50,889 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:27:51,196 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 14:27:51,198 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:27:52,612 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:27:52,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:27:53,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:27:58,310 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:27:58,310 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:27:58,383 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:27:58,384 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:27:58,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:27:59,011 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:28:03,184 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:28:03,189 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:28:03,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:28:03,280 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:28:07,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:08,086 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:08,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:28:08,896 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:28:08,896 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:28:15,023 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:28:15,025 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:28:16,235 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:28:16,235 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:28:16,237 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 14:28:16,239 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 14:28:16,239 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:28:16,241 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:28:16,243 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:28:16,243 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:28:16,245 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:28:16,247 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:28:16,249 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:28:16,251 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:28:16,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:28:17,787 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:28:31,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:28:32,532 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:28:46,970 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:28:46,972 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:28:46,974 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:28:46,974 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:55,233 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 14:28:58,664 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:28:58,696 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:28:58,706 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:29:07,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:29:07,646 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:29:18,659 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:29:18,659 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:29:18,661 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:29:18,677 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:29:27,194 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:29:47,933 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:29:48,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:29:49,599 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:29:49,884 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:11,182 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:31:17,586 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:31:24,648 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:31:31,801 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:31:38,717 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:31:45,944 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:31:52,431 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:31:58,703 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:32:05,787 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:32:11,139 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:32:18,241 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:32:18,243 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:32:18,243 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:32:19,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:32:19,396 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:32:19,398 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:32:22,035 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:32:35,333 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:32:35,708 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 14:32:38,614 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:32:39,579 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1364
2025-11-17 14:32:39,580 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:32:43,295 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 60
2025-11-17 14:32:43,295 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
