2025-11-12 07:01:24,997 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 07:01:25,015 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 07:01:35,879 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:01:49,037 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:02:04,831 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:02:31,058 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 07:02:53,081 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 07:02:57,713 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:02:59,545 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:02:59,547 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 07:03:02,471 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 380
2025-11-12 07:03:02,472 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 07:03:02,472 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:03:03,981 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:03:05,504 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:04:21,737 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,741 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,768 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,774 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,798 - ispa_next.appointments.models - DEBUG - Appointment Siegfried Geißler  WBA51EG0505W23667 ohne Termin.
2025-11-12 07:04:21,821 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,822 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,854 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,870 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,892 - ispa_next.appointments.models - DEBUG - Appointment Frau Alexandra Wolf BA-AW 555 WBY8P210607K30883 ohne Termin.
2025-11-12 07:04:21,893 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,893 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,894 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,894 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,896 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,896 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,921 - ispa_next.appointments.models - DEBUG - Appointment Gasthof Dinkel LIF-JD 555 WBSJF010X0G965188 ohne Termin.
2025-11-12 07:04:21,934 - ispa_next.appointments.models - DEBUG - Appointment Firma Minges Kaffeerösterei GmbH BA-MK 540 WBA11GR0409Y69237 ohne Termin.
2025-11-12 07:04:21,938 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,938 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:21,995 - ispa_next.appointments.models - DEBUG - Appointment Herr Bastian Stern HÖS-S 1312 WBA4J51020BN80220 ohne Termin.
2025-11-12 07:04:22,007 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:22,008 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:22,033 - ispa_next.appointments.models - DEBUG - Appointment Herr Stephan Nätscher BA-MN 1019 WBA7K310307J40556 ohne Termin.
2025-11-12 07:04:22,049 - ispa_next.appointments.models - DEBUG - Appointment Firma Kraftanlagen Energies & M-KA 2446 WBA41EG0905Z23353 ohne Termin.
2025-11-12 07:04:22,057 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:22,079 - ispa_next.appointments.models - DEBUG - Appointment Frau Franziska Berg BA-JP 1720 WMWLN710202E75045 ohne Termin.
2025-11-12 07:04:22,088 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:22,103 - ispa_next.appointments.models - DEBUG - Appointment Herr Jürgen Manfred Suppe BA-SU 380 WBY61EF0305W96365 ohne Termin.
2025-11-12 07:04:22,115 - ispa_next.appointments.models - DEBUG - Appointment Herr Gunter Kirsch BA-BK 746 WBA2E510205G50991 ohne Termin.
2025-11-12 07:04:22,117 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:22,132 - ispa_next.appointments.models - DEBUG - Appointment Firma Andreas Wagner Vertriebs GmbH HAS-W 3690 WBA15BZ070N298504 ohne Termin.
2025-11-12 07:04:22,137 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:22,189 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:22,247 - ispa_next.appointments.models - DEBUG - Appointment Firma Erlanger Treuhand GmbH ER-TR 70E WBA21GV020CU74535 ohne Termin.
2025-11-12 07:04:22,258 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:22,285 - ispa_next.appointments.models - DEBUG - Appointment Herr Joseph Köberlein BA-ZZ 900 WBABK71050ER63535 ohne Termin.
2025-11-12 07:04:22,303 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:22,325 - ispa_next.appointments.models - DEBUG - Appointment Frau Aslihan Karaman NÖ-AK 5252 WBAHT710305K01893 ohne Termin.
2025-11-12 07:04:22,346 - ispa_next.appointments.models - DEBUG - Appointment Generalstaatsanwaltschaft BA-N 1017E WBA51BX0607T37782 ohne Termin.
2025-11-12 07:04:22,380 - ispa_next.appointments.models - DEBUG - Appointment Herr Josef Reuß KG-TR 899 WBA8H91030A719314 ohne Termin.
2025-11-12 07:04:22,415 - ispa_next.appointments.models - DEBUG - Appointment Firma Elektro Weis GmbH & Co. KG BA-XX 621 WMW61DL0503P86044 ohne Termin.
2025-11-12 07:04:22,445 - ispa_next.appointments.models - DEBUG - Appointment Frau Birgitta Helmstetter BA-A 607 WBA7K310507K49097 ohne Termin.
2025-11-12 07:04:22,448 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:22,463 - ispa_next.appointments.models - DEBUG - Appointment Herr Wolfgang Kießwetter BA-CL 16 WBA4A51060D408079 ohne Termin.
2025-11-12 07:04:22,477 - ispa_next.appointments.models - DEBUG - Appointment Firma bornheim GmbH & Co. KG BA-M 180 WBA11GF0107R40264 ohne Termin.
2025-11-12 07:04:22,492 - ispa_next.appointments.models - DEBUG - Appointment Herr Adam Jacek Kesminowicz BA-KA 91 WBAHT710505J98589 ohne Termin.
2025-11-12 07:04:22,508 - ispa_next.appointments.models - DEBUG - Appointment Frau Inge Kimbrough WUN-NY 111 WBA31AD0303L79467 ohne Termin.
2025-11-12 07:04:22,523 - ispa_next.appointments.models - DEBUG - Appointment Herr Peter Kupsch BA-PK 12 WBAHS910805H68893 ohne Termin.
2025-11-12 07:04:22,538 - ispa_next.appointments.models - DEBUG - Appointment Frau Jennifer Crayne ERH-JD 604 WMW51DK0102T47698 ohne Termin.
2025-11-12 07:04:22,538 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:04:22,560 - ispa_next.appointments.models - DEBUG - Appointment Herr Rainer Andreas Rebel BA-TR 2003 WBAPP11070E794980 ohne Termin.
2025-11-12 07:04:22,585 - ispa_next.appointments.models - DEBUG - Appointment Herr Mohammad Al Ahmad BA-SY 222 WBA8T31090BX94248 ohne Termin.
2025-11-12 07:04:22,611 - ispa_next.appointments.models - DEBUG - Appointment Herr Mario Kämpf ASL-MH 810 WBA11AB0005U74034 ohne Termin.
2025-11-12 07:04:22,636 - ispa_next.appointments.models - DEBUG - Appointment Frau Martina Zeißler EBS-MZ 181 WBA1S510605A79963 ohne Termin.
2025-11-12 07:04:22,664 - ispa_next.appointments.models - DEBUG - Appointment Frau Christine Roppelt BA-CR 4422 WBAJG110X03G84879 ohne Termin.
2025-11-12 07:04:22,686 - ispa_next.appointments.models - DEBUG - Appointment Frau Ulrike Starker BA-US 96 WBA8H71040K803544 ohne Termin.
2025-11-12 07:04:22,702 - ispa_next.appointments.models - DEBUG - Appointment Firma MG-Nährmittel Produktservice BA-M 8013 WBSAE01020CE87488 ohne Termin.
2025-11-12 07:04:22,717 - ispa_next.appointments.models - DEBUG - Appointment Herr Alexander Erdpohl BA-AE 779 WBA8H91000K868189 ohne Termin.
2025-11-12 07:04:22,791 - ispa_next.main - DEBUG - Found 15 out of 221 appointments to process (configured limit: 15).
2025-11-12 07:04:22,792 - ispa_next.main - DEBUG - Processing 0 fresh appointments.
2025-11-12 07:04:22,793 - ispa_next.main - DEBUG - Processing 15 already visited appointments (w/ RKR not callable).
2025-11-12 07:04:22,793 - ispa_next.main - DEBUG - All appointments: FO-MX 186, BA-CT 97, BA-PM 1007, BA-EK 33, BA-FS 2002, BA-PE 76, ER-S 2305E, BA-CR 4422, BA-L 938, BA-AR 4321, BA-A 1284, FÜ-H 2234, BA-F 2008E, BA-CL 16, BA-NZ 1609
2025-11-12 07:04:22,806 - ispa_next.main - DEBUG - 



2025-11-12 07:04:22,807 - ispa_next.main - DEBUG - starting with process 1 (FO-MX 186) of 15
2025-11-12 07:04:22,844 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:04:24,413 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:04:26,007 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:04:26,009 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 380
2025-11-12 07:04:28,145 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:04:28,146 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:05:05,299 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:05:07,830 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:05:13,630 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:05:15,583 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:05:15,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:05:15,716 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:05:16,030 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 07:05:21,232 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:05:21,237 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:05:21,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:05:21,320 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:05:29,701 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:05:29,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:05:31,091 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:05:33,095 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:05:33,266 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:05:33,416 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:05:33,509 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:05:37,769 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:05:38,785 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:05:38,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:05:39,350 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:05:55,406 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:06:00,731 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:06:00,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:06:00,881 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:06:00,882 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:06:01,069 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:06:02,569 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:06:02,952 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:06:05,767 - ispa_next.functions - DEBUG - Updated appointment (AC00040980) customer contact data.
2025-11-12 07:06:06,706 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:06:06,712 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:06:07,836 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:06:07,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:06:08,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:06:12,846 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:06:12,846 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:06:12,853 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:06:12,854 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:06:12,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:06:13,393 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:06:17,549 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:06:17,558 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:06:17,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:06:17,681 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:06:21,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:06:22,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:06:22,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:06:22,922 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:06:22,925 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:06:24,896 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:06:24,900 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:06:27,367 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:06:27,369 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:06:27,376 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:06:27,383 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:06:27,391 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:06:27,394 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:06:27,397 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:06:27,404 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:06:27,405 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:06:27,411 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:06:27,418 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:06:27,424 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:06:27,425 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:06:29,501 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:06:29,508 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:06:29,511 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:06:31,528 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:06:31,528 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:06:31,531 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:06:33,565 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:06:33,576 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:06:33,581 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:06:35,626 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:06:53,777 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:06:54,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:06:55,346 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:06:55,556 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:07:14,698 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:07:20,097 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:07:20,104 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:07:20,105 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:07:21,025 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:07:21,123 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:07:21,129 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:07:23,588 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:07:36,630 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:07:37,065 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 07:07:37,765 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:07:41,538 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:07:41,540 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:07:46,868 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 07:07:46,869 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:07:47,918 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:07:47,920 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:07:47,932 - ispa_next.main - DEBUG - 



2025-11-12 07:07:47,932 - ispa_next.main - DEBUG - starting with process 2 (BA-CT 97) of 15
2025-11-12 07:07:47,942 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:07:49,389 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:07:51,240 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:07:51,242 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 07:07:53,137 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:07:53,138 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:08:33,261 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:08:35,532 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:08:41,259 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:08:43,292 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:08:43,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:08:43,368 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:08:43,747 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:08:43,758 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:08:43,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:08:43,897 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:08:55,072 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:08:55,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:08:56,329 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:08:58,334 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:08:58,498 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:08:58,649 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:08:58,736 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:09:00,923 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:09:01,929 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:09:01,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:09:02,730 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:09:17,050 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:09:22,343 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:09:22,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:09:22,504 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:09:22,505 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:09:22,585 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:09:22,767 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:09:24,540 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:09:24,891 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:09:28,167 - ispa_next.functions - DEBUG - Updated appointment (AC00040950) customer contact data.
2025-11-12 07:09:29,122 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:09:29,128 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:09:29,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:09:30,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:09:31,675 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:09:31,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:09:31,751 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:09:35,419 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:09:35,419 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:09:35,424 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:09:35,425 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:09:35,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:09:35,962 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:09:40,110 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:09:44,740 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:09:44,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:09:44,901 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:09:45,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:09:45,956 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:09:45,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:09:46,772 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:09:46,781 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:09:48,947 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:09:48,982 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:09:54,334 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:09:54,337 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:09:54,344 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:09:54,346 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:09:54,354 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:09:54,355 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:09:54,362 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:09:54,363 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:09:54,369 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:09:54,376 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:09:54,386 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:09:54,388 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:09:56,667 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:09:56,673 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:09:56,676 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:09:58,708 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:09:58,708 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:09:58,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:10:00,911 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:10:00,916 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:10:00,918 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:10:03,021 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:10:19,819 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:10:20,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:10:21,303 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:10:21,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:10:41,684 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:10:47,378 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:10:47,385 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:10:47,386 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:10:48,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:10:48,338 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:10:48,344 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:10:50,917 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:11:01,975 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:11:02,380 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 07:11:03,107 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:11:07,053 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:11:07,054 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:11:10,563 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 07:11:10,565 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:11:11,593 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:11:11,595 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:11:11,608 - ispa_next.main - DEBUG - 



2025-11-12 07:11:11,609 - ispa_next.main - DEBUG - starting with process 3 (BA-PM 1007) of 15
2025-11-12 07:11:11,618 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:11:13,100 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:11:14,828 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:11:14,830 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 07:11:16,914 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:11:16,916 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:11:51,145 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:11:53,503 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:11:59,305 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:12:00,628 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:12:00,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:00,750 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:12:01,104 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:12:01,111 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:12:01,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:01,289 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:12:04,512 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:12:04,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:12:05,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:12:07,761 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:12:07,935 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:12:08,065 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:12:08,263 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:12:12,488 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:12:13,494 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:12:13,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:14,014 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:27,927 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:12:27,928 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:12:33,049 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:12:33,051 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:33,222 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:12:33,223 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:12:33,341 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:12:34,861 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:12:35,260 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:12:38,365 - ispa_next.functions - DEBUG - Updated appointment (AC00041241) customer contact data.
2025-11-12 07:12:39,309 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:12:39,313 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:12:40,401 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:12:40,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:12:41,357 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:12:45,015 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:12:45,015 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:12:45,020 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:12:45,021 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:12:45,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:12:45,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:12:49,959 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:12:49,975 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:12:49,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:12:50,098 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:12:55,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:56,370 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:56,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:12:57,277 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:12:57,282 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:12:58,646 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:12:58,648 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:13:00,795 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:13:00,823 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:13:00,831 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:13:00,832 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:13:00,838 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:13:00,839 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:13:00,840 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:13:00,846 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:13:00,847 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:13:00,853 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:13:00,861 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:13:00,869 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:13:00,869 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:13:02,262 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:13:02,268 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:13:02,270 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:13:03,658 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:13:03,658 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:13:03,660 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:13:05,088 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:13:05,094 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:13:05,098 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:13:06,446 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:13:22,908 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:13:23,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:13:24,290 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:13:24,552 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:13:39,277 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:13:39,281 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:13:39,282 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:13:40,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:13:40,187 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:13:40,194 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:13:42,753 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:13:53,515 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:13:53,945 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 07:13:54,729 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:13:56,752 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:13:56,753 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:14:00,762 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 07:14:00,762 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:14:01,864 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:14:01,866 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:14:01,874 - ispa_next.main - DEBUG - 



2025-11-12 07:14:01,874 - ispa_next.main - DEBUG - starting with process 4 (BA-EK 33) of 15
2025-11-12 07:14:01,880 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:14:03,339 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:14:04,968 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:14:04,970 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 07:14:06,963 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:14:06,965 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:14:39,548 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:14:42,052 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:14:48,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:14:51,689 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:14:51,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:14:52,143 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:14:52,506 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:14:52,518 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:14:52,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:14:52,712 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:14:55,940 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:14:55,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:14:57,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:14:59,413 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:14:59,550 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:14:59,728 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:14:59,802 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:15:04,056 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:15:05,064 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:15:05,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:05,608 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:20,606 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:15:20,607 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:15:25,700 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:15:25,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:25,851 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:15:25,852 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:15:25,923 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:15:27,505 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:15:27,889 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:15:31,457 - ispa_next.functions - DEBUG - Updated appointment (AC00041222) customer contact data.
2025-11-12 07:15:32,451 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:15:32,457 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:15:33,517 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:15:33,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:15:34,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:15:38,140 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:15:38,140 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:15:38,145 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:15:38,146 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:15:38,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:15:38,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:15:42,992 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:15:43,000 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:15:43,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:15:43,132 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:15:52,307 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 07:16:00,827 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-12 07:16:07,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:16:07,733 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:16:07,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:16:08,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:16:08,578 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:16:10,671 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:16:10,673 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:16:13,086 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:16:13,088 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:16:13,095 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:16:13,098 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:16:13,106 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:16:13,108 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:16:13,109 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:16:13,115 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:16:13,116 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:16:13,122 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:16:13,129 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:16:13,136 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:16:13,136 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:16:15,224 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:16:15,228 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:16:15,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:16:17,628 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:16:17,628 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:16:17,632 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:16:19,680 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:16:19,686 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:16:19,693 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:16:21,763 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:16:39,062 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:16:39,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:16:40,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:16:40,789 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:17:01,260 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:17:06,718 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:17:06,723 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:17:06,723 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:17:07,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:17:07,702 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:17:07,721 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:17:10,292 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:17:21,488 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:17:21,879 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 07:17:22,694 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:17:25,263 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:17:25,264 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:17:29,460 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 07:17:29,461 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:17:30,631 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:17:30,633 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:17:30,642 - ispa_next.main - DEBUG - 



2025-11-12 07:17:30,642 - ispa_next.main - DEBUG - starting with process 5 (BA-FS 2002) of 15
2025-11-12 07:17:30,648 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:17:32,128 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:17:33,867 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:17:33,868 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 07:17:35,941 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:17:35,942 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:18:08,624 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:18:10,891 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:18:17,078 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:18:19,181 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:18:19,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:19,319 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:18:19,577 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:18:19,589 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:18:19,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:19,730 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:18:28,547 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:18:28,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:18:29,962 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:18:31,967 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:18:32,122 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:18:32,253 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:18:32,346 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:18:36,587 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:18:37,605 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:18:37,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:38,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:53,518 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:18:59,027 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:18:59,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:59,200 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:18:59,201 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:18:59,321 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:19:00,854 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:19:01,243 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:19:04,843 - ispa_next.functions - DEBUG - Updated appointment (AC00040970) customer contact data.
2025-11-12 07:19:05,810 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:19:05,851 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:19:06,923 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:19:06,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:19:08,039 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:19:11,642 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:19:11,642 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:19:11,647 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:19:11,648 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:19:11,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:19:12,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:19:16,333 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:19:16,339 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:19:16,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:19:16,490 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:19:16,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:19:17,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:19:17,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:19:18,582 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:19:18,587 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:19:20,666 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:19:20,668 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:19:22,938 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:19:22,940 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:19:22,948 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:19:22,950 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:19:22,957 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:19:22,958 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:19:22,959 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:19:22,965 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:19:22,966 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:19:22,972 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:19:22,985 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:19:22,992 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:19:22,992 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:19:25,135 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:19:25,139 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:19:25,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:19:27,151 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:19:27,151 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:19:27,154 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:19:29,211 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:19:29,217 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:19:29,220 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:19:31,238 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:19:51,584 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:19:52,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:19:53,594 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:19:53,830 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:20:14,094 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:20:20,054 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:20:20,059 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:20:20,059 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:20:20,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:20:21,079 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:20:21,086 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:20:23,712 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:20:34,913 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:20:35,322 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 07:20:36,174 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:20:38,512 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:20:38,513 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:20:42,299 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 07:20:42,300 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:20:43,435 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:20:43,437 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:20:43,450 - ispa_next.main - DEBUG - 



2025-11-12 07:20:43,450 - ispa_next.main - DEBUG - starting with process 6 (BA-PE 76) of 15
2025-11-12 07:20:43,459 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:20:44,908 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:20:46,514 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:20:46,515 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 07:20:48,636 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:20:48,637 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:21:23,817 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:21:26,555 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:21:32,982 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:36,371 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:21:36,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:21:36,488 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:21:36,774 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:21:36,782 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:21:36,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:21:36,941 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:21:40,527 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:21:40,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:21:42,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:21:44,203 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:21:44,371 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:21:44,543 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:21:44,675 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:21:48,928 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:21:49,934 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:21:49,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:21:50,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:05,540 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:22:11,243 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:22:11,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:11,412 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:22:11,413 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:22:11,549 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:22:13,039 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:22:14,509 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:22:14,885 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:22:18,259 - ispa_next.functions - DEBUG - Updated appointment (AC00040790) customer contact data.
2025-11-12 07:22:19,305 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:22:19,310 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:22:20,662 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:22:20,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:22:21,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:22:25,299 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:22:25,299 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:22:25,304 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:22:25,305 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:22:25,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:22:25,883 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:22:30,053 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:22:30,059 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:22:30,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:22:30,140 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:22:39,302 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 07:22:49,943 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:22:50,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:50,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:50,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:22:51,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:22:51,733 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:22:55,049 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:22:55,051 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:22:57,301 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:22:57,303 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:22:57,309 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:22:57,310 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:22:57,316 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:22:57,317 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:22:57,319 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:22:57,325 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:22:57,326 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:22:57,334 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:22:57,341 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:22:57,347 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:22:57,348 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:00,875 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:23:00,881 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:23:00,885 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:04,261 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:23:04,261 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:23:04,263 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:07,658 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:23:07,665 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:23:07,667 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:11,026 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:23:30,170 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:23:30,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:23:31,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:23:31,913 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:04,948 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:24:10,184 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:24:15,980 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:24:22,254 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:24:22,259 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:24:22,259 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:24:23,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:24:23,294 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:24:23,298 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:24:26,037 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:24:37,839 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:24:38,275 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 07:24:39,221 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:24:41,704 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:24:41,705 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:24:45,667 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 07:24:45,668 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:24:46,664 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:24:46,666 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:24:46,678 - ispa_next.main - DEBUG - 



2025-11-12 07:24:46,678 - ispa_next.main - DEBUG - starting with process 7 (ER-S 2305E) of 15
2025-11-12 07:24:46,684 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:24:50,379 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:24:53,178 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:24:53,180 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 07:24:55,451 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:24:55,452 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:25:29,900 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:25:32,763 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:25:38,614 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:41,321 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:25:41,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:41,407 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:25:41,785 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:25:41,794 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:25:41,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:41,935 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:25:45,474 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:25:45,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:25:46,950 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:25:48,953 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:25:49,160 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:25:49,290 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:25:49,419 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:25:53,769 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:25:54,796 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:25:54,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:55,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:13,025 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:26:18,657 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:26:18,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:18,768 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:26:18,814 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:26:18,957 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:26:20,431 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:26:20,833 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:26:24,701 - ispa_next.functions - DEBUG - Updated appointment (AC00041046) customer contact data.
2025-11-12 07:26:25,714 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:26:25,720 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:26:26,713 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:26:26,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:26:27,757 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:26:31,396 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:26:31,396 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:26:31,405 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:26:31,406 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:26:31,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:31,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:26:36,148 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:26:36,154 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:26:36,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:36,315 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:26:45,417 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 07:26:51,622 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:26:51,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:52,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:52,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:53,626 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:26:53,632 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:26:56,449 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:26:56,451 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:26:58,955 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:26:58,956 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:26:58,963 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:26:58,964 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:26:58,970 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:26:58,971 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:26:58,977 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:26:58,978 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:26:58,985 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:26:58,997 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:26:59,003 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:26:59,004 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:27:01,946 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:27:01,952 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:27:01,955 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:27:04,708 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:27:04,708 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:27:04,710 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:27:07,441 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:27:07,448 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:27:07,451 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:27:10,137 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:27:27,446 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:27:28,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:27:28,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:27:29,085 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:27:56,266 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:28:01,644 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:28:10,549 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:28:10,556 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:28:10,557 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:28:11,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:28:11,724 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:28:11,730 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:28:14,355 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:28:25,671 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:28:26,057 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 07:28:27,070 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:28:29,290 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:28:29,292 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:28:34,308 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 07:28:34,309 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:28:35,490 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:28:35,491 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:28:35,499 - ispa_next.main - DEBUG - 



2025-11-12 07:28:35,499 - ispa_next.main - DEBUG - starting with process 8 (BA-CR 4422) of 15
2025-11-12 07:28:35,505 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:28:37,029 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:28:38,738 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:28:38,740 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 07:28:40,999 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:28:41,001 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:29:18,031 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:29:20,880 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:29:26,925 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:29,649 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:29:29,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:29:29,768 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:29:30,126 - ispa_next.functions - DEBUG - HU date already expired after 780 days.
2025-11-12 07:29:35,625 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:29:35,630 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:29:35,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:29:35,707 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:29:44,117 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:29:44,119 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:29:45,559 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:29:47,563 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:29:47,764 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:29:47,919 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:29:48,083 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:29:52,274 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:29:53,281 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:29:53,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:29:53,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:09,060 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:30:09,069 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:30:14,647 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:30:14,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:14,807 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:30:14,808 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:30:14,925 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:30:15,149 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:30:16,779 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:30:17,114 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:30:20,862 - ispa_next.functions - DEBUG - Updated appointment (AC00041239) customer contact data.
2025-11-12 07:30:21,874 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:30:21,878 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:30:22,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:30:23,266 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:30:24,485 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:30:24,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:30:24,562 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:30:28,366 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:30:28,366 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:30:28,371 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:30:28,372 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:30:28,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:28,964 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:30:33,184 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:30:33,193 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:30:33,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:33,381 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:30:37,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:38,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:38,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:39,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:30:39,005 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:30:41,638 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:30:41,640 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:30:44,662 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:30:44,664 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:30:44,672 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:30:44,674 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:30:44,681 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:30:44,683 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:30:44,684 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:30:44,690 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:30:44,691 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:30:44,696 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:30:44,704 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:30:44,712 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:30:44,713 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:48,521 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:30:48,528 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:30:48,531 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:51,248 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:30:51,248 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:30:51,250 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:53,990 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:30:53,996 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:30:54,001 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:56,764 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:31:13,910 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:31:14,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:31:15,462 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:31:15,665 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:42,899 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:31:48,327 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:31:54,172 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:31:54,180 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:31:54,181 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:31:55,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:31:55,198 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:31:55,227 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:31:58,147 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:32:10,015 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:32:10,432 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 07:32:11,274 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:32:13,773 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:32:13,775 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:32:18,969 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 07:32:18,970 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:32:19,999 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:32:20,001 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:32:20,013 - ispa_next.main - DEBUG - 



2025-11-12 07:32:20,013 - ispa_next.main - DEBUG - starting with process 9 (BA-L 938) of 15
2025-11-12 07:32:20,024 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:32:21,510 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:32:23,303 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:32:23,304 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 07:32:25,383 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:32:25,386 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:33:02,543 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:33:05,153 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:33:11,749 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:14,631 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:33:14,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:14,748 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:33:14,988 - ispa_next.functions - DEBUG - HU date already expired after 322 days.
2025-11-12 07:33:20,651 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:33:20,658 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:33:20,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:20,736 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:33:29,776 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:33:29,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:33:31,452 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:33:33,455 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:33:33,656 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:33:33,804 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:33:33,918 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:33:38,188 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:33:39,199 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:33:39,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:39,766 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:55,460 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:34:01,671 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:34:01,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:01,785 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:34:01,786 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:34:01,927 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:34:02,112 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:34:03,744 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:34:04,112 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:34:07,512 - ispa_next.functions - DEBUG - Updated appointment (AC00041260) customer contact data.
2025-11-12 07:34:08,538 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:34:08,544 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:34:08,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:34:10,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:34:11,868 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:34:11,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:34:11,994 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:34:16,059 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:34:16,059 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:34:16,067 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:34:16,068 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:34:16,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:34:16,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:34:20,822 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:34:20,832 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:34:20,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:34:20,924 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:34:21,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:21,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:21,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:34:22,953 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:34:22,957 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:34:25,826 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:34:25,829 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:34:28,169 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:34:28,170 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:34:28,177 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:34:28,184 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:34:28,190 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:34:28,191 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:34:28,192 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:34:28,198 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:34:28,199 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:34:28,205 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:34:28,213 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:34:28,219 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:34:28,220 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:31,148 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:34:31,154 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:34:31,156 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:33,965 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:34:33,965 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:34:33,967 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:36,736 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:34:36,740 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:34:36,742 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:39,622 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:34:57,937 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:34:58,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:34:59,501 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:34:59,730 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:26,113 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:31,641 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:40,228 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:40,233 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:35:40,234 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:35:41,130 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:35:41,294 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:35:41,298 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:35:44,113 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:35:56,761 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:35:57,187 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 07:35:58,096 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:36:00,755 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:36:00,757 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:36:04,853 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 487
2025-11-12 07:36:04,854 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:36:06,100 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:36:06,101 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:36:06,109 - ispa_next.main - DEBUG - 



2025-11-12 07:36:06,109 - ispa_next.main - DEBUG - starting with process 10 (BA-AR 4321) of 15
2025-11-12 07:36:06,115 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:36:07,633 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:36:09,559 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:36:09,560 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 487
2025-11-12 07:36:11,899 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:36:11,901 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:36:51,654 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:36:54,128 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:37:00,521 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:01,794 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:37:01,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:02,049 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:37:02,505 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:37:02,513 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:37:02,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:02,693 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:37:06,048 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:37:06,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:37:07,891 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:37:09,894 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:37:10,077 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:37:10,182 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:37:10,323 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:37:14,595 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:37:15,611 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:37:15,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:16,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:34,114 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:37:40,305 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:37:40,307 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:40,477 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:37:40,478 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:37:40,546 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:37:42,015 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:37:44,955 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:37:45,761 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:37:49,703 - ispa_next.functions - DEBUG - Updated appointment (AC00041090) customer contact data.
2025-11-12 07:37:50,667 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:37:50,688 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:37:52,359 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:37:52,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:37:53,557 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:37:57,275 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:37:57,275 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:37:57,281 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:37:57,281 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:37:57,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:37:57,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:38:01,971 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:38:01,981 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:38:01,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:38:02,087 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:38:06,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:38:06,618 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:38:06,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:38:07,465 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:38:07,469 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:38:08,887 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:38:08,889 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:38:11,314 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:38:11,317 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:38:11,324 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:38:11,326 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:38:11,334 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:38:11,336 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:38:11,337 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:38:11,343 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:38:11,344 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:38:11,350 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:38:11,358 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:38:11,364 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:38:11,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:12,737 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:38:12,741 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:38:12,743 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:14,127 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:38:14,128 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:38:14,130 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:15,433 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:38:15,439 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:38:15,442 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:16,845 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:38:35,699 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:38:36,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:38:37,292 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:38:37,527 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:50,696 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:50,700 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:38:50,701 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:38:51,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:38:51,735 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:38:51,739 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:38:54,298 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:39:06,113 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:39:06,549 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 07:39:07,517 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:39:10,113 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:39:10,114 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:39:13,915 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 487
2025-11-12 07:39:13,916 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:39:14,993 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:39:14,995 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:39:15,008 - ispa_next.main - DEBUG - 



2025-11-12 07:39:15,008 - ispa_next.main - DEBUG - starting with process 11 (BA-A 1284) of 15
2025-11-12 07:39:15,018 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:39:16,548 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:39:18,318 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 07:39:18,320 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 487
2025-11-12 07:39:20,490 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:39:20,491 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:39:55,444 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:39:58,047 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:40:04,472 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:05,859 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:40:05,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:05,937 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:40:06,265 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:40:06,270 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:40:06,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:06,349 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:40:15,331 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:40:15,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:40:16,909 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:40:18,911 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:40:19,070 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:40:19,258 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:40:19,387 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:40:23,633 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:40:24,643 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:40:24,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:25,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:43,170 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:40:49,458 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:40:49,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:49,573 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:40:49,574 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:40:49,682 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:40:51,234 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:40:52,676 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:40:53,060 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:40:57,165 - ispa_next.functions - DEBUG - Updated appointment (AE00025445) customer contact data.
2025-11-12 07:40:58,116 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:40:58,137 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:40:59,257 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:40:59,258 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:41:00,430 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:41:04,026 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:41:04,026 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:41:04,031 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:41:04,032 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:41:04,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:41:04,615 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:41:08,749 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:41:08,757 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:41:08,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:41:08,924 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:41:12,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:13,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:13,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:41:14,297 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:41:14,301 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:41:15,928 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:41:15,930 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:41:18,300 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:41:18,301 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:41:18,306 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:41:18,307 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:41:18,314 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:41:18,315 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:41:18,316 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:41:18,322 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:41:18,324 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:41:18,329 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:41:18,337 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:41:18,344 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:41:18,344 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:19,754 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:41:19,761 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:41:19,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:21,406 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:41:21,406 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:41:21,432 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:22,816 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:41:22,823 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:41:22,828 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:24,220 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:41:41,697 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:41:42,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:41:43,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:41:43,631 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:56,921 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:41:56,925 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:41:56,926 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:41:57,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:41:57,895 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:41:57,902 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:42:00,655 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:42:12,396 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:42:12,826 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 07:42:13,695 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:42:16,557 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1685
2025-11-12 07:42:16,558 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:42:21,080 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 487
2025-11-12 07:42:21,081 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:42:22,137 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:42:22,138 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:42:22,146 - ispa_next.main - DEBUG - 



2025-11-12 07:42:22,146 - ispa_next.main - DEBUG - starting with process 12 (FÜ-H 2234) of 15
2025-11-12 07:42:22,152 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:42:23,802 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:42:25,538 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1685
2025-11-12 07:42:25,540 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 487
2025-11-12 07:42:27,725 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:42:27,726 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:43:06,860 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:43:09,556 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:43:16,356 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:43:17,691 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:43:17,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:17,771 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:43:18,143 - ispa_next.functions - DEBUG - HU date soon to be invalid in 9 days.
2025-11-12 07:43:23,745 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:43:23,753 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:43:23,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:23,990 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:43:27,473 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:43:27,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:43:29,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:43:31,211 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:43:31,350 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:43:31,493 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:43:31,663 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:43:35,905 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:43:36,912 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:43:36,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:37,528 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:55,548 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:44:02,030 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:44:02,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:02,233 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:44:02,235 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:44:02,375 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:44:03,894 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:44:04,293 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:44:08,658 - ispa_next.functions - DEBUG - Updated appointment (AC00041005) customer contact data.
2025-11-12 07:44:09,618 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:44:09,738 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:44:10,883 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:44:10,884 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:44:12,288 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:44:15,902 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:44:15,902 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:44:15,907 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:44:15,908 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:44:15,909 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:44:16,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:44:20,657 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:44:20,664 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:44:20,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:44:20,784 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:44:26,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:26,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:26,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:44:28,040 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:44:28,043 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:44:29,490 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:44:29,491 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:44:31,968 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:44:31,970 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:44:31,975 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:44:31,977 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:44:31,983 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:44:31,984 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:44:31,985 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:44:31,994 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:44:31,996 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:44:32,002 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:44:32,009 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:44:32,016 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:44:32,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:44:33,504 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:44:33,510 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:44:33,513 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:44:34,901 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:44:34,901 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:44:34,904 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:44:36,245 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:44:36,249 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:44:36,251 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:44:37,588 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:44:55,752 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:44:56,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:44:57,440 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:44:57,645 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:12,029 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:45:12,035 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:45:12,036 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:45:12,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:45:12,985 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:45:12,995 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:45:15,535 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:45:27,417 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:45:27,799 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 07:45:28,708 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:45:31,570 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1685
2025-11-12 07:45:31,572 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:45:35,686 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 487
2025-11-12 07:45:35,687 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:45:36,858 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:45:36,860 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:45:36,873 - ispa_next.main - DEBUG - 



2025-11-12 07:45:36,873 - ispa_next.main - DEBUG - starting with process 13 (BA-F 2008E) of 15
2025-11-12 07:45:36,882 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:45:38,478 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:45:40,137 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1685
2025-11-12 07:45:40,138 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 487
2025-11-12 07:45:42,677 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:45:42,678 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:46:19,766 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:46:22,497 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:46:29,598 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:46:30,984 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:46:30,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:31,141 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:46:31,405 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:46:31,413 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:46:31,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:31,540 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:46:34,862 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:46:34,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:46:36,554 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:46:38,556 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:46:38,743 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:46:38,919 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:46:39,045 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:46:43,250 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:46:44,261 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:46:44,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:44,818 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:58,660 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:47:04,893 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:47:04,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:05,077 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:47:05,078 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:47:05,168 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:47:06,708 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:47:08,159 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:47:08,498 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:47:12,103 - ispa_next.functions - DEBUG - Updated appointment (AC00041326) customer contact data.
2025-11-12 07:47:13,059 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:47:13,244 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:47:14,756 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:47:14,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:47:15,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:47:19,623 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:47:19,623 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:47:19,628 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:47:19,629 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:47:19,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:47:20,209 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:47:24,454 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:47:24,461 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:47:24,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:47:24,564 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:47:24,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:25,578 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:25,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:47:26,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:47:26,404 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:47:27,921 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:47:27,926 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:47:32,862 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:47:32,864 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:47:32,871 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:47:32,906 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:47:32,915 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:47:32,916 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:47:32,918 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:47:32,925 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:47:32,927 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:47:32,934 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:47:32,943 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:47:32,949 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:47:32,950 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:34,353 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:47:34,359 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:47:34,362 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:35,761 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:47:35,761 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:47:35,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:37,164 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:47:37,170 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:47:37,173 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:38,554 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:47:56,369 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:47:57,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:47:58,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:47:58,298 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:48:12,743 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:48:12,747 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:48:12,748 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:48:13,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:48:13,766 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:48:13,776 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:48:16,549 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:48:28,125 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:48:28,525 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 07:48:29,461 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:48:32,243 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1685
2025-11-12 07:48:32,244 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:48:36,238 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 487
2025-11-12 07:48:36,239 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:48:37,305 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:48:37,307 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:48:37,318 - ispa_next.main - DEBUG - 



2025-11-12 07:48:37,318 - ispa_next.main - DEBUG - starting with process 14 (BA-CL 16) of 15
2025-11-12 07:48:37,324 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:48:38,894 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:48:40,732 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1685
2025-11-12 07:48:40,733 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 487
2025-11-12 07:48:43,058 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:48:43,059 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:49:21,270 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:49:23,840 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:49:30,806 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:49:32,220 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:49:32,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:49:32,330 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:49:32,667 - ispa_next.functions - DEBUG - HU date already expired after 24 days.
2025-11-12 07:49:38,592 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:49:38,599 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:49:38,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:49:38,787 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:49:48,386 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:49:48,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:49:50,060 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:49:52,090 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:49:52,267 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:49:52,482 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:49:52,688 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:49:56,909 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:49:57,915 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:49:57,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:49:58,443 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:12,716 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:50:19,260 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:50:19,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:19,380 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:50:19,381 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:50:19,466 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:50:20,882 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:50:21,244 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:50:24,793 - ispa_next.functions - DEBUG - Updated appointment (AC00041245) customer contact data.
2025-11-12 07:50:25,734 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:50:25,742 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:50:27,740 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:50:27,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:50:29,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:50:32,718 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:50:32,718 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:50:32,723 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:50:32,724 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:50:32,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:50:33,306 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:50:37,503 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:50:37,510 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:50:37,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:50:37,632 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:50:41,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:42,169 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:42,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:50:42,973 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:50:42,978 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:50:44,387 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:50:44,390 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:50:46,921 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:50:46,924 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:50:46,931 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:50:46,932 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:50:46,939 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:50:46,940 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:50:46,941 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:50:46,947 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:50:46,948 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:50:46,954 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:50:46,962 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:50:46,969 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:50:46,970 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:50:48,376 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 07:50:52,100 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:50:52,120 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:50:52,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:50:53,705 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:50:53,705 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:50:53,709 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:50:55,041 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:50:55,047 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:50:55,060 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:50:56,394 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:51:14,180 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:51:14,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:51:15,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:51:16,055 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:51:30,665 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:51:30,669 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:51:30,670 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:51:31,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:51:31,711 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:51:31,725 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:51:34,694 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:51:46,544 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:51:46,926 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 07:51:48,056 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:51:50,829 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1685
2025-11-12 07:51:50,830 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:51:55,197 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 487
2025-11-12 07:51:55,198 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:51:56,376 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:51:56,377 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:51:56,390 - ispa_next.main - DEBUG - 



2025-11-12 07:51:56,390 - ispa_next.main - DEBUG - starting with process 15 (BA-NZ 1609) of 15
2025-11-12 07:51:56,400 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:51:58,043 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:51:59,768 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1685
2025-11-12 07:51:59,769 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 487
2025-11-12 07:52:02,292 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:52:02,294 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:52:45,253 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:52:48,001 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:52:54,922 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:52:56,954 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:52:56,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:52:57,141 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:52:57,543 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:52:57,551 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:52:57,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:52:57,684 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:53:06,926 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:53:06,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:53:08,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:53:10,548 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:53:10,684 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:53:10,779 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:53:10,942 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:53:15,226 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:53:16,238 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:53:16,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:53:16,801 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:53:31,392 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:53:38,261 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:53:38,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:53:38,342 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:53:38,376 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:53:38,505 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:53:39,995 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:53:41,560 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:53:41,938 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:53:45,531 - ispa_next.functions - DEBUG - Updated appointment (AC00041097) customer contact data.
2025-11-12 07:53:46,489 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:53:46,681 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:53:48,360 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:53:48,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:53:49,684 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:53:53,282 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:53:53,282 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:53:53,287 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:53:53,288 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:53:53,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:53:53,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:53:57,980 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:53:57,989 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:53:57,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:53:58,123 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:53:58,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:53:59,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:53:59,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:53:59,982 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:53:59,988 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:54:02,122 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:54:02,124 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:54:04,882 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:54:04,884 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:54:04,891 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:54:04,892 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:54:04,898 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:54:04,899 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:54:04,900 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:54:04,907 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:54:04,909 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:54:04,914 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:54:04,922 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:54:04,928 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:54:04,929 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:54:07,156 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:54:07,163 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:54:07,165 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:54:09,267 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:54:09,267 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:54:09,270 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:54:11,301 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:54:11,307 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:54:11,309 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:54:13,435 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:54:30,865 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:54:31,586 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:54:32,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:54:32,714 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:54:43,868 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:54:43,869 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:54:44,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:54:44,907 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:54:44,914 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:54:51,872 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 07:55:03,692 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:55:04,143 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 07:55:05,118 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:55:07,779 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1686
2025-11-12 07:55:07,781 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:55:12,119 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 07:55:12,120 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:55:13,263 - ispa_next.appointments.models - DEBUG - Appointment Moritz Ronicke BA-MR 45 WBA6L510X0FH87940 ohne Termin.
2025-11-12 07:55:13,267 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:55:13,268 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
