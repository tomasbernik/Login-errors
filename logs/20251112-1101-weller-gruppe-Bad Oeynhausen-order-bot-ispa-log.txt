2025-11-12 11:08:23,708 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:08:23,716 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:08:35,188 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:08:45,888 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:09:01,737 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:09:27,161 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:09:42,287 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:09:45,601 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:47,127 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 308
2025-11-12 11:09:47,129 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 11:09:50,390 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 70
2025-11-12 11:09:50,391 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:09:50,391 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:09:51,864 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:09:53,335 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:05,800 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:05,830 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:05,855 - ispa_next.main - DEBUG - Found 6 out of 8 appointments to process (configured limit: 15).
2025-11-12 11:10:05,856 - ispa_next.main - DEBUG - Processing 2 fresh appointments.
2025-11-12 11:10:05,857 - ispa_next.main - DEBUG - Processing 4 already visited appointments (w/ RKR not callable).
2025-11-12 11:10:05,857 - ispa_next.main - DEBUG - All appointments: HF-KT 524, mi mp 200, GT-WK 7070, OS-MW 37, MI-JH356, MI-EI 121E
2025-11-12 11:10:05,860 - ispa_next.main - DEBUG - 



2025-11-12 11:10:05,860 - ispa_next.main - DEBUG - starting with process 1 (HF-KT 524) of 6
2025-11-12 11:10:05,869 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:10:07,341 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:08,884 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 308
2025-11-12 11:10:08,886 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 70
2025-11-12 11:10:10,622 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:10,624 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:48,491 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:11:00,906 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:09,129 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:11:09,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:09,249 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:11:09,608 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:11:09,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:09,781 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:11:17,681 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:11:20,675 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:11:20,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:11:21,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:11:23,921 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:11:24,097 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:11:24,198 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:11:24,370 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:11:24,372 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:33,438 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:11:42,518 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:11:43,522 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:11:43,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:44,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:54,380 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:12:03,548 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:12:03,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:03,682 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:03,683 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:12:03,785 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:12:05,302 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:12:07,074 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:12:07,405 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:12:09,368 - ispa_next.functions - DEBUG - Updated appointment (AA00050509) customer contact data.
2025-11-12 11:12:10,367 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:12:10,369 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:12:11,570 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:12:11,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:12:12,499 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:12:16,112 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:12:16,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:16,650 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:18,653 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:12:18,788 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:12:18,935 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:12:19,016 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:12:19,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:27,408 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:12:35,962 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:13:35,965 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:13:47,749 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 11:13:52,274 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:13:52,276 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:14:01,062 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:14:05,288 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:14:06,293 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:14:06,294 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:14:06,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:14:06,438 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:14:10,553 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:14:11,481 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:14:26,660 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:14:26,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:14:26,869 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:14:27,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:14:27,875 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:14:27,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:14:28,963 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:14:28,964 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:14:36,681 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:14:36,700 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:14:38,740 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:14:38,743 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:14:38,746 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart), Package(name=Interne Qualitätssicherung, source=from_tab, target=cart)}
2025-11-12 11:14:38,747 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:14:38,750 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 11:14:38,751 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:14:38,754 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:14:38,755 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:14:38,757 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:14:38,759 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:14:39,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:14:40,623 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:14:48,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:14:49,109 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:15:06,439 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:15:06,441 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 11:15:12,097 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:12,668 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:13,219 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:14,908 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:15,468 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:16,017 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:17,660 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:18,212 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:18,760 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:20,378 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:20,928 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:21,496 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:23,080 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:23,642 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:24,204 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:25,825 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:26,374 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:26,930 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:28,496 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:29,058 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:29,617 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:31,198 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:31,750 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:32,300 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:35,159 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:35,713 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:36,275 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:37,948 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:38,506 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:39,072 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:40,689 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:41,272 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:41,829 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:43,484 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:44,049 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:44,603 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:46,298 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:15:46,862 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:15:47,416 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 11:15:47,978 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1630, 0)
2025-11-12 11:15:48,528 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1620, 0)
2025-11-12 11:15:49,079 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1610, 0)
2025-11-12 11:15:49,631 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1600, 0)
2025-11-12 11:15:49,631 - ispa_next.package_manager.helper - DEBUG - Error during package identification in cart detail view
2025-11-12 11:15:51,638 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 266, in run
    self._process_to_advice_list(self.to_advice_list)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 234, in _process_to_advice_list
    self.ui_helper.cart_operation(self.base_element, move_to_container)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 551, in cart_operation
    raise e
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 507, in cart_operation
    raise ValueError("Package not found in cart operation.")
ValueError: Package not found in cart operation.

2025-11-12 11:15:52,203 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:15:52,204 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:15:54,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:15:55,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:15:55,498 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 11:15:55,583 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:16:02,754 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:16:02,758 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:04,218 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 308
2025-11-12 11:16:04,220 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:11,213 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 11:16:11,214 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:13,130 - ispa_next.main - DEBUG - 



2025-11-12 11:16:13,130 - ispa_next.main - DEBUG - starting with process 2 (mi mp 200) of 6
2025-11-12 11:16:13,135 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:16:16,096 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:19,483 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 308
2025-11-12 11:16:19,489 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 11:16:24,787 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:24,789 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:17:12,171 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:17:12,183 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:17:12,187 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:17:13,541 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 308
2025-11-12 11:17:13,543 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:17:19,679 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 11:17:19,680 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:17:21,682 - ispa_next.main - DEBUG - 



2025-11-12 11:17:21,682 - ispa_next.main - DEBUG - starting with process 3 (GT-WK 7070) of 6
2025-11-12 11:17:21,691 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:17:24,586 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:17:31,082 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 308
2025-11-12 11:17:31,084 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 11:17:34,120 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:17:34,122 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:22,332 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:18:26,598 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:18:37,199 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:41,382 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:18:41,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:41,534 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:18:41,999 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:18:50,931 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:18:50,934 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:18:54,314 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:18:54,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:56,368 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:18:58,371 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:18:58,574 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:18:58,787 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:18:59,098 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:19:03,431 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:19:04,437 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:19:04,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:04,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:21,314 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:19:30,304 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:19:30,307 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:30,459 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:30,460 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:19:30,540 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:19:32,197 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:19:32,583 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:19:35,292 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:19:35,328 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:19:37,110 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:19:37,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:19:38,481 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:19:42,175 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:42,175 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:19:42,178 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:19:42,179 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:19:42,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:42,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:19:47,084 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:19:47,089 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:19:47,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:47,198 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:19:56,129 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:20:11,149 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:20:11,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:12,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:12,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:13,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:13,657 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:20:17,639 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:20:17,642 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:20:20,003 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:20:20,006 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:20,011 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:20:20,012 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:20,016 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:20:20,017 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:20:20,019 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:20:20,022 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:20:20,024 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:20:20,026 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:20:20,029 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:20:20,031 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:20:20,032 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:24,571 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:20:24,572 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:20:24,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:28,825 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:20:28,825 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:20:28,832 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:33,035 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:20:33,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:20:34,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:20:34,993 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:55,186 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:20:55,190 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:59,464 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:21:22,602 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:21:23,258 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:21:23,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:21:24,377 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:07,188 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:15,326 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:23,632 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:31,893 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:41,846 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:41,848 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:22:41,850 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:43,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:43,587 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:22:43,588 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:22:47,986 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:23:09,796 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:23:10,410 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:23:12,515 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:13,984 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 289
2025-11-12 11:23:13,986 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:21,142 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 82
2025-11-12 11:23:21,143 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:24,843 - ispa_next.main - DEBUG - 



2025-11-12 11:23:24,843 - ispa_next.main - DEBUG - starting with process 4 (OS-MW 37) of 6
2025-11-12 11:23:24,903 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:23:28,755 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:32,228 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 289
2025-11-12 11:23:32,231 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 82
2025-11-12 11:23:35,566 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:35,568 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:24:32,178 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:24:36,572 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:24:45,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:49,928 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:24:49,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:50,092 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:24:50,506 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:24:50,510 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:24:53,978 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:24:53,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:55,979 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:57,983 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:24:58,195 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:24:58,515 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:24:58,691 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:25:02,995 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:25:04,000 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:25:04,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:04,609 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:21,116 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:25:29,925 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:25:29,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:30,092 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:30,093 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:25:30,182 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:25:30,467 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:25:32,214 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:25:32,576 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:25:35,604 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:25:35,607 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:25:35,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:25:37,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:25:39,303 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:25:39,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:25:39,417 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:25:43,113 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:25:43,113 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:25:43,116 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:25:43,116 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:25:43,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:43,682 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:25:47,959 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:25:47,963 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:25:47,964 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:48,154 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:25:57,002 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:26:11,326 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:26:11,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:12,754 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:12,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:13,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:26:13,823 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:26:18,353 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:26:18,355 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:26:20,735 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:26:20,737 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:26:20,740 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:26:20,741 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:26:20,744 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:26:20,745 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:26:20,746 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:26:20,750 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:26:20,751 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:26:20,753 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:26:20,756 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:26:20,758 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:26:20,759 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:25,916 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:26:25,917 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:26:25,919 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:30,891 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:26:30,891 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:26:30,893 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:35,870 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:26:35,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:26:37,158 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:26:37,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:46,188 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:26:46,192 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:51,168 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:27:13,510 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:27:14,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:27:14,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:27:15,162 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:04,983 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:28:13,571 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:28:24,496 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:28:33,218 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:28:42,158 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:28:51,327 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:28:51,329 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:28:51,330 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:28:52,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:28:53,058 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:28:53,060 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:28:57,532 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:29:16,910 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:29:17,371 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:29:19,541 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:29:21,107 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 290
2025-11-12 11:29:21,110 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:29:28,330 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 83
2025-11-12 11:29:28,359 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:29:30,573 - ispa_next.main - DEBUG - Found new Appointment: M-RZ 5001
2025-11-12 11:29:30,574 - ispa_next.main - DEBUG - 



2025-11-12 11:29:30,574 - ispa_next.main - DEBUG - starting with process 5 (M-RZ 5001) of 7
2025-11-12 11:29:30,578 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:29:33,387 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:29:36,730 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 290
2025-11-12 11:29:36,732 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 83
2025-11-12 11:29:39,943 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:29:39,945 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:30:30,542 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:30:48,016 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:50,903 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:30:50,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:30:51,084 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:30:51,708 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:30:51,712 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:30:55,268 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:30:55,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:30:57,275 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:30:59,278 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:30:59,481 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:30:59,734 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:30:59,935 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:31:04,292 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:31:05,298 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:31:05,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:05,865 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:21,622 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:31:35,827 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:31:35,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:35,952 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:31:35,953 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:31:36,116 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:31:37,667 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:31:38,052 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:31:40,884 - ispa_next.functions - DEBUG - Updated appointment (AA00050558) customer contact data.
2025-11-12 11:31:41,903 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:31:41,916 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:31:44,278 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:31:44,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:31:45,756 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:31:49,427 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:31:49,427 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:31:49,432 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:31:49,433 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:31:49,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:50,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:31:54,215 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:31:54,219 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:31:54,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:54,398 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:31:58,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:58,717 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:58,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:59,870 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:31:59,871 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:32:02,569 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:32:02,573 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:32:04,238 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:32:04,240 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:32:04,244 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart), Package(name=Interne Qualitätssicherung, source=from_tab, target=cart)}
2025-11-12 11:32:04,245 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:32:04,247 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:32:04,248 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:32:04,250 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:32:04,252 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:32:04,254 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:32:04,256 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:32:04,258 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:32:05,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:32:06,286 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:32:13,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:32:14,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:32:31,980 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:32:31,981 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:32:31,982 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:32:31,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:36,276 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:32:36,278 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:32:36,281 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:40,489 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:32:40,489 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:32:40,492 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:44,682 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:32:44,683 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:32:45,442 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:32:45,651 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:53,716 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:32:53,720 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:58,086 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:33:24,072 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:33:24,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:33:25,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:33:25,778 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:34:08,909 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:17,972 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:26,702 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:35,576 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:44,684 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:44,687 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:34:44,688 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:34:46,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:34:46,457 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:34:46,458 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:34:50,958 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:35:10,411 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:35:10,806 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:35:13,781 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:35:15,328 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 290
2025-11-12 11:35:15,330 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:35:22,488 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 82
2025-11-12 11:35:22,489 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:35:24,798 - ispa_next.main - DEBUG - 



2025-11-12 11:35:24,798 - ispa_next.main - DEBUG - starting with process 6 (MI-JH356) of 7
2025-11-12 11:35:24,802 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:35:27,736 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:35:31,303 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 290
2025-11-12 11:35:31,306 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 82
2025-11-12 11:35:34,765 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:35:34,767 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:36:29,842 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:36:34,485 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:36:43,687 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:49,478 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:36:49,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:49,666 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:36:50,194 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:36:59,488 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:36:59,491 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:37:02,825 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:37:02,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:37:05,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:37:07,103 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:37:07,330 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:37:07,634 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:37:07,808 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:37:12,840 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:37:13,846 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:37:13,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:37:14,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:37:31,414 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:37:41,268 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:37:41,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:37:41,446 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:37:41,447 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:37:41,540 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:37:43,072 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:37:43,437 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:37:46,971 - ispa_next.functions - DEBUG - Updated appointment (AA00050351) customer contact data.
2025-11-12 11:37:48,138 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:37:48,140 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:37:50,189 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:37:50,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:37:51,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:37:55,332 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:37:55,332 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:37:55,335 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:37:55,336 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:37:55,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:37:55,901 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:38:00,883 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:38:00,889 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:38:00,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:38:01,130 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:38:10,212 - ispa_next.wipers - DEBUG - valid contract found: BMW Service Plus
2025-11-12 11:38:26,278 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:38:26,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:27,587 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:27,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:38:28,847 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:38:28,850 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:38:34,120 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:38:34,139 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:38:36,327 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:38:36,330 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:38:36,334 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:38:36,335 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:38:36,338 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:38:36,340 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:38:36,341 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:38:36,344 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:38:36,345 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:38:36,348 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:38:36,352 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:38:36,353 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:38:36,354 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:42,215 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:38:42,218 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:38:42,221 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:47,956 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:38:47,956 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:38:47,959 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:53,696 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:38:53,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:38:55,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:38:55,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:11,899 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:39:11,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:17,682 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:39:41,817 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:39:42,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:39:43,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:39:43,612 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:40:32,501 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:40:32,502 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:40:34,143 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:40:34,298 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:40:34,300 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:40:42,849 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:41:03,357 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:41:03,761 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:41:06,164 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:41:07,817 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 290
2025-11-12 11:41:07,819 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:41:15,213 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 82
2025-11-12 11:41:15,215 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:41:17,096 - ispa_next.main - DEBUG - 



2025-11-12 11:41:17,096 - ispa_next.main - DEBUG - starting with process 7 (MI-EI 121E) of 7
2025-11-12 11:41:17,175 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:41:20,526 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:41:23,972 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 290
2025-11-12 11:41:23,974 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 82
2025-11-12 11:41:27,319 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:41:27,323 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:42:16,360 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:42:20,810 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:42:29,626 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:42:33,224 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:42:33,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:33,424 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:42:33,951 - ispa_next.functions - DEBUG - HU date already expired after 265 days.
2025-11-12 11:42:43,182 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:42:43,185 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:42:46,577 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:42:46,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:42:48,450 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:42:50,454 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:42:50,664 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:42:50,943 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:42:51,128 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:42:55,491 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:42:56,497 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:42:56,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:57,051 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:14,184 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:43:23,775 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:43:23,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:23,972 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:43:23,973 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:43:24,060 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:43:25,740 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:43:26,101 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:43:29,728 - ispa_next.functions - DEBUG - Updated appointment (AA00050549) customer contact data.
2025-11-12 11:43:30,890 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:43:30,892 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:43:32,833 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:43:32,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:43:34,530 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:43:38,239 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:43:38,240 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:43:38,243 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:43:38,244 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:43:38,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:43:38,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:43:43,060 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:43:43,064 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:43:43,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:43:43,226 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:43:43,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:44,281 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:44,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:43:45,498 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:43:45,499 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:43:48,931 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:43:48,933 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:43:51,061 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:43:51,063 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:43:51,067 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:43:51,070 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:43:51,075 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:43:51,077 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:43:51,079 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:43:51,081 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:43:51,083 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:43:51,105 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:43:51,107 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:43:51,108 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:55,260 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:43:55,263 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:43:55,293 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:59,201 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:43:59,201 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:43:59,203 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:02,766 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:44:02,767 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:44:04,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:44:04,298 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:44:04,301 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:07,888 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:44:29,873 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:44:30,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:44:31,174 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:44:31,556 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:45:07,758 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:45:17,035 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:45:26,107 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:45:35,331 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:45:35,334 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:45:35,335 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:45:36,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:45:37,104 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:45:37,105 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:45:41,525 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:46:00,533 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:46:00,918 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:46:03,120 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:46:04,882 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 290
2025-11-12 11:46:04,884 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:46:12,527 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 82
2025-11-12 11:46:12,528 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
