2025-11-12 10:00:32,717 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:00:32,721 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:00:45,699 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:00:57,110 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:01:12,661 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:01:46,214 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:02:00,220 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:02:02,895 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:02:03,870 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:02:03,871 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 192
2025-11-12 10:02:06,332 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 192
2025-11-12 10:02:06,332 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:02:06,333 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:02:07,634 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:02:08,726 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:02:36,966 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:36,982 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:37,002 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:37,032 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Franz Tönnessen KLE-JT 304 WBA3A11000J283456 ohne Termin.
2025-11-12 10:02:37,057 - ispa_next.appointments.models - DEBUG - Appointment Daria Kamila Kolodziej KLE-QR 734 WBA8L71060K555733 ohne Termin.
2025-11-12 10:02:37,106 - ispa_next.appointments.models - DEBUG - Appointment Oliver Christian Wiegand MH-WI 1001 WMWZM31040T035812 ohne Termin.
2025-11-12 10:02:37,116 - ispa_next.appointments.models - DEBUG - Appointment Rabiullah Arash GEL-NK 786 WBAWZ510800M35552 ohne Termin.
2025-11-12 10:02:37,118 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:37,118 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:37,119 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:37,119 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:37,138 - ispa_next.main - DEBUG - Found 15 out of 48 appointments to process (configured limit: 15).
2025-11-12 10:02:37,139 - ispa_next.main - DEBUG - Processing 10 fresh appointments.
2025-11-12 10:02:37,139 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 10:02:37,140 - ispa_next.main - DEBUG - All appointments: GEL-LJ 23, GEL-GM 90, MO-JR 306, LÖWN93, MO-FP 2023, WES-SC 128, KLE F 404, KLE S 7711, GEL RG111, M-D-3722, BM-R 220E, GEL-AH 22E, GEL-F 6363, KLE-B 1268, KLE-W 5828
2025-11-12 10:02:37,142 - ispa_next.main - DEBUG - 



2025-11-12 10:02:37,142 - ispa_next.main - DEBUG - starting with process 1 (GEL-LJ 23) of 15
2025-11-12 10:02:37,146 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:02:38,235 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:02:39,313 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:02:39,314 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 192
2025-11-12 10:02:40,696 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:02:40,698 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:04,893 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:03:14,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:03:14,872 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:03:15,067 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:03:16,963 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:03:16,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:03:17,033 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:03:17,205 - ispa_next.functions - DEBUG - HU date already expired after 116 days.
2025-11-12 10:03:23,586 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:03:23,590 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:03:23,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:03:23,680 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:03:32,572 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:03:32,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:03:33,529 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:03:35,534 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:03:35,633 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:03:38,855 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:03:46,384 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 10:03:47,389 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:03:47,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:03:47,895 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:03:59,186 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:04:05,775 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:04:05,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:05,840 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:04:05,841 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:04:05,902 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:04:07,062 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:04:08,142 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:04:08,408 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:04:11,450 - ispa_next.functions - DEBUG - Updated appointment (AL00014243) customer contact data.
2025-11-12 10:04:12,377 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:04:12,381 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:04:13,279 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:04:13,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:04:13,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:04:18,443 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:04:18,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:04:19,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:04:21,026 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:04:21,147 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:04:21,258 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:04:21,363 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:04:21,363 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:04:29,415 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:05:29,419 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:05:37,693 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:06:05,695 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:06:17,021 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:06:21,720 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:06:21,720 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:06:25,945 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:06:26,958 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:06:26,960 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:06:26,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:06:27,071 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:06:27,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:27,930 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:27,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:06:28,589 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:06:28,593 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:06:30,504 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:06:30,506 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:06:31,869 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:06:31,871 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:06:31,874 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-12 10:06:31,875 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:06:31,878 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:06:31,880 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:06:31,880 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:06:31,884 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:06:31,885 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:06:31,888 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:06:31,890 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:06:32,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:06:33,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:06:40,091 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:06:40,094 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:06:40,096 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:06:40,098 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:06:42,721 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:06:42,723 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:06:42,725 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:06:45,325 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:06:45,327 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:06:45,327 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:06:45,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:06:47,926 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:07:00,518 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:07:01,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:07:01,855 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:07:02,027 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:08,454 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:07:14,362 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:07:14,362 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:07:14,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:07:15,115 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:07:15,117 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:07:18,148 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:07:28,303 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:07:28,684 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:07:29,495 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:07:30,184 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:07:30,186 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:07:32,896 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 192
2025-11-12 10:07:32,896 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:07:33,591 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:07:33,595 - ispa_next.main - DEBUG - 



2025-11-12 10:07:33,595 - ispa_next.main - DEBUG - starting with process 2 (GEL-GM 90) of 15
2025-11-12 10:07:33,599 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:07:34,458 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:07:35,184 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:07:35,185 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 192
2025-11-12 10:07:36,369 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:07:36,370 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:07:57,131 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:08:10,226 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:08:14,987 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:08:14,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:08:15,042 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:08:15,254 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:08:15,257 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:08:15,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:08:15,327 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:08:24,902 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:08:24,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:08:25,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:08:27,771 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:08:27,884 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:08:27,974 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:08:28,035 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:08:30,167 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:08:31,172 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:08:31,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:08:31,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:08:42,415 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:08:49,930 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:08:49,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:08:50,019 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:08:50,020 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:08:50,092 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:08:50,184 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:08:51,288 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:08:52,485 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:08:52,794 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:08:55,197 - ispa_next.functions - DEBUG - Updated appointment (AL00014246) customer contact data.
2025-11-12 10:08:56,093 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:08:56,093 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:08:56,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:08:56,889 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:08:58,217 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:08:58,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:08:58,315 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:09:01,883 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:09:01,883 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:09:01,886 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:09:01,890 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:09:01,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:09:02,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:09:02,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:03,315 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:03,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:09:04,115 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:09:04,117 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:09:08,788 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:09:08,790 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:09:09,898 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:09:09,900 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:09:09,903 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:09:09,905 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:09:09,909 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:09:09,910 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:09:09,912 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:09:09,914 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:09:09,922 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:09:09,928 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:09:09,931 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:09:09,933 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:09:09,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:09:15,287 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:09:15,289 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:09:15,291 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:09:20,619 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:09:20,621 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:09:20,622 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:09:20,625 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:09:25,857 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:09:39,380 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:09:40,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:09:40,686 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:09:40,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:09:49,558 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:09:55,918 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:09:55,920 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:09:56,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:09:56,644 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:09:56,645 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:10:00,331 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:10:08,652 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:10:09,058 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:10:09,785 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:10,289 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:10:10,289 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:10:13,125 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 192
2025-11-12 10:10:13,126 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:14,007 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:14,012 - ispa_next.main - DEBUG - 



2025-11-12 10:10:14,012 - ispa_next.main - DEBUG - starting with process 3 (MO-JR 306) of 15
2025-11-12 10:10:14,016 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:10:15,311 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:16,519 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:10:16,521 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 192
2025-11-12 10:10:17,987 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:10:17,988 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:39,640 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:10:49,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:49,604 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:10:49,740 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:10:51,720 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:10:51,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:51,794 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:10:51,989 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:10:51,993 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:10:51,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:52,085 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:11:01,690 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:11:01,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:11:02,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:11:04,522 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:11:10,440 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 10:11:18,024 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 10:11:19,030 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:11:19,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:19,552 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:32,360 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:11:39,614 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:11:39,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:39,696 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:11:39,702 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:11:39,746 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:11:39,836 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:11:40,973 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:11:41,192 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:11:44,404 - ispa_next.functions - DEBUG - Updated appointment (AL00014240) customer contact data.
2025-11-12 10:11:45,309 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:11:45,311 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:11:45,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:11:46,424 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:11:47,839 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:11:47,840 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:11:47,939 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:11:51,914 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:11:51,914 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:11:51,914 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:11:51,916 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:11:51,920 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:11:51,920 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 10:11:51,924 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:11:54,347 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:11:54,349 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:11:54,957 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:11:54,958 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:11:54,962 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-12 10:11:54,963 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:11:54,965 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:11:54,967 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:11:54,967 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:11:54,969 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:11:54,971 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:11:54,974 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:11:54,977 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:11:55,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:11:56,207 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:12:03,277 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:12:03,279 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:12:03,281 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:12:03,282 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:06,608 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:12:06,609 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:12:06,611 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:09,810 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:12:09,812 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:12:09,814 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:12:09,816 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:13,082 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:12:26,313 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:12:26,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:12:27,587 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:12:27,697 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:35,147 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:12:41,582 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:12:41,583 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:12:42,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:12:42,410 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:12:42,411 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:12:46,042 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:12:52,749 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:12:53,149 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:12:53,978 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:12:54,566 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:12:54,566 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:12:57,615 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 192
2025-11-12 10:12:57,616 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:12:58,317 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:12:58,337 - ispa_next.main - DEBUG - 



2025-11-12 10:12:58,337 - ispa_next.main - DEBUG - starting with process 4 (LÖWN93) of 15
2025-11-12 10:12:58,343 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:12:59,570 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:13:00,365 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:13:00,366 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 192
2025-11-12 10:13:01,572 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:13:01,573 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:13:33,187 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:13:33,286 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:13:33,289 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:13:33,699 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:13:33,701 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:13:36,233 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 192
2025-11-12 10:13:36,234 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:13:36,969 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:13:36,973 - ispa_next.main - DEBUG - 



2025-11-12 10:13:36,973 - ispa_next.main - DEBUG - starting with process 5 (MO-FP 2023) of 15
2025-11-12 10:13:36,977 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:13:38,136 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:13:39,461 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:13:39,462 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 192
2025-11-12 10:13:40,837 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:13:40,838 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:14:10,804 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:14:10,813 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:14:10,818 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:11,268 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:14:11,268 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:14,189 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 192
2025-11-12 10:14:14,190 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:14:15,093 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:14:15,098 - ispa_next.main - DEBUG - 



2025-11-12 10:14:15,098 - ispa_next.main - DEBUG - starting with process 6 (WES-SC 128) of 15
2025-11-12 10:14:15,102 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:16,467 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:17,887 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:14:17,889 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 192
2025-11-12 10:14:19,274 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:19,275 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:14:49,110 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:14:49,119 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:14:49,123 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:49,527 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:14:49,529 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:52,050 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 192
2025-11-12 10:14:52,051 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:14:52,651 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:14:52,656 - ispa_next.main - DEBUG - 



2025-11-12 10:14:52,656 - ispa_next.main - DEBUG - starting with process 7 (KLE F 404) of 15
2025-11-12 10:14:52,659 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:53,864 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:55,105 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:14:55,106 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 192
2025-11-12 10:14:56,650 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:56,652 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:15:30,318 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:15:30,329 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 10:15:30,334 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:15:30,910 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:15:30,912 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:15:33,733 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 192
2025-11-12 10:15:33,734 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:15:34,538 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:15:34,542 - ispa_next.main - DEBUG - 



2025-11-12 10:15:34,542 - ispa_next.main - DEBUG - starting with process 8 (KLE S 7711) of 15
2025-11-12 10:15:34,546 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:15:35,733 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:15:37,016 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:15:37,018 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 192
2025-11-12 10:15:38,845 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:15:38,846 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:10,243 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:16:10,251 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 10:16:10,255 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:10,805 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:16:10,806 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:13,360 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 192
2025-11-12 10:16:13,361 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:14,262 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:14,266 - ispa_next.main - DEBUG - 



2025-11-12 10:16:14,266 - ispa_next.main - DEBUG - starting with process 9 (GEL RG111) of 15
2025-11-12 10:16:14,270 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:16:15,359 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:16,428 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:16:16,430 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 192
2025-11-12 10:16:18,013 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:18,014 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:48,739 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:16:48,749 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 10:16:48,753 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:49,360 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:16:49,360 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:51,896 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 192
2025-11-12 10:16:51,897 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:52,685 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:52,691 - ispa_next.main - DEBUG - 



2025-11-12 10:16:52,691 - ispa_next.main - DEBUG - starting with process 10 (M-D-3722) of 15
2025-11-12 10:16:52,696 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:16:53,560 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:54,715 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:16:54,716 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 192
2025-11-12 10:16:55,965 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:55,966 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:17:28,900 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:17:28,910 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 10:17:28,913 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:17:29,515 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:17:29,516 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:17:32,232 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 192
2025-11-12 10:17:32,232 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:17:33,272 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:17:33,277 - ispa_next.main - DEBUG - 



2025-11-12 10:17:33,277 - ispa_next.main - DEBUG - starting with process 11 (BM-R 220E) of 15
2025-11-12 10:17:33,287 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:17:34,529 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:17:35,835 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 427
2025-11-12 10:17:35,837 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 192
2025-11-12 10:17:37,205 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:17:37,206 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:18:02,352 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:18:04,417 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:18:09,840 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:14,542 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:18:14,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:14,658 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:18:14,808 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:18:19,346 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:18:19,348 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:18:19,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:19,411 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:18:22,471 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:18:22,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:23,386 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:25,389 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:18:25,539 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:18:25,676 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:18:25,740 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:18:29,945 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:18:30,950 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:18:30,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:31,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:45,629 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:18:49,443 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:18:49,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:49,527 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:18:49,527 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:18:49,559 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:18:50,805 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:18:51,045 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:18:52,610 - ispa_next.functions - DEBUG - Updated appointment (BB00024105) customer contact data.
2025-11-12 10:18:53,533 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:18:53,535 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:18:54,345 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:18:54,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:18:55,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:18:58,659 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:18:58,659 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:18:58,662 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:18:58,665 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:18:58,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:59,138 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:19:08,199 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 10:19:12,912 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:19:12,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:13,450 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:13,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:14,181 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:19:14,183 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:19:18,331 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:19:18,333 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:19:19,658 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:19:19,670 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:19:19,674 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:19:19,676 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:19:19,680 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:19:19,682 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:19:19,686 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:19:19,686 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:19:19,701 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:19:19,705 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:19:19,707 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:19:19,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:24,364 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:19:24,366 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:19:24,368 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:28,964 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:19:28,965 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:19:28,968 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:19:28,972 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:33,609 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:19:45,808 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:19:46,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:19:46,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:19:47,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:55,443 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:19:58,880 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:19:58,880 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:19:59,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:19:59,656 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:19:59,657 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:20:02,797 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:20:11,299 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:20:11,677 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 10:20:12,338 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:12,874 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 429
2025-11-12 10:20:12,876 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:20:15,406 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 10:20:15,407 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:20:16,083 - ispa_next.main - DEBUG - Found new Appointment: KLE-K 9997
2025-11-12 10:20:16,086 - ispa_next.main - DEBUG - 



2025-11-12 10:20:16,086 - ispa_next.main - DEBUG - starting with process 12 (KLE-K 9997) of 16
2025-11-12 10:20:16,090 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:20:16,871 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:17,609 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 429
2025-11-12 10:20:17,610 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 10:20:18,859 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:20:18,860 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:20:55,711 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:21:08,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:11,872 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:21:11,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:11,950 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:21:12,184 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:21:12,186 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:21:12,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:12,325 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:21:15,540 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:21:15,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:21:16,661 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:21:18,664 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:21:18,753 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:21:18,837 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:21:18,955 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:21:23,157 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:21:24,162 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:21:24,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:24,682 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:35,192 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:21:42,074 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:21:42,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:42,170 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:21:42,172 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:21:42,218 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:21:43,585 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:21:43,808 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:21:46,985 - ispa_next.functions - DEBUG - Updated appointment (AL00014264) customer contact data.
2025-11-12 10:21:47,923 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:21:47,925 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:21:48,803 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:21:48,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:21:49,621 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:21:53,252 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:21:53,253 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:21:53,265 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:21:53,269 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:21:53,269 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:21:53,771 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:21:59,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:59,979 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:59,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:22:00,785 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:22:00,789 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:22:03,877 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:22:03,882 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:22:04,851 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:22:04,855 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:22:04,864 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-12 10:22:04,866 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:22:04,870 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:22:04,872 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:22:04,882 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:22:04,904 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:22:04,906 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:22:04,917 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:22:04,921 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:22:05,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:22:06,270 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:22:13,176 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:22:13,178 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:22:13,178 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:22:13,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:22:17,250 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:22:17,252 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:22:17,254 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:22:21,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:22:21,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:22:30,622 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:22:43,694 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:22:43,696 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:22:43,698 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:22:43,701 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:22:47,730 - ispa_next.functions - DEBUG - adding material to item=Package(name=Service Motoröl, source=cart, target=unkown)
2025-11-12 10:22:57,635 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:23:09,449 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:23:10,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:23:10,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:23:10,757 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:18,838 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:23:24,823 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:23:24,823 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:23:25,485 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:23:25,575 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:23:25,576 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:23:29,247 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:23:36,974 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:23:37,363 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 10:23:38,696 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:23:39,462 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 429
2025-11-12 10:23:39,464 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:23:42,426 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 10:23:42,427 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:23:43,239 - ispa_next.main - DEBUG - 



2025-11-12 10:23:43,239 - ispa_next.main - DEBUG - starting with process 13 (GEL-AH 22E) of 16
2025-11-12 10:23:43,277 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:23:44,486 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:23:45,701 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 429
2025-11-12 10:23:45,703 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 10:23:47,215 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:23:47,217 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:24:12,604 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:24:14,763 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:24:20,018 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:22,657 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:24:22,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:22,743 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:24:23,110 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:24:23,112 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:24:23,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:23,186 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:24:26,412 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:24:26,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:24:27,490 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:24:29,494 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:24:29,591 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:24:29,690 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:24:29,753 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:24:33,967 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:24:34,985 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:24:34,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:35,501 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:46,998 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:24:46,998 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:24:51,384 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:24:51,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:51,513 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:24:51,515 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:24:51,611 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:24:52,865 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:24:53,103 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:24:54,788 - ispa_next.functions - DEBUG - Updated appointment (BB00024057) customer contact data.
2025-11-12 10:24:55,728 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:24:55,730 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:24:56,557 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:24:56,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:24:57,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:25:00,937 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:25:00,937 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:25:00,941 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:25:00,945 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:25:00,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:25:01,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:25:10,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:11,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:11,072 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:25:11,794 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:25:11,796 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:25:14,280 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:25:14,293 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:25:15,617 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:25:15,618 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:25:15,621 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:25:15,622 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:25:15,626 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:25:15,632 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:25:15,642 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:25:15,646 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:25:15,652 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:25:15,655 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:25:15,656 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:25:15,658 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:18,200 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:25:18,202 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:25:18,204 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:20,876 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:25:20,878 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:25:20,880 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:25:20,882 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:23,514 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:25:35,708 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:25:36,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:25:36,829 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:25:36,972 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:43,803 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:25:47,627 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:25:47,627 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:25:48,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:25:48,419 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:25:48,422 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:25:52,190 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:26:00,717 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:26:01,120 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 10:26:01,826 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:26:02,618 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 429
2025-11-12 10:26:02,620 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:26:05,734 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 10:26:05,735 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:26:06,600 - ispa_next.main - DEBUG - 



2025-11-12 10:26:06,600 - ispa_next.main - DEBUG - starting with process 14 (GEL-F 6363) of 16
2025-11-12 10:26:06,606 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:26:07,702 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:26:08,523 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 429
2025-11-12 10:26:08,524 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 10:26:10,021 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:26:10,022 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:26:33,211 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:26:35,104 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:26:39,620 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:44,908 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:26:44,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:44,990 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:26:45,274 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:26:49,274 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:26:49,278 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:26:49,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:49,339 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:26:52,443 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:26:52,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:54,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:26:56,122 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:26:56,217 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:26:56,366 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:26:56,429 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:27:00,701 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:27:01,705 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:27:01,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:02,168 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:13,371 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:27:17,349 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:27:17,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:17,436 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:27:17,437 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:27:17,480 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:27:18,676 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:27:19,777 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:27:20,021 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:27:21,706 - ispa_next.functions - DEBUG - Updated appointment (BB00025221) customer contact data.
2025-11-12 10:27:22,613 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:27:22,614 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:27:23,199 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:27:23,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:27:23,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:27:27,948 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:27:27,948 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:27:27,950 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:27:27,954 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:27:27,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:27:28,455 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:27:28,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:29,356 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:29,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:27:30,098 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:27:30,100 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:27:34,964 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:27:34,965 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:27:36,529 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:27:36,533 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:27:36,537 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:27:36,539 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:27:36,543 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:27:36,545 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:27:36,547 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:27:36,551 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:27:36,551 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:27:36,556 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:27:36,558 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:27:36,560 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:27:36,560 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:27:41,902 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:27:41,904 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:27:41,906 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:27:47,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:27:47,486 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:27:58,870 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:13,418 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:28:13,420 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:28:13,422 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:28:13,430 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:18,865 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-12 10:28:26,679 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:28:41,691 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:28:42,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:28:43,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:28:44,008 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:53,458 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:28:57,753 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:28:57,753 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:28:58,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:28:58,327 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:28:58,329 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:29:01,544 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:29:10,206 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:29:10,580 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 10:29:11,710 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:29:12,494 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 429
2025-11-12 10:29:12,496 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:29:15,886 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 10:29:15,887 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:29:16,846 - ispa_next.main - DEBUG - 



2025-11-12 10:29:16,846 - ispa_next.main - DEBUG - starting with process 15 (KLE-B 1268) of 16
2025-11-12 10:29:16,850 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:29:18,078 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:29:19,339 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 429
2025-11-12 10:29:19,341 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 10:29:20,800 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:29:20,802 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:29:55,936 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:29:55,949 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 10:29:55,962 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:29:56,319 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 429
2025-11-12 10:29:56,319 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:29:58,399 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 10:29:58,399 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:29:59,517 - ispa_next.main - DEBUG - 



2025-11-12 10:29:59,517 - ispa_next.main - DEBUG - starting with process 16 (KLE-W 5828) of 16
2025-11-12 10:29:59,521 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:30:00,627 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:30:01,622 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 429
2025-11-12 10:30:01,623 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 10:30:03,136 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:30:03,137 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:30:30,593 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:30:33,109 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:30:38,349 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:41,688 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:30:41,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:41,771 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:30:41,991 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:30:41,994 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:30:41,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:42,108 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:30:45,286 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:30:45,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:30:47,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:30:49,015 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:30:49,174 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:30:49,267 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:30:49,339 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:30:53,558 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:30:54,563 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:30:54,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:55,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:31:06,307 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:31:10,803 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:31:10,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:31:10,917 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:31:10,919 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:31:10,961 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:31:11,135 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:31:12,369 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:31:12,623 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:31:14,498 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:31:14,500 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:31:14,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:31:15,581 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:31:17,027 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:31:17,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:31:17,177 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:31:20,777 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:31:20,777 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:31:20,781 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:31:20,783 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:31:20,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:31:21,351 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:31:25,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:31:26,048 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:31:26,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:31:26,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:31:26,658 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:31:29,700 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:31:29,702 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:31:30,788 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:31:30,790 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:31:30,795 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:31:30,796 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:31:30,800 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:31:30,801 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:31:30,802 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:31:30,805 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:31:30,807 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:31:30,814 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:31:30,820 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:31:30,822 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:31:30,822 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:34,089 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:31:34,091 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:31:34,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:37,372 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:31:37,374 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:31:37,376 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:31:37,380 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:40,715 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:31:54,979 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:31:55,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:31:56,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:31:56,495 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:32:04,103 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:32:07,522 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:32:07,522 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:32:07,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:32:08,069 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:32:08,072 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:32:11,306 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:32:19,352 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:32:19,765 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 10:32:20,705 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:32:21,473 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 429
2025-11-12 10:32:21,473 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:32:24,444 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 10:32:24,445 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
