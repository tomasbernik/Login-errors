2025-11-17 11:00:39,202 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 11:00:39,208 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 11:00:47,602 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:00:59,969 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:01:15,496 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:03:13,956 - ispa_next.app_start.main - DEBUG - Operation already took 107.05 seconds (more than 80 seconds)
2025-11-17 11:03:16,017 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\385f9d745d744ad3\\tess_w5ck6bxo_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\385f9d745d744ad3\\tess_w5ck6bxo', 'txt']
2025-11-17 11:03:16,298 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 11:03:16,304 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 11:03:16,306 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:05:15,836 - ispa_next.app_start.main - DEBUG - Operation already took 107.12 seconds (more than 80 seconds)
2025-11-17 11:05:17,891 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\385f9d745d744ad3\\tess_uq8kqiye_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\385f9d745d744ad3\\tess_uq8kqiye', 'txt']
2025-11-17 11:05:18,145 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 11:05:18,150 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 11:05:26,688 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 11:05:36,398 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:05:47,141 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:06:02,624 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:06:50,368 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 11:07:05,404 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 11:07:09,217 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:07:10,614 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1224
2025-11-17 11:07:10,615 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 157
2025-11-17 11:07:12,725 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 120
2025-11-17 11:07:12,726 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 11:07:12,727 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:07:13,743 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:07:14,752 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:07:31,980 - ispa_next.appointments.models - DEBUG - Appointment bwp Burggraf + Weber M-MG 2206 E WBY41AW070FS23336 ohne Termin.
2025-11-17 11:07:32,005 - ispa_next.appointments.models - DEBUG - Appointment Adam Szulc DAH-QX 230 WBA5K11060D943181 ohne Termin.
2025-11-17 11:07:32,018 - ispa_next.appointments.models - DEBUG - Appointment Robert Charles Armin FS-NA 42 WMWYT910303D93360 ohne Termin.
2025-11-17 11:07:32,031 - ispa_next.appointments.models - DEBUG - Appointment Benedikt Burger FFB-XG 87 WBS11DM0708D97738 ohne Termin.
2025-11-17 11:07:32,040 - ispa_next.appointments.models - DEBUG - Appointment Timon Wohlfarth  WMWXU710402M05502 ohne Termin.
2025-11-17 11:07:32,048 - ispa_next.appointments.models - DEBUG - Appointment Chi Chung Nguyen M-HC 2737 WBACR61070LJ18143 ohne Termin.
2025-11-17 11:07:32,057 - ispa_next.appointments.models - DEBUG - Appointment Ingrid Berger M-MB 525 WBAFF41030L117517 ohne Termin.
2025-11-17 11:07:32,057 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:07:32,058 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:07:32,058 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:07:32,060 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:07:32,069 - ispa_next.appointments.models - DEBUG - Appointment Brigitte Lang DAH-U 904 WMW21DL0703N66211 ohne Termin.
2025-11-17 11:07:32,077 - ispa_next.appointments.models - DEBUG - Appointment Franziska Scheitler DAH-FS 242 WBA31DZ040FJ93655 ohne Termin.
2025-11-17 11:07:32,085 - ispa_next.appointments.models - DEBUG - Appointment NovaTaste Germany GmbH BGL-NT 303 WBA41EG0005X32470 ohne Termin.
2025-11-17 11:07:32,095 - ispa_next.appointments.models - DEBUG - Appointment Sieglinde Wasmeier PAN-SW 11 WBA21BX0907N85009 ohne Termin.
2025-11-17 11:07:32,102 - ispa_next.appointments.models - DEBUG - Appointment REWE Markt GmbH FS-RE 208 WBA71AC0505R28464 ohne Termin.
2025-11-17 11:07:32,111 - ispa_next.appointments.models - DEBUG - Appointment Christos Michalopoulos DAH-GR 517 WBATX95050ND73284 ohne Termin.
2025-11-17 11:07:32,122 - ispa_next.appointments.models - DEBUG - Appointment Hiller DAH-LH 258 WBAWY510600E18805 ohne Termin.
2025-11-17 11:07:32,130 - ispa_next.appointments.models - DEBUG - Appointment Johannes Nist DAH-VN 66 WBA11GR0209Z99162 ohne Termin.
2025-11-17 11:07:32,139 - ispa_next.appointments.models - DEBUG - Appointment Annemarie Eichhorn DAH-AE 279 WBA71AC0405V15516 ohne Termin.
2025-11-17 11:07:32,194 - ispa_next.appointments.models - DEBUG - Appointment Ezmin Tanjic RE-EZA 1 WBACV61030LJ72146 ohne Termin.
2025-11-17 11:07:32,202 - ispa_next.appointments.models - DEBUG - Appointment PRK GmbH Kunststoffverarbeitung  WMW61DL0903S22669 ohne Termin.
2025-11-17 11:07:32,211 - ispa_next.appointments.models - DEBUG - Appointment Härtetechnik Redak GmbH & Co. KG DAH-MC 510 WBS41AY030FM13870 ohne Termin.
2025-11-17 11:07:32,219 - ispa_next.appointments.models - DEBUG - Appointment Volksbank Raiffeisenbank Dachau eG DAH-VR 86 E WBA81CY050FS22937 ohne Termin.
2025-11-17 11:07:32,228 - ispa_next.appointments.models - DEBUG - Appointment Dirk Ullrich RN-M 500E WBS81GV040CV92768 ohne Termin.
2025-11-17 11:07:32,236 - ispa_next.appointments.models - DEBUG - Appointment Jörg Rolfes OAL-AR 191 WBAUZ35010N015446 ohne Termin.
2025-11-17 11:07:32,243 - ispa_next.appointments.models - DEBUG - Appointment Andreas Christmann M-AK 1539E WMW11GC05RTA37157 ohne Termin.
2025-11-17 11:07:32,250 - ispa_next.appointments.models - DEBUG - Appointment Christian Ettenberger FFB-CE 56E WMW11DJ0602T37216 ohne Termin.
2025-11-17 11:07:32,260 - ispa_next.appointments.models - DEBUG - Appointment Baader Bank AG M-V 7427 WBA41EG0X05Y35735 ohne Termin.
2025-11-17 11:07:32,267 - ispa_next.appointments.models - DEBUG - Appointment Dr. Nicola Steiner DAH-LS 855 WMWXU71010TN14283 ohne Termin.
2025-11-17 11:07:32,275 - ispa_next.appointments.models - DEBUG - Appointment Rita Oberrecht-Schwarz DAH-RA 13 WBA11AB01N5T43220 ohne Termin.
2025-11-17 11:07:32,283 - ispa_next.appointments.models - DEBUG - Appointment Rolf Ludwig Hagert DAH-AR 678 WBA2E310705D82895 ohne Termin.
2025-11-17 11:07:32,292 - ispa_next.appointments.models - DEBUG - Appointment Rainer Tobias Möller DAH-ST 807 WBA6V31070EB10798 ohne Termin.
2025-11-17 11:07:32,300 - ispa_next.appointments.models - DEBUG - Appointment Dr. Norbert Metz STA-M 2828 WBA6X310405T68381 ohne Termin.
2025-11-17 11:07:32,308 - ispa_next.appointments.models - DEBUG - Appointment Franz Rockinger FFB-FR 267 WBA31BX0807R25447 ohne Termin.
2025-11-17 11:07:32,317 - ispa_next.appointments.models - DEBUG - Appointment Dario Zandonella Maiucco DAH-DZ 73 WBAXA51050C586150 ohne Termin.
2025-11-17 11:07:32,326 - ispa_next.appointments.models - DEBUG - Appointment Anna Gushchina M-AG 7192 WMWRC310X0TB89348 ohne Termin.
2025-11-17 11:07:32,335 - ispa_next.appointments.models - DEBUG - Appointment Radloff DAH-RA 238 WBY71AW050FR88400 ohne Termin.
2025-11-17 11:07:32,343 - ispa_next.appointments.models - DEBUG - Appointment Augusto Fracasso DAH-GF 289 WBA11AB0005N66647 ohne Termin.
2025-11-17 11:07:32,353 - ispa_next.main - DEBUG - Found 6 out of 58 appointments to process (configured limit: 15).
2025-11-17 11:07:32,353 - ispa_next.main - DEBUG - Processing 6 fresh appointments.
2025-11-17 11:07:32,353 - ispa_next.main - DEBUG - All appointments: DAH-BA 795, E-FM 8843, FFB-VL 993, M-BM 173E, AS-I 135, M-SF 763
2025-11-17 11:07:32,357 - ispa_next.main - DEBUG - 



2025-11-17 11:07:32,357 - ispa_next.main - DEBUG - starting with process 1 (DAH-BA 795) of 6
2025-11-17 11:07:32,362 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:07:33,676 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:07:35,154 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1224
2025-11-17 11:07:35,156 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 120
2025-11-17 11:07:36,824 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:07:36,826 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:08:16,364 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:08:27,111 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:08:29,077 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:08:29,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:29,217 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:08:29,392 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 11:08:37,008 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:08:37,012 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:08:39,811 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:08:39,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:08:40,824 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:08:42,829 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:08:50,078 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 11:08:58,037 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 11:08:59,048 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:08:59,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:59,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:03,463 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 11:09:03,467 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:09:03,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:03,591 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:09:03,592 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:09:03,627 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:09:03,734 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:09:04,826 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 11:09:05,991 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 11:09:06,268 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:09:07,872 - ispa_next.functions - DEBUG - Updated appointment (EL00000576) customer contact data.
2025-11-17 11:09:08,783 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:09:08,784 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:09:08,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:09:09,537 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:09:10,960 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:09:10,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:09:11,044 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:09:15,050 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:09:15,050 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:09:15,050 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:09:15,053 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:09:15,054 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:09:15,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:09:15,583 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:09:19,688 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:09:19,694 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:09:19,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:09:19,820 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:09:20,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:20,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:20,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:09:21,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:09:21,328 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:09:23,823 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:09:23,826 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:09:24,863 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:09:24,864 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:09:24,868 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Servicereinigung / Maschinelle Oberwäsche und Fußr, source=from_tab, target=cart)}
2025-11-17 11:09:24,870 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:09:24,872 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 11:09:24,873 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:09:24,874 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Winter - Fit - Paket / Winter - Fit - Paket, source=from_tab, target=advice_list)}
2025-11-17 11:09:24,881 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:09:24,886 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:09:24,890 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:09:24,899 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:09:24,902 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:09:25,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:09:26,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:09:32,153 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:09:32,178 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:09:32,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:09:32,983 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:09:46,082 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:09:46,119 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:09:46,121 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:09:46,122 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:09:49,415 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:09:49,417 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:09:49,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:09:52,751 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:09:52,753 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:09:52,754 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:09:52,763 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:09:56,025 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:10:10,604 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:10:11,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:10:12,120 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:10:12,286 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:21,516 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:10:25,917 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:10:29,914 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:10:33,855 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:10:33,857 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:10:33,857 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:10:34,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:10:34,590 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:10:34,592 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:10:36,737 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:10:48,055 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:10:48,457 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 11:10:49,234 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:10:51,867 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1225
2025-11-17 11:10:51,869 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:10:55,053 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 157
2025-11-17 11:10:55,054 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:10:55,983 - ispa_next.main - DEBUG - 



2025-11-17 11:10:55,983 - ispa_next.main - DEBUG - starting with process 2 (E-FM 8843) of 6
2025-11-17 11:10:55,986 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:10:57,237 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:10:58,666 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1225
2025-11-17 11:10:58,667 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 157
2025-11-17 11:11:00,426 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:11:00,428 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:11:30,746 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:11:41,870 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:11:46,483 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:11:46,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:11:46,577 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:11:46,840 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:11:46,844 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:11:49,670 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:11:49,672 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:11:50,641 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:11:52,645 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:11:52,764 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:11:52,855 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:11:52,928 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:11:55,062 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:11:56,078 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:11:56,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:11:56,632 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:12:10,494 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:12:18,735 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:12:18,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:12:18,807 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:12:18,808 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:12:18,841 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:12:20,085 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:12:21,280 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:12:21,492 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:12:24,441 - ispa_next.functions - DEBUG - Updated appointment (EL00000570) customer contact data.
2025-11-17 11:12:25,401 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:12:25,403 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:12:26,291 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:12:26,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:12:27,024 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:12:30,656 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:12:30,657 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:12:30,660 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:12:30,660 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:12:30,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:12:31,140 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:12:35,251 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:12:35,963 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:12:49,922 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:12:49,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:12:50,057 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:12:59,747 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 11:13:21,393 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 11:13:21,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:22,540 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:22,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:13:23,437 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:13:23,438 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:13:27,643 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:13:27,645 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:13:28,765 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:13:28,768 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:13:28,771 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Servicereinigung / Maschinelle Oberwäsche und Fußr, source=from_tab, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 11:13:28,774 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:13:28,777 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 11:13:28,778 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:13:28,780 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Winter - Fit - Paket / Winter - Fit - Paket, source=from_tab, target=advice_list)}
2025-11-17 11:13:28,789 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:13:28,791 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:13:28,793 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:13:28,797 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:13:28,802 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:13:29,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:13:30,269 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:13:57,749 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:13:57,834 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:13:58,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:13:58,757 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:14:12,738 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:14:12,739 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 11:14:23,247 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:14:23,267 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:14:23,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:14:29,549 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:14:29,552 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:14:29,554 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:14:35,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:14:36,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:14:45,767 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:15:03,387 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:15:03,389 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:15:03,391 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:15:03,398 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:15:09,906 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:15:29,665 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:15:30,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:15:31,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:15:31,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:15:43,525 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:15:50,366 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:15:58,945 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:15:58,946 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:16:00,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:16:00,418 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:16:00,420 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:16:08,051 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:16:23,480 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:16:23,860 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 11:16:25,276 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:16:27,914 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1225
2025-11-17 11:16:27,916 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:16:33,250 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 156
2025-11-17 11:16:33,251 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:16:34,596 - ispa_next.main - DEBUG - 



2025-11-17 11:16:34,596 - ispa_next.main - DEBUG - starting with process 3 (FFB-VL 993) of 6
2025-11-17 11:16:34,601 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:16:36,681 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:16:38,656 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1225
2025-11-17 11:16:38,657 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 156
2025-11-17 11:16:41,008 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:16:41,010 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:17:19,656 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:17:33,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:33,320 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:17:33,627 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:17:34,825 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:17:34,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:34,916 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:17:35,207 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 11:17:43,812 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:17:43,815 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:17:46,913 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:17:46,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:17:48,605 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:17:50,612 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:17:50,736 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:17:54,041 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:17:54,142 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:17:54,146 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:17:55,363 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:18:07,973 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:18:08,979 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:18:08,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:09,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:27,305 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:18:36,825 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:18:36,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:36,920 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:18:36,921 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:18:37,039 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:18:38,458 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:18:39,807 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:18:40,091 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:18:43,782 - ispa_next.functions - DEBUG - Updated appointment (EL00000569) customer contact data.
2025-11-17 11:18:44,707 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:18:44,710 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:18:46,237 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:18:46,238 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:18:47,225 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:18:50,840 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:18:50,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:18:51,386 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:18:53,406 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:18:53,552 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:18:53,717 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:18:53,839 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:18:53,840 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:18:55,116 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:19:07,558 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:20:07,560 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:20:19,264 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:20:27,437 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:20:27,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:30,925 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremse hinten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 11:20:35,621 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:20:37,932 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:20:38,984 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:20:38,985 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:20:38,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:20:39,071 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:20:43,275 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:20:44,448 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:20:57,775 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:20:57,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:20:58,098 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:20:58,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:20:59,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:20:59,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:20:59,999 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:21:00,002 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:21:01,365 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:21:01,367 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:21:03,818 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:21:03,820 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:21:03,823 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Servicereinigung / Maschinelle Oberwäsche und Fußr, source=from_tab, target=cart)}
2025-11-17 11:21:03,824 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:21:03,827 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 11:21:03,828 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:21:03,830 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Winter - Fit - Paket / Winter - Fit - Paket, source=from_tab, target=advice_list)}
2025-11-17 11:21:03,831 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:21:03,833 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:21:03,834 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:21:03,836 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:21:03,838 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:21:04,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:21:05,519 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:21:11,858 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:21:11,860 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:21:12,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:21:12,674 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:21:27,077 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:21:27,080 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:21:27,081 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:21:27,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:21:29,074 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:21:29,077 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:21:29,080 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:21:31,010 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:21:31,012 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:21:31,014 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:21:31,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:21:32,961 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:21:54,598 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:21:55,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:21:56,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:21:56,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:22:05,891 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:22:12,483 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:22:12,486 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:22:12,487 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:22:13,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:22:13,841 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:22:13,843 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:22:17,229 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:22:27,071 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 11:22:27,073 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:22:27,074 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:22:28,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:22:28,323 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:22:28,325 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:22:30,734 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 11:22:30,763 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:22:33,283 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 11:22:33,287 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:22:37,112 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1227
2025-11-17 11:22:37,113 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:22:42,048 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 157
2025-11-17 11:22:42,049 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:22:43,314 - ispa_next.appointments.models - DEBUG - Appointment Maximilian Eilhardt DAH-GO 390 WMW81GC06STA68907 ohne Termin.
2025-11-17 11:22:43,323 - ispa_next.main - DEBUG - 



2025-11-17 11:22:43,323 - ispa_next.main - DEBUG - starting with process 4 (M-BM 173E) of 6
2025-11-17 11:22:43,327 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:22:45,338 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:22:47,458 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1227
2025-11-17 11:22:47,460 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 157
2025-11-17 11:22:49,636 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:22:49,637 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:23:25,467 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:23:38,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:40,853 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:23:40,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:40,931 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:23:41,252 - ispa_next.functions - DEBUG - HU date soon to be invalid in 2 days.
2025-11-17 11:23:50,232 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:23:50,235 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:23:53,077 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:23:53,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:23:53,364 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 11:23:54,241 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\ProgramData\robocorp\ht\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 11:23:54,260 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:23:54,261 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:23:55,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:23:56,294 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:23:56,295 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:23:56,344 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:23:59,846 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 11:23:59,850 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:24:02,295 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1227
2025-11-17 11:24:02,297 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:24:07,047 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 156
2025-11-17 11:24:07,048 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:24:08,305 - ispa_next.appointments.models - DEBUG - Appointment Maximilian Eilhardt DAH-GO 390 WMW81GC06STA68907 ohne Termin.
2025-11-17 11:24:08,313 - ispa_next.main - DEBUG - 



2025-11-17 11:24:08,313 - ispa_next.main - DEBUG - starting with process 5 (AS-I 135) of 6
2025-11-17 11:24:08,317 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:24:10,241 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:24:12,354 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1227
2025-11-17 11:24:12,356 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 156
2025-11-17 11:24:14,766 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:24:14,768 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:24:55,502 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:25:09,795 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:25:12,411 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:25:12,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:25:12,510 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:25:12,914 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:25:12,918 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:25:16,056 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:25:16,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:25:17,692 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:25:19,697 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:25:19,865 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:25:23,140 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:25:23,300 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:25:23,302 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:25:26,036 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:25:38,308 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:25:39,313 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:25:39,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:25:39,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:25:55,794 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:26:06,046 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:26:06,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:26:06,181 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:26:06,182 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:26:06,240 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:26:07,577 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:26:09,067 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:26:09,326 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:26:11,812 - ispa_next.functions - DEBUG - Updated appointment (AV00011750) customer contact data.
2025-11-17 11:26:12,703 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:26:12,705 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:26:14,400 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:26:14,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:26:15,426 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:26:19,025 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:26:19,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:26:19,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:26:21,577 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:26:21,745 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:26:21,871 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:26:22,019 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:26:22,021 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:26:24,667 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:26:35,653 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:26:43,458 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:26:43,460 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:26:47,624 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 11:26:49,631 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:26:54,616 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:26:55,621 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:26:55,622 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:26:55,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:26:55,708 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:26:59,865 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:27:01,228 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:27:13,654 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:27:13,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:27:13,758 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:27:14,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:27:14,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:27:14,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:27:15,592 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:27:15,594 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:27:18,044 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:27:18,046 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:27:19,602 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:27:19,603 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:27:19,605 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Servicereinigung / Maschinelle Oberwäsche und Fußr, source=from_tab, target=cart)}
2025-11-17 11:27:19,607 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:27:19,609 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 11:27:19,610 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:27:19,611 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Winter - Fit - Paket / Winter - Fit - Paket, source=from_tab, target=advice_list)}
2025-11-17 11:27:19,612 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:27:19,614 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:27:19,615 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:27:19,618 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:27:19,619 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:27:20,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:27:21,114 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:27:28,073 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:27:28,075 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:27:28,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:27:28,912 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:27:43,136 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:27:43,139 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:27:43,141 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:27:43,142 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:46,412 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:27:51,086 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:27:51,089 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:27:51,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:54,595 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:27:54,597 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:27:54,600 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:27:54,601 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:57,899 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:28:21,781 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:28:22,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:28:23,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:28:24,147 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:28:33,527 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:28:40,119 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:28:48,231 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:28:54,556 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:28:54,558 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:28:54,559 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:28:55,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:28:55,896 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:28:55,898 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:28:58,912 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:29:11,471 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:29:11,854 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 11:29:13,067 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:29:15,818 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1228
2025-11-17 11:29:15,820 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:29:20,490 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 155
2025-11-17 11:29:20,490 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:29:21,808 - ispa_next.main - DEBUG - Found new Appointment: DAH-GO 390
2025-11-17 11:29:21,810 - ispa_next.main - DEBUG - 



2025-11-17 11:29:21,811 - ispa_next.main - DEBUG - starting with process 6 (DAH-GO 390) of 7
2025-11-17 11:29:21,815 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:29:23,720 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:29:25,738 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1228
2025-11-17 11:29:25,740 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 155
2025-11-17 11:29:28,263 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:29:28,265 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:30:16,832 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:30:30,618 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:30:32,472 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:30:32,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:32,567 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:30:32,881 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:30:32,883 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:30:35,865 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:30:35,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:30:37,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:30:39,081 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:30:39,218 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:30:39,351 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:30:39,465 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:30:43,690 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:30:44,695 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:30:44,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:45,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:03,377 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:31:13,925 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:31:13,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:14,050 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:31:14,051 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:31:14,094 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:31:15,449 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:31:15,730 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:31:18,411 - ispa_next.functions - DEBUG - Updated appointment (EP00000330) customer contact data.
2025-11-17 11:31:19,394 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:31:19,396 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:31:21,201 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:31:21,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:31:22,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:31:26,736 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:31:26,736 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:31:26,805 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:31:26,806 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:31:26,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:31:27,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:31:31,551 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:31:31,571 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:31:31,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:31:31,664 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:31:41,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:41,681 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:41,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:31:42,480 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:31:42,482 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:31:44,951 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:31:44,953 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:31:46,143 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:31:46,144 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:31:46,146 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Servicereinigung / Maschinelle Oberwäsche und Fußr, source=from_tab, target=cart)}
2025-11-17 11:31:46,157 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:31:46,159 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 11:31:46,162 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:31:46,163 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Winter - Fit - Paket / Winter - Fit - Paket, source=from_tab, target=advice_list)}
2025-11-17 11:31:46,164 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:31:46,166 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:31:46,166 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:31:46,168 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:31:46,170 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:31:46,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:31:47,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:31:54,135 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:31:54,137 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:31:54,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:31:54,923 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:32:08,791 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:32:08,793 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:32:08,794 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:32:08,795 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:32:12,099 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:32:15,609 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:32:15,626 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:32:15,630 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:32:19,080 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:32:19,083 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:32:19,085 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:32:19,090 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:32:22,473 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:32:46,443 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:32:47,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:32:48,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:32:49,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:00,605 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:33:07,115 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:33:13,594 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:33:20,407 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:33:20,409 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:33:20,410 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:33:21,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:33:21,721 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:33:21,723 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:33:24,725 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:33:35,283 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 11:33:35,285 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:33:35,286 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:33:36,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:33:36,821 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:33:36,823 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:33:39,976 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 11:33:40,003 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:33:42,843 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 11:33:42,846 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:33:45,742 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1229
2025-11-17 11:33:45,743 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:33:50,178 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 156
2025-11-17 11:33:50,179 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:33:51,535 - ispa_next.main - DEBUG - Found new Appointment: M-OT 153
2025-11-17 11:33:51,539 - ispa_next.main - DEBUG - 



2025-11-17 11:33:51,539 - ispa_next.main - DEBUG - starting with process 7 (M-OT 153) of 8
2025-11-17 11:33:51,543 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:33:53,575 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:33:55,641 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1229
2025-11-17 11:33:55,643 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 156
2025-11-17 11:33:58,205 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:33:58,207 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:34:37,869 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:34:50,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:51,004 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:34:51,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:34:52,474 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:34:52,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:52,570 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:34:52,957 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 11:35:02,256 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:35:02,259 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:35:05,073 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:35:05,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:35:06,611 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:35:08,615 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:35:08,759 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:35:08,925 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:35:09,077 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:35:09,079 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:35:10,382 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:35:21,843 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:35:29,646 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:35:29,648 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:35:30,915 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:35:35,144 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:35:36,164 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:35:36,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:35:36,721 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:35:54,480 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:36:05,651 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:36:05,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:36:05,771 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:36:05,771 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:36:05,873 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:36:07,262 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:36:08,301 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 11:36:09,542 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 11:36:09,919 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:36:12,217 - ispa_next.functions - DEBUG - Updated appointment (EP00000339) customer contact data.
2025-11-17 11:36:13,135 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:36:13,137 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:36:14,702 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:36:14,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:36:15,806 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:36:20,394 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:36:20,394 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:36:20,456 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:36:20,457 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:36:20,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:36:21,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:36:25,270 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:36:25,273 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:36:25,273 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 11:36:25,275 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:36:27,168 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:36:27,172 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:36:28,363 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:36:28,376 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:36:28,379 - ispa_next.package_manager.main - DEBUG - Cannot place Servicereinigung / Maschinelle Oberwäsche und Fußr: active service advisor guards
2025-11-17 11:36:28,381 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:36:28,383 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:36:28,385 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 11:36:28,389 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:36:28,390 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Winter - Fit - Paket / Winter - Fit - Paket, source=from_tab, target=advice_list)}
2025-11-17 11:36:28,392 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:36:28,405 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:36:28,408 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:36:28,413 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:36:28,415 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:36:29,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:36:29,999 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:36:44,455 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:36:44,458 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:36:44,459 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:36:44,460 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:36:46,405 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:36:50,687 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:36:50,815 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:36:50,819 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:36:52,952 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:36:52,954 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:36:52,956 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:36:52,970 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:36:54,882 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:37:17,582 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:37:18,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:37:19,504 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:37:19,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:37:28,806 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:37:35,547 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:37:35,549 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:37:35,549 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:37:37,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:37:37,280 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:37:37,282 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:37:40,499 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:37:52,935 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:37:53,321 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 11:37:54,203 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:37:56,545 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1229
2025-11-17 11:37:56,547 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:38:00,402 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 156
2025-11-17 11:38:00,403 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:38:01,446 - ispa_next.main - DEBUG - 



2025-11-17 11:38:01,446 - ispa_next.main - DEBUG - starting with process 8 (M-SF 763) of 8
2025-11-17 11:38:01,450 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:38:02,920 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:38:05,036 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1229
2025-11-17 11:38:05,037 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 156
2025-11-17 11:38:07,726 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:38:07,727 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:38:54,864 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:39:08,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:08,704 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:39:08,897 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:39:10,805 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:39:10,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:10,887 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:39:11,187 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 11:39:21,294 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:39:21,297 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:39:24,322 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:39:24,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:39:26,081 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:39:28,087 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:39:28,238 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:39:28,376 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:39:28,457 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:39:28,458 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:39:30,397 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:39:41,457 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:39:49,547 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:39:49,548 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:39:51,592 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:39:55,862 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:39:56,876 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:39:56,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:57,863 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:14,494 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:40:14,495 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:40:25,463 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:40:25,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:25,566 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:40:25,566 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:40:25,622 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:40:26,948 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:40:28,297 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:40:28,524 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:40:32,155 - ispa_next.functions - DEBUG - Updated appointment (FP00000129) customer contact data.
2025-11-17 11:40:33,091 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:40:33,095 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:40:35,040 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:40:35,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:40:36,220 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:40:40,733 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:40:40,733 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:40:40,813 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:40:40,814 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:40:40,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:40:41,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:40:45,612 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:40:45,617 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:40:45,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:40:45,722 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:40:50,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:50,623 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:50,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:40:51,445 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:40:51,447 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:40:54,011 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:40:54,013 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:40:55,542 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:40:55,545 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:40:55,547 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:40:55,548 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:40:55,566 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 11:40:55,569 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:40:55,570 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Winter - Fit - Paket / Winter - Fit - Paket, source=from_tab, target=advice_list)}
2025-11-17 11:40:55,573 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:40:55,576 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:40:55,578 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:40:55,583 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:40:55,589 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:40:56,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:40:57,239 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:41:11,568 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:41:11,571 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:41:11,572 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:41:11,573 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:41:14,390 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:41:14,392 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:41:14,394 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:41:17,074 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:41:17,077 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:41:17,078 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:41:17,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:41:19,693 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:41:41,264 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:41:42,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:41:43,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:41:43,684 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:41:54,747 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:42:01,377 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:42:08,224 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:42:08,225 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:42:08,226 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:42:09,490 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:42:09,588 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:42:09,589 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:42:12,919 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:42:26,359 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:42:26,755 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 11:42:28,029 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:42:30,941 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1230
2025-11-17 11:42:30,942 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:42:35,256 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 157
2025-11-17 11:42:35,257 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:42:36,309 - ispa_next.appointments.models - DEBUG - Appointment Albert Jarausch-Romero DAH-AJ 968 WBA7K310907K73340 ohne Termin.
