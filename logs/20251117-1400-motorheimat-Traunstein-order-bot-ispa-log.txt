2025-11-17 14:14:38,368 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 14:14:38,374 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 14:14:47,898 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:14:58,340 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:15:14,130 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:15:42,149 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 14:15:57,849 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 14:16:00,383 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:16:01,419 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 275
2025-11-17 14:16:01,420 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 91
2025-11-17 14:16:03,583 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 77
2025-11-17 14:16:03,583 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 14:16:03,584 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:16:04,658 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:16:05,791 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:16:15,368 - ispa_next.appointments.models - DEBUG - Appointment Andreas Ponemunski Herr TS-A 1564 WBA71AG050CF97572 ohne Termin.
2025-11-17 14:16:15,378 - ispa_next.appointments.models - DEBUG - Appointment Heiko Lange Herr K-HL 1707 WBAUB51060VJ06122 ohne Termin.
2025-11-17 14:16:15,388 - ispa_next.appointments.models - DEBUG - Appointment Fabian Landler Herr TS-FL 440 WBA11AR0X0CM30916 ohne Termin.
2025-11-17 14:16:15,394 - ispa_next.appointments.models - DEBUG - Appointment Bianca Nadine Böhme Frau TS-BM 6120 WBA8G31070K880825 ohne Termin.
2025-11-17 14:16:15,399 - ispa_next.main - DEBUG - Found 5 out of 8 appointments to process (configured limit: 15).
2025-11-17 14:16:15,399 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-17 14:16:15,399 - ispa_next.main - DEBUG - All appointments: TS-ST 248, BGL-A 774, TS-LU 2810, TS-GH 434, TS-KS 2005
2025-11-17 14:16:15,412 - ispa_next.main - DEBUG - 



2025-11-17 14:16:15,413 - ispa_next.main - DEBUG - starting with process 1 (TS-ST 248) of 5
2025-11-17 14:16:15,415 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:16:16,185 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:16:17,177 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 275
2025-11-17 14:16:17,178 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 77
2025-11-17 14:16:18,606 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:16:18,608 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:16:49,835 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:16:59,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:17:02,618 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:17:02,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:02,719 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:17:02,924 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:17:02,927 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:17:02,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:03,023 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:17:12,809 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:17:12,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:13,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:17:15,779 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:17:15,927 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:17:16,019 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:17:16,132 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:17:20,311 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:17:21,316 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:17:21,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:21,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:31,745 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:17:37,752 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:17:37,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:37,866 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:17:37,867 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:17:37,904 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:17:37,996 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:17:39,220 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:17:39,489 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:17:43,278 - ispa_next.functions - DEBUG - Updated appointment (AJ00018649) customer contact data.
2025-11-17 14:17:44,212 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:17:44,213 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:17:44,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:17:44,921 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:17:46,148 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:17:46,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:17:46,285 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:17:49,847 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:17:49,847 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:17:49,849 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:17:49,850 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:17:49,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:50,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:17:54,482 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:17:55,022 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:18:04,352 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:18:04,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:18:04,492 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:18:04,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:05,369 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:05,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:18:06,145 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:18:06,146 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:18:09,175 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:18:09,177 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:18:10,701 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:18:10,702 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:18:10,703 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:18:10,704 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:18:10,705 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:18:10,706 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:18:10,708 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:18:10,709 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:18:10,710 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:18:10,712 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:18:10,713 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:18:10,715 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:18:10,717 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:18:10,718 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:18:10,719 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:14,027 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:18:14,029 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:18:14,032 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:17,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:18:17,458 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:18:26,671 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:41,140 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:18:41,140 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 14:18:41,142 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:44,492 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:18:44,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:18:45,266 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:18:45,315 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:18:45,319 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:48,628 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:19:01,180 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:19:01,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:19:02,180 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:19:02,437 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:35,185 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:19:40,383 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:19:44,749 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:19:50,945 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:19:50,947 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:19:50,948 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:19:51,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:19:51,918 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:19:51,918 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:19:54,271 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:20:06,520 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:20:06,927 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 14:20:08,370 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:20:08,962 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 275
2025-11-17 14:20:08,963 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:20:12,547 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 91
2025-11-17 14:20:12,547 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:20:13,592 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
2025-11-17 14:20:13,596 - ispa_next.main - DEBUG - 



2025-11-17 14:20:13,596 - ispa_next.main - DEBUG - starting with process 2 (BGL-A 774) of 5
2025-11-17 14:20:13,599 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:20:14,968 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:20:16,753 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 275
2025-11-17 14:20:16,755 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 91
2025-11-17 14:20:18,677 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:20:18,678 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:21:05,018 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:21:17,205 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:21,171 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:21:21,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:21,303 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:21,683 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:21:21,685 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:21:21,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:21,804 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:25,128 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:21:25,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:21:26,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:21:28,708 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:21:28,835 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:21:28,955 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:21:29,095 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:21:33,278 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:21:34,282 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:21:34,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:34,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:48,913 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:21:56,893 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:21:56,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:56,998 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:56,998 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:21:57,078 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:21:58,461 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:21:58,735 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:22:03,183 - ispa_next.functions - DEBUG - Updated appointment (AJ00018645) customer contact data.
2025-11-17 14:22:04,102 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:22:04,104 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:22:05,272 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:22:05,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:22:06,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:22:09,783 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:22:09,783 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:22:09,786 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:22:09,787 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:22:09,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:10,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:22:14,558 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:22:15,945 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:22:25,819 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:22:25,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:25,907 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:22:31,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:32,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:32,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:32,872 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:22:32,873 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:22:36,562 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:22:36,568 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:22:37,914 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:22:37,915 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:22:37,918 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:22:37,919 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:22:37,920 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:22:37,921 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:22:37,922 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:22:37,923 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:22:37,924 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:22:37,926 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:22:37,927 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:22:37,928 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:22:37,930 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:22:37,931 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:22:37,931 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:22:41,890 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:22:41,891 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:22:41,893 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:22:46,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:46,272 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:22:54,994 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:10,657 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:23:10,657 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 14:23:10,660 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:14,743 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:23:14,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:23:15,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:23:15,714 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:23:15,716 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:19,748 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:23:33,775 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:23:34,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:23:34,860 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:23:35,106 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:12,414 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:24:12,415 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:24:13,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:24:13,454 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:24:13,455 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:24:16,889 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:24:27,706 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:24:28,126 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 14:24:28,917 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:24:30,171 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 276
2025-11-17 14:24:30,173 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:24:34,552 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 92
2025-11-17 14:24:34,553 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:24:35,842 - ispa_next.appointments.models - DEBUG - Appointment Ursula Bell Frau RO-UM 550 WBA6V510905V64897 ohne Termin.
2025-11-17 14:24:35,849 - ispa_next.main - DEBUG - 



2025-11-17 14:24:35,849 - ispa_next.main - DEBUG - starting with process 3 (TS-LU 2810) of 5
2025-11-17 14:24:35,853 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:24:37,522 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:24:38,898 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 276
2025-11-17 14:24:38,900 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 92
2025-11-17 14:24:40,587 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:24:40,589 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:25:15,334 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:25:26,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:26,966 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:25:27,193 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:29,103 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:25:29,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:29,186 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:25:29,610 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:25:29,612 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:25:29,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:29,705 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:25:33,188 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:25:33,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:25:34,587 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:25:36,591 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:25:36,729 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:25:40,047 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:25:40,149 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:25:40,149 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:25:51,712 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:25:52,720 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:25:52,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:53,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:10,542 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:26:10,543 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:26:19,329 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:26:19,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:19,452 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:26:19,453 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:26:19,527 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:26:20,928 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:26:22,368 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:26:22,634 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:26:26,915 - ispa_next.functions - DEBUG - Updated appointment (AJ00018630) customer contact data.
2025-11-17 14:26:27,888 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:26:27,890 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:26:29,271 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:26:29,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:26:30,240 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:26:33,843 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:26:33,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:26:34,358 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:26:36,362 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:26:36,557 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:26:36,738 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:26:36,899 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:26:36,899 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:26:48,712 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:27:48,716 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:28:00,316 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:28:16,319 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:28:27,938 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:28:37,936 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:28:38,941 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:28:38,941 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:28:38,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:28:39,065 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:28:43,179 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:28:43,183 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:28:43,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:28:43,288 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:28:48,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:49,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:49,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:28:50,286 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:28:50,287 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:28:52,181 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:28:52,183 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:28:53,672 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:28:53,674 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:28:53,676 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:28:53,677 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:28:53,678 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:28:53,679 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:28:53,682 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:28:53,683 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:28:53,684 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:28:53,691 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:28:53,696 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:28:53,701 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:28:53,706 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:28:53,707 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:28:53,708 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:55,649 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:28:55,650 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:28:55,653 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:57,580 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:28:57,580 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 14:28:57,583 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:59,642 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:28:59,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:29:00,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:29:00,688 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:29:00,693 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:29:02,649 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:29:17,053 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:29:17,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:29:18,061 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:29:18,278 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:29:37,288 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:29:41,918 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:29:41,919 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:29:41,920 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:29:42,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:29:42,623 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:29:42,624 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:29:44,893 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:29:54,941 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:29:55,329 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 14:29:55,920 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:29:57,427 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 276
2025-11-17 14:29:57,429 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:30:01,685 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 92
2025-11-17 14:30:01,686 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:30:02,848 - ispa_next.main - DEBUG - Found new Appointment: RO-UM 550
2025-11-17 14:30:02,849 - ispa_next.main - DEBUG - 



2025-11-17 14:30:02,849 - ispa_next.main - DEBUG - starting with process 4 (RO-UM 550) of 6
2025-11-17 14:30:02,988 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:30:04,739 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:30:06,487 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 276
2025-11-17 14:30:06,489 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 92
2025-11-17 14:30:08,488 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:30:08,489 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:30:55,220 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:31:07,448 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:10,684 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:31:10,684 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:10,780 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:31:11,044 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:31:11,046 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:31:11,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:11,151 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:31:14,811 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:31:14,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:16,171 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:31:18,175 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:31:18,362 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:31:18,525 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:31:18,674 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:31:22,929 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:31:23,934 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:31:23,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:24,424 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:36,234 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:31:36,234 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:31:45,044 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:31:45,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:45,129 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:31:45,131 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:31:45,185 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:31:46,529 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:31:46,775 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:31:51,224 - ispa_next.functions - DEBUG - Updated appointment (AJ00018661) customer contact data.
2025-11-17 14:31:52,148 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:31:52,149 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:31:53,332 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:31:53,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:31:54,255 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:31:57,841 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:31:57,841 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:31:57,843 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:31:57,844 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:31:57,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:58,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:32:02,585 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:32:03,609 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:32:12,781 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:32:12,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:32:12,901 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:32:13,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:32:14,252 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:32:14,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:32:15,018 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:32:15,019 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:32:18,059 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:32:18,064 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:32:19,351 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:32:19,353 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:32:19,354 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:32:19,356 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:32:19,357 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:32:19,358 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:32:19,361 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:32:19,362 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:32:19,363 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:32:19,365 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:32:19,366 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:32:19,368 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:32:19,371 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:32:19,373 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:32:19,374 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:22,764 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:32:22,766 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:32:22,768 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:26,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:32:26,165 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:32:35,649 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:49,629 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:32:49,629 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 14:32:49,631 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:52,976 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:32:52,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:32:53,686 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:32:53,735 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:32:53,738 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:57,023 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:33:09,236 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:33:09,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:33:10,234 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:33:10,437 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:33:42,350 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:33:47,034 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:33:53,185 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:33:58,307 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:33:58,308 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:33:58,309 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:33:59,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:33:59,230 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:33:59,231 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:34:01,550 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:34:12,026 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:34:12,421 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 14:34:13,861 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:34:14,809 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 276
2025-11-17 14:34:14,810 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:34:19,303 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 92
2025-11-17 14:34:19,304 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:34:20,698 - ispa_next.main - DEBUG - 



2025-11-17 14:34:20,698 - ispa_next.main - DEBUG - starting with process 5 (TS-GH 434) of 6
2025-11-17 14:34:20,702 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:34:22,413 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:34:24,161 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 276
2025-11-17 14:34:24,163 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 92
2025-11-17 14:34:26,012 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:34:26,013 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:35:08,203 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 14:35:08,287 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 14:35:08,290 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:35:08,908 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 276
2025-11-17 14:35:08,910 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:35:12,379 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 92
2025-11-17 14:35:12,380 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:35:13,598 - ispa_next.main - DEBUG - 



2025-11-17 14:35:13,598 - ispa_next.main - DEBUG - starting with process 6 (TS-KS 2005) of 6
2025-11-17 14:35:13,602 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:35:15,231 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:35:16,951 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 276
2025-11-17 14:35:16,952 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 92
2025-11-17 14:35:18,558 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:35:18,559 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:35:52,708 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 14:35:52,718 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 14:35:52,722 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:35:53,463 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 276
2025-11-17 14:35:53,464 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:35:57,334 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 92
2025-11-17 14:35:57,335 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
