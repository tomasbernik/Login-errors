2025-11-12 10:14:34,170 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:14:34,176 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:14:44,603 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:14:54,903 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:15:10,472 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:17:07,974 - ispa_next.app_start.main - DEBUG - Operation already took 106.08 seconds (more than 80 seconds)
2025-11-12 10:17:10,024 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_93lesl5g_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_93lesl5g', 'txt']
2025-11-12 10:17:10,364 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:17:10,369 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:17:10,370 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:19:09,356 - ispa_next.app_start.main - DEBUG - Operation already took 106.75 seconds (more than 80 seconds)
2025-11-12 10:19:11,430 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_yulmmba7_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_yulmmba7', 'txt']
2025-11-12 10:19:11,714 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:19:11,729 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:19:19,509 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 10:19:29,239 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:19:39,568 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:19:55,086 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:21:52,836 - ispa_next.app_start.main - DEBUG - Operation already took 106.72 seconds (more than 80 seconds)
2025-11-12 10:21:54,957 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_gqcknxq7_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_gqcknxq7', 'txt']
2025-11-12 10:21:55,210 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:21:55,216 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:21:55,217 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:23:53,969 - ispa_next.app_start.main - DEBUG - Operation already took 106.35 seconds (more than 80 seconds)
2025-11-12 10:23:56,048 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_00ld3xyh_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_00ld3xyh', 'txt']
2025-11-12 10:23:56,285 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:23:56,290 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:24:03,319 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 10:24:11,781 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:24:22,115 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:24:37,789 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:26:35,694 - ispa_next.app_start.main - DEBUG - Operation already took 106.86 seconds (more than 80 seconds)
2025-11-12 10:26:37,765 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_1p0u8ey8_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_1p0u8ey8', 'txt']
2025-11-12 10:26:37,994 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:26:38,000 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:26:38,001 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:28:36,639 - ispa_next.app_start.main - DEBUG - Operation already took 106.34 seconds (more than 80 seconds)
2025-11-12 10:28:38,701 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_p6lj5tle_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_p6lj5tle', 'txt']
2025-11-12 10:28:38,948 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:28:38,953 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:28:45,606 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-12 10:28:54,563 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:29:04,967 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:29:20,585 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:31:18,237 - ispa_next.app_start.main - DEBUG - Operation already took 106.55 seconds (more than 80 seconds)
2025-11-12 10:31:20,327 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_ykckzx7r_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_ykckzx7r', 'txt']
2025-11-12 10:31:20,559 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:31:20,563 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:31:20,564 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:33:19,138 - ispa_next.app_start.main - DEBUG - Operation already took 106.26 seconds (more than 80 seconds)
2025-11-12 10:33:21,198 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_2_z7spkk_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\27083150021b9e49\\tess_2_z7spkk', 'txt']
2025-11-12 10:33:21,415 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:33:21,420 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:33:28,034 - ispa_next.main - DEBUG - ISPA Next attempt (5 / 5)
2025-11-12 10:33:36,372 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:33:46,647 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:34:02,093 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:34:26,330 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:34:37,437 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:34:39,928 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:34:41,190 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:34:41,191 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 126
2025-11-12 10:34:43,463 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 94
2025-11-12 10:34:43,464 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:34:43,464 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:34:44,594 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:34:45,747 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:35:00,647 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:35:00,711 - ispa_next.main - DEBUG - Found 6 out of 42 appointments to process (configured limit: 15).
2025-11-12 10:35:00,711 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-12 10:35:00,711 - ispa_next.main - DEBUG - Processing 1 already visited appointments (w/ RKR not callable).
2025-11-12 10:35:00,711 - ispa_next.main - DEBUG - All appointments: WW-D 570, LM-AT 914, DIZ-GL 7E, ENS-MP-48, LM MM 585, LM-R 890
2025-11-12 10:35:00,714 - ispa_next.main - DEBUG - 



2025-11-12 10:35:00,714 - ispa_next.main - DEBUG - starting with process 1 (WW-D 570) of 6
2025-11-12 10:35:00,718 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:35:01,772 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:35:02,607 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:35:02,609 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 94
2025-11-12 10:35:03,864 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:35:03,865 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:35:35,327 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:35:44,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:47,450 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:35:47,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:47,546 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:35:47,743 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:35:47,746 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:35:47,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:47,836 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:35:50,871 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:35:50,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:35:51,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:35:53,536 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:35:53,624 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:35:56,829 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:35:56,888 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:35:56,888 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:36:05,073 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:36:06,078 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:36:06,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:06,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:17,474 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:36:17,475 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:36:24,287 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:36:24,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:24,384 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:36:24,386 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:36:24,429 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:36:24,533 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:36:25,692 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:36:25,962 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:36:29,857 - ispa_next.functions - DEBUG - Updated appointment (AB00018673) customer contact data.
2025-11-12 10:36:30,772 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:36:30,774 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:36:30,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:36:31,608 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:36:32,999 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:36:32,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:36:33,108 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:36:36,689 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:36:36,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:36:37,164 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:36:39,169 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:36:39,282 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:36:39,399 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:36:39,469 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:36:39,469 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:36:47,615 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:37:47,617 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:37:58,888 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 10:38:02,890 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:38:02,890 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:38:07,092 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:38:08,111 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:38:08,112 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:38:08,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:08,182 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:38:12,278 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 10:38:12,989 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 10:38:24,075 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:38:24,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:24,175 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:38:28,062 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:28,608 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:28,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:29,415 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:38:29,416 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:38:31,890 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:38:31,892 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:38:33,384 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:38:33,385 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:38:33,389 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart)}
2025-11-12 10:38:33,390 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:38:33,392 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:38:33,394 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:38:33,395 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:38:33,397 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:38:33,398 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:38:33,400 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:38:33,403 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:38:34,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:38:34,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:38:48,932 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:38:48,934 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:38:48,936 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:38:48,937 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:52,163 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:38:52,164 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:38:52,171 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:55,446 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:38:55,448 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:38:55,449 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:38:55,962 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:38:56,154 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:05,328 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:39:05,330 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:08,605 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:39:22,869 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:39:23,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:39:23,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:39:24,173 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:32,503 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:37,595 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:44,546 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:39:44,547 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:39:45,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:39:45,322 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:39:45,323 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:39:48,520 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:40:01,681 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:40:02,049 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:40:03,704 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:40:04,500 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:40:04,501 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:40:08,367 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 126
2025-11-12 10:40:08,368 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:40:09,429 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:40:09,433 - ispa_next.main - DEBUG - Found new Appointment: LM-K 55
2025-11-12 10:40:09,434 - ispa_next.main - DEBUG - 



2025-11-12 10:40:09,435 - ispa_next.main - DEBUG - starting with process 2 (LM-K 55) of 7
2025-11-12 10:40:09,438 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:40:10,829 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:40:12,384 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:40:12,385 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 126
2025-11-12 10:40:14,070 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:40:14,072 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:40:53,284 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:41:04,103 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:05,972 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:41:05,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:06,070 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:06,455 - ispa_next.functions - DEBUG - HU date soon to be invalid in 89 days.
2025-11-12 10:41:14,758 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:41:14,761 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:41:14,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:14,841 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:18,231 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:41:18,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:41:19,529 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:41:21,538 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:41:21,666 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:41:24,950 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:41:25,073 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:41:29,310 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:41:30,326 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:41:30,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:30,855 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:46,476 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:41:55,621 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:41:55,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:55,749 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:55,750 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:41:55,800 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:41:57,207 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:41:57,455 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:42:01,556 - ispa_next.functions - DEBUG - Updated appointment (AB00018674) customer contact data.
2025-11-12 10:42:02,460 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:42:02,462 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:42:03,812 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:42:03,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:42:04,710 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:42:09,245 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:42:09,245 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:42:09,256 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:42:09,257 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:42:09,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:42:09,757 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:42:13,965 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:42:13,969 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:42:13,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:42:14,048 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:42:19,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:42:20,221 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:42:20,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:42:21,110 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:42:21,111 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:42:22,979 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:42:22,981 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:42:24,665 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:42:24,666 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:42:24,669 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart)}
2025-11-12 10:42:24,670 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:42:24,672 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:42:24,674 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:42:24,675 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:42:24,677 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:42:24,678 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:42:24,680 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:42:24,682 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:42:25,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:42:26,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:42:39,588 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:42:39,590 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:42:39,592 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:42:39,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:42,183 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:42:42,185 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:42:42,189 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:44,811 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:42:44,812 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:42:44,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:42:45,297 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:42:45,453 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:51,729 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:42:51,731 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:54,304 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:43:07,706 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:43:08,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:43:08,784 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:43:09,007 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:16,588 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:43:23,405 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:43:28,405 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:43:28,407 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:43:28,407 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:43:29,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:43:29,391 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:43:29,392 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:43:31,781 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:43:42,495 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:43:42,892 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:43:44,440 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:43:45,280 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:43:45,281 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:43:48,711 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 126
2025-11-12 10:43:48,712 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:43:49,621 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:43:49,625 - ispa_next.main - DEBUG - 



2025-11-12 10:43:49,625 - ispa_next.main - DEBUG - starting with process 3 (LM-AT 914) of 7
2025-11-12 10:43:49,629 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:43:50,831 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:43:51,987 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:43:51,988 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 126
2025-11-12 10:43:53,773 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:43:53,775 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:44:21,206 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:44:33,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:33,090 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:44:33,335 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:44:35,224 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:44:35,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:35,327 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:44:35,621 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:44:35,624 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:44:35,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:35,771 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:44:39,205 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:44:39,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:44:40,600 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:44:42,605 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:44:42,736 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:44:46,011 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:44:46,115 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:44:46,115 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:44:54,616 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:44:55,620 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:44:55,621 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:56,127 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:06,804 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:45:15,830 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:45:15,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:15,960 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:45:15,961 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:45:16,008 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:45:17,331 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:45:18,596 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:45:18,829 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:45:22,851 - ispa_next.functions - DEBUG - Updated appointment (AB00018670) customer contact data.
2025-11-12 10:45:23,774 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:45:23,776 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:45:25,183 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:45:25,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:45:26,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:45:29,715 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:45:29,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:45:30,339 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:45:32,345 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:45:32,477 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:45:32,611 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:45:32,785 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:45:32,786 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:45:43,650 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:45:49,255 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:45:49,255 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:45:53,494 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:45:54,530 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:45:54,531 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:45:54,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:45:54,627 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:45:58,838 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:45:58,859 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:45:58,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:45:59,014 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:46:03,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:46:03,858 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:46:03,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:46:04,649 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:46:04,653 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:46:06,589 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:46:06,594 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:46:07,933 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:46:07,938 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:46:07,941 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart)}
2025-11-12 10:46:07,944 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:46:07,947 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:46:07,948 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:46:07,950 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:46:07,952 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:46:07,953 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:46:07,955 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:46:07,957 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:46:08,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:46:09,486 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:46:23,302 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:46:23,304 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:46:23,306 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:46:23,306 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:46:25,904 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:46:25,906 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:46:25,914 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:46:28,467 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:46:28,469 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:46:28,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:46:29,018 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:46:29,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:46:43,742 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:46:43,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:46:46,360 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:47:00,292 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:47:00,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:47:01,392 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:47:01,561 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:47:08,979 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:47:14,373 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:47:19,873 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:47:19,875 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:47:19,876 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:47:20,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:47:20,903 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:47:20,904 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:47:23,660 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:47:34,386 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:47:34,773 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:47:36,493 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:47:37,351 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:47:37,352 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:47:41,471 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 126
2025-11-12 10:47:41,472 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:47:42,561 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:47:42,565 - ispa_next.main - DEBUG - 



2025-11-12 10:47:42,566 - ispa_next.main - DEBUG - starting with process 4 (DIZ-GL 7E) of 7
2025-11-12 10:47:42,569 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:47:44,361 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:47:46,037 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:47:46,039 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 126
2025-11-12 10:47:47,953 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:47:47,955 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:48:24,569 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:48:36,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:48:36,988 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:48:37,247 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:48:38,573 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:48:38,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:48:38,662 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:48:39,030 - ispa_next.functions - DEBUG - HU date already expired after 1 days.
2025-11-12 10:48:47,560 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:48:47,563 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:48:47,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:48:47,643 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:48:51,107 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:48:51,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:48:52,423 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:48:54,428 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:48:54,568 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:48:57,818 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:48:57,960 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:48:57,960 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:49:06,601 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:49:07,607 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:49:07,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:08,346 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:21,303 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:49:21,303 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:49:30,446 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:49:30,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:30,553 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:49:30,554 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:49:30,609 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:49:31,991 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:49:32,199 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:49:36,524 - ispa_next.functions - DEBUG - Updated appointment (AB00018665) customer contact data.
2025-11-12 10:49:37,463 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:49:37,466 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:49:38,596 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:49:38,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:49:39,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:49:42,963 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:49:42,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:49:43,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:49:45,480 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:49:45,757 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:49:45,928 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:49:46,059 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:49:46,059 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:49:57,179 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:50:01,858 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:50:01,858 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:50:06,085 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:50:07,105 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:50:07,115 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:50:07,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:50:07,207 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:50:11,398 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:50:11,402 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:50:11,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:50:11,485 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:50:17,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:50:17,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:50:17,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:50:18,419 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:50:18,421 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:50:19,730 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:50:19,732 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:50:21,020 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:50:21,022 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:50:21,040 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart)}
2025-11-12 10:50:21,042 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:50:21,045 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:50:21,046 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:50:21,048 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:50:21,050 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:50:21,051 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:50:21,053 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:50:21,059 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:50:21,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:50:22,641 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:50:36,770 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:50:36,772 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:50:36,774 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:50:36,775 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:50:38,765 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:50:38,767 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:50:38,769 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:50:40,726 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:50:40,728 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:50:40,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:50:41,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:50:41,631 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:50:52,267 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:50:52,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:50:54,236 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:51:09,334 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:51:09,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:51:10,528 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:51:10,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:51:18,219 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:51:23,813 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:51:23,815 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:51:23,815 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:51:24,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:51:24,816 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:51:24,817 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:51:27,377 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:51:38,052 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:51:38,419 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:51:40,067 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:51:40,867 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:51:40,868 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:51:45,087 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 126
2025-11-12 10:51:45,087 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:51:46,155 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:51:46,159 - ispa_next.main - DEBUG - 



2025-11-12 10:51:46,159 - ispa_next.main - DEBUG - starting with process 5 (ENS-MP-48) of 7
2025-11-12 10:51:46,163 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:51:47,806 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:51:49,522 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:51:49,535 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 126
2025-11-12 10:51:51,412 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:51:51,414 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:52:27,915 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:52:28,012 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:52:28,017 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:52:28,751 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:52:28,753 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:52:32,296 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 126
2025-11-12 10:52:32,297 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:52:33,425 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:52:33,430 - ispa_next.main - DEBUG - 



2025-11-12 10:52:33,430 - ispa_next.main - DEBUG - starting with process 6 (LM MM 585) of 7
2025-11-12 10:52:33,434 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:52:35,054 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:52:36,663 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:52:36,665 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 126
2025-11-12 10:52:38,520 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:52:38,522 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:53:14,447 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:53:14,459 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:53:14,463 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:53:15,169 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:53:15,170 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:53:18,883 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 126
2025-11-12 10:53:18,884 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:53:19,970 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:53:19,974 - ispa_next.main - DEBUG - 



2025-11-12 10:53:19,974 - ispa_next.main - DEBUG - starting with process 7 (LM-R 890) of 7
2025-11-12 10:53:19,977 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:53:21,708 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:53:23,439 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:53:23,440 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 126
2025-11-12 10:53:25,334 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:53:25,335 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:53:55,721 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:53:58,302 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:54:04,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:54:06,800 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:54:06,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:54:06,916 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:54:07,292 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:54:07,294 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:54:07,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:54:07,391 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:54:16,076 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:54:16,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:54:17,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:54:19,787 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:54:19,904 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:54:20,063 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:54:20,176 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:54:24,365 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:54:25,371 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:54:25,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:54:25,874 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:54:39,545 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:54:44,678 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:54:44,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:54:44,798 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:54:44,799 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:54:44,864 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:54:46,450 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:54:47,706 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:54:47,981 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:54:49,821 - ispa_next.functions - DEBUG - Updated appointment (AC00019071) customer contact data.
2025-11-12 10:54:50,730 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:54:50,733 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:54:51,866 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:54:51,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:54:52,861 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:54:56,741 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:54:56,741 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:54:56,744 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:54:56,745 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:54:56,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:54:57,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:55:01,430 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:55:01,434 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:55:01,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:55:01,551 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:55:01,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:55:02,425 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:55:02,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:55:03,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:55:03,366 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:55:05,851 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:55:05,853 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:55:07,678 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:55:07,701 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:55:07,708 - ispa_next.package_manager.main - DEBUG - Cannot place FAHRZEUGWÄSCHE BASIS: active placement guards
2025-11-12 10:55:07,721 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug Innenraum saugen: active placement guards
2025-11-12 10:55:07,727 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:55:07,728 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:55:07,733 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:55:07,735 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:55:07,736 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:55:07,739 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:55:07,740 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:55:07,742 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:55:07,744 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:55:07,746 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:55:07,746 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:55:10,365 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:55:10,368 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:55:10,373 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:55:13,003 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:55:13,005 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:55:13,006 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:55:14,084 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:55:14,343 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:55:28,534 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:55:28,536 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:55:31,164 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:55:45,612 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:55:46,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:55:46,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:55:47,039 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:55:54,748 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:56:00,208 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:56:00,210 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:56:00,211 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:56:00,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:56:01,075 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:56:01,076 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:56:03,246 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:56:13,308 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:56:13,696 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 10:56:15,126 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:56:15,959 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 549
2025-11-12 10:56:15,960 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:56:20,326 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 126
2025-11-12 10:56:20,327 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:56:21,440 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
