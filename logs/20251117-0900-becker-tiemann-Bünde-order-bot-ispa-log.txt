2025-11-17 09:00:35,526 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 09:00:35,536 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 09:00:49,927 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:01:00,329 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:01:15,894 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:01:48,304 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 09:01:59,362 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 09:02:02,634 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:02:03,899 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 584
2025-11-17 09:02:03,900 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 318
2025-11-17 09:02:06,141 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 133
2025-11-17 09:02:06,141 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 09:02:06,142 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:02:07,030 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:02:07,795 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:02:28,619 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:02:28,684 - ispa_next.appointments.models - DEBUG - Appointment Mariya Aleksandrovna OS-UA 81 WBA4C11010G273031 ohne Termin.
2025-11-17 09:02:28,695 - ispa_next.appointments.models - DEBUG - Appointment Öezlem Cicek HF-OZ 84 WBA31AX010FP86133 ohne Termin.
2025-11-17 09:02:28,702 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-17 09:02:28,708 - ispa_next.appointments.models - DEBUG - Appointment Karlheinz Böttger HF-EK 2016 WBA2X71000V366813 ohne Termin.
2025-11-17 09:02:28,718 - ispa_next.main - DEBUG - Found 8 out of 40 appointments to process (configured limit: 15).
2025-11-17 09:02:28,718 - ispa_next.main - DEBUG - Processing 8 fresh appointments.
2025-11-17 09:02:28,718 - ispa_next.main - DEBUG - All appointments: HF-LF 3030, HF-XN44, HF-X 1020, BÜNDE, HF L 1612, OS-CW177, HF-BT 540, BÜNDE
2025-11-17 09:02:28,720 - ispa_next.main - DEBUG - 



2025-11-17 09:02:28,721 - ispa_next.main - DEBUG - starting with process 1 (HF-LF 3030) of 8
2025-11-17 09:02:28,724 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:02:29,646 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:02:30,853 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 584
2025-11-17 09:02:30,855 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 133
2025-11-17 09:02:32,208 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:02:32,209 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:03:04,706 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:03:13,833 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:03:21,061 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:03:21,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:03:21,135 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:03:21,357 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:03:21,360 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:03:21,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:03:21,471 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:03:24,651 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:03:24,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:03:25,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:03:27,705 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:03:27,812 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:03:31,016 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:03:31,105 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:03:31,106 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:03:42,318 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:03:43,322 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:03:43,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:03:43,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:03:55,295 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:03:55,296 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 09:04:01,560 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:04:01,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:04:01,626 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:04:01,627 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:04:01,668 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:04:02,958 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:04:04,057 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:04:04,353 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:04:07,469 - ispa_next.functions - DEBUG - Updated appointment (AA00044696) customer contact data.
2025-11-17 09:04:08,387 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:04:08,388 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:04:09,293 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:04:09,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:04:09,996 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:04:13,585 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:04:13,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:04:14,074 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:04:16,084 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:04:16,199 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:04:16,304 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:04:16,391 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:04:16,392 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:04:27,913 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 09:04:35,316 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:04:35,316 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:04:39,514 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:04:40,521 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:04:40,524 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:04:40,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:04:40,616 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:04:50,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:04:51,083 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:04:51,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:04:51,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:04:51,784 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:04:58,769 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:04:58,782 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:04:59,708 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:04:59,710 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:04:59,712 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 09:04:59,714 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 09:04:59,716 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:04:59,718 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:04:59,720 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:04:59,721 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:04:59,722 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:04:59,724 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:04:59,725 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:04:59,727 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:04:59,730 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:04:59,731 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:04:59,732 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:05:07,670 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:05:07,672 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:05:07,674 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:05:15,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:05:15,807 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:05:24,429 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:05:42,815 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:05:42,816 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:05:42,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:05:43,607 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:05:43,831 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:06:08,542 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:06:08,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:06:16,530 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:06:16,533 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:06:17,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:06:17,603 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:06:17,729 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:06:27,076 - ispa_next.common.utils - DEBUG - Attempt 1/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 09:06:27,076 - ispa_next.common.utils - DEBUG - Attempt 1/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 1.0s
2025-11-17 09:06:29,484 - ispa_next.common.utils - DEBUG - Attempt 2/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 09:06:29,485 - ispa_next.common.utils - DEBUG - Attempt 2/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 2.0s
2025-11-17 09:06:32,974 - ispa_next.common.utils - DEBUG - Attempt 3/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 09:06:32,975 - ispa_next.common.utils - DEBUG - Attempt 3/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 4.0s
2025-11-17 09:06:38,352 - ispa_next.common.utils - DEBUG - Attempt 4/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 09:06:38,352 - ispa_next.common.utils - DEBUG - Attempt 4/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 8.0s
2025-11-17 09:06:47,543 - ispa_next.common.utils - DEBUG - Attempt 5/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 09:06:47,543 - ispa_next.common.utils - DEBUG - Attempt 5/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 16.0s
2025-11-17 09:07:04,924 - ispa_next.common.utils - DEBUG - Attempt 6/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 09:07:05,593 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 126, in process_appointment
    f.check_cart_packages_for_parts_service_and_parts_availability(app, appointment, state)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\functions.py", line 390, in check_cart_packages_for_parts_service_and_parts_availability
    retry_ui_action(open_job_details_view, condition=job_details_view_exists, base_delay=1.0)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\utils.py", line 254, in retry_ui_action
    raise RetryUiActionError(f"UI action failed after {max_attempts} attempts: Condition never satisfied")
ispa_next.exceptions.RetryUiActionError: UI action failed after 6 attempts: Condition never satisfied

2025-11-17 09:07:05,683 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:07:05,684 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:07:06,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:07:06,451 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:07:06,452 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 09:07:06,477 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 09:07:09,432 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 09:07:09,435 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:07:09,802 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 584
2025-11-17 09:07:09,803 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:07:12,519 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 317
2025-11-17 09:07:12,520 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:07:13,296 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:07:13,296 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:07:13,304 - ispa_next.main - DEBUG - Found new Appointment: HF-ML 7030
2025-11-17 09:07:13,305 - ispa_next.main - DEBUG - 



2025-11-17 09:07:13,305 - ispa_next.main - DEBUG - starting with process 2 (HF-ML 7030) of 9
2025-11-17 09:07:13,309 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:07:14,380 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:07:15,448 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 584
2025-11-17 09:07:15,449 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 317
2025-11-17 09:07:16,702 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:07:16,704 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:07:38,920 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:07:47,872 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:07:53,196 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:07:53,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:07:53,262 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:07:53,419 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:07:53,421 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:07:53,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:07:53,483 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:07:56,376 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:07:56,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:07:57,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:07:59,334 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:07:59,443 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:08:02,657 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 09:08:10,205 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 09:08:11,211 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:08:11,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:08:11,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:08:23,369 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:08:30,000 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:08:30,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:08:30,086 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:08:30,088 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:08:30,123 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:08:31,292 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:08:32,299 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 09:08:33,485 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 09:08:33,787 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:08:36,464 - ispa_next.functions - DEBUG - Updated appointment (AA00044704) customer contact data.
2025-11-17 09:08:37,389 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:08:37,391 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:08:38,151 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:08:38,152 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:08:38,966 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:08:43,015 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 09:08:43,015 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:08:43,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:08:43,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:08:45,526 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:08:45,640 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:08:45,729 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:08:45,830 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:08:49,989 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:08:50,995 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:08:50,998 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:08:50,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:08:51,080 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:08:59,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:09:00,386 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:09:00,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:09:00,991 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:09:00,992 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:09:05,676 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:09:05,678 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:09:06,637 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:09:06,638 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:09:06,640 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 09:09:06,640 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 09:09:06,641 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:09:06,642 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:09:06,646 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:09:06,649 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:09:06,652 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:09:06,656 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:09:06,659 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:09:06,661 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:09:06,663 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:09:06,665 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:09:06,665 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:11,994 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:09:11,995 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:09:11,997 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:17,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:09:17,340 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:09:27,391 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:09:27,392 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:09:27,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:09:28,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:09:28,295 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:37,384 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:09:37,388 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:42,687 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:09:42,690 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:09:43,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:09:43,682 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:09:43,849 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:53,221 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:09:57,354 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:10:02,909 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:10:02,910 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:10:03,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:10:03,682 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:10:03,683 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:10:06,445 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:10:17,204 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:10:17,600 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 09:10:18,542 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:10:19,080 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 585
2025-11-17 09:10:19,081 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:10:22,072 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 318
2025-11-17 09:10:22,073 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:10:22,902 - ispa_next.appointments.models - DEBUG - Appointment Christian Josef Güth HF-CM 9945 WBA71BX0807M38881 ohne Termin.
2025-11-17 09:10:22,911 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:10:22,911 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:10:22,919 - ispa_next.main - DEBUG - 



2025-11-17 09:10:22,919 - ispa_next.main - DEBUG - starting with process 3 (HF-XN44) of 9
2025-11-17 09:10:22,922 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:10:23,991 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:10:25,079 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 585
2025-11-17 09:10:25,080 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 318
2025-11-17 09:10:26,414 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:10:26,415 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:10:57,790 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:10:57,801 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 09:10:57,805 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:10:58,206 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 585
2025-11-17 09:10:58,207 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:11:00,781 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 318
2025-11-17 09:11:00,782 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:11:01,582 - ispa_next.appointments.models - DEBUG - Appointment Christian Josef Güth HF-CM 9945 WBA71BX0807M38881 ohne Termin.
2025-11-17 09:11:01,590 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:11:01,590 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:11:01,597 - ispa_next.main - DEBUG - 



2025-11-17 09:11:01,597 - ispa_next.main - DEBUG - starting with process 4 (HF-X 1020) of 9
2025-11-17 09:11:01,601 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:11:02,887 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:11:04,295 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 585
2025-11-17 09:11:04,296 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 318
2025-11-17 09:11:05,702 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:11:05,703 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:11:28,816 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:11:38,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:11:46,230 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:11:46,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:11:46,291 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:11:46,449 - ispa_next.functions - DEBUG - HU date already expired after 78 days.
2025-11-17 09:11:53,637 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:11:53,639 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:11:53,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:11:53,700 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:12:03,733 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:12:03,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:12:04,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:12:06,792 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:12:06,887 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:12:10,092 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:12:10,193 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:12:10,193 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:12:21,622 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:12:22,627 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:12:22,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:12:23,126 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:12:37,433 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 09:12:44,959 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:12:44,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:12:45,035 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:12:45,035 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:12:45,104 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:12:46,321 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:12:47,437 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 09:12:48,696 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 09:12:49,074 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:12:51,720 - ispa_next.functions - DEBUG - Updated appointment (AA00044542) customer contact data.
2025-11-17 09:12:52,632 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:12:52,634 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:12:53,535 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:12:53,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:12:54,267 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:12:58,285 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 09:12:58,285 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:12:58,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:12:58,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:13:00,794 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:13:00,897 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:13:01,017 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:13:01,107 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:13:01,107 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:13:12,311 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:14:12,313 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:14:23,283 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:14:29,286 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:14:40,220 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 09:14:47,478 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:14:47,478 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:14:49,637 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:14:50,649 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:14:50,652 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:14:50,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:14:50,778 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:14:51,138 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:14:51,681 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:14:51,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:14:52,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:14:52,388 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:15:00,634 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:15:00,635 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:15:01,776 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:15:01,778 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:15:01,780 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart), Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=from_aw_package, target=cart)}
2025-11-17 09:15:01,781 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:15:01,783 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:15:01,784 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:15:01,785 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:15:01,787 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:15:01,788 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:15:01,789 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:15:01,791 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:16:00,766 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:16:00,768 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:16:00,769 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:16:00,771 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:16:11,599 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 09:16:17,511 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:16:17,520 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:16:17,571 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:16:28,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:16:28,488 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:16:38,803 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:16:59,565 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:16:59,567 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:16:59,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:17:00,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:17:00,448 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:17:13,414 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:17:13,416 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:17:24,211 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:17:24,213 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:17:24,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:17:25,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:17:25,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:17:37,545 - ispa_next.common.utils - DEBUG - Attempt 1/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 09:17:37,545 - ispa_next.common.utils - DEBUG - Attempt 1/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 1.0s
2025-11-17 09:17:39,723 - ispa_next.common.utils - DEBUG - Attempt 2/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 09:17:39,724 - ispa_next.common.utils - DEBUG - Attempt 2/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 2.0s
2025-11-17 09:17:42,969 - ispa_next.common.utils - DEBUG - Attempt 3/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 09:17:42,969 - ispa_next.common.utils - DEBUG - Attempt 3/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 4.0s
2025-11-17 09:17:48,161 - ispa_next.common.utils - DEBUG - Attempt 4/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 09:17:48,162 - ispa_next.common.utils - DEBUG - Attempt 4/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 8.0s
2025-11-17 09:17:57,530 - ispa_next.common.utils - DEBUG - Attempt 5/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 09:17:57,530 - ispa_next.common.utils - DEBUG - Attempt 5/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 16.0s
2025-11-17 09:18:14,746 - ispa_next.common.utils - DEBUG - Attempt 6/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 09:18:15,070 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 126, in process_appointment
    f.check_cart_packages_for_parts_service_and_parts_availability(app, appointment, state)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\functions.py", line 390, in check_cart_packages_for_parts_service_and_parts_availability
    retry_ui_action(open_job_details_view, condition=job_details_view_exists, base_delay=1.0)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\utils.py", line 254, in retry_ui_action
    raise RetryUiActionError(f"UI action failed after {max_attempts} attempts: Condition never satisfied")
ispa_next.exceptions.RetryUiActionError: UI action failed after 6 attempts: Condition never satisfied

2025-11-17 09:18:15,086 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:18:15,087 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:18:15,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:18:15,898 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:18:15,899 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 09:18:15,921 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 09:18:18,793 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 09:18:18,796 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:18:19,132 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 587
2025-11-17 09:18:19,133 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:18:21,684 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 320
2025-11-17 09:18:21,684 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:18:22,312 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-17 09:18:22,318 - ispa_next.appointments.models - DEBUG - Appointment Christian Josef Güth HF-CM 9945 WBA71BX0807M38881 ohne Termin.
2025-11-17 09:18:22,326 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:18:22,327 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:22,332 - ispa_next.main - DEBUG - Found new Appointment: HF-HX 70
2025-11-17 09:18:22,334 - ispa_next.main - DEBUG - 



2025-11-17 09:18:22,335 - ispa_next.main - DEBUG - starting with process 5 (HF-HX 70) of 10
2025-11-17 09:18:22,338 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:18:23,138 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:18:23,969 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 587
2025-11-17 09:18:23,970 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 320
2025-11-17 09:18:25,415 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:18:25,416 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:18:46,204 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:18:55,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:18:55,997 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:18:56,154 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:18:57,355 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:18:57,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:18:57,465 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:18:57,658 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:18:57,660 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:18:57,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:18:57,764 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:19:00,932 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:19:00,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:19:01,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:19:03,987 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:19:04,083 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:19:07,399 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:19:07,459 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:19:07,459 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:19:18,723 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:19:19,726 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:19:19,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:19:20,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:19:31,413 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:19:31,413 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 09:19:37,997 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:19:38,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:19:38,069 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:19:38,070 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:19:38,104 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:19:39,316 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:19:39,562 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:19:42,639 - ispa_next.functions - DEBUG - Updated appointment (AA00044709) customer contact data.
2025-11-17 09:19:43,535 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:19:43,537 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:19:44,476 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:19:44,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:19:45,212 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:19:48,795 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:19:48,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:19:49,325 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:19:51,355 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:19:51,476 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:19:51,590 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:19:51,666 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:19:51,666 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:20:02,398 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:20:09,513 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:20:09,513 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:20:13,725 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:20:14,730 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:20:14,747 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:20:14,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:20:14,827 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:20:20,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:20,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:20,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:20:21,644 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:20:21,645 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:20:22,936 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:20:22,939 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:20:24,021 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:20:24,022 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:20:24,025 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 09:20:24,026 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 09:20:24,027 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:20:24,028 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:20:24,030 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:20:24,031 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:20:24,032 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:20:24,034 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:20:24,035 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:20:24,037 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:20:24,039 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:20:24,040 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:20:24,041 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:20:25,232 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:20:25,234 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:20:25,238 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:20:26,462 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:20:26,463 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:20:26,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:20:27,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:20:27,475 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:20:37,373 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:20:37,374 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:20:38,649 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:20:38,651 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:20:39,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:20:39,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:20:39,991 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:20:45,528 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:20:45,530 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:20:45,530 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:20:46,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:20:46,273 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:20:46,274 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:20:48,092 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:20:55,538 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:20:55,907 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 09:20:56,267 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:20:57,466 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 587
2025-11-17 09:20:57,467 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:21:00,198 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 320
2025-11-17 09:21:00,198 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:21:01,090 - ispa_next.appointments.models - DEBUG - Appointment Christian Josef Güth HF-CM 9945 WBA71BX0807M38881 ohne Termin.
2025-11-17 09:21:01,098 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:21:01,098 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:21:01,104 - ispa_next.main - DEBUG - Found new Appointment: MI-OV 77
2025-11-17 09:21:01,106 - ispa_next.main - DEBUG - 



2025-11-17 09:21:01,106 - ispa_next.main - DEBUG - starting with process 6 (MI-OV 77) of 11
2025-11-17 09:21:01,109 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:21:01,915 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:21:02,776 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 587
2025-11-17 09:21:02,777 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 320
2025-11-17 09:21:03,906 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:21:03,907 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:21:27,508 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:21:37,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:21:37,637 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:21:37,808 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:21:38,996 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:21:38,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:21:39,101 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:21:39,348 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:21:39,349 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:21:39,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:21:39,447 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:21:49,865 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:21:49,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:21:50,929 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:21:52,933 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:21:53,044 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:21:56,272 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:21:56,350 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:21:56,351 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:22:07,699 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:22:08,703 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:22:08,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:22:09,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:22:17,933 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 09:22:23,919 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:22:23,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:22:23,998 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:22:23,998 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:22:24,048 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:22:24,137 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:22:25,759 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:22:25,985 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:22:29,155 - ispa_next.functions - DEBUG - Updated appointment (AA00044710) customer contact data.
2025-11-17 09:22:30,064 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:22:30,065 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:22:30,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:22:30,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:22:32,190 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:22:32,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:22:32,287 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:22:36,316 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 09:22:36,316 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:22:36,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:22:36,903 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:22:38,906 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:22:39,031 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:22:39,157 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:22:39,246 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:22:39,247 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:22:50,289 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:23:50,291 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:24:01,595 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:24:27,597 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:24:38,440 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:24:45,646 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:24:45,646 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:24:49,818 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:24:50,824 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:24:50,826 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:24:50,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:24:50,916 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:24:51,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:24:51,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:24:51,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:24:52,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:24:52,691 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:24:54,590 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:24:54,592 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:24:55,642 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:24:55,644 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:24:55,647 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 09:24:55,649 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 09:24:55,650 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:24:55,651 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:24:55,653 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:24:55,654 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:24:55,655 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:24:55,656 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:24:55,657 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:24:55,659 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:24:55,662 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:24:55,663 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:24:55,664 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:24:57,537 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:24:57,538 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:24:57,540 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:24:59,467 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:24:59,469 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:24:59,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:25:00,121 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:25:00,195 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:25:00,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:25:02,054 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:25:02,055 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:25:02,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:25:03,127 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:25:03,255 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:25:09,259 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:25:12,751 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:25:12,753 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:25:12,753 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:25:13,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:25:13,381 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:25:13,383 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:25:14,800 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:25:21,481 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:25:21,873 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 09:25:22,275 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:25:23,322 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 587
2025-11-17 09:25:23,323 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:25:26,539 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 09:25:26,539 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:25:27,263 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:25:27,264 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:25:27,270 - ispa_next.main - DEBUG - 



2025-11-17 09:25:27,270 - ispa_next.main - DEBUG - starting with process 7 (BÜNDE) of 11
2025-11-17 09:25:27,273 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:25:28,527 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:25:29,775 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 587
2025-11-17 09:25:29,776 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 09:25:31,125 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:25:31,126 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:26:08,908 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:26:08,920 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 09:26:08,923 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:26:09,412 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 587
2025-11-17 09:26:09,413 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:26:12,068 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 09:26:12,069 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:26:12,912 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:26:12,913 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:26:12,924 - ispa_next.main - DEBUG - 



2025-11-17 09:26:12,924 - ispa_next.main - DEBUG - starting with process 8 (HF L 1612) of 11
2025-11-17 09:26:12,927 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:26:14,055 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:26:15,252 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 587
2025-11-17 09:26:15,254 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 09:26:16,674 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:26:16,676 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:26:47,647 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:26:47,656 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 09:26:47,659 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:26:48,185 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 587
2025-11-17 09:26:48,186 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:26:50,809 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 09:26:50,810 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:26:52,042 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:26:52,042 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:26:52,049 - ispa_next.main - DEBUG - 



2025-11-17 09:26:52,049 - ispa_next.main - DEBUG - starting with process 9 (OS-CW177) of 11
2025-11-17 09:26:52,052 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:26:53,163 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:26:54,278 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 587
2025-11-17 09:26:54,279 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 09:26:55,714 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:26:55,716 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:27:27,385 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:27:27,395 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 09:27:27,398 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:27:27,969 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 587
2025-11-17 09:27:27,971 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:27:29,884 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 09:27:29,885 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:27:30,709 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:27:30,710 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:27:30,716 - ispa_next.main - DEBUG - 



2025-11-17 09:27:30,716 - ispa_next.main - DEBUG - starting with process 10 (HF-BT 540) of 11
2025-11-17 09:27:30,719 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:27:32,007 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:27:33,197 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 587
2025-11-17 09:27:33,198 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 09:27:34,634 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:27:34,635 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:27:57,311 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:28:09,266 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:28:13,209 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:28:13,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:13,284 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:28:13,567 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:28:13,569 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:28:13,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:13,665 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:28:16,872 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:28:16,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:28:18,046 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:28:20,062 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:28:20,183 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:28:23,435 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:28:23,506 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:28:23,506 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:28:34,747 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:28:35,756 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:28:35,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:36,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:47,513 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:28:47,514 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 09:28:54,312 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:28:54,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:54,398 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:28:54,399 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:28:54,441 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:28:55,663 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:28:55,878 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:28:59,338 - ispa_next.functions - DEBUG - Updated appointment (AE00024535) customer contact data.
2025-11-17 09:29:00,255 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:29:00,257 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:29:01,139 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:29:01,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:29:02,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:29:05,697 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:29:05,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:29:06,206 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:29:08,208 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:29:08,327 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:29:08,445 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:29:08,518 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:29:08,518 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:29:19,936 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 09:29:27,417 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:29:27,417 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:29:31,628 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:29:32,635 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:29:32,638 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:29:32,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:29:32,706 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:29:33,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:29:33,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:29:33,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:29:34,380 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:29:34,381 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:29:38,009 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:29:38,039 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:29:39,559 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:29:39,561 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:29:39,563 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 09:29:39,564 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 09:29:39,565 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:29:39,570 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:29:39,588 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:29:39,590 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:29:39,593 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:29:39,595 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:29:39,596 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:29:39,602 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:29:39,614 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:29:39,616 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:29:39,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:29:43,587 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:29:43,590 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:29:43,592 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:29:47,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:29:47,619 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:29:56,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:30:10,171 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:30:10,172 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:30:10,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:30:11,104 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:30:11,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:30:24,151 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:30:24,154 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:30:28,132 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:30:28,133 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:30:28,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:30:29,188 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:30:29,303 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:30:36,778 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:30:41,241 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:30:46,185 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:30:46,186 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:30:46,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:30:46,713 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:30:46,715 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:30:49,552 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:30:57,011 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:30:57,420 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 09:30:58,416 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:30:58,965 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 588
2025-11-17 09:30:58,966 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:31:01,284 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 320
2025-11-17 09:31:01,284 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:31:01,921 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:31:01,921 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:31:01,927 - ispa_next.main - DEBUG - Found new Appointment: BI-SD 245E
2025-11-17 09:31:01,928 - ispa_next.main - DEBUG - 



2025-11-17 09:31:01,929 - ispa_next.main - DEBUG - starting with process 11 (BI-SD 245E) of 12
2025-11-17 09:31:01,934 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:31:02,786 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:31:03,713 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 588
2025-11-17 09:31:03,715 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 320
2025-11-17 09:31:05,011 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:31:05,012 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:31:35,866 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:31:45,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:31:50,303 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:31:50,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:31:50,392 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:31:50,579 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:31:50,581 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:31:50,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:31:50,645 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:31:53,691 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:31:53,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:31:54,793 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:31:56,797 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:31:56,894 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:32:00,128 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 09:32:07,465 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 09:32:08,469 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:32:08,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:32:08,965 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:32:19,638 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:32:19,639 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 09:32:26,668 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:32:26,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:32:26,784 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:32:26,785 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:32:26,864 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:32:28,060 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:32:29,286 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:32:29,507 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:32:33,104 - ispa_next.functions - DEBUG - Updated appointment (AA00044713) customer contact data.
2025-11-17 09:32:34,098 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:32:34,100 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:32:34,841 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:32:34,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:32:35,567 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:32:39,165 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:32:39,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:32:39,658 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:32:41,660 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:32:41,769 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:32:41,882 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:32:42,007 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:32:42,008 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:32:53,775 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:33:53,777 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:34:04,818 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 09:34:12,018 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:34:12,018 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:34:16,186 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:34:17,193 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:34:17,196 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:34:17,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:34:17,268 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:34:22,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:34:23,386 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:34:23,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:34:24,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:34:24,079 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:34:28,265 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:34:28,267 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:34:29,374 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:34:29,376 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:34:29,377 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 09:34:29,380 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 09:34:29,385 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:34:29,388 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:34:29,390 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:34:29,392 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:34:29,393 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:34:29,395 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:34:29,396 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:34:29,398 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:34:29,400 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:34:29,401 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:34:29,402 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:34,069 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:34:34,070 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:34:34,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:38,732 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:34:38,735 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:34:38,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:34:39,682 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:34:39,977 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:57,732 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:34:57,734 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:02,407 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:35:02,408 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:35:02,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:35:03,576 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:35:03,714 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:12,648 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:35:16,452 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:35:20,427 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:35:24,862 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:35:29,013 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:35:32,707 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:35:32,709 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:35:32,710 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:35:33,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:35:33,471 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:35:33,472 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:35:35,418 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:35:48,519 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 09:35:48,522 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:35:48,522 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:35:49,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:35:49,445 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:35:49,446 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:35:51,216 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:35:57,927 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 09:35:57,929 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:35:57,929 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:35:58,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:35:58,408 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:35:58,409 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:36:00,121 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 09:36:00,151 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 09:36:02,118 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 09:36:02,121 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:36:05,137 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 588
2025-11-17 09:36:05,139 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:36:08,118 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 320
2025-11-17 09:36:08,118 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:36:08,932 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:36:08,933 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:36:08,948 - ispa_next.main - DEBUG - 



2025-11-17 09:36:08,948 - ispa_next.main - DEBUG - starting with process 12 (BÜNDE) of 12
2025-11-17 09:36:08,952 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:36:10,107 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:36:11,245 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 588
2025-11-17 09:36:11,247 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 320
2025-11-17 09:36:12,669 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:36:12,671 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:36:42,436 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:36:42,448 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 09:36:42,454 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:36:42,956 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 588
2025-11-17 09:36:42,957 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:36:45,703 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 320
2025-11-17 09:36:45,704 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:36:46,488 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:36:46,488 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
