2025-11-12 07:07:35,998 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 07:07:36,024 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 07:07:46,255 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:07:56,493 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:08:12,073 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:10:10,207 - ispa_next.app_start.main - DEBUG - Operation already took 106.84 seconds (more than 80 seconds)
2025-11-12 07:10:12,290 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\76938e7134f2378c\\tess_wjziiyz2_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\76938e7134f2378c\\tess_wjziiyz2', 'txt']
2025-11-12 07:10:12,582 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:10:12,587 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:10:12,588 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:12:12,189 - ispa_next.app_start.main - DEBUG - Operation already took 107.14 seconds (more than 80 seconds)
2025-11-12 07:12:14,256 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\76938e7134f2378c\\tess_pjvese2p_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\76938e7134f2378c\\tess_pjvese2p', 'txt']
2025-11-12 07:12:14,476 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:12:14,480 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:12:23,265 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 07:12:30,741 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:12:41,972 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:12:57,391 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:13:54,802 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 07:14:09,919 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 07:14:12,463 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:14:13,426 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:14:13,428 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 166
2025-11-12 07:14:15,714 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 95
2025-11-12 07:14:15,714 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 07:14:15,715 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:14:16,839 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:14:17,939 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:14:31,156 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:14:31,188 - ispa_next.appointments.models - DEBUG - Appointment Janecke Möbeltechnik GmbH LIP-L 179 E WBY21HH050CU09424 ohne Termin.
2025-11-12 07:14:31,211 - ispa_next.main - DEBUG - Found 8 out of 21 appointments to process (configured limit: 15).
2025-11-12 07:14:31,211 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-12 07:14:31,211 - ispa_next.main - DEBUG - Processing 4 already visited appointments (w/ RKR not callable).
2025-11-12 07:14:31,212 - ispa_next.main - DEBUG - All appointments: HX PA 5010, LIP-JS 49E, LIP-L 738 E, Lip-qz 95 e, LIP FJ 389, LIP-CP 300, LIP-JB 17E, LIP-FB 273
2025-11-12 07:14:31,215 - ispa_next.main - DEBUG - 



2025-11-12 07:14:31,215 - ispa_next.main - DEBUG - starting with process 1 (HX PA 5010) of 8
2025-11-12 07:14:31,219 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:14:32,146 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:14:32,869 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:14:32,870 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 95
2025-11-12 07:14:33,894 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:14:33,895 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:15:10,926 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:15:11,015 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 07:15:11,018 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:15:11,506 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:15:11,508 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:15:13,816 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 166
2025-11-12 07:15:13,816 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:15:14,670 - ispa_next.main - DEBUG - 



2025-11-12 07:15:14,671 - ispa_next.main - DEBUG - starting with process 2 (LIP-JS 49E) of 8
2025-11-12 07:15:14,674 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:15:15,828 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:15:16,927 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:15:16,928 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 166
2025-11-12 07:15:18,320 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:15:18,321 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:15:41,492 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:15:51,556 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:15:54,862 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:15:54,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:54,943 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:15:55,174 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:15:55,178 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:15:55,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:55,273 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:15:58,294 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:15:58,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:15:59,225 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:16:01,229 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:16:01,360 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:16:04,569 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:16:11,934 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 07:16:12,939 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:16:12,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:16:13,519 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:16:22,955 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:16:29,952 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:16:29,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:16:30,049 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:16:30,050 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:16:30,079 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:16:31,313 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:16:31,558 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:16:34,608 - ispa_next.functions - DEBUG - Updated appointment (AF00021389) customer contact data.
2025-11-12 07:16:35,543 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:16:35,544 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:16:36,279 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:16:36,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:16:37,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:16:40,648 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:16:40,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:16:41,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:16:43,164 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:16:43,299 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:16:43,391 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:16:43,460 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:16:43,460 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:16:51,747 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:17:51,750 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:18:00,148 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:18:42,160 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:18:50,427 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:18:58,142 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 07:18:59,147 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:18:59,149 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:18:59,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:18:59,270 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:19:08,154 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 07:19:19,947 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:19:20,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:19:20,799 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:19:20,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:19:21,548 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:19:21,549 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:19:24,584 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:19:24,585 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:19:25,551 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:19:25,556 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:19:25,560 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:19:25,563 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:19:25,565 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 07:19:25,566 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:19:25,568 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:19:25,569 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:19:25,570 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:19:25,572 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:19:25,573 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:19:25,575 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:19:25,576 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 07:19:47,631 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-12 07:19:47,654 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:19:47,655 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:19:48,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:19:49,162 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:19:49,163 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 07:19:49,196 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 07:19:51,814 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 07:19:51,818 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:19:52,254 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:19:52,255 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:19:54,421 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 166
2025-11-12 07:19:54,422 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:19:55,072 - ispa_next.main - DEBUG - 



2025-11-12 07:19:55,072 - ispa_next.main - DEBUG - starting with process 3 (LIP-L 738 E) of 8
2025-11-12 07:19:55,075 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:19:55,898 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:19:56,670 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:19:56,671 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 166
2025-11-12 07:19:57,953 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:19:57,954 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:20:35,660 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:20:35,670 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 07:20:35,673 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:20:36,132 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:20:36,133 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:20:38,372 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 166
2025-11-12 07:20:38,373 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:20:39,027 - ispa_next.main - DEBUG - 



2025-11-12 07:20:39,027 - ispa_next.main - DEBUG - starting with process 4 (Lip-qz 95 e) of 8
2025-11-12 07:20:39,030 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:20:40,103 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:20:41,249 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:20:41,250 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 166
2025-11-12 07:20:42,646 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:20:42,647 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:21:14,157 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:21:14,166 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 07:21:14,168 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:21:14,501 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:21:14,502 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:21:16,539 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 166
2025-11-12 07:21:16,540 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:21:17,119 - ispa_next.main - DEBUG - 



2025-11-12 07:21:17,119 - ispa_next.main - DEBUG - starting with process 5 (LIP FJ 389) of 8
2025-11-12 07:21:17,123 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:21:17,927 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:21:18,818 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:21:18,820 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 166
2025-11-12 07:21:20,178 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:21:20,179 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:21:53,454 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:21:53,462 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 07:21:53,464 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:21:53,844 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:21:53,845 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:21:55,857 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 166
2025-11-12 07:21:55,858 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:21:56,515 - ispa_next.main - DEBUG - 



2025-11-12 07:21:56,515 - ispa_next.main - DEBUG - starting with process 6 (LIP-CP 300) of 8
2025-11-12 07:21:56,519 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:21:57,616 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:21:58,906 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:21:58,908 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 166
2025-11-12 07:22:00,315 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:22:00,316 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:22:24,420 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:22:26,117 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:22:31,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:22:33,158 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:22:33,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:33,284 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:22:33,479 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:22:33,482 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:22:33,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:33,566 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:22:36,714 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:22:36,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:22:37,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:22:39,713 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:22:39,843 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:22:39,950 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:22:40,014 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:22:44,170 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:22:45,202 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:22:45,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:45,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:58,030 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:23:01,770 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:23:01,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:01,873 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:23:01,873 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:23:01,918 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:23:03,142 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:23:03,363 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:23:04,734 - ispa_next.functions - DEBUG - Updated appointment (AB00040557) customer contact data.
2025-11-12 07:23:05,666 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:23:05,667 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:23:06,512 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:23:06,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:23:07,181 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:23:10,864 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:23:10,864 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:23:10,866 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:23:10,869 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:23:10,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:23:11,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:23:17,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:17,587 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:17,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:23:18,280 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:23:18,281 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:23:20,216 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:23:20,218 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:23:21,321 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:23:21,322 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:23:21,324 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:23:21,325 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:23:21,326 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:23:21,327 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:23:21,330 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:23:21,337 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:23:21,341 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:23:21,344 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:23:21,347 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:23:21,353 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:23:21,356 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:23:21,357 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:23:21,358 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:23,263 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:23:23,265 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:23:23,266 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:25,144 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:23:25,145 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:23:25,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:23:25,921 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:23:26,150 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:36,820 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:23:36,823 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:38,728 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:23:38,729 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:23:39,238 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:23:39,794 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:23:39,936 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:45,642 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:23:51,458 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:23:51,460 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:23:51,461 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:23:52,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:23:52,153 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:23:52,154 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:23:54,056 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:24:04,783 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:24:05,164 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 07:24:05,570 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:24:06,413 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:24:06,414 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:24:08,788 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 166
2025-11-12 07:24:08,789 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:24:09,441 - ispa_next.main - DEBUG - 



2025-11-12 07:24:09,441 - ispa_next.main - DEBUG - starting with process 7 (LIP-JB 17E) of 8
2025-11-12 07:24:09,447 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:24:10,421 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:24:11,652 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:24:11,653 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 166
2025-11-12 07:24:12,964 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:24:12,965 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:24:36,282 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:24:38,261 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:24:43,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:47,350 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:24:47,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:47,451 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:24:47,667 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:24:47,669 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:24:47,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:47,734 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:24:50,998 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:24:51,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:24:51,877 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:24:53,886 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:24:53,993 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:24:54,106 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:24:54,200 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:24:58,356 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:24:59,360 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:24:59,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:59,943 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:10,813 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:25:13,863 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:25:13,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:13,927 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:25:13,928 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:25:13,971 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:25:15,132 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:25:16,233 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:25:16,439 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:25:17,686 - ispa_next.functions - DEBUG - Updated appointment (AB00040543) customer contact data.
2025-11-12 07:25:18,601 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:25:18,602 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:25:19,375 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:25:19,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:25:20,180 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:25:23,768 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:25:23,768 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:25:23,770 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:25:23,773 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:25:23,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:25:24,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:25:29,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:30,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:30,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:25:31,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:25:31,113 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:25:34,675 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:25:34,680 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:25:35,589 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:25:35,598 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:25:35,601 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:25:35,605 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:25:35,607 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:25:35,610 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:25:35,626 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:25:35,628 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:25:35,630 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:25:35,633 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:25:35,634 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:25:35,638 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:25:35,641 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:25:35,643 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:25:35,644 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:39,612 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 07:25:41,759 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:25:41,761 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:25:41,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:45,796 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:25:45,798 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:25:45,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:25:46,441 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:25:46,674 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:57,721 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:25:57,723 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:01,643 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:26:01,644 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:26:02,143 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:26:02,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:26:02,801 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:10,303 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:26:13,495 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:26:17,218 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:26:20,715 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:26:25,146 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:26:25,148 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:26:25,149 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:26:25,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:26:25,894 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:26:25,895 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:26:27,680 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:26:35,634 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:26:36,005 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 07:26:36,305 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:26:37,128 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:26:37,130 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:26:39,996 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 166
2025-11-12 07:26:39,997 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:26:40,950 - ispa_next.main - DEBUG - 



2025-11-12 07:26:40,950 - ispa_next.main - DEBUG - starting with process 8 (LIP-FB 273) of 8
2025-11-12 07:26:40,953 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:26:42,221 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:26:43,479 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:26:43,480 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 166
2025-11-12 07:26:44,754 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:26:44,755 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:27:10,907 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:27:12,476 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:27:17,000 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:27:20,236 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:27:20,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:27:20,321 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:27:20,509 - ispa_next.functions - DEBUG - HU date soon to be invalid in 3 days.
2025-11-12 07:27:24,314 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:27:24,316 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:27:24,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:27:24,381 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:27:27,493 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:27:27,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:27:28,487 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:27:30,493 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:27:30,598 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:27:30,684 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:27:30,751 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:27:34,886 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:27:35,889 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:27:35,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:27:36,344 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:27:49,908 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:27:53,938 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:27:53,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:27:54,033 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:27:54,034 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:27:54,072 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:27:55,326 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:27:55,578 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:27:57,150 - ispa_next.functions - DEBUG - Updated appointment (AF00021399) customer contact data.
2025-11-12 07:27:58,037 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:27:58,039 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:27:58,865 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:27:58,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:27:59,701 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:28:03,267 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:28:03,267 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:28:03,270 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:28:03,273 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:28:03,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:03,748 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:12,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:13,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:13,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:13,841 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:13,842 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:28:16,827 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:28:16,829 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:28:18,149 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:28:18,150 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:28:18,152 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:28:18,153 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:28:18,154 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:28:18,155 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:28:18,157 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:28:18,158 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:28:18,159 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:28:18,161 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:28:18,163 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:28:18,164 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:28:18,167 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:28:18,168 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:28:18,169 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:21,528 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:28:21,530 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:28:21,531 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:24,801 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:28:24,802 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:28:24,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:28:25,730 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:28:25,964 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:39,572 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:28:39,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:42,877 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:28:42,878 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:28:43,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:28:43,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:28:44,090 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:51,205 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:28:55,055 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:28:59,233 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:29:04,553 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:29:04,555 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:29:04,556 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:29:05,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:29:05,253 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:29:05,254 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:29:06,982 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:29:13,610 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:29:14,006 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 07:29:14,622 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:29:15,336 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 481
2025-11-12 07:29:15,338 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:29:18,525 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 166
2025-11-12 07:29:18,526 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
