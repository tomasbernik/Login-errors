2025-11-12 13:10:17,836 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 13:10:17,843 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 13:10:27,271 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:10:37,532 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:10:53,257 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:12:51,934 - ispa_next.app_start.main - DEBUG - Operation already took 107.32 seconds (more than 80 seconds)
2025-11-12 13:12:54,004 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\10a427c155e4c2af\\tess_zf45swpf_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\10a427c155e4c2af\\tess_zf45swpf', 'txt']
2025-11-12 13:12:54,247 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:12:54,252 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:12:54,252 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:14:53,039 - ispa_next.app_start.main - DEBUG - Operation already took 106.47 seconds (more than 80 seconds)
2025-11-12 13:14:55,128 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\10a427c155e4c2af\\tess_2i9s7lr1_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\10a427c155e4c2af\\tess_2i9s7lr1', 'txt']
2025-11-12 13:14:55,369 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:14:55,373 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:15:01,589 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 13:15:11,055 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:15:21,759 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:15:37,379 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:17:36,025 - ispa_next.app_start.main - DEBUG - Operation already took 107.58 seconds (more than 80 seconds)
2025-11-12 13:17:38,128 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\10a427c155e4c2af\\tess_27idwvbl_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\10a427c155e4c2af\\tess_27idwvbl', 'txt']
2025-11-12 13:17:38,373 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:17:38,379 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:17:38,381 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:19:37,819 - ispa_next.app_start.main - DEBUG - Operation already took 107.24 seconds (more than 80 seconds)
2025-11-12 13:19:39,875 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\10a427c155e4c2af\\tess_zdz81fgy_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\10a427c155e4c2af\\tess_zdz81fgy', 'txt']
2025-11-12 13:19:40,130 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:19:40,135 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:19:46,510 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 13:19:54,972 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:20:05,425 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:20:21,223 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:22:19,518 - ispa_next.app_start.main - DEBUG - Operation already took 107.21 seconds (more than 80 seconds)
2025-11-12 13:22:21,593 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\10a427c155e4c2af\\tess_emx1o_zw_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\10a427c155e4c2af\\tess_emx1o_zw', 'txt']
2025-11-12 13:22:21,816 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:22:21,821 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:22:21,822 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:24:20,877 - ispa_next.app_start.main - DEBUG - Operation already took 106.76 seconds (more than 80 seconds)
2025-11-12 13:24:22,968 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\10a427c155e4c2af\\tess_xot2ldkn_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\10a427c155e4c2af\\tess_xot2ldkn', 'txt']
2025-11-12 13:24:23,206 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:24:23,210 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:24:29,378 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-12 13:24:38,283 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:24:48,699 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:25:04,217 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:25:28,153 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 13:25:39,731 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 13:25:42,917 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:25:44,186 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:25:44,187 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 13:25:46,757 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 195
2025-11-12 13:25:46,758 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 13:25:46,759 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:25:47,851 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:25:49,110 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:26:19,064 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:26:19,075 - ispa_next.appointments.models - DEBUG - Appointment Herr Gunter Rieger TÜ-DG 1415 WBA5K31070G277653 ohne Termin.
2025-11-12 13:26:19,086 - ispa_next.appointments.models - DEBUG - Appointment Herr Klaus Friedl TÜ-XX 1226 WBAUS31070A834463 ohne Termin.
2025-11-12 13:26:19,086 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:26:19,117 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:26:19,175 - ispa_next.main - DEBUG - Found 9 out of 79 appointments to process (configured limit: 15).
2025-11-12 13:26:19,176 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 13:26:19,176 - ispa_next.main - DEBUG - Processing 6 already visited appointments (w/ RKR not callable).
2025-11-12 13:26:19,176 - ispa_next.main - DEBUG - All appointments: TÜ-RE 2227, TÜ JB 1122, TÜ-E 789 E, TÜ-SV 337, ES-MY 600 E, TÜ-PS 2101, TÜ-NB 9186, TÜ-MJ 1316, TÜ-TE 247
2025-11-12 13:26:19,178 - ispa_next.main - DEBUG - 



2025-11-12 13:26:19,178 - ispa_next.main - DEBUG - starting with process 1 (TÜ-RE 2227) of 9
2025-11-12 13:26:19,182 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:26:20,033 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:26:21,019 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:26:21,020 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 195
2025-11-12 13:26:22,311 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:26:22,312 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:00,730 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:27:00,826 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 13:27:00,830 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:01,494 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:27:01,495 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:04,080 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 13:27:04,082 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:05,020 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 13:27:05,025 - ispa_next.main - DEBUG - 



2025-11-12 13:27:05,025 - ispa_next.main - DEBUG - starting with process 2 (TÜ JB 1122) of 9
2025-11-12 13:27:05,029 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:27:06,176 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:07,348 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:27:07,349 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 13:27:08,952 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:08,953 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:42,840 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:27:42,851 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 13:27:42,854 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:43,438 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:27:43,439 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:46,056 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 13:27:46,057 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:46,758 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 13:27:46,763 - ispa_next.main - DEBUG - 



2025-11-12 13:27:46,764 - ispa_next.main - DEBUG - starting with process 3 (TÜ-E 789 E) of 9
2025-11-12 13:27:46,767 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:27:47,606 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:48,758 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:27:48,759 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 13:27:50,183 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:50,184 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:28:12,394 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:28:22,683 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:26,634 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:28:26,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:26,711 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:28:26,899 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:28:26,902 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:28:29,691 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:28:29,693 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:28:29,875 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 13:28:30,196 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 13:28:30,212 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:28:30,213 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:28:30,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:28:31,581 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:28:31,583 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 13:28:31,606 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 13:28:33,850 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 13:28:33,853 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:28:34,760 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:28:34,761 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:28:37,651 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 13:28:37,652 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:28:38,477 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 13:28:38,482 - ispa_next.main - DEBUG - 



2025-11-12 13:28:38,482 - ispa_next.main - DEBUG - starting with process 4 (TÜ-SV 337) of 9
2025-11-12 13:28:38,485 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:28:39,670 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:28:40,681 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:28:40,682 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 13:28:42,121 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:28:42,123 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:29:02,973 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:29:04,501 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:29:09,062 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:11,641 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:29:11,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:11,727 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:29:11,929 - ispa_next.functions - DEBUG - HU date soon to be invalid in 40 days.
2025-11-12 13:29:15,775 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:29:15,778 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:29:18,644 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:29:18,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:29:19,596 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:29:21,606 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:29:21,713 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:29:21,820 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:29:21,887 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:29:26,039 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:29:27,045 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:29:27,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:27,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:40,902 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:29:44,705 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:29:44,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:44,790 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:29:44,791 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:29:44,834 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:29:44,921 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:29:46,091 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:29:46,336 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:29:47,815 - ispa_next.functions - DEBUG - Updated appointment (AC00054609) customer contact data.
2025-11-12 13:29:48,723 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:29:48,725 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:29:48,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:29:49,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:29:50,818 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:29:50,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:29:50,889 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:29:54,514 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:29:54,514 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:29:54,518 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:29:54,518 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:29:54,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:29:55,048 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:29:59,195 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:29:59,200 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:29:59,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:29:59,288 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:29:59,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:00,188 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:00,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:00,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:30:00,906 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:30:03,448 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:30:03,450 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:30:05,991 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:30:05,992 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:30:05,993 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 13:30:05,994 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:30:05,995 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:30:05,997 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:30:05,998 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:30:05,999 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:30:06,000 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:30:06,001 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:30:06,003 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:30:06,006 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:30:06,008 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:30:06,008 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:08,641 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:30:08,641 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:11,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 13:30:11,987 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 13:30:12,723 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:30:12,725 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:15,221 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:30:15,223 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:30:15,224 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:30:15,226 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:17,793 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:30:30,271 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:30:30,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:30:31,376 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:30:31,498 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:38,161 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:30:42,277 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:30:46,821 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:30:46,823 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:30:46,824 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:30:47,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:30:47,648 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:30:47,649 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:30:49,650 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:30:59,373 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:30:59,750 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 13:31:00,094 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:31:02,315 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:31:02,317 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:31:05,191 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 13:31:05,192 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:31:06,032 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 13:31:06,037 - ispa_next.main - DEBUG - 



2025-11-12 13:31:06,037 - ispa_next.main - DEBUG - starting with process 5 (ES-MY 600 E) of 9
2025-11-12 13:31:06,040 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:31:07,008 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:31:07,900 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:31:07,901 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 13:31:09,223 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:31:09,224 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:31:40,729 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:31:42,652 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:31:47,762 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:50,325 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:31:50,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:50,417 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:31:50,616 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:31:54,890 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:31:54,893 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:31:57,711 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:31:57,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:58,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:32:00,572 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:32:00,701 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:32:00,825 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:32:00,898 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:32:05,068 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:32:06,073 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:32:06,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:32:06,586 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:32:18,174 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:32:22,429 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:32:22,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:32:22,510 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:32:22,511 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:32:22,586 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:32:23,784 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:32:25,321 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:32:25,545 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:32:27,154 - ispa_next.functions - DEBUG - Updated appointment (AC00054663) customer contact data.
2025-11-12 13:32:28,064 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:32:28,066 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:32:28,904 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:32:28,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:32:29,573 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:32:33,621 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:32:33,621 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:32:33,623 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:32:33,624 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:32:33,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:32:34,166 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:32:38,256 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:32:38,261 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:32:38,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:32:38,325 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:32:43,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:32:44,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:32:44,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:32:45,182 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:32:45,183 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:32:47,576 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:32:47,583 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:32:49,324 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:32:49,326 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:32:49,329 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 13:32:49,332 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:32:49,338 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:32:49,341 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:32:49,344 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:32:49,348 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:32:49,350 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:32:49,355 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:32:49,365 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:32:49,367 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:32:49,368 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:51,910 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:32:51,911 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:54,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 13:32:55,058 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 13:32:55,536 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:32:55,538 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:58,035 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:32:58,037 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:32:58,039 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:32:58,041 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:33:00,626 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:33:12,988 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:33:13,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:33:14,155 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:33:14,298 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:33:20,855 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:33:23,964 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:33:28,074 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:33:28,076 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:33:28,077 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:33:28,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:33:28,894 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:33:28,896 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:33:31,008 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:33:39,060 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:33:39,437 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 13:33:39,796 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:41,200 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:33:41,201 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:43,485 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 263
2025-11-12 13:33:43,486 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:33:44,173 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 13:33:44,176 - ispa_next.main - DEBUG - 



2025-11-12 13:33:44,176 - ispa_next.main - DEBUG - starting with process 6 (TÜ-PS 2101) of 9
2025-11-12 13:33:44,179 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:33:45,404 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:46,481 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:33:46,483 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 263
2025-11-12 13:33:48,056 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:48,058 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:34:09,864 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:34:11,754 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:34:16,856 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:18,044 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:34:18,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:18,161 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:34:18,345 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:34:18,348 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:34:21,182 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:34:21,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:34:22,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:34:24,097 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:34:24,245 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:34:24,315 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:34:24,421 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:34:28,570 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:34:29,575 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:34:29,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:30,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:41,075 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:34:45,108 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:34:45,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:45,208 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:34:45,209 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:34:45,308 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:34:46,509 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:34:46,726 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:34:48,324 - ispa_next.functions - DEBUG - Updated appointment (AC00054718) customer contact data.
2025-11-12 13:34:49,251 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:34:49,254 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:34:50,181 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:34:50,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:34:50,948 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:34:54,543 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:34:54,544 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:34:54,553 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:34:54,554 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:34:54,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:34:55,056 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:34:59,193 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:34:59,198 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:34:59,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:34:59,274 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:34:59,693 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:00,182 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:00,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:35:00,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:35:00,835 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:35:02,123 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:35:02,124 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:35:02,946 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:35:02,960 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:35:02,962 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 13:35:02,963 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:35:02,963 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:35:02,965 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:35:02,967 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:35:02,968 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:35:02,969 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:35:02,971 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:35:02,974 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:35:02,976 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:35:02,978 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:35:02,978 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:04,132 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:35:04,132 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:05,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 13:35:06,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 13:35:06,588 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:35:06,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:07,800 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:35:07,802 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:35:07,803 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:35:07,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:08,982 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:35:20,881 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:35:21,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:35:21,970 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:35:22,098 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:27,624 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:35:27,626 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:35:27,627 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:35:28,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:35:28,369 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:35:28,370 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:35:30,144 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:35:36,660 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:35:37,061 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 13:35:37,372 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:35:38,821 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:35:38,822 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:35:41,267 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 263
2025-11-12 13:35:41,268 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:35:41,891 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 13:35:41,898 - ispa_next.main - DEBUG - 



2025-11-12 13:35:41,898 - ispa_next.main - DEBUG - starting with process 7 (TÜ-NB 9186) of 9
2025-11-12 13:35:41,902 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:35:43,162 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:35:44,496 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:35:44,497 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 263
2025-11-12 13:35:45,973 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:35:45,974 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:36:08,733 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:36:10,568 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:36:15,876 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:17,091 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:36:17,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:17,182 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:36:17,418 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:36:20,873 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:36:20,875 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:36:23,630 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:36:23,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:36:24,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:36:26,546 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:36:26,670 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:36:26,778 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:36:26,841 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:36:31,036 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:36:32,042 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:36:32,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:32,562 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:46,298 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:36:50,738 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:36:50,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:50,838 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:36:50,838 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:36:50,878 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:36:52,094 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:36:52,305 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:36:54,268 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:36:54,270 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:36:55,068 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:36:55,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:36:55,842 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:36:59,861 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:36:59,862 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:36:59,865 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:36:59,866 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:36:59,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:37:00,429 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:37:04,569 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:37:04,573 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:37:04,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:37:04,642 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:37:05,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:37:05,526 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:37:05,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:37:06,275 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:37:06,276 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:37:07,634 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:37:07,639 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:37:09,165 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:37:09,171 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:37:09,173 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 13:37:09,175 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:37:09,176 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:37:09,178 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:37:09,183 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:37:09,185 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:37:09,189 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:37:09,191 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:37:09,192 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:37:09,195 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:37:09,197 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:37:09,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:10,392 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:37:10,393 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:11,586 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 13:37:12,305 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 13:37:13,066 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:37:13,068 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:14,319 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:37:14,322 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:37:14,324 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:37:14,328 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:15,539 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:37:27,766 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:37:28,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:37:28,891 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:37:29,048 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:34,698 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:34,700 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:37:34,702 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:35,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:37:35,440 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:37:35,442 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:37:37,527 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:37:46,374 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:37:46,748 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 13:37:47,087 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:48,166 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:37:48,167 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:51,190 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 263
2025-11-12 13:37:51,191 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:37:52,056 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 13:37:52,064 - ispa_next.main - DEBUG - 



2025-11-12 13:37:52,064 - ispa_next.main - DEBUG - starting with process 8 (TÜ-MJ 1316) of 9
2025-11-12 13:37:52,067 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:53,404 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:54,564 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:37:54,565 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 263
2025-11-12 13:37:55,849 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:55,850 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:38:17,668 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:38:19,630 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:38:24,911 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:38:26,119 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:38:26,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:26,223 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:38:26,611 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:38:26,614 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:38:29,549 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:38:29,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:30,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:38:32,756 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:38:32,890 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:38:33,033 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:38:33,111 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:38:37,315 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:38:38,320 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:38:38,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:38,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:50,402 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:38:54,287 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:38:54,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:54,377 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:38:54,378 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:38:54,408 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:38:54,504 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:38:55,599 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:38:55,812 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:38:57,301 - ispa_next.functions - DEBUG - Updated appointment (AC00054706) customer contact data.
2025-11-12 13:38:58,193 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:38:58,195 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:38:58,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:38:59,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:39:00,443 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:39:00,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:39:00,519 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:39:04,103 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:39:04,104 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:39:04,107 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:39:04,107 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:39:04,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:39:04,608 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:39:08,689 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:39:08,694 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:39:08,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:39:08,783 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:39:09,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:39:09,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:39:09,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:39:10,512 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:39:10,513 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:39:11,915 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:39:11,920 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:39:13,369 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:39:13,370 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:39:13,372 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 13:39:13,374 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:39:13,375 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:39:13,376 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:39:13,377 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:39:13,378 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:39:13,380 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:39:13,381 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:39:13,382 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:39:13,391 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:39:13,393 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:39:13,394 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:14,596 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:39:14,597 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:15,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 13:39:16,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 13:39:17,164 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:39:17,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:18,384 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:39:18,386 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:39:18,387 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:39:18,392 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:19,583 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:39:32,130 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:39:32,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:39:33,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:39:33,409 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:39,138 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:39:39,141 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:39:39,141 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:39:39,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:39:39,875 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:39:39,877 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:39:41,886 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:39:50,336 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:39:50,746 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 13:39:51,161 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:39:53,052 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 684
2025-11-12 13:39:53,053 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:39:55,897 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 263
2025-11-12 13:39:55,897 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:39:56,726 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 13:39:56,732 - ispa_next.main - DEBUG - 



2025-11-12 13:39:56,732 - ispa_next.main - DEBUG - starting with process 9 (TÜ-TE 247) of 9
2025-11-12 13:39:56,736 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:39:57,860 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:39:59,030 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 684
2025-11-12 13:39:59,031 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 263
2025-11-12 13:40:00,644 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:40:00,646 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:40:22,861 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:40:24,945 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:40:30,541 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:40:31,797 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:40:31,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:31,869 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:40:32,065 - ispa_next.functions - DEBUG - HU date already expired after 1306 days.
2025-11-12 13:40:35,945 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:40:35,947 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:40:38,603 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:40:38,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:40:39,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:40:41,525 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:40:41,639 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:40:41,752 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:40:41,816 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:40:46,033 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:40:47,039 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:40:47,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:47,554 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:02,002 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:41:06,173 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:41:06,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:06,239 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:41:06,252 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:41:06,285 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:41:06,380 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:41:07,692 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:41:07,898 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:41:09,833 - ispa_next.functions - DEBUG - Updated appointment (AC00054707) customer contact data.
2025-11-12 13:41:10,764 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:41:10,766 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:41:10,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:41:11,672 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:41:12,806 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:41:12,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:41:12,887 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:41:17,039 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 13:41:17,039 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:41:17,039 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:41:17,042 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:41:17,043 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:41:17,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:41:17,562 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:41:21,657 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:41:21,662 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:41:21,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:41:21,767 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:41:22,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:22,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:22,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:41:23,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:41:23,366 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:41:24,637 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:41:24,638 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:41:26,164 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:41:26,169 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:41:26,171 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 13:41:26,172 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:41:26,174 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:41:26,176 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:41:26,177 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:41:26,178 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:41:26,179 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:41:26,181 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:41:26,182 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:41:26,185 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:41:26,187 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:41:26,188 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:27,462 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:41:27,462 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:28,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 13:41:29,623 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 13:41:30,323 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:41:30,326 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:31,595 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:41:31,597 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:41:31,599 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:41:31,602 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:32,774 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:41:44,507 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:41:45,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:41:45,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:41:45,914 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:51,603 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:41:51,605 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:41:51,606 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:41:52,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:41:52,435 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:41:52,437 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:41:54,339 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:42:03,189 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:42:03,563 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 13:42:03,903 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:42:06,088 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-12 13:42:06,089 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:42:09,296 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 263
2025-11-12 13:42:09,296 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:42:10,091 - ispa_next.appointments.models - DEBUG - Appointment Herr Nimet Alban TÜ-NA 444 WMW31DK0302R04781 ohne Termin.
2025-11-12 13:42:10,103 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
