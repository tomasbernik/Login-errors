2025-11-17 09:00:35,394 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 09:00:35,400 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 09:00:46,907 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:00:59,590 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:01:15,176 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:03:13,695 - ispa_next.app_start.main - DEBUG - Operation already took 107.23 seconds (more than 80 seconds)
2025-11-17 09:03:15,794 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6dc253f709b0cb3b\\tess_u8mgddxc_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6dc253f709b0cb3b\\tess_u8mgddxc', 'txt']
2025-11-17 09:03:16,022 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:03:16,027 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:03:16,028 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:03:49,278 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 09:04:08,426 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 09:04:12,088 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:04:13,516 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1204
2025-11-17 09:04:13,518 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-17 09:04:16,207 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 122
2025-11-17 09:04:16,208 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 09:04:16,209 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:04:17,470 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:04:18,823 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:04:37,437 - ispa_next.appointments.models - DEBUG - Appointment bwp Burggraf + Weber M-MG 2206 E WBY41AW070FS23336 ohne Termin.
2025-11-17 09:04:37,469 - ispa_next.appointments.models - DEBUG - Appointment Adam Szulc DAH-QX 230 WBA5K11060D943181 ohne Termin.
2025-11-17 09:04:37,481 - ispa_next.appointments.models - DEBUG - Appointment Robert Charles Armin FS-NA 42 WMWYT910303D93360 ohne Termin.
2025-11-17 09:04:37,496 - ispa_next.appointments.models - DEBUG - Appointment Benedikt Burger FFB-XG 87 WBS11DM0708D97738 ohne Termin.
2025-11-17 09:04:37,521 - ispa_next.appointments.models - DEBUG - Appointment Timon Wohlfarth  WMWXU710402M05502 ohne Termin.
2025-11-17 09:04:37,555 - ispa_next.appointments.models - DEBUG - Appointment Chi Chung Nguyen M-HC 2737 WBACR61070LJ18143 ohne Termin.
2025-11-17 09:04:37,566 - ispa_next.appointments.models - DEBUG - Appointment Ingrid Berger M-MB 525 WBAFF41030L117517 ohne Termin.
2025-11-17 09:04:37,566 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:04:37,569 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:04:37,569 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:04:37,571 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:04:37,580 - ispa_next.appointments.models - DEBUG - Appointment Brigitte Lang DAH-U 904 WMW21DL0703N66211 ohne Termin.
2025-11-17 09:04:37,588 - ispa_next.appointments.models - DEBUG - Appointment Franziska Scheitler DAH-FS 242 WBA31DZ040FJ93655 ohne Termin.
2025-11-17 09:04:37,599 - ispa_next.appointments.models - DEBUG - Appointment NovaTaste Germany GmbH BGL-NT 303 WBA41EG0005X32470 ohne Termin.
2025-11-17 09:04:37,607 - ispa_next.appointments.models - DEBUG - Appointment Sieglinde Wasmeier PAN-SW 11 WBA21BX0907N85009 ohne Termin.
2025-11-17 09:04:37,615 - ispa_next.appointments.models - DEBUG - Appointment REWE Markt GmbH FS-RE 208 WBA71AC0505R28464 ohne Termin.
2025-11-17 09:04:37,623 - ispa_next.appointments.models - DEBUG - Appointment Christos Michalopoulos DAH-GR 517 WBATX95050ND73284 ohne Termin.
2025-11-17 09:04:37,635 - ispa_next.appointments.models - DEBUG - Appointment Hiller DAH-LH 258 WBAWY510600E18805 ohne Termin.
2025-11-17 09:04:37,644 - ispa_next.appointments.models - DEBUG - Appointment Johannes Nist DAH-VN 66 WBA11GR0209Z99162 ohne Termin.
2025-11-17 09:04:37,653 - ispa_next.appointments.models - DEBUG - Appointment Annemarie Eichhorn DAH-AE 279 WBA71AC0405V15516 ohne Termin.
2025-11-17 09:04:37,663 - ispa_next.appointments.models - DEBUG - Appointment Ezmin Tanjic RE-EZA 1 WBACV61030LJ72146 ohne Termin.
2025-11-17 09:04:37,671 - ispa_next.appointments.models - DEBUG - Appointment PRK GmbH Kunststoffverarbeitung  WMW61DL0903S22669 ohne Termin.
2025-11-17 09:04:37,680 - ispa_next.appointments.models - DEBUG - Appointment Härtetechnik Redak GmbH & Co. KG DAH-MC 510 WBS41AY030FM13870 ohne Termin.
2025-11-17 09:04:37,687 - ispa_next.appointments.models - DEBUG - Appointment Volksbank Raiffeisenbank Dachau eG DAH-VR 86 E WBA81CY050FS22937 ohne Termin.
2025-11-17 09:04:37,697 - ispa_next.appointments.models - DEBUG - Appointment Dirk Ullrich RN-M 500E WBS81GV040CV92768 ohne Termin.
2025-11-17 09:04:37,709 - ispa_next.appointments.models - DEBUG - Appointment Jörg Rolfes OAL-AR 191 WBAUZ35010N015446 ohne Termin.
2025-11-17 09:04:37,722 - ispa_next.appointments.models - DEBUG - Appointment Andreas Christmann M-AK 1539E WMW11GC05RTA37157 ohne Termin.
2025-11-17 09:04:37,736 - ispa_next.appointments.models - DEBUG - Appointment Christian Ettenberger FFB-CE 56E WMW11DJ0602T37216 ohne Termin.
2025-11-17 09:04:37,746 - ispa_next.appointments.models - DEBUG - Appointment Baader Bank AG M-V 7427 WBA41EG0X05Y35735 ohne Termin.
2025-11-17 09:04:37,755 - ispa_next.appointments.models - DEBUG - Appointment Dr. Nicola Steiner DAH-LS 855 WMWXU71010TN14283 ohne Termin.
2025-11-17 09:04:37,763 - ispa_next.appointments.models - DEBUG - Appointment Rita Oberrecht-Schwarz DAH-RA 13 WBA11AB01N5T43220 ohne Termin.
2025-11-17 09:04:37,773 - ispa_next.appointments.models - DEBUG - Appointment Rolf Ludwig Hagert DAH-AR 678 WBA2E310705D82895 ohne Termin.
2025-11-17 09:04:37,781 - ispa_next.appointments.models - DEBUG - Appointment Rainer Tobias Möller DAH-ST 807 WBA6V31070EB10798 ohne Termin.
2025-11-17 09:04:37,789 - ispa_next.appointments.models - DEBUG - Appointment Dr. Norbert Metz STA-M 2828 WBA6X310405T68381 ohne Termin.
2025-11-17 09:04:37,797 - ispa_next.appointments.models - DEBUG - Appointment Franz Rockinger FFB-FR 267 WBA31BX0807R25447 ohne Termin.
2025-11-17 09:04:37,808 - ispa_next.appointments.models - DEBUG - Appointment Dario Zandonella Maiucco DAH-DZ 73 WBAXA51050C586150 ohne Termin.
2025-11-17 09:04:37,817 - ispa_next.appointments.models - DEBUG - Appointment Anna Gushchina M-AG 7192 WMWRC310X0TB89348 ohne Termin.
2025-11-17 09:04:37,825 - ispa_next.appointments.models - DEBUG - Appointment Radloff DAH-RA 238 WBY71AW050FR88400 ohne Termin.
2025-11-17 09:04:37,834 - ispa_next.appointments.models - DEBUG - Appointment Augusto Fracasso DAH-GF 289 WBA11AB0005N66647 ohne Termin.
2025-11-17 09:04:37,843 - ispa_next.main - DEBUG - Found 4 out of 64 appointments to process (configured limit: 15).
2025-11-17 09:04:37,843 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-17 09:04:37,843 - ispa_next.main - DEBUG - All appointments: GAP-N 180, M-X 3570, M-K 9312, DAH-VA27E
2025-11-17 09:04:37,847 - ispa_next.main - DEBUG - 



2025-11-17 09:04:37,847 - ispa_next.main - DEBUG - starting with process 1 (GAP-N 180) of 4
2025-11-17 09:04:37,852 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:04:39,076 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:04:40,309 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1204
2025-11-17 09:04:40,311 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 122
2025-11-17 09:04:41,540 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:04:41,543 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:05:06,680 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:05:17,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:05:22,876 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:05:22,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:05:22,953 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:05:23,181 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 09:05:30,973 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:05:30,975 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:05:33,782 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:05:33,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:05:34,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:05:36,800 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:05:43,270 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 09:05:51,035 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 09:05:52,041 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:05:52,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:05:52,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:06:04,915 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:06:13,585 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:06:13,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:06:13,653 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:06:13,654 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:06:13,748 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:06:13,866 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:06:15,031 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 09:06:16,273 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 09:06:16,598 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:06:17,822 - ispa_next.functions - DEBUG - Updated appointment (CS00001582) customer contact data.
2025-11-17 09:06:18,728 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:06:18,729 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:06:18,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:06:19,548 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:06:21,147 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:06:21,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:06:21,232 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:06:25,225 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 09:06:25,225 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:06:25,225 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:06:25,228 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:06:25,230 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:06:25,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:06:25,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:06:29,848 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:06:29,854 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:06:29,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:06:29,925 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:06:30,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:06:30,853 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:06:30,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:06:31,493 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:06:31,494 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:06:36,877 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:06:36,882 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:06:37,954 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:06:37,955 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:06:37,958 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Servicereinigung / Maschinelle Oberwäsche und Fußr, source=from_tab, target=cart)}
2025-11-17 09:06:37,961 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:06:37,963 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 09:06:37,964 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:06:37,965 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Winter - Fit - Paket / Winter - Fit - Paket, source=from_tab, target=advice_list)}
2025-11-17 09:06:37,966 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:06:37,969 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:06:37,975 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:06:37,980 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:06:37,982 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:06:38,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:06:39,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:06:45,083 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:06:45,084 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 09:06:45,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:06:46,012 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 09:06:58,895 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:06:58,897 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:06:58,899 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:06:58,900 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:07:05,591 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:07:05,592 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:07:05,594 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:07:12,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:07:12,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:07:24,154 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:07:24,156 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:07:24,158 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:07:24,159 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:07:30,816 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:07:45,868 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:07:46,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:07:47,249 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:07:47,458 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:07:58,524 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:08:03,254 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:08:09,650 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:08:09,651 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:08:10,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:08:10,349 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:08:10,351 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:08:16,455 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:08:26,360 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:08:26,746 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 09:08:27,869 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:08:29,123 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1204
2025-11-17 09:08:29,124 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:08:32,204 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-17 09:08:32,205 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:08:33,076 - ispa_next.appointments.models - DEBUG - Appointment bwp Burggraf + Weber M-MG 2206 E WBY41AW070FS23336 ohne Termin.
2025-11-17 09:08:33,085 - ispa_next.main - DEBUG - 



2025-11-17 09:08:33,085 - ispa_next.main - DEBUG - starting with process 2 (M-X 3570) of 4
2025-11-17 09:08:33,089 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:08:34,216 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:08:35,325 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1204
2025-11-17 09:08:35,326 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-17 09:08:36,625 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:08:36,626 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:09:00,376 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:09:10,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:09:10,589 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:09:10,737 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:11,942 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:09:11,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:09:12,024 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:09:12,269 - ispa_next.functions - DEBUG - HU date already expired after 782 days.
2025-11-17 09:09:19,399 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:09:19,402 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:09:22,167 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:09:22,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:09:23,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:09:25,197 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:09:25,324 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:09:28,587 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:09:28,644 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:09:28,645 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:29,880 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:09:41,213 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:09:42,218 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:09:42,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:09:42,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:09:55,272 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:10:03,315 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:10:03,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:10:03,376 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:10:03,377 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:10:03,422 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:10:04,590 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:10:05,716 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:10:05,933 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:10:08,298 - ispa_next.functions - DEBUG - Updated appointment (CI00002788) customer contact data.
2025-11-17 09:10:09,228 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:10:09,231 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:10:10,063 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:10:10,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:10:10,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:10:14,218 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:10:14,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:10:14,701 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:10:16,705 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:10:16,829 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:10:16,963 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:10:17,040 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:10:17,041 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:10:18,239 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:10:29,759 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:10:36,804 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:10:36,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:10:38,203 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:10:42,408 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:10:43,421 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:10:43,422 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:10:43,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:10:43,537 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:10:47,655 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:10:47,659 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:10:47,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:10:47,742 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:10:48,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:10:48,638 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:10:48,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:10:49,450 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:10:49,451 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:10:50,746 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:10:50,747 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:10:51,804 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:10:51,805 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:10:51,807 - ispa_next.package_manager.main - DEBUG - Cannot place Servicereinigung / Maschinelle Oberwäsche und Fußr: active service advisor guards
2025-11-17 09:10:51,808 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:10:51,811 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:10:51,817 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 09:10:51,819 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:10:51,821 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Winter - Fit - Paket / Winter - Fit - Paket, source=from_tab, target=advice_list)}
2025-11-17 09:10:51,822 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:10:51,825 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:10:51,826 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:10:51,828 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:10:51,830 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 09:10:52,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:10:53,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:11:05,863 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:11:05,865 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:11:05,866 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:11:05,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:11:07,084 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 09:11:09,967 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:11:09,972 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:11:09,998 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:11:11,260 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:11:11,262 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:11:11,264 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:11:11,265 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:11:12,453 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:11:26,959 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:11:27,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:11:28,339 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:11:28,491 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:11:35,581 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:11:35,583 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:11:35,584 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:11:36,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:11:36,231 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:11:36,233 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:11:37,976 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:11:45,447 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:11:45,829 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 09:11:46,239 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:11:47,959 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1204
2025-11-17 09:11:47,960 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:11:50,425 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 162
2025-11-17 09:11:50,425 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:11:51,231 - ispa_next.appointments.models - DEBUG - Appointment bwp Burggraf + Weber M-MG 2206 E WBY41AW070FS23336 ohne Termin.
2025-11-17 09:11:51,238 - ispa_next.main - DEBUG - 



2025-11-17 09:11:51,238 - ispa_next.main - DEBUG - starting with process 3 (M-K 9312) of 4
2025-11-17 09:11:51,242 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:11:52,439 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:11:53,463 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1204
2025-11-17 09:11:53,464 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 162
2025-11-17 09:11:55,091 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:11:55,092 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:12:17,395 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:12:26,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:12:26,948 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:12:27,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:12:29,807 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:12:29,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:12:29,958 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:12:30,240 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 09:12:37,051 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:12:37,054 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:12:39,783 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:12:39,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:12:40,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:12:42,837 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:12:43,018 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:12:46,323 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 09:12:54,543 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 09:12:55,548 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:12:55,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:12:56,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:13:08,071 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:13:08,072 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 09:13:15,148 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:13:15,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:13:15,217 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:13:15,218 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:13:15,284 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:13:16,427 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:13:17,745 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:13:17,967 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:13:21,365 - ispa_next.functions - DEBUG - Updated appointment (BS00006667) customer contact data.
2025-11-17 09:13:22,299 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:13:22,302 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:13:23,169 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:13:23,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:13:23,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:13:27,528 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:13:27,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:13:28,042 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:13:30,045 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:13:30,159 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:13:30,249 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:13:30,332 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:13:30,334 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:13:33,092 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:13:44,750 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:14:44,753 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:14:55,525 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:15:02,689 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:15:02,690 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:15:05,278 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:15:09,495 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:15:10,537 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:15:10,538 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:15:10,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:15:10,614 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:15:14,755 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:15:15,521 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 09:15:28,034 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:15:28,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:15:28,149 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:15:37,617 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 09:15:47,398 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-17 09:15:57,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:15:58,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:15:58,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:15:59,149 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:15:59,150 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:16:01,592 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:16:01,596 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:16:02,891 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:16:02,893 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:16:02,896 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Servicereinigung / Maschinelle Oberwäsche und Fußr, source=from_tab, target=cart)}
2025-11-17 09:16:02,898 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:16:02,902 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 09:16:02,916 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:16:02,919 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Winter - Fit - Paket / Winter - Fit - Paket, source=from_tab, target=advice_list)}
2025-11-17 09:16:02,920 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:16:02,924 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:16:02,925 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:16:02,930 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:16:02,932 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:16:03,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:16:04,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:16:10,671 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:16:10,672 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 09:16:11,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:16:11,512 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 09:16:26,087 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:16:26,113 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:16:26,115 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:16:26,116 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:16:29,458 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 09:16:38,676 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:16:38,699 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:16:38,726 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:16:42,243 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:16:42,246 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:16:42,247 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:16:42,251 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:16:45,572 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:17:08,238 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:17:09,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:17:10,546 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:17:10,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:17:20,398 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:17:27,737 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:17:35,917 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:17:35,918 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:17:37,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:17:37,239 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:17:37,241 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:17:45,228 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:17:59,636 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:18:00,014 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 09:18:01,148 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:18:03,827 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1205
2025-11-17 09:18:03,828 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:18:08,354 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 163
2025-11-17 09:18:08,355 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:18:09,653 - ispa_next.appointments.models - DEBUG - Appointment bwp Burggraf + Weber M-MG 2206 E WBY41AW070FS23336 ohne Termin.
2025-11-17 09:18:09,659 - ispa_next.main - DEBUG - Found new Appointment: DAH-AW 400
2025-11-17 09:18:09,660 - ispa_next.main - DEBUG - 



2025-11-17 09:18:09,660 - ispa_next.main - DEBUG - starting with process 4 (DAH-AW 400) of 5
2025-11-17 09:18:09,664 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:18:11,631 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:18:13,652 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1205
2025-11-17 09:18:13,653 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 163
2025-11-17 09:18:16,032 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:18:16,034 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:18:45,603 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:18:58,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:18:59,061 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:18:59,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:19:00,446 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:19:00,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:19:00,530 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:19:00,796 - ispa_next.functions - DEBUG - HU date already expired after 3160 days.
2025-11-17 09:19:09,708 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:19:09,711 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:19:12,679 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:19:12,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:19:14,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:19:16,032 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:19:25,525 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 09:19:35,538 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 09:19:36,544 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:19:36,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:19:37,041 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:19:53,062 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:20:03,602 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:20:03,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:03,713 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:20:03,714 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:20:03,799 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:20:03,964 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:20:05,189 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 09:20:06,517 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 09:20:06,976 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:20:10,062 - ispa_next.functions - DEBUG - Updated appointment (DD00001445) customer contact data.
2025-11-17 09:20:10,955 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:20:10,958 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:20:11,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:20:12,120 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:20:14,037 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:20:14,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:20:14,164 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:20:18,218 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 09:20:18,218 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:20:18,218 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:20:18,222 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:20:18,223 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:20:18,224 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:20:18,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:20:22,993 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:20:22,998 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:20:22,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:20:23,081 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:20:23,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:23,980 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:23,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:20:24,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:20:24,766 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:20:26,652 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:20:26,658 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:20:28,105 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:20:28,107 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:20:28,110 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Servicereinigung / Maschinelle Oberwäsche und Fußr, source=from_tab, target=cart)}
2025-11-17 09:20:28,113 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:20:28,116 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 09:20:28,117 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:20:28,136 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Winter - Fit - Paket / Winter - Fit - Paket, source=from_tab, target=advice_list)}
2025-11-17 09:20:28,140 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:20:28,144 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:20:28,146 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:20:28,148 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:20:28,156 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:20:28,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:20:29,757 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:20:36,013 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:20:36,014 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 09:20:36,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:20:36,824 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 09:20:50,699 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:20:50,702 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:20:50,703 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:20:50,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:20:53,324 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:20:53,326 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:20:53,328 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:20:55,946 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:20:55,948 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:20:55,949 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:20:55,951 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:20:58,583 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:21:22,298 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:21:23,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:21:24,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:21:24,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:21:33,624 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:21:39,473 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:21:46,080 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:21:46,083 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:21:46,083 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:21:47,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:21:47,472 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:21:47,474 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:21:50,948 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:22:03,953 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:22:04,349 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 09:22:05,357 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:22:09,402 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1205
2025-11-17 09:22:09,403 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:22:13,975 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 163
2025-11-17 09:22:13,976 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:22:15,299 - ispa_next.appointments.models - DEBUG - Appointment bwp Burggraf + Weber M-MG 2206 E WBY41AW070FS23336 ohne Termin.
2025-11-17 09:22:15,307 - ispa_next.main - DEBUG - 



2025-11-17 09:22:15,307 - ispa_next.main - DEBUG - starting with process 5 (DAH-VA27E) of 5
2025-11-17 09:22:15,311 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:22:17,296 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:22:19,224 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1205
2025-11-17 09:22:19,226 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 163
2025-11-17 09:22:21,555 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:22:21,557 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:23:03,616 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:23:03,717 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 09:23:03,723 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:23:04,680 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1205
2025-11-17 09:23:04,682 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:23:08,814 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 163
2025-11-17 09:23:08,816 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:23:10,185 - ispa_next.appointments.models - DEBUG - Appointment bwp Burggraf + Weber M-MG 2206 E WBY41AW070FS23336 ohne Termin.
