2025-11-17 11:14:36,089 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 11:14:36,099 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 11:14:45,692 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:14:56,114 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:15:11,733 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:15:35,597 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 11:15:51,583 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 11:15:54,490 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:15:55,487 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 264
2025-11-17 11:15:55,489 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-17 11:15:57,661 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 69
2025-11-17 11:15:57,662 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 11:15:57,662 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:15:58,477 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:15:59,614 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:16:09,716 - ispa_next.appointments.models - DEBUG - Appointment Andreas Ponemunski Herr TS-A 1564 WBA71AG050CF97572 ohne Termin.
2025-11-17 11:16:09,727 - ispa_next.appointments.models - DEBUG - Appointment Heiko Lange Herr K-HL 1707 WBAUB51060VJ06122 ohne Termin.
2025-11-17 11:16:09,735 - ispa_next.appointments.models - DEBUG - Appointment Fabian Landler Herr TS-FL 440 WBA11AR0X0CM30916 ohne Termin.
2025-11-17 11:16:09,741 - ispa_next.appointments.models - DEBUG - Appointment Bianca Nadine Böhme Frau TS-BM 6120 WBA8G31070K880825 ohne Termin.
2025-11-17 11:16:09,745 - ispa_next.main - DEBUG - Found 4 out of 6 appointments to process (configured limit: 15).
2025-11-17 11:16:09,745 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-17 11:16:09,746 - ispa_next.main - DEBUG - All appointments: TS-J 1822, BGL-EW 55 E, TS-GH 434, TS-KS 2005
2025-11-17 11:16:09,748 - ispa_next.main - DEBUG - 



2025-11-17 11:16:09,748 - ispa_next.main - DEBUG - starting with process 1 (TS-J 1822) of 4
2025-11-17 11:16:09,753 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:16:10,556 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:16:11,386 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 264
2025-11-17 11:16:11,387 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 69
2025-11-17 11:16:12,455 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:16:12,456 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:16:42,563 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:16:51,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:51,835 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:16:52,023 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:53,199 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:16:53,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:53,274 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:16:53,479 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:16:53,487 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:16:53,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:53,600 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:17:03,046 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:17:03,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:17:04,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:17:06,030 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:17:06,179 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:17:09,470 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:17:09,546 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:17:09,547 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:17:20,732 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:17:21,735 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:17:21,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:22,223 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:32,255 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:17:38,779 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:17:38,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:38,871 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:17:38,873 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:17:38,909 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:17:40,208 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:17:40,521 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:17:44,776 - ispa_next.functions - DEBUG - Updated appointment (AJ00018580) customer contact data.
2025-11-17 11:17:45,675 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:17:45,677 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:17:46,447 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:17:46,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:17:47,099 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:17:50,719 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:17:50,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:17:51,191 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:17:53,195 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:17:53,359 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:17:53,436 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:17:53,512 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:17:53,512 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:18:04,526 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:19:04,528 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:19:15,950 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:19:23,138 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:19:23,138 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:19:27,304 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:19:28,309 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:19:28,310 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:19:28,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:19:28,409 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:19:32,491 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:19:32,494 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:19:32,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:19:32,587 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:19:32,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:19:33,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:19:33,485 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:19:34,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:19:34,081 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:19:35,365 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:19:35,367 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:19:36,322 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:19:36,324 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:19:36,326 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:19:36,327 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:19:36,328 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeuginnenraum raussaugen -kostenlos-, source=from_tab, target=cart)}
2025-11-17 11:19:36,329 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:19:36,331 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:19:36,332 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:19:36,333 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:19:36,334 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:19:36,335 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:19:36,336 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:19:36,338 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:19:37,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:19:37,711 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:19:41,737 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:19:41,738 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:19:41,740 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:19:41,740 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:42,995 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:19:42,997 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:19:42,999 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:44,229 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:19:44,229 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:19:44,231 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:45,496 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:19:45,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:19:45,994 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:19:46,185 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:53,893 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:19:53,894 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:55,108 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:20:05,598 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:20:06,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:20:06,665 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:20:06,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:17,831 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:17,832 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:20:17,833 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:20:18,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:20:18,280 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:20:18,281 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:20:19,546 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:20:27,508 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:20:27,892 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 11:20:28,288 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:20:29,058 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 265
2025-11-17 11:20:29,059 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:20:32,100 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-17 11:20:32,101 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:20:32,897 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
2025-11-17 11:20:32,903 - ispa_next.main - DEBUG - Found new Appointment: RO-HR 523 E
2025-11-17 11:20:32,903 - ispa_next.main - DEBUG - Found new Appointment: TS-HW 238
2025-11-17 11:20:32,905 - ispa_next.main - DEBUG - 



2025-11-17 11:20:32,905 - ispa_next.main - DEBUG - starting with process 2 (RO-HR 523 E) of 6
2025-11-17 11:20:32,908 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:20:34,032 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:20:35,252 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 265
2025-11-17 11:20:35,253 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-17 11:20:36,606 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:20:36,607 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:21:11,515 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:21:20,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:21:20,229 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:21:20,408 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:21:21,639 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:21:21,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:21:21,702 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:21:21,870 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:21:21,872 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:21:21,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:21:21,956 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:21:24,875 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:21:24,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:21:25,748 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:21:27,753 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:21:27,856 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:21:31,057 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:21:31,131 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:21:31,131 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:21:42,098 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:21:43,101 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:21:43,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:21:43,594 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:21:53,853 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:21:53,853 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:22:00,343 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:22:00,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:22:00,447 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:22:00,448 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:22:00,493 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:22:00,589 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:22:01,892 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:22:02,166 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:22:06,063 - ispa_next.functions - DEBUG - Updated appointment (AJ00018603) customer contact data.
2025-11-17 11:22:07,018 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:22:07,019 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:22:07,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:22:07,869 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:22:09,016 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:22:09,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:22:09,082 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:22:13,556 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:22:13,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:22:14,101 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:22:16,120 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:22:16,240 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:22:16,334 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:22:16,400 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:22:16,401 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:22:27,462 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:23:27,465 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:23:38,472 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:24:12,475 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:24:23,558 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:24:30,544 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:24:31,553 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:24:31,554 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:24:31,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:24:31,633 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:24:35,740 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:24:35,743 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:24:35,743 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 11:24:35,744 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:24:37,607 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:24:37,609 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:24:38,957 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:24:38,960 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:24:38,962 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:24:38,963 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:24:38,976 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeuginnenraum raussaugen -kostenlos-, source=from_tab, target=cart)}
2025-11-17 11:24:38,978 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:24:38,984 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:24:38,985 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:24:38,989 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:24:38,990 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:24:38,994 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:24:39,014 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:24:39,017 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:24:39,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:24:40,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:24:44,241 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:24:44,243 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:24:44,245 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:24:44,246 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:46,171 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:24:46,172 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:24:46,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:48,065 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:24:48,065 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:24:48,070 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:50,170 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:24:50,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:24:50,631 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:24:50,668 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:24:50,670 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:52,554 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:25:02,281 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:25:02,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:25:03,228 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:25:03,483 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:25:20,780 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:25:24,700 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:25:24,702 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:25:24,702 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:25:25,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:25:25,154 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:25:25,155 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:25:26,480 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:25:37,550 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 11:25:37,551 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:25:37,552 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:25:38,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:25:39,041 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:25:39,042 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:25:41,451 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 11:25:41,476 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:25:43,574 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 11:25:43,576 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:25:44,310 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 265
2025-11-17 11:25:44,311 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:25:47,011 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-17 11:25:47,012 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:25:47,890 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
2025-11-17 11:25:47,896 - ispa_next.main - DEBUG - 



2025-11-17 11:25:47,896 - ispa_next.main - DEBUG - starting with process 3 (TS-HW 238) of 6
2025-11-17 11:25:47,899 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:25:49,054 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:25:50,109 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 265
2025-11-17 11:25:50,111 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-17 11:25:51,493 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:25:51,495 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:26:19,891 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:26:29,873 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:26:33,822 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:26:33,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:26:33,897 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:26:34,085 - ispa_next.functions - DEBUG - HU date already expired after 574 days.
2025-11-17 11:26:40,801 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:26:40,803 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:26:40,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:26:40,885 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:26:44,021 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:26:44,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:26:45,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:26:47,174 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:26:47,263 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:26:50,456 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:26:50,514 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:26:54,675 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:26:55,681 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:26:55,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:26:56,166 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:27:06,597 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:27:13,668 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:27:13,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:27:13,758 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:27:13,759 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:27:13,831 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:27:15,016 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:27:16,214 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:27:16,475 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:27:20,417 - ispa_next.functions - DEBUG - Updated appointment (AO00010669) customer contact data.
2025-11-17 11:27:21,373 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:27:21,375 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:27:22,077 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:27:22,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:27:22,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:27:26,590 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:27:26,590 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:27:26,593 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:27:26,594 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:27:26,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:27:27,102 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:27:31,306 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:27:31,310 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:27:31,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:27:31,396 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:27:35,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:27:35,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:27:35,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:27:36,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:27:36,540 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:27:40,208 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:27:40,209 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:27:41,088 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:27:41,093 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:27:41,095 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:27:41,098 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:27:41,100 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:27:41,102 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:27:41,104 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:27:41,105 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:27:41,106 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:27:41,107 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:27:41,108 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:27:41,110 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:27:41,112 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:27:41,113 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:27:41,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:45,006 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:27:47,192 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:27:47,194 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:27:47,197 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:51,339 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:27:51,339 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:27:51,341 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:55,200 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:27:55,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:27:55,841 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:27:56,043 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:28:07,133 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:28:07,135 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:28:11,119 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:28:21,142 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:28:21,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:28:22,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:28:22,185 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:29:00,290 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:03,898 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:07,605 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:11,660 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:15,664 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:15,666 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:29:15,667 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:29:16,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:29:16,365 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:29:16,366 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:29:18,104 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:29:25,283 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:29:25,668 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 11:29:26,011 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:29:26,919 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 265
2025-11-17 11:29:26,920 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:29:29,855 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-17 11:29:29,856 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:29:30,687 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
2025-11-17 11:29:30,692 - ispa_next.main - DEBUG - 



2025-11-17 11:29:30,692 - ispa_next.main - DEBUG - starting with process 4 (BGL-EW 55 E) of 6
2025-11-17 11:29:30,695 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:29:31,897 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:29:33,169 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 265
2025-11-17 11:29:33,171 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-17 11:29:34,500 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:29:34,502 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:30:00,381 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:30:09,417 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:30:11,358 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:30:11,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:11,458 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:30:11,694 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 11:30:18,492 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:30:18,493 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:30:18,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:18,566 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:30:21,595 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:30:21,596 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:30:22,623 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:30:24,629 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:30:24,749 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:30:28,003 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:30:28,066 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:30:28,067 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:30:39,197 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:30:40,201 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:30:40,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:40,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:50,948 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:30:50,948 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:30:57,277 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:30:57,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:57,400 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:30:57,401 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:30:57,446 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:30:58,670 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:30:59,930 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:31:00,191 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:31:03,026 - ispa_next.functions - DEBUG - Updated appointment (AG00027173) customer contact data.
2025-11-17 11:31:03,923 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:31:03,924 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:31:04,560 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:31:04,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:31:05,286 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:31:08,899 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:31:08,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:31:09,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:31:11,408 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:31:11,496 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:31:11,606 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:31:11,702 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:31:11,702 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:31:22,785 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:32:22,788 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:32:33,609 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:33:00,612 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:33:11,339 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:33:18,448 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:33:18,448 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:33:22,641 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:33:23,647 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:33:23,648 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:33:23,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:33:23,713 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:33:27,860 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:33:27,864 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:33:27,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:33:27,942 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:33:33,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:33:34,093 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:33:34,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:33:34,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:33:34,808 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:33:36,765 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:33:36,785 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:33:37,829 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:33:37,830 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:33:37,832 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:33:37,833 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:33:37,834 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:33:37,835 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:33:37,837 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:33:37,838 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:33:37,838 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:33:37,840 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:33:37,841 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:33:37,843 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:33:37,845 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:33:37,846 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:33:37,846 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:39,744 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:33:39,745 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:33:39,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:41,608 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:33:41,608 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:33:41,610 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:43,556 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:33:43,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:33:44,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:33:44,680 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:59,169 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:33:59,170 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:34:01,081 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:34:12,111 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:34:12,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:34:13,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:34:13,305 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:34:31,345 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:34:35,348 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:34:35,350 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:34:35,351 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:34:35,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:34:36,036 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:34:36,037 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:34:37,760 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:34:45,473 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:34:45,853 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 11:34:46,260 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:34:46,975 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 266
2025-11-17 11:34:46,976 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:34:49,530 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 86
2025-11-17 11:34:49,534 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:34:50,165 - ispa_next.appointments.models - DEBUG - Appointment Firma Lighthouse Advisors AG AR-20359 WBA31EU0X09W25726 ohne Termin.
2025-11-17 11:34:50,170 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
2025-11-17 11:34:50,173 - ispa_next.main - DEBUG - 



2025-11-17 11:34:50,173 - ispa_next.main - DEBUG - starting with process 5 (TS-GH 434) of 6
2025-11-17 11:34:50,176 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:34:51,024 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:34:52,513 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 266
2025-11-17 11:34:52,515 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 86
2025-11-17 11:34:54,019 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:34:54,021 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:35:17,773 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 11:35:17,870 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 11:35:17,874 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:35:18,261 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 266
2025-11-17 11:35:18,262 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:35:20,667 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 86
2025-11-17 11:35:20,668 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:35:21,521 - ispa_next.appointments.models - DEBUG - Appointment Firma Lighthouse Advisors AG AR-20359 WBA31EU0X09W25726 ohne Termin.
2025-11-17 11:35:21,527 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
2025-11-17 11:35:21,532 - ispa_next.main - DEBUG - 



2025-11-17 11:35:21,532 - ispa_next.main - DEBUG - starting with process 6 (TS-KS 2005) of 6
2025-11-17 11:35:21,535 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:35:22,925 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:35:24,046 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 266
2025-11-17 11:35:24,048 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 86
2025-11-17 11:35:25,416 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:35:25,419 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:35:52,234 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 11:35:52,244 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 11:35:52,247 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:35:52,639 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 266
2025-11-17 11:35:52,640 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:35:55,428 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 86
2025-11-17 11:35:55,428 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:35:56,250 - ispa_next.appointments.models - DEBUG - Appointment Firma Lighthouse Advisors AG AR-20359 WBA31EU0X09W25726 ohne Termin.
2025-11-17 11:35:56,256 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
