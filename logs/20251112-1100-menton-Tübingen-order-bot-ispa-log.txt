2025-11-12 11:07:31,319 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:07:31,325 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:07:42,121 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:07:52,647 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:08:08,409 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:08:32,407 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:08:46,388 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:08:49,678 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:51,000 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:08:51,001 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 281
2025-11-12 11:08:53,632 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 211
2025-11-12 11:08:53,633 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:08:53,634 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:08:54,963 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:08:56,240 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:25,172 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:09:25,216 - ispa_next.appointments.models - DEBUG - Appointment Herr Gunter Rieger TÜ-DG 1415 WBA5K31070G277653 ohne Termin.
2025-11-12 11:09:25,230 - ispa_next.appointments.models - DEBUG - Appointment Herr Klaus Friedl TÜ-XX 1226 WBAUS31070A834463 ohne Termin.
2025-11-12 11:09:25,231 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:09:25,268 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:09:25,321 - ispa_next.main - DEBUG - Found 10 out of 77 appointments to process (configured limit: 15).
2025-11-12 11:09:25,321 - ispa_next.main - DEBUG - Processing 8 fresh appointments.
2025-11-12 11:09:25,322 - ispa_next.main - DEBUG - Processing 2 already visited appointments (w/ RKR not callable).
2025-11-12 11:09:25,322 - ispa_next.main - DEBUG - All appointments: TÜ-PS 2101, TÜ-TE 247, TÜ-MJ 1316, TÜ-CV 500, TÜ-RP 8, TÜ-NB 9186, TÜ JB 1122, TÜ-E 789 E, TÜ-SV 337, ES-MY 600 E
2025-11-12 11:09:25,324 - ispa_next.main - DEBUG - 



2025-11-12 11:09:25,324 - ispa_next.main - DEBUG - starting with process 1 (TÜ-PS 2101) of 10
2025-11-12 11:09:25,328 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:09:26,399 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:27,753 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:09:27,763 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 211
2025-11-12 11:09:29,205 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:29,206 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:01,629 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:10:11,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:11,515 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:10:11,706 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:12,984 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:10:12,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:13,065 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:10:13,283 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:10:13,287 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:10:16,188 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:10:16,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:17,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:10:19,403 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:10:19,504 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:10:22,753 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:10:30,927 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 11:10:31,943 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:10:31,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:32,508 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:43,013 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:10:49,742 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:10:49,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:49,845 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:10:49,846 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:10:49,892 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:10:51,104 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:10:51,389 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:10:53,385 - ispa_next.functions - DEBUG - Updated appointment (AC00054718) customer contact data.
2025-11-12 11:10:54,293 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:10:54,295 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:10:54,984 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:10:54,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:10:55,715 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:10:59,302 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:10:59,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:59,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:11:01,815 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:11:01,901 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:11:01,990 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:11:02,067 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:11:02,069 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:03,288 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:11:11,507 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:12:11,511 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:12:19,676 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:13:01,679 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:13:13,172 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:13:18,139 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:13:18,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:19,384 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:13:23,610 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:13:24,616 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:13:24,617 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:13:24,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:24,704 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:13:28,865 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:13:28,869 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:13:28,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:28,994 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:13:29,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:29,894 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:29,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:30,691 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:13:30,692 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:13:32,177 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:13:32,188 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:13:33,321 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:13:33,322 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:13:33,323 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 11:13:33,324 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:13:33,325 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:13:33,326 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:13:33,326 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:13:33,327 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:13:33,328 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:13:33,329 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:13:33,330 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:13:33,336 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:13:33,338 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:13:33,338 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:34,533 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:13:34,533 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:35,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 11:13:36,450 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 11:13:37,056 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:13:37,058 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:38,425 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:13:38,426 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:13:38,428 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:13:38,431 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:39,646 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:13:52,210 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:13:52,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:13:53,293 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:13:53,550 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:59,199 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:13:59,201 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:13:59,202 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:59,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:13:59,796 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:13:59,797 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:14:01,276 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:14:12,192 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:14:12,570 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:14:12,953 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:14,079 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:14:14,081 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:16,886 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 277
2025-11-12 11:14:16,887 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:17,564 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 11:14:17,571 - ispa_next.appointments.models - DEBUG - Appointment Firma Gerhard Hechler TÜ-H 1160 WBAJM91070BH38619 ohne Termin.
2025-11-12 11:14:17,580 - ispa_next.appointments.models - DEBUG - Appointment Frau Liane Ohlendorf RT-SF 444 WBA2A51080V980420 ohne Termin.
2025-11-12 11:14:17,587 - ispa_next.appointments.models - DEBUG - Appointment Herr Michael Himmelstein RT-HI 6 WBAJM71040B267739 ohne Termin.
2025-11-12 11:14:17,593 - ispa_next.main - DEBUG - 



2025-11-12 11:14:17,593 - ispa_next.main - DEBUG - starting with process 2 (TÜ-TE 247) of 10
2025-11-12 11:14:17,596 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:18,525 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:19,623 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:14:19,624 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 277
2025-11-12 11:14:21,125 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:21,127 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:48,887 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:14:58,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:14:58,479 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:14:58,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:14:59,874 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:14:59,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:00,041 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:15:00,231 - ispa_next.functions - DEBUG - HU date already expired after 1306 days.
2025-11-12 11:15:09,858 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:15:09,860 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:15:12,602 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:15:12,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:15:13,719 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:15:15,722 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:15:15,899 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:15:19,136 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:15:26,998 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 11:15:28,003 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:15:28,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:28,500 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:41,099 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:15:49,646 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:15:49,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:49,731 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:15:49,731 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:15:49,798 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:15:49,938 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:15:51,141 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:15:51,410 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:15:53,392 - ispa_next.functions - DEBUG - Updated appointment (AC00054707) customer contact data.
2025-11-12 11:15:54,309 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:15:54,311 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:15:54,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:15:55,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:15:56,830 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:15:56,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:15:56,906 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:16:01,012 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:16:01,012 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:16:01,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:16:01,541 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:16:03,552 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:16:03,670 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:16:03,793 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:16:03,853 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:16:03,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:05,075 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:16:13,533 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:17:13,538 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:17:21,978 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:17:48,982 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:17:57,408 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:18:04,851 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:18:05,856 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:18:05,857 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:18:05,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:05,951 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:18:10,074 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:18:10,077 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:18:10,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:10,140 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:18:10,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:11,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:11,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:11,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:18:11,771 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:18:13,031 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:18:13,033 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:18:14,329 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:18:14,358 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:18:14,373 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 11:18:14,376 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:18:14,377 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:18:14,378 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:18:14,379 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:18:14,382 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:18:14,383 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:18:14,384 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:18:14,385 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:18:14,387 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:18:14,389 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:18:14,389 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:15,551 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:18:15,551 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:16,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 11:18:17,435 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 11:18:17,993 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:18:17,995 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:19,133 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:18:19,134 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:18:19,136 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:18:19,137 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:20,325 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:18:32,862 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:18:33,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:33,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:18:34,186 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:39,718 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:39,721 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:18:39,722 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:40,485 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:40,617 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:18:40,619 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:18:42,563 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:18:51,228 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:18:51,602 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:18:51,964 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:53,118 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:18:53,119 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:55,674 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 272
2025-11-12 11:18:55,675 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:56,339 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 11:18:56,349 - ispa_next.appointments.models - DEBUG - Appointment Firma Gerhard Hechler TÜ-H 1160 WBAJM91070BH38619 ohne Termin.
2025-11-12 11:18:56,358 - ispa_next.appointments.models - DEBUG - Appointment Frau Liane Ohlendorf RT-SF 444 WBA2A51080V980420 ohne Termin.
2025-11-12 11:18:56,367 - ispa_next.appointments.models - DEBUG - Appointment Herr Michael Himmelstein RT-HI 6 WBAJM71040B267739 ohne Termin.
2025-11-12 11:18:56,370 - ispa_next.main - DEBUG - 



2025-11-12 11:18:56,371 - ispa_next.main - DEBUG - starting with process 3 (TÜ-MJ 1316) of 10
2025-11-12 11:18:56,373 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:57,235 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:58,080 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:18:58,081 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 272
2025-11-12 11:18:59,357 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:59,358 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:20,269 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:19:30,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:30,479 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:30,702 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:31,903 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:19:31,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:31,982 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:32,248 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:19:32,250 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:19:35,180 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:35,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:36,467 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:19:38,471 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:19:38,573 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:19:41,804 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:19:49,561 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 11:19:50,569 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:19:50,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:51,024 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:01,386 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:20:07,848 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:20:07,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:07,915 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:07,915 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:20:08,021 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:20:08,122 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:20:09,241 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:20:09,465 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:20:11,427 - ispa_next.functions - DEBUG - Updated appointment (AC00054706) customer contact data.
2025-11-12 11:20:12,350 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:20:12,352 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:20:12,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:20:13,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:20:14,577 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:20:14,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:20:14,637 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:20:18,661 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:20:18,661 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:20:18,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:19,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:21,247 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:20:21,346 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:20:21,445 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:20:21,515 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:20:21,515 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:22,731 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:20:30,985 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:21:30,987 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:21:39,533 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:22:20,537 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:22:31,381 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:22:35,722 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:22:35,724 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:36,927 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:22:41,577 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:22:42,584 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:22:42,585 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:22:42,586 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:42,653 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:22:46,916 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:22:46,921 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:22:46,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:47,009 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:22:47,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:47,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:47,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:48,593 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:22:48,594 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:22:49,861 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:22:49,864 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:22:51,408 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:22:51,410 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:22:51,411 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 11:22:51,412 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:22:51,414 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:22:51,416 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:22:51,417 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:22:51,418 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:22:51,420 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:22:51,427 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:22:51,431 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:22:51,435 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:22:51,437 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:22:51,438 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:52,626 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:22:52,627 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:53,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 11:22:54,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 11:22:55,274 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:22:55,276 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:56,521 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:22:56,524 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:22:56,532 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:22:56,535 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:57,731 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:23:10,933 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:23:11,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:23:12,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:23:12,358 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:17,267 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:23:17,269 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:23:17,269 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:23:17,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:23:17,849 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:23:17,850 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:23:19,392 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:23:27,312 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:23:27,690 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:23:28,029 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:29,702 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:23:29,703 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:32,248 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 268
2025-11-12 11:23:32,249 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:32,985 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 11:23:32,994 - ispa_next.appointments.models - DEBUG - Appointment Firma Gerhard Hechler TÜ-H 1160 WBAJM91070BH38619 ohne Termin.
2025-11-12 11:23:33,004 - ispa_next.appointments.models - DEBUG - Appointment Frau Liane Ohlendorf RT-SF 444 WBA2A51080V980420 ohne Termin.
2025-11-12 11:23:33,012 - ispa_next.appointments.models - DEBUG - Appointment Herr Michael Himmelstein RT-HI 6 WBAJM71040B267739 ohne Termin.
2025-11-12 11:23:33,018 - ispa_next.main - DEBUG - 



2025-11-12 11:23:33,018 - ispa_next.main - DEBUG - starting with process 4 (TÜ-CV 500) of 10
2025-11-12 11:23:33,022 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:23:33,950 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:34,826 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:23:34,827 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 268
2025-11-12 11:23:36,117 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:36,118 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:24:11,967 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:24:21,490 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:24,819 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:24:24,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:24,883 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:24:25,085 - ispa_next.functions - DEBUG - HU date already expired after 23 days.
2025-11-12 11:24:32,063 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:24:32,066 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:24:34,897 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:24:34,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:36,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:38,077 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:24:38,258 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:24:38,391 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:24:38,462 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:24:42,667 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:24:43,673 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:24:43,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:44,209 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:55,718 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:25:03,719 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:25:03,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:03,807 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:03,808 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:25:03,852 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:25:03,972 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:25:05,168 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:25:05,379 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:25:09,122 - ispa_next.functions - DEBUG - Updated appointment (AC00054701) customer contact data.
2025-11-12 11:25:10,066 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:25:10,067 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:25:10,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:25:10,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:25:12,536 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:25:12,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:25:12,647 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:25:17,059 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-12 11:25:17,059 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:25:17,060 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:25:17,063 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:25:17,064 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:25:17,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:17,617 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:25:21,790 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:25:22,597 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:25:38,678 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:25:38,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:38,859 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:25:48,139 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:25:58,264 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:25:58,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:59,178 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:59,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:59,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:25:59,994 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:26:03,166 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:26:03,169 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:26:04,991 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:26:04,992 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:26:04,994 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 11:26:04,996 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-12 11:26:04,997 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:26:04,999 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:26:05,000 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:26:05,001 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:26:05,002 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:26:05,005 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:26:05,006 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:26:05,008 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:26:29,897 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:26:29,899 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-12 11:26:38,227 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:26:38,229 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:26:38,231 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:42,334 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:26:45,803 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:26:45,821 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:50,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 11:26:51,209 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 11:26:52,333 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:26:52,336 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:56,327 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:26:56,329 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:26:56,330 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:26:56,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:00,340 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:27:15,585 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:27:16,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:27:16,813 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:27:17,003 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:26,898 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:32,861 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:40,999 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:27:40,999 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:27:41,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:27:42,005 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:27:42,007 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:27:47,015 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:27:59,035 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:27:59,407 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:28:00,039 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:28:03,002 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:28:03,004 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:28:07,731 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 268
2025-11-12 11:28:07,732 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:28:09,058 - ispa_next.appointments.models - DEBUG - Appointment Herr Raphael Christian Eisenmann TÜ-RE 2227 WMW31DK0402S90730 ohne Termin.
2025-11-12 11:28:09,066 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 11:28:09,074 - ispa_next.appointments.models - DEBUG - Appointment Firma Gerhard Hechler TÜ-H 1160 WBAJM91070BH38619 ohne Termin.
2025-11-12 11:28:09,085 - ispa_next.appointments.models - DEBUG - Appointment Frau Liane Ohlendorf RT-SF 444 WBA2A51080V980420 ohne Termin.
2025-11-12 11:28:09,095 - ispa_next.appointments.models - DEBUG - Appointment Herr Michael Himmelstein RT-HI 6 WBAJM71040B267739 ohne Termin.
2025-11-12 11:28:09,100 - ispa_next.main - DEBUG - 



2025-11-12 11:28:09,100 - ispa_next.main - DEBUG - starting with process 5 (TÜ-RP 8) of 10
2025-11-12 11:28:09,105 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:28:11,087 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:28:12,807 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:28:12,809 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 268
2025-11-12 11:28:15,215 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:28:15,217 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:28:46,351 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:28:58,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:58,793 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:28:59,022 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:00,239 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:29:00,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:00,380 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:29:00,751 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:29:00,754 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:29:03,813 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:29:03,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:05,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:29:07,368 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:29:07,499 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:29:07,642 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:29:07,726 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:29:07,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:09,044 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:29:19,967 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:29:26,654 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:29:26,655 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:30,147 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremse hinten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 11:29:33,841 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:29:38,350 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:29:39,357 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:29:39,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:39,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:54,916 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:30:05,104 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:30:05,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:30:05,196 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:30:05,196 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:30:05,277 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:30:06,564 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:30:07,790 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:30:08,041 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:30:10,000 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:30:10,002 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:30:11,032 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:30:11,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:30:12,247 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:30:16,400 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:30:16,400 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:30:16,400 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:30:16,403 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:30:16,404 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:30:16,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:30:16,897 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:30:21,099 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:30:22,479 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:30:34,048 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:30:34,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:30:34,198 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:30:34,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:30:35,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:30:35,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:30:35,969 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:30:35,970 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:30:37,286 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:30:37,288 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:30:39,528 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:30:39,531 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:30:39,532 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 11:30:39,534 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:30:39,554 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:30:39,558 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:30:39,559 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:30:39,560 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:30:39,562 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:30:39,563 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:30:39,565 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:30:39,568 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:30:39,571 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:30:39,573 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:40,781 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:30:40,782 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:42,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 11:30:43,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 11:30:44,874 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:30:44,877 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:46,115 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:30:46,117 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:30:46,119 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:30:46,121 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:47,335 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:31:03,039 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:31:03,687 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:31:04,369 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:31:04,669 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:12,151 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:12,153 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:31:12,154 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:13,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:31:13,371 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:31:13,372 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:31:16,264 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:31:28,643 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:31:29,037 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:31:29,598 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:32,710 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:31:32,711 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:31:37,779 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 268
2025-11-12 11:31:37,779 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:39,050 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 11:31:39,059 - ispa_next.appointments.models - DEBUG - Appointment Firma Gerhard Hechler TÜ-H 1160 WBAJM91070BH38619 ohne Termin.
2025-11-12 11:31:39,070 - ispa_next.appointments.models - DEBUG - Appointment Frau Liane Ohlendorf RT-SF 444 WBA2A51080V980420 ohne Termin.
2025-11-12 11:31:39,080 - ispa_next.appointments.models - DEBUG - Appointment Herr Michael Himmelstein RT-HI 6 WBAJM71040B267739 ohne Termin.
2025-11-12 11:31:39,083 - ispa_next.main - DEBUG - Found new Appointment: TÜ-RE 2227
2025-11-12 11:31:39,085 - ispa_next.main - DEBUG - 



2025-11-12 11:31:39,085 - ispa_next.main - DEBUG - starting with process 6 (TÜ-RE 2227) of 11
2025-11-12 11:31:39,089 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:40,520 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:41,974 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:31:41,975 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 268
2025-11-12 11:31:43,878 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:31:43,880 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:32:18,669 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:32:18,771 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:32:18,776 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:32:19,513 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:32:19,515 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:32:23,918 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 268
2025-11-12 11:32:23,918 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:32:25,573 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 11:32:25,586 - ispa_next.appointments.models - DEBUG - Appointment Firma Gerhard Hechler TÜ-H 1160 WBAJM91070BH38619 ohne Termin.
2025-11-12 11:32:25,598 - ispa_next.appointments.models - DEBUG - Appointment Frau Liane Ohlendorf RT-SF 444 WBA2A51080V980420 ohne Termin.
2025-11-12 11:32:25,607 - ispa_next.appointments.models - DEBUG - Appointment Herr Michael Himmelstein RT-HI 6 WBAJM71040B267739 ohne Termin.
2025-11-12 11:32:25,613 - ispa_next.main - DEBUG - 



2025-11-12 11:32:25,613 - ispa_next.main - DEBUG - starting with process 7 (TÜ-NB 9186) of 11
2025-11-12 11:32:25,617 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:32:27,633 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:32:29,656 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:32:29,658 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 268
2025-11-12 11:32:32,075 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:32:32,077 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:33:02,430 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:33:16,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:16,102 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:33:16,319 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:17,547 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:33:17,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:17,631 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:33:17,944 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:33:26,790 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:33:26,793 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:33:29,674 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:33:29,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:33:31,786 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:33:33,792 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:33:33,924 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:33:37,194 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:33:47,653 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 11:33:48,659 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:33:48,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:49,206 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:06,119 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:34:16,276 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:34:16,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:16,384 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:34:16,384 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:34:16,475 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:34:17,857 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:34:18,116 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:34:21,514 - ispa_next.functions - DEBUG - Updated appointment (AC00054697) customer contact data.
2025-11-12 11:34:22,404 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:34:22,408 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:34:23,828 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:34:23,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:34:24,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:34:29,412 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:34:29,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:34:30,108 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:34:32,113 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:34:32,304 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:34:32,464 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:34:32,603 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:34:32,603 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:34:33,856 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:34:42,988 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:35:42,991 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:35:54,077 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:35:58,581 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:35:58,582 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:59,842 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:36:04,097 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:36:05,118 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:36:05,119 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:36:05,119 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:36:05,263 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:36:09,455 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:36:09,459 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:36:09,459 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 11:36:09,460 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:36:10,810 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:36:10,812 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:36:12,591 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:36:12,592 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:36:12,594 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 11:36:12,596 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:36:12,597 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:36:12,598 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:36:12,599 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:36:12,600 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:36:12,607 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:36:12,608 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:36:12,614 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:36:12,617 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:36:12,619 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:36:12,620 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:13,923 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:36:13,924 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:15,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 11:36:16,169 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 11:36:17,215 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:36:17,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:18,487 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:36:18,489 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:36:18,491 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:36:18,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:19,729 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:36:36,395 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:36:36,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:36:37,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:36:38,052 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:45,511 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:36:45,513 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:36:45,514 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:36:46,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:36:46,775 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:36:46,777 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:36:49,585 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:37:01,644 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:37:02,034 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:37:02,466 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:37:05,237 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:37:05,239 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:37:10,055 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 266
2025-11-12 11:37:10,056 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:37:11,424 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 11:37:11,433 - ispa_next.appointments.models - DEBUG - Appointment Firma Gerhard Hechler TÜ-H 1160 WBAJM91070BH38619 ohne Termin.
2025-11-12 11:37:11,444 - ispa_next.appointments.models - DEBUG - Appointment Frau Liane Ohlendorf RT-SF 444 WBA2A51080V980420 ohne Termin.
2025-11-12 11:37:11,454 - ispa_next.appointments.models - DEBUG - Appointment Herr Michael Himmelstein RT-HI 6 WBAJM71040B267739 ohne Termin.
2025-11-12 11:37:11,459 - ispa_next.main - DEBUG - 



2025-11-12 11:37:11,459 - ispa_next.main - DEBUG - starting with process 8 (TÜ JB 1122) of 11
2025-11-12 11:37:11,463 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:37:13,347 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:37:15,273 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:37:15,275 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 266
2025-11-12 11:37:17,730 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:37:17,733 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:38:01,669 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:38:01,679 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:38:01,682 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:38:02,370 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:38:02,372 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:38:06,679 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 266
2025-11-12 11:38:06,680 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:38:07,916 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 11:38:07,926 - ispa_next.appointments.models - DEBUG - Appointment Firma Gerhard Hechler TÜ-H 1160 WBAJM91070BH38619 ohne Termin.
2025-11-12 11:38:07,936 - ispa_next.appointments.models - DEBUG - Appointment Frau Liane Ohlendorf RT-SF 444 WBA2A51080V980420 ohne Termin.
2025-11-12 11:38:07,944 - ispa_next.appointments.models - DEBUG - Appointment Herr Michael Himmelstein RT-HI 6 WBAJM71040B267739 ohne Termin.
2025-11-12 11:38:07,949 - ispa_next.main - DEBUG - 



2025-11-12 11:38:07,949 - ispa_next.main - DEBUG - starting with process 9 (TÜ-E 789 E) of 11
2025-11-12 11:38:07,952 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:38:10,054 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:38:11,979 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:38:11,980 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 266
2025-11-12 11:38:14,471 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:38:14,472 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:38:43,270 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:38:55,821 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:59,814 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:38:59,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:59,898 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:39:00,253 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:39:00,256 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:39:03,337 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:39:03,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:39:03,721 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 11:39:04,020 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 11:39:04,038 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:39:04,040 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:39:05,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:39:05,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:39:05,983 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 11:39:06,008 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:39:09,243 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:39:09,246 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:39:11,994 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:39:11,995 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:39:16,908 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 11:39:16,909 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:39:17,888 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 11:39:17,895 - ispa_next.appointments.models - DEBUG - Appointment Firma Gerhard Hechler TÜ-H 1160 WBAJM91070BH38619 ohne Termin.
2025-11-12 11:39:17,904 - ispa_next.appointments.models - DEBUG - Appointment Frau Liane Ohlendorf RT-SF 444 WBA2A51080V980420 ohne Termin.
2025-11-12 11:39:17,912 - ispa_next.appointments.models - DEBUG - Appointment Herr Michael Himmelstein RT-HI 6 WBAJM71040B267739 ohne Termin.
2025-11-12 11:39:17,921 - ispa_next.main - DEBUG - 



2025-11-12 11:39:17,921 - ispa_next.main - DEBUG - starting with process 10 (TÜ-SV 337) of 11
2025-11-12 11:39:17,925 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:39:19,281 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:39:21,225 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-12 11:39:21,226 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 11:39:23,642 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:39:23,644 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:39:55,914 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:39:58,749 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:40:05,255 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:40:07,849 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:40:07,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:07,963 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:40:08,244 - ispa_next.functions - DEBUG - HU date soon to be invalid in 40 days.
2025-11-12 11:40:14,093 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:40:14,095 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:40:17,119 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:40:17,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:40:18,557 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:40:20,563 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:40:20,700 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:40:20,860 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:40:20,996 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:40:25,250 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:40:26,256 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:40:26,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:27,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:44,154 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:40:50,214 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:40:50,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:50,301 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:40:50,302 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:40:50,433 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:40:50,594 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:40:51,909 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:40:52,126 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:40:54,734 - ispa_next.functions - DEBUG - Updated appointment (AC00054609) customer contact data.
2025-11-12 11:40:55,652 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:40:55,655 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:40:55,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:40:57,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:40:58,530 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:40:58,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:40:58,625 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:41:02,256 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:41:02,256 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:41:02,259 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:41:02,260 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:41:02,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:02,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:41:06,999 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:41:07,003 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:41:07,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:07,077 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:41:07,490 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:07,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:07,989 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:08,793 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:41:08,794 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:41:11,376 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:41:11,377 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:41:14,050 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:41:14,052 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:41:14,054 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 11:41:14,056 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:41:14,058 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:41:14,061 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:41:14,062 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:41:14,063 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:41:14,065 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:41:14,066 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:41:14,067 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:41:14,069 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:41:14,071 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:41:14,072 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:16,675 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:41:16,676 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:19,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 11:41:20,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 11:41:21,523 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:41:21,526 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:24,128 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:41:24,130 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:41:24,132 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:41:24,138 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:26,707 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:41:43,053 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:41:43,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:41:44,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:41:44,671 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:53,012 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:41:59,026 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:42:05,307 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:42:05,310 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:42:05,310 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:42:06,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:42:06,518 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:42:06,520 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:42:09,280 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:42:20,781 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:42:21,180 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 11:42:21,847 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:42:24,836 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 672
2025-11-12 11:42:24,838 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:42:29,683 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 263
2025-11-12 11:42:29,685 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:42:30,984 - ispa_next.appointments.models - DEBUG - Appointment Herr Maksim Maksimov BB-MM 102 WBATX35070NA17660 ohne Termin.
2025-11-12 11:42:30,993 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 11:42:31,002 - ispa_next.appointments.models - DEBUG - Appointment Firma Gerhard Hechler TÜ-H 1160 WBAJM91070BH38619 ohne Termin.
2025-11-12 11:42:31,013 - ispa_next.appointments.models - DEBUG - Appointment Frau Liane Ohlendorf RT-SF 444 WBA2A51080V980420 ohne Termin.
2025-11-12 11:42:31,018 - ispa_next.main - DEBUG - 



2025-11-12 11:42:31,018 - ispa_next.main - DEBUG - starting with process 11 (ES-MY 600 E) of 11
2025-11-12 11:42:31,022 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:42:32,899 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:42:34,698 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 672
2025-11-12 11:42:34,699 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 263
2025-11-12 11:42:36,751 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:42:36,753 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:43:05,685 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:43:08,173 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:43:15,326 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:17,979 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:43:17,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:18,062 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:43:18,545 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:43:23,976 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:43:23,978 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:43:26,843 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:43:26,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:43:28,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:43:30,197 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:43:30,322 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:43:30,491 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:43:30,596 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:43:34,811 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:43:35,816 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:43:35,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:36,314 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:51,826 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:43:57,402 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:43:57,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:57,483 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:43:57,484 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:43:57,583 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:43:58,871 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:44:00,681 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:44:00,906 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:44:03,049 - ispa_next.functions - DEBUG - Updated appointment (AC00054663) customer contact data.
2025-11-12 11:44:03,976 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:44:03,979 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:44:05,325 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:44:05,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:44:06,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:44:10,442 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:44:10,443 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:44:10,446 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:44:10,446 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:44:10,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:44:11,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:44:15,248 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:44:15,253 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:44:15,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:44:15,362 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:44:20,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:44:21,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:44:21,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:44:22,708 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:44:22,708 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:44:25,192 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:44:25,197 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:44:27,165 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:44:27,170 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:44:27,172 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 11:44:27,174 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:44:27,176 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:44:27,177 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:44:27,179 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:44:27,180 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:44:27,183 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:44:27,185 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:44:27,190 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:44:27,193 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:44:27,194 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:29,876 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:44:29,877 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:32,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 11:44:33,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 11:44:35,278 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:44:35,279 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:37,860 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:44:37,863 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:44:37,865 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:44:37,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:40,460 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:44:57,684 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:44:58,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:44:59,110 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:44:59,392 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:45:07,908 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:45:13,681 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:45:19,834 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:45:19,836 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:45:19,837 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:45:20,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:45:20,909 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:45:20,910 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:45:23,866 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:45:35,792 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:45:36,179 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 11:45:36,797 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:45:39,722 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 672
2025-11-12 11:45:39,726 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:45:43,902 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 260
2025-11-12 11:45:43,903 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:45:44,970 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 11:45:44,979 - ispa_next.appointments.models - DEBUG - Appointment Firma Gerhard Hechler TÜ-H 1160 WBAJM91070BH38619 ohne Termin.
2025-11-12 11:45:44,988 - ispa_next.appointments.models - DEBUG - Appointment Frau Liane Ohlendorf RT-SF 444 WBA2A51080V980420 ohne Termin.
2025-11-12 11:45:44,992 - ispa_next.main - DEBUG - Found new Appointment: BB-MM 102
2025-11-12 11:45:44,994 - ispa_next.main - DEBUG - 



2025-11-12 11:45:44,994 - ispa_next.main - DEBUG - starting with process 12 (BB-MM 102) of 12
2025-11-12 11:45:44,997 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:45:46,319 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:45:47,805 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 672
2025-11-12 11:45:47,807 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 260
2025-11-12 11:45:49,808 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:45:49,810 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:46:25,554 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:46:39,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:46:39,671 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:46:39,939 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:47,318 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:46:47,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:46:47,440 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:46:47,767 - ispa_next.functions - DEBUG - HU date already expired after 194 days.
2025-11-12 11:46:58,022 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:46:58,025 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:47:01,105 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:47:01,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:47:02,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:47:04,982 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:47:05,118 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:47:08,409 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:47:08,566 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:47:08,568 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:47:16,339 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:47:25,837 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:47:26,842 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:47:26,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:47:27,386 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:47:43,223 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:47:43,223 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:47:54,117 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:47:54,119 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:47:54,233 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:47:54,234 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:47:54,299 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:47:54,499 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:47:55,858 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:47:56,073 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:48:00,438 - ispa_next.functions - DEBUG - Updated appointment (AC00054733) customer contact data.
2025-11-12 11:48:01,430 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:48:01,433 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:48:01,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:48:03,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:48:05,280 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:48:05,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:48:05,434 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:48:09,034 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:48:09,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:48:09,595 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:48:11,598 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:48:11,748 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:48:11,897 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:48:12,031 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:48:12,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:48:19,820 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:48:29,177 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:49:26,180 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:49:37,235 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:49:44,144 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:49:44,146 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:49:52,034 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:49:54,214 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:49:55,220 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:49:55,222 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:49:55,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:49:55,346 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:49:59,495 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:50:00,914 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:50:13,725 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:50:13,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:50:13,842 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:50:18,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:50:18,860 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:50:18,861 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:50:19,772 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:50:19,773 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:50:26,392 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:50:26,394 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:50:28,450 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:50:28,452 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:50:28,455 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblätter Leasing, source=from_tab, target=cart)}
2025-11-12 11:50:28,457 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:50:28,459 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:50:28,461 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:50:28,464 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:50:28,470 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:50:28,486 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:50:28,489 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:50:28,491 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:50:29,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:50:30,268 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:50:38,457 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:50:38,460 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:50:38,462 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:50:38,463 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:50:46,795 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:50:46,796 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:50:55,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 11:50:56,118 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 11:50:57,388 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:50:57,390 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:51:05,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:51:06,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:51:18,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:51:39,818 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:51:39,819 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:51:39,821 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:51:39,835 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:51:48,105 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:52:09,041 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:52:09,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:52:10,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:52:11,281 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:52:25,398 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:52:30,629 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:52:37,564 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:52:46,054 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:52:46,055 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:52:46,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:52:47,031 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:52:47,032 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:52:52,760 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:53:06,404 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:53:06,769 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 11:53:09,995 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:53:11,173 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 674
2025-11-12 11:53:11,175 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:53:16,510 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 256
2025-11-12 11:53:16,510 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:53:17,770 - ispa_next.appointments.models - DEBUG - Appointment Frau Ingeborg Hehl TÜ-H 1848 WBA71AC0205U49550 ohne Termin.
2025-11-12 11:53:17,779 - ispa_next.appointments.models - DEBUG - Appointment Herr Patrick Ott RT-P 6696 WBA2H310X0VF57986 ohne Termin.
2025-11-12 11:53:17,789 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 11:53:17,798 - ispa_next.appointments.models - DEBUG - Appointment Firma Gerhard Hechler TÜ-H 1160 WBAJM91070BH38619 ohne Termin.
