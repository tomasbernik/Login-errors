2025-11-17 10:00:34,450 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:00:34,457 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:00:46,956 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:00:57,663 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:01:13,205 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:03:11,200 - ispa_next.app_start.main - DEBUG - Operation already took 106.63 seconds (more than 80 seconds)
2025-11-17 10:03:13,318 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\f4daabcc240384f9\\tess_flgv7bgh_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\f4daabcc240384f9\\tess_flgv7bgh', 'txt']
2025-11-17 10:03:13,576 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 10:03:13,581 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 10:03:13,582 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:03:49,010 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:04:00,719 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:04:03,379 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:04:04,669 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 10:04:04,670 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 205
2025-11-17 10:04:06,795 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 148
2025-11-17 10:04:06,796 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:04:06,797 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:04:07,646 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:04:08,563 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:04:29,002 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 10:04:29,003 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:04:29,004 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:04:29,028 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:04:29,072 - ispa_next.appointments.models - DEBUG - Appointment Ulrich Franz WW-SC 91 WBA5V71020FH87156 ohne Termin.
2025-11-17 10:04:29,098 - ispa_next.appointments.models - DEBUG - Appointment Firma AKC Angersbach & Kaiser  WBA65GP080N366928 ohne Termin.
2025-11-17 10:04:29,108 - ispa_next.appointments.models - DEBUG - Appointment   WBA11GV080CW64111 ohne Termin.
2025-11-17 10:04:29,117 - ispa_next.appointments.models - DEBUG - Appointment Marcel Werner Hohmann FD-MH 1306 WBAJN71050BS67908 ohne Termin.
2025-11-17 10:04:29,124 - ispa_next.appointments.models - DEBUG - Appointment   WBA32EE0805469799 ohne Termin.
2025-11-17 10:04:29,131 - ispa_next.appointments.models - DEBUG - Appointment Dino Keshishi HU-MD 1991 WBA8T31040GB33829 ohne Termin.
2025-11-17 10:04:29,139 - ispa_next.appointments.models - DEBUG - Appointment Edat Bayram GN-XM 1996 WBA7C41070BR92361 ohne Termin.
2025-11-17 10:04:29,147 - ispa_next.appointments.models - DEBUG - Appointment Firma MARL Seafood GmbH OF-AL 4545 WBA41EU0609Z08046 ohne Termin.
2025-11-17 10:04:29,178 - ispa_next.main - DEBUG - Found 15 out of 126 appointments to process (configured limit: 15).
2025-11-17 10:04:29,178 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 10:04:29,178 - ispa_next.main - DEBUG - All appointments: MKK RN 24, MKK-RS 25, F-RR 8716, HU-MJ 28, HU-TK 1402, HU-PW 667, FB-B 985, HU-KJ 81, HU-XS 108, HU-AS 958, OF-JF 333, FB-SR 1700, MKK-RM 157, GN-BB 156, MKK-MG 366
2025-11-17 10:04:29,180 - ispa_next.main - DEBUG - 



2025-11-17 10:04:29,180 - ispa_next.main - DEBUG - starting with process 1 (MKK RN 24) of 15
2025-11-17 10:04:29,185 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:04:29,968 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:04:30,736 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 10:04:30,740 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 148
2025-11-17 10:04:31,922 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:04:31,923 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:05:01,927 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:05:05,089 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:05:08,329 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:05:08,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:08,396 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:05:08,667 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:05:15,332 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:05:15,336 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:05:15,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:15,417 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:05:18,329 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:05:18,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:19,325 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:05:21,329 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:05:21,422 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:05:21,527 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:05:21,586 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:05:25,764 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:05:26,770 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:05:26,775 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:05:26,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:27,250 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:27,251 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:05:27,326 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:05:28,580 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:05:28,803 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:05:31,649 - ispa_next.functions - DEBUG - Updated appointment (AH00015416) customer contact data.
2025-11-17 10:05:32,573 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:05:32,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:32,705 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:05:32,891 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:05:32,894 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:05:33,727 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:05:33,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:05:34,433 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:05:38,536 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:05:38,536 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:05:38,540 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:05:38,541 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:05:38,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:39,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:05:43,263 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:05:44,147 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:05:59,641 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:05:59,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:59,787 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:06:08,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:09,530 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:09,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:10,345 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:06:10,345 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:06:13,351 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:06:13,353 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:06:14,612 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:06:14,614 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:06:14,616 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:06:14,618 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:06:14,620 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:06:14,623 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:06:14,624 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:06:14,625 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:06:14,626 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:06:14,628 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:06:14,631 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:06:14,633 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:06:14,634 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:17,884 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:06:17,886 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:06:17,888 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:21,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:21,219 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:06:31,753 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:06:31,755 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:06:31,757 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:06:31,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:35,147 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:06:35,150 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:06:36,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:06:37,006 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:06:37,189 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:05,071 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:07:05,071 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:07:06,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:07:06,188 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:07:06,190 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:07:10,875 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:07:24,883 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:07:25,258 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:07:27,279 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:07:28,348 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 10:07:28,350 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:07:32,911 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 205
2025-11-17 10:07:32,912 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:07:34,176 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:07:34,188 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:07:34,198 - ispa_next.main - DEBUG - 



2025-11-17 10:07:34,198 - ispa_next.main - DEBUG - starting with process 2 (MKK-RS 25) of 15
2025-11-17 10:07:34,203 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:07:36,137 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:07:38,164 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 10:07:38,166 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 205
2025-11-17 10:07:40,183 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:07:40,184 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:11,215 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:08:15,023 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:16,308 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:08:16,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:16,391 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:08:16,764 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:08:16,769 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:08:16,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:16,871 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:08:20,433 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:08:20,435 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:21,239 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:08:23,250 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:08:23,382 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_cbs_table
2025-11-17 10:08:24,388 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:08:24,393 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:08:24,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:24,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:24,940 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:08:25,066 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:08:26,448 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:08:27,797 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:08:28,038 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:08:30,010 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:08:30,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:30,203 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:08:30,430 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:08:30,433 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:08:31,782 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:08:31,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:08:32,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:08:36,457 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:08:36,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:37,001 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:08:39,005 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:08:39,224 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_cbs_table
2025-11-17 10:08:40,231 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:08:40,232 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:08:40,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:40,340 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:08:41,116 - ispa_next.functions - DEBUG - check_service_requirement couldn't find CBS table, returning False
2025-11-17 10:08:41,119 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:08:41,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:41,211 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:08:46,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:47,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:47,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:48,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:08:48,349 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:08:49,659 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:08:49,663 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:08:50,583 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:08:50,586 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:08:50,589 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:08:50,591 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:08:50,594 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:08:50,595 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:08:50,597 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:08:50,598 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:08:50,600 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:08:50,601 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:08:50,605 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:08:50,608 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:08:50,608 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:51,827 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:08:51,829 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:08:51,852 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:53,105 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:08:53,108 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:08:53,112 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:08:53,116 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:54,361 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:08:54,363 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:08:54,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:08:55,631 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:08:55,979 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:09,292 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:09:09,295 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:09:09,296 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:09:10,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:09:10,380 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:09:10,382 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:09:13,311 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:09:23,611 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:09:24,006 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:09:25,617 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:26,342 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 10:09:26,344 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:09:30,893 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 205
2025-11-17 10:09:30,894 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:32,148 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:09:32,158 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:09:32,165 - ispa_next.main - DEBUG - 



2025-11-17 10:09:32,165 - ispa_next.main - DEBUG - starting with process 3 (F-RR 8716) of 15
2025-11-17 10:09:32,169 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:09:33,508 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:34,899 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 10:09:34,901 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 205
2025-11-17 10:09:36,903 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:09:36,904 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:11,695 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:10:15,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:15,396 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:15,689 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:10:18,316 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:10:18,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:18,393 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:18,756 - ispa_next.functions - DEBUG - HU date soon to be invalid in 42 days.
2025-11-17 10:10:24,557 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:10:24,560 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:10:24,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:24,640 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:32,562 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:10:32,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:33,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:10:35,981 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:10:36,139 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:10:36,295 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:10:36,436 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:10:36,438 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:10:39,077 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:10:51,226 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:10:52,231 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:10:52,236 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:10:52,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:52,793 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:52,794 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:10:52,893 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:10:53,080 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:10:54,309 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:10:54,528 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:10:56,503 - ispa_next.functions - DEBUG - Updated appointment (AB00028034) customer contact data.
2025-11-17 10:10:57,414 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:10:57,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:57,535 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:57,748 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:10:57,750 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:10:57,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:10:58,900 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:11:00,294 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:11:00,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:11:00,385 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:11:04,550 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:11:04,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:11:05,076 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:11:07,109 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:11:07,311 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:11:07,627 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:11:07,795 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:11:07,796 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:11:10,548 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:11:22,735 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:12:22,737 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:12:34,740 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:13:11,742 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:13:23,925 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:13:33,900 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:13:34,907 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:13:34,908 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:13:34,909 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:34,993 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:13:39,166 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:13:39,171 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:13:39,171 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 10:13:39,171 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:13:41,635 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:13:41,636 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:13:42,891 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:13:42,894 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:13:42,895 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:13:42,897 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:13:42,899 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:13:42,902 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:13:42,904 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:13:42,906 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:13:42,907 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:13:42,908 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:13:42,911 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:13:42,914 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:13:42,915 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:45,533 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:13:45,536 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:13:45,539 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:48,130 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:13:48,133 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:13:48,135 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:13:48,137 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:50,751 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:13:50,754 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:13:51,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:13:52,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:13:53,042 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:18,940 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:14:24,192 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:14:29,850 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:14:29,853 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:14:29,853 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:14:30,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:14:30,712 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:14:30,716 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:14:32,904 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:14:42,963 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:14:43,378 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:14:43,980 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:14:46,175 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-17 10:14:46,176 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:14:50,794 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-17 10:14:50,795 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:14:51,999 - ispa_next.appointments.models - DEBUG - Appointment Firma Nicole Kramer HU-NK 444 WBATX35070NC12898 ohne Termin.
2025-11-17 10:14:52,012 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:14:52,022 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:14:52,029 - ispa_next.main - DEBUG - 



2025-11-17 10:14:52,029 - ispa_next.main - DEBUG - starting with process 4 (HU-MJ 28) of 15
2025-11-17 10:14:52,034 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:14:53,791 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:14:55,671 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-17 10:14:55,672 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-17 10:14:57,887 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:14:57,888 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:15:36,164 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:15:39,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:41,530 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:15:41,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:41,614 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:42,093 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:15:42,097 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:15:42,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:42,200 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:45,759 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:15:45,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:15:47,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:15:49,304 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:15:49,445 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:15:49,579 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:15:49,734 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:15:53,976 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:15:54,998 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:15:55,001 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:15:55,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:55,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:55,518 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:15:55,571 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:15:56,955 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:15:57,193 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:15:59,226 - ispa_next.functions - DEBUG - Updated appointment (AA00030021) customer contact data.
2025-11-17 10:16:00,157 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:16:00,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:00,372 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:16:00,574 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:16:00,577 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:16:01,796 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:16:01,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:16:02,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:16:06,422 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:16:06,422 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:16:06,429 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:16:06,430 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:16:06,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:07,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:11,165 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:16:11,170 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:16:11,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:11,286 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:16:25,476 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 10:16:41,846 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:16:42,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:42,846 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:42,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:43,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:43,705 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:16:45,577 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:16:45,580 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:16:46,780 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:16:46,781 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:16:46,783 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart)}
2025-11-17 10:16:46,784 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:16:46,786 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:16:46,788 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:16:46,788 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:16:46,790 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:16:46,791 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:16:46,793 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:16:46,798 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:17:08,796 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:17:08,797 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 10:17:13,721 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:17:13,726 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:17:13,729 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:16,583 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:17:16,587 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:17:16,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:19,268 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:17:19,270 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:17:19,272 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:17:19,280 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:21,907 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:17:21,910 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:17:22,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:17:23,896 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:17:24,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:49,719 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:54,761 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:18:01,315 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:18:01,318 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:18:01,319 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:18:02,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:18:02,461 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:18:02,463 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:18:05,205 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:18:16,764 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:18:17,157 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:18:18,804 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:18:19,618 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 10:18:19,620 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:18:23,467 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 204
2025-11-17 10:18:23,470 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:18:24,479 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:18:24,491 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:18:24,499 - ispa_next.main - DEBUG - 



2025-11-17 10:18:24,499 - ispa_next.main - DEBUG - starting with process 5 (HU-TK 1402) of 15
2025-11-17 10:18:24,505 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:18:25,997 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:18:27,392 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 10:18:27,400 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 204
2025-11-17 10:18:29,323 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:18:29,324 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:19:15,408 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:19:19,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:22,516 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:19:22,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:22,604 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:19:23,002 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:19:28,810 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:19:28,814 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:19:28,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:28,945 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:19:37,188 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:19:37,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:38,825 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:19:40,839 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:19:41,026 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:19:41,224 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:19:41,389 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:19:45,601 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:19:46,607 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:19:46,612 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:19:46,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:47,158 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:47,159 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:19:47,227 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:19:48,627 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:19:48,836 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:19:50,845 - ispa_next.functions - DEBUG - Updated appointment (AB00028030) customer contact data.
2025-11-17 10:19:51,762 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:19:51,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:51,963 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:19:52,264 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:19:52,266 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:19:53,440 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:19:53,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:19:54,612 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:19:58,730 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:19:58,730 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:19:58,734 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:19:58,735 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:19:58,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:59,290 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:03,417 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:20:03,422 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:20:03,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:03,549 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:20:07,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:07,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:07,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:08,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:08,810 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:20:11,963 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:20:11,967 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:20:13,543 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:20:13,544 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:20:13,548 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:20:13,550 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:20:13,554 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:20:13,557 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:20:13,559 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:20:13,560 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:20:13,562 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:20:13,564 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:20:13,569 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:20:13,572 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:20:13,573 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:16,914 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:20:16,918 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:20:16,927 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:20,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:20,391 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:20:32,176 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:46,558 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:20:46,561 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:20:46,563 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:20:46,581 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:50,016 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:20:50,020 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:20:51,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:20:52,746 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:20:52,994 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:27,329 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:33,212 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:38,150 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:44,548 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:44,551 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:21:44,552 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:21:45,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:21:45,729 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:21:45,732 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:21:48,215 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:21:59,357 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:21:59,758 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:22:01,910 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:22:02,622 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 10:22:02,623 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:22:06,808 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 204
2025-11-17 10:22:06,809 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:22:08,004 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:22:08,016 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:22:08,027 - ispa_next.main - DEBUG - 



2025-11-17 10:22:08,027 - ispa_next.main - DEBUG - starting with process 6 (HU-PW 667) of 15
2025-11-17 10:22:08,032 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:22:09,787 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:22:11,740 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 10:22:11,742 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 204
2025-11-17 10:22:14,094 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:22:14,096 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:22:58,732 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:23:02,289 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:23:04,198 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:23:04,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:04,309 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:23:04,626 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:23:04,629 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:23:04,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:04,736 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:23:08,068 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:23:08,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:09,389 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:23:11,395 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:23:11,621 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:23:12,053 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:23:12,187 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:23:16,380 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:23:17,399 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:23:17,405 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:23:17,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:17,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:17,993 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:23:18,042 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:23:19,408 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:23:19,619 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:23:21,591 - ispa_next.functions - DEBUG - Updated appointment (AA00030017) customer contact data.
2025-11-17 10:23:22,504 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:23:22,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:22,661 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:23:22,847 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:23:22,850 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:23:23,779 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:23:23,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:23:24,814 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:23:29,144 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:23:29,144 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:23:29,150 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:23:29,151 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:23:29,152 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:29,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:23:33,860 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:23:33,865 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:23:33,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:33,972 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:23:39,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:40,241 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:40,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:41,190 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:23:41,191 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:23:43,282 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:23:43,285 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:23:44,607 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:23:44,611 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:23:44,613 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:23:44,615 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:23:44,618 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:23:44,619 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:23:44,620 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:23:44,622 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:23:44,623 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:23:44,635 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:23:44,645 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:23:44,649 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:23:44,660 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:23:46,606 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:23:46,609 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:23:46,613 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:23:48,617 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:23:48,620 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:23:48,624 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:23:48,626 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:23:50,551 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:23:50,554 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:23:51,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:23:52,345 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:23:52,585 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:14,572 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:24:20,396 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:24:20,398 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:24:20,399 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:24:21,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:24:21,296 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:24:21,298 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:24:23,986 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:24:35,047 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:24:35,436 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:24:37,144 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:24:38,191 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 10:24:38,193 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:24:42,978 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 204
2025-11-17 10:24:42,978 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:24:44,191 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:24:44,203 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:24:44,211 - ispa_next.main - DEBUG - 



2025-11-17 10:24:44,211 - ispa_next.main - DEBUG - starting with process 7 (FB-B 985) of 15
2025-11-17 10:24:44,215 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:24:46,159 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:24:47,635 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 10:24:47,636 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 204
2025-11-17 10:24:49,588 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:24:49,589 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:25:26,743 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:25:30,418 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:31,655 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:25:31,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:31,754 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:25:32,156 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:25:32,160 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:25:32,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:32,284 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:25:35,783 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:25:35,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:25:37,154 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:25:39,157 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:25:39,303 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:25:39,413 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:25:39,535 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:25:43,723 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:25:44,729 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:25:44,735 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:25:44,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:45,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:45,309 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:25:45,407 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:25:46,969 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:25:47,210 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:25:49,354 - ispa_next.functions - DEBUG - Updated appointment (AA00030016) customer contact data.
2025-11-17 10:25:50,251 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:25:50,252 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:50,425 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:25:50,634 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:25:50,637 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:25:51,622 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:25:51,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:25:52,648 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:25:56,292 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:25:56,293 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:25:56,297 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:25:56,297 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:25:56,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:25:56,847 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:26:00,974 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:26:00,979 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:26:00,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:26:01,109 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:26:10,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:10,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:10,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:26:11,806 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:26:11,806 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:26:13,162 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:26:13,165 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:26:14,552 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:26:14,554 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:26:14,555 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:26:14,557 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:26:14,558 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:26:14,559 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:26:14,560 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:26:14,562 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:26:14,563 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:26:14,564 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:26:14,568 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:26:14,571 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:26:14,571 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:15,852 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:26:15,855 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:26:15,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:17,136 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:26:17,138 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:26:17,140 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:26:17,143 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:18,430 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:26:18,432 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:26:19,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:26:20,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:26:20,451 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:35,582 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:26:35,585 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:26:35,585 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:26:36,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:26:36,491 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:26:36,493 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:26:38,706 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:26:48,212 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:26:48,591 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:26:50,279 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:26:51,165 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 10:26:51,167 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:26:56,187 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 204
2025-11-17 10:26:56,188 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:26:57,539 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:26:57,554 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:26:57,562 - ispa_next.main - DEBUG - 



2025-11-17 10:26:57,562 - ispa_next.main - DEBUG - starting with process 8 (HU-KJ 81) of 15
2025-11-17 10:26:57,566 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:26:59,409 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:27:01,334 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 10:27:01,336 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 204
2025-11-17 10:27:03,590 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:27:03,592 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:27:50,940 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:27:54,978 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:27:57,121 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:27:57,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:57,281 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:27:58,540 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:28:10,731 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:28:10,735 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:28:10,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:10,872 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:28:14,407 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:28:14,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:15,858 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:28:17,865 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:28:17,998 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:28:18,156 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:28:18,233 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:28:22,442 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:28:23,462 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:28:23,466 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:28:23,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:24,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:24,080 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:28:24,177 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:28:25,499 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:28:25,759 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:28:27,832 - ispa_next.functions - DEBUG - Updated appointment (AA00030012) customer contact data.
2025-11-17 10:28:28,758 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:28:28,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:29,353 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:28:29,597 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:28:29,600 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:28:30,804 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:28:30,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:28:31,932 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:28:36,055 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:28:36,055 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:28:36,061 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:28:36,062 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:28:36,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:36,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:28:40,784 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:28:40,790 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:28:40,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:40,879 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:28:46,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:47,172 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:47,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:48,104 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:28:48,105 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:28:50,059 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:28:50,061 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:28:51,477 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:28:51,490 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:28:51,493 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:28:51,494 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:28:51,498 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:28:51,499 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:28:51,502 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:28:51,503 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:28:51,506 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:28:51,507 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:28:51,519 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:28:51,522 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:28:51,523 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:53,538 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:28:53,541 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:28:53,547 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:55,551 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:28:55,554 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:28:55,556 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:28:55,558 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:57,511 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:28:57,514 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:28:58,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:28:59,188 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:28:59,395 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:18,419 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:29:23,740 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:29:23,743 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:29:23,743 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:29:24,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:29:24,828 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:29:24,831 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:29:27,587 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:29:38,682 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:29:39,059 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:29:40,807 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:29:41,780 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 10:29:41,782 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:29:46,267 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 204
2025-11-17 10:29:46,268 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:29:47,246 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:29:47,257 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:29:47,264 - ispa_next.main - DEBUG - 



2025-11-17 10:29:47,264 - ispa_next.main - DEBUG - starting with process 9 (HU-XS 108) of 15
2025-11-17 10:29:47,268 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:29:48,552 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:29:49,932 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 10:29:49,933 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 204
2025-11-17 10:29:51,840 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:29:51,842 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:30:27,519 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:30:30,979 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:30:32,894 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:30:32,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:32,987 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:30:33,287 - ispa_next.functions - DEBUG - HU date already expired after 323 days.
2025-11-17 10:30:38,164 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:30:38,168 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:30:38,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:38,285 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:30:47,545 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:30:47,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:30:48,894 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:30:50,898 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:30:51,031 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:30:51,199 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:30:51,321 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:30:55,532 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:30:56,538 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:30:56,543 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:30:56,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:57,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:57,039 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:30:57,114 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:30:57,287 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:30:58,474 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:30:58,686 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:31:00,602 - ispa_next.functions - DEBUG - Updated appointment (AA00030000) customer contact data.
2025-11-17 10:31:01,499 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:31:01,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:01,688 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:31:01,886 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:31:01,888 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:31:01,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:31:03,195 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:31:04,370 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:31:04,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:31:04,501 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:31:08,102 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:31:08,102 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:31:08,107 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:31:08,108 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:31:08,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:31:08,660 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:31:12,859 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:31:12,866 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:31:12,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:31:12,972 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:31:13,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:13,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:13,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:31:14,723 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:31:14,724 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:31:16,693 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:31:16,695 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:31:17,870 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:31:17,872 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:31:17,874 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:31:17,875 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:31:17,877 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:31:17,878 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:31:17,879 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:31:17,881 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:31:17,888 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:31:17,891 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:31:17,896 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:31:17,899 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:31:17,900 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:19,852 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:31:19,854 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:31:19,861 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:21,785 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:31:21,788 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:31:21,792 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:31:21,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:23,860 - ispa_next.functions - DEBUG - adding material to item=Package(name=Ölwechsel im Doppelkupplungsgetriebe (DKG), source=cart, target=unkown)
2025-11-17 10:31:33,803 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:31:33,805 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:31:34,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:31:35,321 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:31:35,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:56,119 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:32:02,636 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:32:02,639 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:32:02,640 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:32:03,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:32:03,788 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:32:03,790 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:32:06,329 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:32:17,361 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:32:17,753 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:32:19,712 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:32:20,748 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 10:32:20,750 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:32:25,895 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 204
2025-11-17 10:32:25,896 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:32:27,069 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:32:27,083 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:32:27,093 - ispa_next.main - DEBUG - 



2025-11-17 10:32:27,093 - ispa_next.main - DEBUG - starting with process 10 (HU-AS 958) of 15
2025-11-17 10:32:27,099 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:32:28,717 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:32:30,397 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 10:32:30,399 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 204
2025-11-17 10:32:32,781 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:32:32,783 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:33:14,006 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:33:18,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:20,690 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:33:20,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:20,772 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:33:21,102 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:33:25,775 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:33:25,778 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:33:25,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:25,898 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:33:34,372 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:33:34,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:33:35,969 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:33:37,974 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:33:38,143 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:33:38,277 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:33:38,433 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:33:40,562 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:33:41,569 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:33:41,573 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:33:41,575 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:42,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:42,125 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:33:42,172 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:33:42,369 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:33:43,659 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:33:43,877 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:33:46,863 - ispa_next.functions - DEBUG - Updated appointment (AF00016210) customer contact data.
2025-11-17 10:33:47,778 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:33:47,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:47,963 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:33:48,176 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:33:48,178 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:33:48,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:33:49,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:33:50,742 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:33:50,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:33:50,822 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:33:54,942 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:33:54,942 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:33:54,946 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:33:54,947 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:33:54,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:33:55,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:33:59,690 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:34:05,886 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:34:05,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:34:05,997 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:34:06,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:07,278 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:07,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:34:08,152 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:34:08,153 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:34:10,722 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:34:10,726 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:34:13,275 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:34:13,276 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:34:13,278 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:34:13,279 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:34:13,280 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:34:13,281 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:34:13,282 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:34:13,283 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:34:13,284 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:34:13,286 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:34:13,298 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:34:13,300 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:34:13,301 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:34:15,977 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:34:15,979 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:34:15,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:34:18,704 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:34:18,707 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:34:18,709 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:34:18,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:34:21,325 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:34:21,329 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:34:22,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:34:22,937 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:34:23,204 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:34:50,445 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:34:56,320 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:35:02,917 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:35:02,920 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:35:02,921 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:35:03,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:35:04,107 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:35:04,109 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:35:07,042 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:35:19,583 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:35:19,962 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 10:35:22,111 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:35:23,267 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-17 10:35:23,269 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:35:28,970 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 205
2025-11-17 10:35:28,971 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:35:30,316 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:35:30,332 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:35:30,343 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:35:30,350 - ispa_next.main - DEBUG - 



2025-11-17 10:35:30,350 - ispa_next.main - DEBUG - starting with process 11 (OF-JF 333) of 15
2025-11-17 10:35:30,355 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:35:32,225 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:35:34,086 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-17 10:35:34,088 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 205
2025-11-17 10:35:36,501 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:35:36,503 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:36:18,174 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:36:22,050 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:36:27,548 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:36:27,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:27,651 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:36:28,018 - ispa_next.functions - DEBUG - HU date already expired after 24 days.
2025-11-17 10:36:34,299 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:36:34,303 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:36:34,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:34,395 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:36:44,426 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:36:44,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:36:46,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:36:48,029 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:36:48,237 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:36:48,395 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:36:48,557 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:36:52,780 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:36:53,787 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:36:53,792 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:36:53,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:54,372 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:54,373 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:36:54,458 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:36:54,657 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:36:56,096 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:36:56,380 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:36:59,244 - ispa_next.functions - DEBUG - Updated appointment (AE00018282) customer contact data.
2025-11-17 10:37:00,187 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:37:00,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:00,439 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:37:00,692 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:37:00,695 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:37:00,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:37:02,185 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:37:03,752 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:37:03,753 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:37:03,885 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:37:07,568 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:37:07,568 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:37:07,573 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:37:07,574 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:37:07,575 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:08,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:37:12,344 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:37:17,516 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:37:17,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:17,682 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:37:18,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:18,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:18,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:19,451 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:37:19,451 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:37:24,276 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:37:24,278 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:37:25,615 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:37:25,616 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:37:25,618 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:37:25,619 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:37:25,621 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:37:25,622 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:37:25,623 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:37:25,624 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:37:25,625 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:37:25,627 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:37:25,651 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:37:25,655 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:37:25,656 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:31,314 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:37:31,318 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:37:31,324 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:36,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:36,920 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:37:49,354 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:37:49,356 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:37:49,358 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:37:49,372 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:54,926 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:37:54,930 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:37:55,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:37:56,706 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:37:56,992 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:44,504 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:38:51,071 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:38:57,934 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:03,187 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:09,652 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:16,385 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:16,388 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:39:16,389 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:17,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:39:17,706 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:39:17,708 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:39:20,688 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:39:34,218 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:39:34,616 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 10:39:37,403 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:38,566 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-17 10:39:38,567 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:43,781 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 204
2025-11-17 10:39:43,782 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:39:45,022 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:39:45,037 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:39:45,085 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:39:45,092 - ispa_next.main - DEBUG - 



2025-11-17 10:39:45,092 - ispa_next.main - DEBUG - starting with process 12 (FB-SR 1700) of 15
2025-11-17 10:39:45,097 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:46,963 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:48,507 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-17 10:39:48,509 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 204
2025-11-17 10:39:50,527 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:50,528 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:40:30,114 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:40:33,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:40:36,391 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:40:36,394 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:36,503 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:40:36,793 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:40:36,797 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:40:36,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:36,897 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:40:46,091 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:40:46,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:40:47,994 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:40:50,000 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:40:50,176 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:40:50,343 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:40:50,438 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:40:54,747 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:40:55,755 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:40:55,761 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:40:55,764 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:56,285 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:56,286 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:40:56,341 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:40:56,525 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:40:57,973 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:40:58,239 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:41:01,158 - ispa_next.functions - DEBUG - Updated appointment (AR00006517) customer contact data.
2025-11-17 10:41:02,087 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:41:02,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:02,361 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:41:02,588 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:41:02,591 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:41:02,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:41:04,084 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:41:05,547 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:41:05,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:41:05,644 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:41:09,779 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:41:09,779 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:41:09,779 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:41:09,784 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:41:09,785 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:41:09,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:10,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:41:14,559 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:41:14,564 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:41:14,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:14,681 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:41:15,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:15,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:15,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:16,496 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:41:16,497 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:41:19,037 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:41:19,040 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:41:20,606 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:41:20,609 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:41:20,610 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:41:20,612 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:41:20,614 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:41:20,615 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:41:20,616 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:41:20,618 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:41:20,619 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:41:20,620 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:41:20,624 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:41:20,627 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:41:20,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:23,317 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:41:23,320 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:41:23,323 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:25,988 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:41:25,990 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:41:25,992 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:41:25,994 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:28,652 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:41:28,655 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:41:29,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:41:30,794 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:41:31,063 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:57,127 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:03,278 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:10,190 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:10,193 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:42:10,194 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:42:11,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:42:11,418 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:42:11,420 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:42:14,299 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:42:25,454 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:42:25,833 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 10:42:27,944 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:42:28,995 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-17 10:42:28,998 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:42:34,116 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 204
2025-11-17 10:42:34,117 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:42:35,439 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:42:35,458 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:42:35,482 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:42:35,491 - ispa_next.main - DEBUG - 



2025-11-17 10:42:35,491 - ispa_next.main - DEBUG - starting with process 13 (MKK-RM 157) of 15
2025-11-17 10:42:35,500 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:42:37,472 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:42:39,371 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-17 10:42:39,373 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 204
2025-11-17 10:42:42,170 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:42:42,172 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:43:25,236 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:43:29,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:31,798 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:43:31,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:31,940 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:43:32,279 - ispa_next.functions - DEBUG - HU date already expired after 84 days.
2025-11-17 10:43:38,210 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:43:38,213 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:43:38,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:38,309 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:43:47,150 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:43:47,152 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:43:48,747 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:43:50,751 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:43:50,893 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:43:51,017 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:43:51,133 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:43:51,135 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:53,175 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:44:05,367 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:44:06,373 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:44:06,379 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:44:06,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:06,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:06,916 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:44:06,982 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:44:08,367 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:44:09,759 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:44:10,020 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:44:12,270 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:44:12,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:12,542 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:44:12,789 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:44:12,792 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:44:14,168 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:44:14,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:44:15,668 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:44:19,740 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:44:19,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:20,797 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:44:22,800 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:44:22,970 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:44:23,116 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:44:23,219 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:44:23,220 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:25,250 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:44:37,373 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:45:37,377 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:45:50,177 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:46:26,181 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:46:38,365 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen' in nested popup
2025-11-17 10:46:46,189 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:46:46,191 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:46:57,881 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Abgasuntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:47:01,994 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:47:06,039 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:47:10,401 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Zündkerzen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:47:14,807 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Luftfiltereinsatz' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:47:20,261 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motoröl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:47:24,712 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:47:29,400 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Standardumfang' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:47:34,119 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:47:37,501 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:47:41,338 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:47:42,346 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:47:42,347 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:47:42,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:42,488 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:47:46,712 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:47:51,424 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:47:51,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:51,519 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:47:51,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:52,414 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:52,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:53,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:47:53,230 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:47:55,111 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:47:55,113 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:48:00,052 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:48:00,055 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:48:00,056 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:48:00,057 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:48:00,074 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:48:00,076 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:48:00,078 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:48:00,079 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:48:00,080 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:48:00,082 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:48:00,086 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:48:00,089 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:48:00,090 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:02,129 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:48:02,132 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:48:02,134 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:04,125 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:48:04,128 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:48:04,131 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:48:04,135 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:06,096 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:48:06,098 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:48:06,840 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:48:07,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:48:08,219 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:28,324 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:33,826 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:33,829 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:48:33,830 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:48:34,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:48:34,773 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:48:34,775 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:48:37,188 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:48:48,185 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:48:48,579 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 10:48:50,953 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:48:52,194 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 672
2025-11-17 10:48:52,197 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:48:57,188 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-17 10:48:57,189 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:48:58,456 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:48:58,457 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:48:58,480 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:48:58,509 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 10:48:58,514 - ispa_next.main - DEBUG - Found new Appointment: HU-VS 232
2025-11-17 10:48:58,515 - ispa_next.main - DEBUG - 



2025-11-17 10:48:58,515 - ispa_next.main - DEBUG - starting with process 14 (HU-VS 232) of 16
2025-11-17 10:48:58,523 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:49:00,072 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:49:01,731 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 672
2025-11-17 10:49:01,733 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-17 10:49:03,794 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:49:03,795 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:49:41,127 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:49:45,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:45,420 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:49:45,698 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:49:47,023 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:49:47,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:47,144 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:49:47,478 - ispa_next.functions - DEBUG - HU date already expired after 1875 days.
2025-11-17 10:49:57,767 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:49:57,771 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:49:57,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:57,868 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:10,835 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:50:10,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:12,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:50:14,526 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:50:14,687 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:50:17,967 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:50:18,076 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:50:18,080 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:19,356 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:50:32,112 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:50:33,119 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:50:33,124 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:50:33,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:33,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:33,695 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:50:33,750 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:50:33,966 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:50:35,311 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:50:35,540 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:50:41,072 - ispa_next.functions - DEBUG - Updated appointment (AB00028046) customer contact data.
2025-11-17 10:50:42,044 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:50:42,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:42,340 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:42,610 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:50:42,613 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:50:42,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:50:44,146 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:50:46,309 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:50:46,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:50:46,430 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:50:50,403 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:50:50,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:50,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:50:52,986 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:50:53,148 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:50:53,333 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:50:53,435 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:50:53,436 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:55,516 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:51:07,703 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:52:07,706 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:52:19,589 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:52:27,562 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:52:27,564 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:52:35,534 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:52:39,460 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Zündkerzen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:52:43,710 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:52:47,897 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Luftfiltereinsatz' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:52:52,241 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motoröl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:52:56,984 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:53:00,817 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:53:03,275 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:53:04,306 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:53:04,308 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:53:04,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:04,398 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:53:08,585 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:53:09,746 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:53:21,606 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:53:21,609 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:21,739 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:53:22,128 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:22,745 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:22,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:23,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:53:23,522 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:53:25,490 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:53:25,493 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:53:29,912 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:53:29,914 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:53:29,915 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:53:29,916 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:53:29,917 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:53:29,918 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:53:29,920 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:53:29,921 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:53:29,922 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:53:29,923 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:53:29,927 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:53:29,930 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:53:29,931 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:31,968 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:53:31,971 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:53:31,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:34,018 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:53:34,021 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:53:34,026 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:53:34,034 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:36,077 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:53:36,079 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:53:36,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:53:37,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:53:38,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:01,903 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:54:08,564 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:54:08,567 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:54:08,569 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:54:09,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:54:09,857 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:54:09,859 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:54:13,001 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:54:27,196 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 10:54:27,199 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:54:27,199 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:54:28,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:54:28,712 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:54:28,715 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:54:30,970 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 10:54:31,003 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:54:35,255 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 10:54:35,261 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:54:35,934 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 673
2025-11-17 10:54:35,935 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:54:40,774 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 207
2025-11-17 10:54:40,775 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:54:42,147 - ispa_next.appointments.models - DEBUG - Appointment Firma Winter and More  WBA51EG0305486602 ohne Termin.
2025-11-17 10:54:42,147 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:54:42,149 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:54:42,164 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:54:42,172 - ispa_next.main - DEBUG - 



2025-11-17 10:54:42,172 - ispa_next.main - DEBUG - starting with process 15 (GN-BB 156) of 16
2025-11-17 10:54:42,177 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:54:44,215 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:54:46,146 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 673
2025-11-17 10:54:46,148 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 207
2025-11-17 10:54:48,822 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:54:48,823 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:55:28,108 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:55:31,967 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:32,072 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:32,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:55:34,304 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:55:34,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:34,432 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:34,771 - ispa_next.functions - DEBUG - HU date already expired after 5070 days.
2025-11-17 10:55:41,563 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:55:41,568 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:55:41,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:41,713 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:50,943 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:55:50,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:55:52,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:55:54,746 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:56:02,591 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:56:09,383 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:56:10,389 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:56:10,416 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:56:10,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:10,983 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:10,984 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:56:11,083 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:56:11,269 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:56:12,541 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:56:14,151 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:56:14,447 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:56:17,308 - ispa_next.functions - DEBUG - Updated appointment (AD00021162) customer contact data.
2025-11-17 10:56:18,300 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:56:18,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:18,601 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:56:18,870 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:56:18,873 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:56:19,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:56:20,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:56:21,870 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:56:21,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:56:21,964 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:56:26,111 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:56:26,112 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:56:26,112 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:56:26,116 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:56:26,117 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:56:26,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:56:26,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:56:30,832 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:56:30,838 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:56:30,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:56:30,941 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:56:31,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:31,829 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:31,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:56:32,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:56:32,676 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:56:34,584 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:56:34,587 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:56:35,819 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:56:35,827 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:56:35,829 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:56:35,830 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:56:35,832 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:56:35,835 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:56:35,836 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:56:35,838 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:56:35,849 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:56:35,851 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:56:35,855 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:56:35,857 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:56:35,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:56:37,861 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:56:37,863 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:56:37,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:56:39,793 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:56:39,796 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:56:39,798 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:56:39,801 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:56:41,856 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:56:41,859 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:56:42,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:56:43,664 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:56:43,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:06,319 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:12,972 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:12,974 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:57:12,975 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:57:13,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:57:13,965 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:57:13,968 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:57:16,785 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:57:29,121 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:57:29,557 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 10:57:31,576 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:57:32,587 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 673
2025-11-17 10:57:32,588 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:57:37,445 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 207
2025-11-17 10:57:37,446 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:57:38,759 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:57:38,760 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:57:38,775 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 10:57:38,782 - ispa_next.main - DEBUG - 



2025-11-17 10:57:38,782 - ispa_next.main - DEBUG - starting with process 16 (MKK-MG 366) of 16
2025-11-17 10:57:38,787 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:57:40,686 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:57:42,646 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 673
2025-11-17 10:57:42,647 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 207
2025-11-17 10:57:45,193 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:57:45,195 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:58:27,993 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:58:31,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:36,948 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:58:36,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:58:37,041 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:58:37,478 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:58:37,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:58:37,584 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:58:49,114 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:58:49,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:58:49,550 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:59:00,126 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:59:00,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:59:01,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:59:03,794 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:59:12,331 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:59:18,201 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:59:19,208 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:59:19,219 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:59:19,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:19,738 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:19,739 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:59:19,812 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:59:19,965 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:59:22,088 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:59:22,337 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:59:24,916 - ispa_next.functions - DEBUG - Updated appointment (AD00021124) customer contact data.
2025-11-17 10:59:25,891 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:59:25,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:26,150 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:59:29,546 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:59:29,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:59:31,150 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:59:32,704 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:59:32,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:59:32,807 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:59:36,940 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:59:36,940 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:59:36,940 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:59:36,944 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:59:36,945 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:59:36,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:59:37,443 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:59:41,673 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:59:47,572 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:59:47,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:59:47,687 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:59:48,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:48,607 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:48,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:59:49,372 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:59:49,373 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:59:54,284 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:59:54,289 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:59:55,757 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:59:55,759 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:59:55,760 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:59:55,761 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:59:55,763 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:59:55,764 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:59:55,766 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:59:55,768 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:59:55,769 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:59:55,770 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:59:55,774 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:59:55,781 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:59:55,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:00:01,458 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:00:01,460 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:00:01,467 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:00:07,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:00:08,959 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:00:24,486 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:00:24,489 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:00:24,493 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:00:24,496 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:00:30,162 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:00:30,165 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:00:30,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:00:32,029 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:00:32,262 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:01:12,166 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:01:12,174 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:01:13,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:01:13,377 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:01:13,382 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:01:18,382 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:01:32,749 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:01:33,136 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 11:01:36,159 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:01:37,366 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 674
2025-11-17 11:01:37,368 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:01:42,743 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 208
2025-11-17 11:01:42,744 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:01:44,066 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:01:44,068 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:01:44,086 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
