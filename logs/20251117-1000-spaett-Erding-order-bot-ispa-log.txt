2025-11-17 10:14:36,407 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:14:36,413 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:14:44,307 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:14:56,708 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:15:12,683 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:15:44,566 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:16:02,092 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:16:06,089 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:16:07,036 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-17 10:16:07,038 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-17 10:16:09,430 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 322
2025-11-17 10:16:09,431 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:16:09,432 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:16:10,635 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:16:11,835 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:17:00,472 - ispa_next.appointments.models - DEBUG - Appointment Giovanni Ciconti ED-GC 1000 WBA31BN070CL81257 ohne Termin.
2025-11-17 10:17:00,501 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-17 10:17:00,514 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:17:00,522 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:17:00,535 - ispa_next.appointments.models - DEBUG - Appointment Bogdan-Laurentiu Turcu ED-BT 315 WBA5U91000FK31617 ohne Termin.
2025-11-17 10:17:00,548 - ispa_next.appointments.models - DEBUG - Appointment Ute Mätzig M-U 7573 WBA81GE0007T32557 ohne Termin.
2025-11-17 10:17:00,557 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Miotorenwerke Akti M-NK 3548 WBA15GR030N352507 ohne Termin.
2025-11-17 10:17:00,566 - ispa_next.appointments.models - DEBUG - Appointment Rainer Kollenda ED-XX 24 WBAMT11020C298608 ohne Termin.
2025-11-17 10:17:00,577 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-17 10:17:00,586 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-17 10:17:00,599 - ispa_next.appointments.models - DEBUG - Appointment Fitim Kucani ED-FF 2723 WBAUE11050PZ54416 ohne Termin.
2025-11-17 10:17:00,600 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:17:00,615 - ispa_next.appointments.models - DEBUG - Appointment Daniel Raphael ED-RD 212 WBA6T510607D45067 ohne Termin.
2025-11-17 10:17:00,627 - ispa_next.appointments.models - DEBUG - Appointment Firma Bucher Hydraulics Erding GmbH ED-BH 186 WBA5V7105LFH57377 ohne Termin.
2025-11-17 10:17:00,639 - ispa_next.appointments.models - DEBUG - Appointment Katerina Werner M-W 7091 WBA11EV0809V62969 ohne Termin.
2025-11-17 10:17:00,644 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:17:00,655 - ispa_next.appointments.models - DEBUG - Appointment Benedikt Friedl ED-SE 225 WBA61CA0X09V93186 ohne Termin.
2025-11-17 10:17:00,665 - ispa_next.appointments.models - DEBUG - Appointment Harald Kümmet ED-H 110 WMWSS91020WN99113 ohne Termin.
2025-11-17 10:17:00,671 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:17:00,689 - ispa_next.appointments.models - DEBUG - Appointment Thomas Ralf Olaf Buer ED-B 880 5UXWX7C54EL983484 ohne Termin.
2025-11-17 10:17:00,710 - ispa_next.appointments.models - DEBUG - Appointment Alen Halidowicz ED-HA 910 WBA6E41080G692725 ohne Termin.
2025-11-17 10:17:00,725 - ispa_next.appointments.models - DEBUG - Appointment Martina Bauer ED-Z 1988 WBADS41020GU95176 ohne Termin.
2025-11-17 10:17:00,766 - ispa_next.appointments.models - DEBUG - Appointment Ludwig Schönhuber FS-M 2909 WBAHF31040WX45135 ohne Termin.
2025-11-17 10:17:00,766 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:17:00,791 - ispa_next.appointments.models - DEBUG - Appointment Alois Obermaier ED-AO 67 WBA35BG040N074618 ohne Termin.
2025-11-17 10:17:00,803 - ispa_next.appointments.models - DEBUG - Appointment Karl-Heinz Baris ED-JA 828 WBA8J91020A190670 ohne Termin.
2025-11-17 10:17:00,812 - ispa_next.appointments.models - DEBUG - Appointment Rainer Wieder FS-RW 606 WBAJP310X0CD36205 ohne Termin.
2025-11-17 10:17:00,825 - ispa_next.appointments.models - DEBUG - Appointment Firma Büro der Fachärzte ED-BF 811 WBAPY71050C023350 ohne Termin.
2025-11-17 10:17:00,848 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Wildried Rademann ED-JR 900 WBAJP31030BT83692 ohne Termin.
2025-11-17 10:17:00,858 - ispa_next.appointments.models - DEBUG - Appointment Markus Christian Geyer M-CG 3388 WBA3Z910X0D367242 ohne Termin.
2025-11-17 10:17:00,867 - ispa_next.appointments.models - DEBUG - Appointment Levente Gergely ED-GL 71 WBA4X31050AA80192 ohne Termin.
2025-11-17 10:17:00,877 - ispa_next.appointments.models - DEBUG - Appointment Markus Kerndlbacher ED-MK 135 WBAUC71000VE99305 ohne Termin.
2025-11-17 10:17:00,888 - ispa_next.appointments.models - DEBUG - Appointment Firma VR-Bank Erding eG ED-VR 530 WBA5D31040GV81033 ohne Termin.
2025-11-17 10:17:00,905 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Scheid ED-P 1307 WBATX35020NC37837 ohne Termin.
2025-11-17 10:17:00,921 - ispa_next.appointments.models - DEBUG - Appointment Jakob Angermaier ED-AJ 44 WBAHS910105F51976 ohne Termin.
2025-11-17 10:17:00,933 - ispa_next.appointments.models - DEBUG - Appointment Almperto Kyriazis ED-AK 1994 WBA1A11020J903022 ohne Termin.
2025-11-17 10:17:00,948 - ispa_next.appointments.models - DEBUG - Appointment Firma Cleaning Express Gebäudedienst ED-BS 887 WBA41BX0707N24573 ohne Termin.
2025-11-17 10:17:00,972 - ispa_next.appointments.models - DEBUG - Appointment Bianca-Viviana Huber FS-H 162 E WBY8P210507H82040 ohne Termin.
2025-11-17 10:17:00,982 - ispa_next.appointments.models - DEBUG - Appointment Katharina Eichinger ED-LE 236 WMW11BR0903N74463 ohne Termin.
2025-11-17 10:17:00,994 - ispa_next.appointments.models - DEBUG - Appointment Firma BayWa Aktiengesellschaft M-GH 7766 WBA15BZ000N166569 ohne Termin.
2025-11-17 10:17:01,006 - ispa_next.appointments.models - DEBUG - Appointment Firma Privatbr. ERDINGER Weißbräu ED-EW 332 WBA41EG0005X82947 ohne Termin.
2025-11-17 10:17:01,006 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:17:01,016 - ispa_next.appointments.models - DEBUG - Appointment Carmen Berndt ED-CP 1725 WBAYN110X05T94356 ohne Termin.
2025-11-17 10:17:01,027 - ispa_next.appointments.models - DEBUG - Appointment Luigi Fazio  WBAKS410500C30478 ohne Termin.
2025-11-17 10:17:01,038 - ispa_next.appointments.models - DEBUG - Appointment Zhensheng Guo ED-SG 8888 WBA5L31030G122160 ohne Termin.
2025-11-17 10:17:01,049 - ispa_next.appointments.models - DEBUG - Appointment Christine Ertel ED-C 1272 WMW31DH0802W00594 ohne Termin.
2025-11-17 10:17:01,061 - ispa_next.appointments.models - DEBUG - Appointment Daniel Franke LA-EB 308 WBA1V71070V616601 ohne Termin.
2025-11-17 10:17:01,071 - ispa_next.appointments.models - DEBUG - Appointment Paul Valerian Mona MM 23 MON WBA5E51090G100007 ohne Termin.
2025-11-17 10:17:01,082 - ispa_next.appointments.models - DEBUG - Appointment Firma Lear Corporation GmbH GG-LC 292E WBA81CY000FS44344 ohne Termin.
2025-11-17 10:17:01,112 - ispa_next.main - DEBUG - Found 13 out of 159 appointments to process (configured limit: 20).
2025-11-17 10:17:01,112 - ispa_next.main - DEBUG - Processing 13 fresh appointments.
2025-11-17 10:17:01,112 - ispa_next.main - DEBUG - All appointments: ED-FM 115 E, ED M 2304, ED RU 101, ED-MH-171, ED-A1024, ED-K2010, ED-AL59, M-ED-2001, ED N 1926, ED SN 4108, M-M6325, ED-BT 235, F-SF 148 E
2025-11-17 10:17:01,114 - ispa_next.main - DEBUG - 



2025-11-17 10:17:01,114 - ispa_next.main - DEBUG - starting with process 1 (ED-FM 115 E) of 13
2025-11-17 10:17:01,119 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:17:01,881 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:17:02,700 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-17 10:17:02,701 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 322
2025-11-17 10:17:03,810 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:17:03,811 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:17:35,020 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:17:45,001 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:46,878 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:17:46,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:17:46,983 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:17:47,193 - ispa_next.functions - DEBUG - HU date soon to be invalid in 13 days.
2025-11-17 10:17:54,009 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:17:54,012 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:17:56,829 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:17:56,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:17:57,841 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:17:59,845 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:17:59,976 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:18:03,210 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:18:03,292 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:18:03,293 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:18:14,561 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:18:15,567 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:18:15,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:16,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:26,310 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:18:26,310 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:18:32,582 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:18:32,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:32,652 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:18:32,653 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:18:32,711 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:18:34,001 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:18:34,278 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:18:37,396 - ispa_next.functions - DEBUG - Updated appointment (AG00009925) customer contact data.
2025-11-17 10:18:38,316 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:18:38,319 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:18:39,084 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:18:39,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:18:39,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:18:43,849 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:18:43,850 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:18:43,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:44,394 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:18:46,398 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:18:46,525 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:18:46,660 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:18:46,734 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:18:46,734 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:18:58,127 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:19:58,129 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:20:09,591 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:20:17,404 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:20:17,404 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:20:21,609 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:20:22,616 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:20:22,620 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:20:22,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:22,716 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:20:23,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:23,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:23,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:24,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:24,385 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:20:26,909 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:20:26,911 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:20:27,751 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:20:27,754 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:20:27,755 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:20:27,756 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:20:27,758 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 10:20:27,759 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:20:27,762 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:20:27,772 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:20:27,773 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:20:27,775 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:20:29,553 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:30,079 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:20:30,983 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:31,547 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:32,072 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:20:32,987 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:33,577 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:34,100 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:20:35,415 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:36,452 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:37,389 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:37,817 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:20:37,819 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:20:37,820 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:39,832 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:20:39,835 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:20:39,837 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:41,709 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:20:41,712 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:20:41,712 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:20:42,317 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:20:42,544 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:51,601 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:20:51,602 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:53,501 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:21:04,370 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:21:04,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:21:05,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:21:05,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:23,757 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:27,868 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:27,872 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:21:27,872 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:21:28,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:21:28,645 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:21:28,647 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:21:30,300 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:21:41,402 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:21:41,779 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:21:42,077 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:21:43,682 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 509
2025-11-17 10:21:43,683 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:21:46,381 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 345
2025-11-17 10:21:46,382 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:21:47,099 - ispa_next.main - DEBUG - 



2025-11-17 10:21:47,099 - ispa_next.main - DEBUG - starting with process 2 (ED M 2304) of 13
2025-11-17 10:21:47,106 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:21:47,966 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:21:48,885 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 509
2025-11-17 10:21:48,886 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 345
2025-11-17 10:21:50,104 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:21:50,105 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:22:20,326 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:22:30,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:32,061 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:22:32,062 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:32,131 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:22:32,380 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:22:38,805 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:22:38,809 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:22:41,528 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:22:41,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:22:42,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:22:44,488 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:22:44,608 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:22:47,800 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:22:47,865 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:22:47,865 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:22:59,414 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:23:00,422 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:23:00,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:00,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:04,637 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:23:04,644 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:23:04,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:04,720 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:23:04,721 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:23:04,818 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:23:06,039 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:23:06,282 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:23:09,237 - ispa_next.functions - DEBUG - Updated appointment (AA00022364) customer contact data.
2025-11-17 10:23:10,156 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:23:10,160 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:23:11,031 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:23:11,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:23:11,669 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:23:15,803 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:23:15,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:16,287 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:23:18,290 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:23:18,486 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:23:18,563 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:23:18,652 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:23:18,652 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:23:29,977 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:24:29,979 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:24:40,991 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:24:47,993 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:24:47,993 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:24:52,159 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:24:53,171 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:24:53,176 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:24:53,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:53,260 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:24:57,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:58,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:58,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:58,767 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:24:58,767 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:25:00,651 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:25:00,652 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:25:01,720 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:25:01,721 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:25:01,723 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:25:01,724 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:25:01,725 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:25:01,732 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:25:01,735 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:25:01,747 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:25:01,750 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:25:01,751 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:25:01,756 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:25:01,759 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:25:01,759 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:03,676 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:25:03,679 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:25:03,681 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:05,641 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:25:05,645 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:25:05,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:25:06,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:25:06,680 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:16,036 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:25:16,038 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:17,982 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:25:29,728 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:25:30,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:25:30,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:25:30,937 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:48,812 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:25:53,153 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:25:53,156 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:25:53,156 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:25:53,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:25:53,812 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:25:53,815 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:25:55,748 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:26:03,936 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:26:04,339 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:26:04,613 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:26:06,576 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 509
2025-11-17 10:26:06,578 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:26:09,424 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 345
2025-11-17 10:26:09,424 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:26:10,062 - ispa_next.main - DEBUG - 



2025-11-17 10:26:10,062 - ispa_next.main - DEBUG - starting with process 3 (ED RU 101) of 13
2025-11-17 10:26:10,066 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:26:10,966 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:26:11,834 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 509
2025-11-17 10:26:11,835 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 345
2025-11-17 10:26:12,866 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:26:12,867 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:26:50,019 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:26:59,812 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:27:01,033 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:27:01,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:01,111 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:27:01,342 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:27:01,346 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:27:04,222 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:27:04,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:05,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:27:07,434 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:27:07,533 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:27:10,781 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:27:17,410 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 10:27:18,417 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:27:18,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:18,980 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:21,782 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:27:21,789 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:27:21,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:21,864 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:27:21,865 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:27:21,988 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:27:23,248 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:27:23,466 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:27:26,420 - ispa_next.functions - DEBUG - Updated appointment (AA00022341) customer contact data.
2025-11-17 10:27:27,342 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:27:27,345 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:27:28,094 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:27:28,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:27:28,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:27:32,414 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:27:32,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:32,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:27:34,980 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:27:35,133 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:27:35,247 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:27:35,321 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:27:35,321 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:27:47,153 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:28:47,160 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:28:58,226 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:29:05,402 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:29:05,402 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:29:09,594 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:29:10,603 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:29:10,608 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:29:10,609 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:29:10,673 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:29:15,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:29:15,979 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:29:15,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:29:16,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:29:16,705 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:29:18,090 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:29:18,092 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:29:19,282 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:29:19,284 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:29:19,285 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:29:19,288 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:29:19,292 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:29:19,294 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:29:19,298 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:29:19,304 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:29:19,305 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:29:19,306 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:29:19,310 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:29:19,313 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:29:19,320 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:20,602 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:29:20,605 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:29:20,609 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:21,813 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:29:21,817 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:29:21,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:29:22,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:29:22,782 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:25,489 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:29:25,491 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:26,722 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:29:37,982 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:29:38,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:29:38,984 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:29:39,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:50,779 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:29:50,782 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:29:50,783 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:29:51,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:29:51,371 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:29:51,374 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:29:52,771 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:30:00,149 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:30:00,549 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:30:00,895 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:30:02,682 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 509
2025-11-17 10:30:02,684 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:30:05,256 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 344
2025-11-17 10:30:05,256 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:30:05,897 - ispa_next.main - DEBUG - 



2025-11-17 10:30:05,897 - ispa_next.main - DEBUG - starting with process 4 (ED-MH-171) of 13
2025-11-17 10:30:05,903 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:30:07,028 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:30:07,957 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 509
2025-11-17 10:30:07,958 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 344
2025-11-17 10:30:09,418 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:30:09,419 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:30:37,918 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:30:48,192 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:30:49,416 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:30:49,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:49,500 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:30:49,837 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:30:49,841 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:30:52,688 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:30:52,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:30:53,983 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:30:55,990 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:30:56,095 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:30:59,312 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:30:59,380 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:30:59,380 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:31:10,948 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:31:11,954 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:31:11,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:12,477 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:15,511 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:31:15,523 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:31:15,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:15,625 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:31:15,626 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:31:15,659 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:31:16,881 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:31:17,115 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:31:20,281 - ispa_next.functions - DEBUG - Updated appointment (AA00022296) customer contact data.
2025-11-17 10:31:21,185 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:31:21,188 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:31:21,889 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:31:21,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:31:22,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:31:26,286 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:31:26,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:31:26,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:31:28,875 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:31:28,975 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:31:29,065 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:31:29,127 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:31:29,127 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:31:40,994 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:32:40,997 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:32:53,031 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:33:00,264 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:33:00,265 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:33:04,468 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:33:05,476 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:33:05,481 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:33:05,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:33:05,892 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:33:06,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:06,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:06,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:33:07,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:33:07,628 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:33:08,935 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:33:08,938 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:33:09,995 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:33:09,996 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:33:09,997 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:33:09,999 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:33:10,000 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:33:10,002 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:33:10,002 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:33:10,009 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:33:10,010 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:33:10,018 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:33:10,022 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:33:10,025 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:33:10,026 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:11,235 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:33:11,238 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:33:11,240 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:12,488 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:33:12,491 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:33:12,491 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:33:13,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:33:13,510 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:22,206 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:33:22,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:23,457 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:33:33,975 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:33:34,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:33:35,162 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:33:35,280 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:47,531 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:33:47,534 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:33:47,534 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:33:48,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:33:48,088 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:33:48,091 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:33:49,989 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:33:57,708 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:33:58,086 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:33:58,473 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:34:00,675 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 508
2025-11-17 10:34:00,676 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:34:03,486 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 344
2025-11-17 10:34:03,487 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:34:04,399 - ispa_next.main - DEBUG - 



2025-11-17 10:34:04,399 - ispa_next.main - DEBUG - starting with process 5 (ED-A1024) of 13
2025-11-17 10:34:04,406 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:34:05,561 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:34:07,264 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 508
2025-11-17 10:34:07,265 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 344
2025-11-17 10:34:08,711 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:34:08,713 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:34:48,416 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:34:57,829 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:34:59,064 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:34:59,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:59,139 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:34:59,342 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:35:05,664 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:35:05,668 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:35:08,491 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:35:08,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:35:09,906 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:35:11,914 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:35:12,072 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:35:15,347 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:35:15,474 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:35:15,475 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:35:27,078 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:35:28,083 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:35:28,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:28,601 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:40,049 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:35:47,875 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:35:47,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:47,985 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:35:47,985 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:35:48,030 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:35:49,273 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:35:49,538 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:35:52,437 - ispa_next.functions - DEBUG - Updated appointment (AA00022294) customer contact data.
2025-11-17 10:35:53,649 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:35:53,653 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:35:54,455 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:35:54,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:35:55,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:35:58,972 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:35:58,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:35:59,486 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:36:01,489 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:36:01,640 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:36:01,750 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:36:01,838 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:36:01,838 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:36:13,300 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:37:13,303 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:37:25,193 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:37:49,196 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:38:00,772 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:38:08,516 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:38:09,525 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:38:09,529 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:38:09,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:38:09,636 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:38:10,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:38:10,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:38:10,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:38:11,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:38:11,397 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:38:12,766 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:38:12,768 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:38:13,938 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:38:13,946 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:38:13,949 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:38:13,951 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:38:13,953 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:38:13,955 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:38:13,956 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:38:13,957 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:38:13,958 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:38:13,960 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:38:13,964 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:38:13,967 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:38:13,968 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:15,225 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:38:15,229 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:38:15,232 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:16,470 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:38:16,473 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:38:16,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:38:17,401 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:38:17,436 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:38:17,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:18,661 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:38:28,560 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:38:28,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:38:29,709 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:38:29,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:41,886 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:38:41,889 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:38:41,890 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:38:42,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:38:42,576 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:38:42,579 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:38:44,568 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:38:52,557 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:38:52,927 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:38:53,434 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:38:54,653 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-17 10:38:54,656 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:38:58,156 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-17 10:38:58,157 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:38:59,010 - ispa_next.main - DEBUG - 



2025-11-17 10:38:59,010 - ispa_next.main - DEBUG - starting with process 6 (ED-K2010) of 13
2025-11-17 10:38:59,015 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:00,193 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:01,370 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-17 10:39:01,372 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-17 10:39:02,889 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:02,891 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:39:40,332 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:39:49,068 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:39:51,005 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:39:51,006 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:51,089 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:39:51,333 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:39:57,744 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:39:57,750 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:40:00,664 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:40:00,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:40:02,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:40:04,064 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:40:04,193 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:40:07,460 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:40:15,805 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 10:40:16,812 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:40:16,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:17,296 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:20,894 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:40:20,899 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:40:20,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:20,982 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:40:20,983 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:40:21,061 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:40:22,312 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:40:23,489 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:40:23,751 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:40:27,004 - ispa_next.functions - DEBUG - Updated appointment (AA00022292) customer contact data.
2025-11-17 10:40:27,897 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:40:27,900 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:40:28,840 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:40:28,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:40:29,735 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:40:33,786 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:40:33,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:40:34,298 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:40:36,301 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:40:36,434 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:40:36,564 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:40:36,660 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:40:36,662 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:40:48,813 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:41:48,815 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:42:00,596 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:42:40,598 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:42:51,546 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:42:58,627 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:42:58,628 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:43:02,837 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:43:03,856 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:43:03,860 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:43:03,861 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:43:03,978 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:43:04,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:04,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:04,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:43:05,487 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:43:05,488 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:43:07,423 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:43:07,425 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:43:08,622 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:43:08,625 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:43:08,628 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:43:08,630 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:43:08,633 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:43:08,636 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:43:08,638 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:43:08,639 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:43:08,641 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:43:08,642 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:43:08,648 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:43:08,651 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:43:08,652 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:10,584 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:43:10,587 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:43:10,589 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:12,531 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:43:12,534 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:43:12,534 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:43:13,494 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:43:13,723 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:23,024 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:43:23,026 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:24,976 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:43:35,408 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:43:35,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:43:36,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:43:36,642 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:55,172 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:43:59,476 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:43:59,479 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:43:59,480 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:43:59,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:44:00,058 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:44:00,060 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:44:01,526 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:44:08,496 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:44:08,892 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:44:09,404 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:44:11,155 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 506
2025-11-17 10:44:11,155 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:44:14,268 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-17 10:44:14,269 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:44:15,147 - ispa_next.main - DEBUG - 



2025-11-17 10:44:15,147 - ispa_next.main - DEBUG - starting with process 7 (ED-AL59) of 13
2025-11-17 10:44:15,154 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:44:16,485 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:44:17,895 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 506
2025-11-17 10:44:17,897 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-17 10:44:19,284 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:44:19,286 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:44:59,502 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:45:08,693 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:45:11,333 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:45:11,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:11,406 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:45:11,616 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:45:17,521 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:45:17,524 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:45:20,199 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:45:20,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:45:21,666 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:45:23,668 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:45:23,785 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:45:27,069 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:45:27,209 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:45:27,209 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:45:38,910 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:45:39,917 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:45:39,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:40,429 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:44,235 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:45:44,241 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:45:44,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:44,305 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:45:44,308 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:45:44,400 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:45:44,480 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:45:45,643 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:45:45,923 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:45:49,654 - ispa_next.functions - DEBUG - Updated appointment (AA00022291) customer contact data.
2025-11-17 10:45:50,578 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:45:50,581 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:45:50,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:45:51,455 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:45:52,807 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:45:52,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:45:52,872 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:45:56,883 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:45:56,884 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:45:57,357 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:45:59,363 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:45:59,472 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:45:59,610 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:45:59,699 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:45:59,699 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:46:11,684 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:47:11,686 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:47:23,621 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:47:31,082 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:47:31,082 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:47:35,273 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:47:36,293 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:47:36,300 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:47:36,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:36,410 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:47:36,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:37,291 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:37,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:38,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:47:38,081 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:47:42,305 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:47:42,308 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:47:43,928 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:47:43,930 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:47:43,932 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:47:43,951 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:47:43,953 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:47:43,955 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:47:43,957 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:47:43,959 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:47:43,960 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:47:43,963 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:47:43,976 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:47:43,979 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:47:43,981 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:48,812 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:47:51,445 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:47:51,465 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:47:51,659 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:56,373 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:47:56,376 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:47:56,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:47:57,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:47:57,700 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:06,920 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:48:06,923 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:11,655 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:48:22,872 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:48:23,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:48:23,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:48:24,101 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:49:10,276 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:49:14,953 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:49:19,257 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:49:23,598 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:49:28,670 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:49:34,035 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:49:34,039 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:49:34,040 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:49:34,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:49:34,836 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:49:34,839 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:49:36,797 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:49:45,758 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:49:46,139 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:49:46,752 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:49:48,226 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 505
2025-11-17 10:49:48,228 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:49:51,847 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-17 10:49:51,847 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:49:52,687 - ispa_next.main - DEBUG - 



2025-11-17 10:49:52,688 - ispa_next.main - DEBUG - starting with process 8 (M-ED-2001) of 13
2025-11-17 10:49:52,693 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:49:53,992 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:49:55,365 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 505
2025-11-17 10:49:55,366 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-17 10:49:56,922 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:49:56,924 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:50:35,737 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:50:45,603 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:47,594 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:50:47,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:47,672 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:47,993 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:50:47,997 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:50:50,920 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:50:50,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:52,322 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:50:54,327 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:50:54,470 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:50:57,732 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:50:57,838 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:50:57,838 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:51:09,673 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:51:10,679 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:51:10,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:11,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:14,970 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:51:14,976 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:51:14,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:15,054 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:51:15,055 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:51:15,129 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:51:16,401 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:51:16,669 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:51:20,273 - ispa_next.functions - DEBUG - Updated appointment (AA00022285) customer contact data.
2025-11-17 10:51:21,246 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:51:21,249 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:51:22,120 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:51:22,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:51:23,039 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:51:27,097 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:51:27,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:27,596 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:51:29,599 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:51:29,725 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:51:29,828 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:51:29,948 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:51:29,949 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:51:42,239 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:52:42,242 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:52:53,338 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:53:00,929 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:53:00,929 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:53:05,114 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:53:06,123 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:53:06,128 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:53:06,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:06,195 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:53:06,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:07,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:07,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:07,785 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:53:07,785 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:53:09,731 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:53:09,733 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:53:10,942 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:53:10,945 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:53:10,947 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:53:10,948 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:53:10,949 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:53:10,951 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:53:10,952 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:53:10,953 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:53:10,954 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:53:10,956 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:53:10,960 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:53:10,963 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:53:10,964 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:12,897 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:53:12,904 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:53:12,907 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:14,882 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:53:14,886 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:53:14,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:53:15,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:53:16,142 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:23,210 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:53:23,213 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:25,191 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:53:37,365 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:53:37,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:53:38,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:53:38,643 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:57,086 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:54:01,327 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:54:01,331 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:54:01,331 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:54:01,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:54:01,893 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:54:01,896 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:54:03,485 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:54:10,827 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:54:11,209 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:54:11,756 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:54:13,752 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 505
2025-11-17 10:54:13,753 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:54:16,420 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-17 10:54:16,421 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:54:17,238 - ispa_next.main - DEBUG - 



2025-11-17 10:54:17,238 - ispa_next.main - DEBUG - starting with process 9 (ED N 1926) of 13
2025-11-17 10:54:17,243 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:54:18,287 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:54:19,378 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 505
2025-11-17 10:54:19,380 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-17 10:54:20,946 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:54:20,948 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:55:00,055 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:55:10,382 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:55:12,370 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:55:12,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:12,447 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:12,661 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:55:19,371 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:55:19,375 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:55:22,237 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:55:22,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:55:23,705 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:55:25,708 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:55:25,855 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:55:29,101 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:55:29,181 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:55:29,181 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:55:40,824 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:55:41,828 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:55:41,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:42,354 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:45,194 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:55:45,198 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:55:45,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:45,268 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:45,269 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:55:45,300 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:55:46,483 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:55:47,646 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:55:47,929 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:55:51,384 - ispa_next.functions - DEBUG - Updated appointment (AA00022282) customer contact data.
2025-11-17 10:55:52,404 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:55:52,407 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:55:53,070 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:55:53,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:55:53,985 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:55:57,981 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:55:57,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:55:58,553 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:56:00,556 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:56:00,647 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:56:00,756 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:56:00,865 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:56:00,865 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:56:13,063 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:57:13,067 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:57:24,630 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:58:00,633 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:58:12,118 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:58:19,464 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:58:20,485 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:58:20,489 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:58:20,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:58:20,570 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:58:20,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:58:21,513 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:58:21,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:58:22,264 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:58:22,265 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:58:24,548 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:58:24,549 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:58:25,586 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:58:25,588 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:58:25,590 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:58:25,592 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:58:25,594 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:58:25,596 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:58:25,598 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:58:25,599 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:58:25,600 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:58:25,601 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:58:25,605 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:58:25,608 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:58:25,608 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:27,498 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:58:27,504 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:58:27,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:29,457 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:58:29,461 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:58:29,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:58:30,450 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:58:30,487 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:58:30,489 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:32,428 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:58:43,375 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:58:43,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:58:44,340 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:58:44,460 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:59:03,014 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:59:07,846 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:59:07,849 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:59:07,850 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:59:08,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:59:08,589 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:59:08,592 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:59:10,444 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:59:18,441 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:59:18,854 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:59:19,406 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:59:20,779 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-17 10:59:20,781 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:59:24,056 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 344
2025-11-17 10:59:24,057 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:59:24,763 - ispa_next.main - DEBUG - 



2025-11-17 10:59:24,763 - ispa_next.main - DEBUG - starting with process 10 (ED SN 4108) of 13
2025-11-17 10:59:24,768 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:59:25,721 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:59:27,102 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-17 10:59:27,103 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 344
2025-11-17 10:59:28,725 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:59:28,728 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:59:59,292 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:00:13,674 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:00:14,993 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:00:14,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:00:15,075 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:00:15,387 - ispa_next.functions - DEBUG - HU date already expired after 388 days.
2025-11-17 11:00:22,423 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:00:22,427 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:00:25,209 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:00:25,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:00:26,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:00:28,792 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:00:28,893 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:00:32,184 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:00:40,444 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 11:00:41,452 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:00:41,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:00:41,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:00:57,756 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:01:05,920 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:01:05,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:01:05,988 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:01:05,989 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:01:06,035 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:01:07,294 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:01:07,564 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:01:11,186 - ispa_next.functions - DEBUG - Updated appointment (AA00022280) customer contact data.
2025-11-17 11:01:12,077 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:01:12,233 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:01:13,397 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:01:13,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:01:14,347 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:01:17,928 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:01:17,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:01:18,552 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:01:20,557 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:01:20,649 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:01:20,768 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:01:20,851 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:01:20,852 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:01:32,356 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:02:32,358 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:02:45,487 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:02:52,837 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:02:52,837 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:02:57,079 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:02:58,099 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:02:58,103 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:02:58,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:02:58,184 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:02:58,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:02:59,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:02:59,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:02:59,754 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:02:59,755 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:03:01,054 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:03:01,056 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:03:02,113 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:03:02,115 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:03:02,117 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:03:02,118 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:03:02,121 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:03:02,130 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:03:02,133 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:03:02,136 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:03:02,139 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:03:02,142 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:03:02,146 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:03:02,150 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:03:02,152 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:03,368 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:03:03,371 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:03:03,376 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:04,643 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:03:04,645 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:03:04,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:03:05,615 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:03:05,859 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:12,858 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:03:12,861 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:14,263 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:03:25,172 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:03:25,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:03:26,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:03:26,406 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:38,473 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:03:38,476 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:03:38,477 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:03:39,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:03:39,232 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:03:39,234 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:03:41,063 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:03:49,270 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:03:49,664 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 11:03:50,353 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:03:51,914 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-17 11:03:51,916 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:03:55,467 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 344
2025-11-17 11:03:55,468 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:03:56,353 - ispa_next.main - DEBUG - 



2025-11-17 11:03:56,353 - ispa_next.main - DEBUG - starting with process 11 (M-M6325) of 13
2025-11-17 11:03:56,359 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:03:57,817 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:03:59,167 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-17 11:03:59,168 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 344
2025-11-17 11:04:01,094 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:04:01,095 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:04:47,461 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:04:57,291 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:59,985 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:04:59,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:05:00,062 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:05:00,274 - ispa_next.functions - DEBUG - HU date already expired after 25 days.
2025-11-17 11:05:07,305 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:05:07,309 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:05:10,220 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:05:10,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:05:11,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:05:13,937 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:05:14,089 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:05:17,314 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:05:17,389 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:05:17,389 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:05:29,620 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:05:30,626 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:05:30,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:05:31,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:05:35,032 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 11:05:35,038 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:05:35,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:05:35,129 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:05:35,130 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:05:35,221 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:05:36,447 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:05:36,719 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:05:41,175 - ispa_next.functions - DEBUG - Updated appointment (AA00022279) customer contact data.
2025-11-17 11:05:42,202 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:05:42,207 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:05:42,861 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:05:42,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:05:43,884 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:05:47,958 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:05:47,959 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:05:47,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:05:48,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:05:50,439 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:05:50,609 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:05:50,784 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:05:50,883 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:05:50,884 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:06:03,226 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:07:03,229 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:07:14,594 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:07:21,721 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:07:21,721 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:07:25,889 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:07:26,929 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:07:26,933 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:07:26,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:07:27,035 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:07:27,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:28,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:28,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:07:28,730 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:07:28,731 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:07:31,316 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:07:31,319 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:07:32,707 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:07:32,712 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:07:32,714 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:07:32,717 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:07:32,726 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:07:32,728 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:07:32,729 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:07:32,732 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:07:32,733 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:07:32,735 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:07:32,753 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:07:32,757 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:07:32,758 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:07:35,474 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:07:35,477 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:07:35,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:07:38,151 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:07:38,156 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:07:38,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:07:39,226 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:07:39,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:07:44,886 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:07:44,887 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:07:47,616 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:07:59,513 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:07:59,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:08:00,626 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:08:00,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:08:26,798 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:08:31,221 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:08:35,830 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:08:35,832 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:08:35,833 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:08:36,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:08:36,400 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:08:36,403 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:08:38,189 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:08:47,535 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:08:47,913 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 11:08:48,567 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:08:50,256 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-17 11:08:50,258 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:08:53,595 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 344
2025-11-17 11:08:53,596 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:08:54,355 - ispa_next.main - DEBUG - 



2025-11-17 11:08:54,355 - ispa_next.main - DEBUG - starting with process 12 (ED-BT 235) of 13
2025-11-17 11:08:54,360 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:08:55,463 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:08:57,527 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 507
2025-11-17 11:08:57,528 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 344
2025-11-17 11:08:59,128 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:08:59,130 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:09:34,297 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:09:45,211 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:09:49,398 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:09:49,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:49,473 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:09:49,689 - ispa_next.functions - DEBUG - HU date soon to be invalid in 67 days.
2025-11-17 11:09:57,211 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:09:57,215 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:10:00,059 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:10:00,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:10:01,458 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:10:03,461 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:10:03,600 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:10:06,886 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:10:14,584 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 11:10:15,592 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:10:15,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:10:16,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:10:29,489 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:10:38,295 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:10:38,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:10:38,376 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:10:38,377 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:10:38,419 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:10:38,556 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:10:39,727 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 11:10:40,977 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 11:10:41,339 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:10:45,579 - ispa_next.functions - DEBUG - Updated appointment (AC00018757) customer contact data.
2025-11-17 11:10:46,542 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:10:46,547 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:10:47,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:10:48,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:10:50,743 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:10:50,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:10:50,819 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:10:55,348 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:10:55,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:10:56,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:10:58,380 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:10:58,516 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:10:58,653 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:10:58,769 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:10:58,769 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:11:10,652 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:12:10,655 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:12:22,016 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 11:12:29,770 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:12:29,771 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:12:33,982 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:12:34,990 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:12:34,996 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:12:34,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:12:35,095 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:12:48,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:12:49,341 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:12:49,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:12:50,035 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:12:50,036 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:12:55,110 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:12:55,115 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:12:56,698 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:12:56,699 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:12:56,701 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:12:56,706 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:12:56,710 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:12:56,717 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:12:56,719 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:12:56,724 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:12:56,728 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:12:56,732 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:12:56,737 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:12:56,745 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:12:56,746 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:13:02,570 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:13:05,268 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:13:05,277 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:13:05,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:13:10,903 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:13:10,906 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:13:10,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:13:11,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:13:11,824 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:13:18,121 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:13:18,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:13:23,771 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:13:34,943 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:13:35,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:13:36,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:13:36,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:14:29,884 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:14:34,668 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:14:39,691 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:14:44,999 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:14:49,687 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:14:54,682 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:15:00,524 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:15:00,528 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:15:00,529 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:15:01,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:15:01,343 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:15:01,346 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:15:03,528 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:15:11,991 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:15:12,386 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 11:15:13,082 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:15:15,002 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 509
2025-11-17 11:15:15,003 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:15:18,091 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 345
2025-11-17 11:15:18,091 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:15:18,830 - ispa_next.main - DEBUG - 



2025-11-17 11:15:18,830 - ispa_next.main - DEBUG - starting with process 13 (F-SF 148 E) of 13
2025-11-17 11:15:18,837 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:15:19,875 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:15:20,786 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 509
2025-11-17 11:15:20,787 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 345
2025-11-17 11:15:22,377 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:15:22,378 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:16:04,872 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:16:14,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:19,680 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:16:19,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:19,780 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:16:20,003 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:16:20,007 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:16:22,983 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:16:22,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:16:24,614 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:16:26,620 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:16:26,746 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:16:29,992 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:16:30,074 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:16:30,074 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:16:41,784 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:16:42,789 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:16:42,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:43,302 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:58,257 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:17:07,225 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:17:07,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:07,290 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:17:07,291 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:17:07,348 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:17:08,628 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:17:09,855 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:17:10,064 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:17:14,380 - ispa_next.functions - DEBUG - Updated appointment (AB00024001) customer contact data.
2025-11-17 11:17:15,527 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:17:15,529 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:17:16,180 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:17:16,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:17:17,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:17:21,157 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:17:21,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:17:21,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:17:23,679 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:17:23,821 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:17:23,948 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:17:24,030 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:17:24,030 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:17:35,313 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:17:42,768 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:17:42,768 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:17:46,977 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:17:47,987 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:17:47,992 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:17:47,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:17:48,059 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:17:58,226 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 11:18:10,032 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 11:18:10,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:11,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:11,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:18:11,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:18:11,943 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:18:16,931 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:18:16,933 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:18:18,066 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:18:18,067 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:18:18,069 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 11:18:18,070 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:18:18,072 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:18:18,073 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:18:18,074 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:18:18,075 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:18:18,079 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:18:18,082 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:18:18,089 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:18:41,109 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:18:41,284 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 11:18:48,256 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:18:48,259 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:18:48,260 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:18:55,218 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:18:58,212 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:18:58,216 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:18:58,503 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:04,912 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:19:04,915 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:19:04,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:19:05,983 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:19:06,235 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:21,500 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:19:21,503 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:27,885 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:19:39,034 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:19:39,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:19:40,293 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:19:40,490 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:40,874 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:46,230 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:51,461 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:57,015 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:02,787 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:07,438 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:11,825 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:17,469 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:17,472 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:21:17,473 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:21:18,258 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:21:18,385 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:21:18,390 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:21:20,076 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:21:28,628 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:21:29,030 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 11:21:29,816 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:21:31,427 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 509
2025-11-17 11:21:31,429 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:21:34,976 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 345
2025-11-17 11:21:34,977 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
