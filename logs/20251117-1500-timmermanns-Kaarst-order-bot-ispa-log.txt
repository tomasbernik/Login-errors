2025-11-17 15:14:34,460 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 15:14:34,468 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 15:14:44,541 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 15:14:55,014 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 15:15:10,968 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:15:35,418 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 15:15:47,127 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 15:15:49,691 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:15:50,496 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 361
2025-11-17 15:15:50,497 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 75
2025-11-17 15:15:52,521 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 69
2025-11-17 15:15:52,521 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 15:15:52,522 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:15:53,485 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:15:54,545 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:16:04,028 - ispa_next.appointments.models - DEBUG - Appointment Faktor 4 Architekten, HEG NE-UH 865 WMWZH71070TY03391 ohne Termin.
2025-11-17 15:16:04,031 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:16:04,045 - ispa_next.appointments.models - DEBUG - Appointment Armaturen Vertrieb Alms GmbH ME-AA 340E WBY71AW020FT62013 ohne Termin.
2025-11-17 15:16:04,051 - ispa_next.appointments.models - DEBUG - Appointment   WBA11FZ090FR60998 ohne Termin.
2025-11-17 15:16:04,058 - ispa_next.appointments.models - DEBUG - Appointment Bianca Prins VIE-PE 881 WBA11AW010FL84234 ohne Termin.
2025-11-17 15:16:04,064 - ispa_next.appointments.models - DEBUG - Appointment Oliver Berndsen NE-JO 288E WBY31FK070CR63503 ohne Termin.
2025-11-17 15:16:04,070 - ispa_next.main - DEBUG - Found 6 out of 9 appointments to process (configured limit: 15).
2025-11-17 15:16:04,070 - ispa_next.main - DEBUG - Processing 6 fresh appointments.
2025-11-17 15:16:04,070 - ispa_next.main - DEBUG - All appointments: NE-FR 76, NE-MT 951, ES CH 403, GV-HS 23, NE-WK 1959, NE-RK 63
2025-11-17 15:16:04,072 - ispa_next.main - DEBUG - 



2025-11-17 15:16:04,072 - ispa_next.main - DEBUG - starting with process 1 (NE-FR 76) of 6
2025-11-17 15:16:04,074 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:16:04,990 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:16:06,086 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 361
2025-11-17 15:16:06,096 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 69
2025-11-17 15:16:07,450 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:16:07,451 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:16:49,356 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:16:58,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:58,531 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:16:58,746 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:17:02,014 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:17:02,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:02,140 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:02,320 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:17:02,322 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:17:05,074 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:17:05,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:17:06,019 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:17:08,025 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:17:08,204 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:17:11,488 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:17:11,567 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:17:11,569 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:17:14,937 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:17:26,212 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:17:27,216 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:17:27,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:27,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:40,816 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:17:47,991 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:17:47,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:48,056 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:48,065 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:17:48,138 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:17:49,315 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:17:49,549 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:17:52,871 - ispa_next.functions - DEBUG - Updated appointment (AA00025094) customer contact data.
2025-11-17 15:17:53,793 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:17:53,795 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:17:54,751 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:17:54,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:17:55,487 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:17:59,076 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:17:59,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:17:59,602 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:18:01,630 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:18:01,734 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:18:01,825 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:18:01,944 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:18:01,946 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:18:05,274 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:18:16,721 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:19:16,724 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:19:28,199 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:19:35,551 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:19:35,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:38,887 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:19:41,042 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:19:42,060 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:19:42,064 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:19:42,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:42,238 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:19:42,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:19:43,154 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:19:43,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:44,061 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:19:44,062 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:19:47,128 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:19:47,130 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:19:47,934 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:19:47,935 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:19:47,937 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 15:19:47,938 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:19:47,939 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:19:47,941 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:19:47,942 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:19:47,943 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:19:47,944 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:19:47,945 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:19:47,946 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:19:47,952 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:19:47,953 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:19:47,953 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:51,194 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 15:19:53,873 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:19:53,874 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:19:53,877 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:57,180 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:19:57,181 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:19:57,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:19:57,973 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:19:58,202 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:06,530 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:20:06,532 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:09,828 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:20:21,511 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:20:22,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:22,525 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:20:22,662 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:41,878 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:20:41,879 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:20:42,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:42,411 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:20:42,412 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:20:45,806 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:20:55,382 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:20:55,795 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 15:20:56,192 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:20:56,987 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 361
2025-11-17 15:20:56,988 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:20:59,708 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 75
2025-11-17 15:20:59,709 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:21:00,729 - ispa_next.appointments.models - DEBUG - Appointment Simone Dorth KK-D 66 WBA15BZ040N140864 ohne Termin.
2025-11-17 15:21:00,733 - ispa_next.main - DEBUG - Found new Appointment: NE-AB 534E
2025-11-17 15:21:00,737 - ispa_next.main - DEBUG - 



2025-11-17 15:21:00,738 - ispa_next.main - DEBUG - starting with process 2 (NE-AB 534E) of 7
2025-11-17 15:21:00,742 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:21:02,256 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:21:03,449 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 361
2025-11-17 15:21:03,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 75
2025-11-17 15:21:04,821 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:21:04,835 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:21:41,260 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:21:51,571 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:21:54,789 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:21:54,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:21:54,870 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:21:55,149 - ispa_next.functions - DEBUG - HU date already expired after 21 days.
2025-11-17 15:22:02,454 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:22:02,456 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:22:05,224 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:22:05,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:22:06,264 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:22:08,271 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:22:08,440 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:22:11,677 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:22:11,784 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:22:11,785 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:22:15,187 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:22:26,563 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:22:27,567 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:22:27,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:28,062 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:40,591 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:22:48,410 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:22:48,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:48,481 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:22:48,484 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:22:48,554 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:22:49,971 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:22:51,205 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:22:51,442 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:22:53,775 - ispa_next.functions - DEBUG - Updated appointment (AE00003748) customer contact data.
2025-11-17 15:22:54,719 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:22:54,720 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:22:55,373 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:22:55,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:22:56,046 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:22:59,636 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:22:59,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:23:00,160 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:23:02,165 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:23:02,283 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:23:02,380 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:23:02,470 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:23:02,471 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:23:05,995 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:23:17,537 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:24:17,541 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:24:28,195 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:24:35,673 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:24:35,675 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:24:39,693 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:24:43,884 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:24:44,909 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:24:44,924 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:24:44,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:45,008 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:24:45,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:45,929 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:45,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:46,661 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:24:46,662 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:24:50,322 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:24:50,332 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:24:51,379 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:24:51,381 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:24:51,382 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 15:24:51,384 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:24:51,386 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:24:51,392 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 15:24:51,395 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:24:51,399 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:24:51,400 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:24:51,402 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:24:51,404 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 15:24:53,838 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:24:54,368 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:24:55,322 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:24:55,872 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:24:56,412 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:24:57,332 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:24:57,932 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:24:58,453 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:24:59,361 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:24:59,943 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:25:00,474 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:25:01,385 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:25:01,942 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:25:02,466 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:25:03,799 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:25:04,911 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:25:05,857 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:25:06,298 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:25:06,328 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:25:06,332 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:09,596 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 15:25:11,954 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:25:11,955 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:25:11,957 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:15,227 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:25:15,229 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:25:15,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:25:15,964 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:25:16,189 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:26,717 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:25:26,721 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:30,054 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:25:41,972 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:25:42,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:25:42,998 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:25:43,112 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:26:02,539 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:26:02,541 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:03,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:26:03,363 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:26:03,365 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:26:07,348 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:26:24,271 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 15:26:24,272 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:26:24,273 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:27,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:26:27,446 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:26:27,448 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:26:29,935 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 15:26:29,966 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:26:32,740 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 15:26:32,743 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:26:33,260 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 362
2025-11-17 15:26:33,261 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-17 15:26:36,124 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 76
2025-11-17 15:26:36,125 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:26:37,086 - ispa_next.appointments.models - DEBUG - Appointment Simone Dorth KK-D 66 WBA15BZ040N140864 ohne Termin.
2025-11-17 15:26:37,091 - ispa_next.main - DEBUG - 



2025-11-17 15:26:37,091 - ispa_next.main - DEBUG - starting with process 3 (NE-MT 951) of 7
2025-11-17 15:26:37,095 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:38,297 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:26:39,540 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 362
2025-11-17 15:26:39,541 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 76
2025-11-17 15:26:40,911 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:26:40,913 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:27:07,310 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:27:17,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:27:17,901 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:27:18,088 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:27:19,975 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:27:19,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:27:20,054 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:27:20,405 - ispa_next.functions - DEBUG - HU date already expired after 57 days.
2025-11-17 15:27:27,576 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:27:27,578 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:27:30,345 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:27:30,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:27:31,318 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:27:33,347 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:27:39,369 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 15:27:47,140 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 15:27:48,144 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:27:48,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:27:48,656 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:28:02,530 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:28:09,918 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:28:09,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:28:10,006 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:28:10,008 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:28:10,069 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:28:10,204 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:28:11,538 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 15:28:12,810 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:28:13,053 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:28:16,062 - ispa_next.functions - DEBUG - Updated appointment (AA00025092) customer contact data.
2025-11-17 15:28:17,010 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:28:17,011 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:28:17,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:28:18,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:28:19,435 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:28:19,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:28:19,524 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:28:23,570 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 15:28:23,570 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:28:23,570 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:28:23,573 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:28:23,576 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:28:23,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:28:24,058 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:28:24,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:28:24,965 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:28:24,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:28:25,732 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:28:25,732 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:28:28,257 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:28:28,263 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:28:29,186 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:28:29,188 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:28:29,190 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 15:28:29,191 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:28:29,192 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:28:29,195 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:28:29,199 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:28:29,201 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:28:29,206 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:28:29,211 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:28:29,213 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:28:29,215 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:28:29,216 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:28:29,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:28:31,840 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:28:31,841 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:28:31,844 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:28:34,460 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:28:34,461 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:28:34,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:28:35,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:28:35,160 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:28:35,162 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:28:37,736 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:28:49,862 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:28:50,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:28:50,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:28:50,992 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:29:18,101 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:29:22,626 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:29:26,935 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:29:26,937 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:29:26,938 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:29:27,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:29:27,770 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:29:27,770 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:29:29,708 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:29:38,587 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:29:38,972 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 15:29:39,269 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:29:40,270 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 362
2025-11-17 15:29:40,272 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:29:43,302 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 76
2025-11-17 15:29:43,303 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:29:44,164 - ispa_next.appointments.models - DEBUG - Appointment Simone Dorth KK-D 66 WBA15BZ040N140864 ohne Termin.
2025-11-17 15:29:44,167 - ispa_next.main - DEBUG - 



2025-11-17 15:29:44,167 - ispa_next.main - DEBUG - starting with process 4 (ES CH 403) of 7
2025-11-17 15:29:44,170 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:29:45,388 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:29:46,708 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 362
2025-11-17 15:29:46,709 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 76
2025-11-17 15:29:48,147 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:29:48,149 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:30:20,218 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:30:31,115 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:30:37,836 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:30:37,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:30:37,926 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:30:38,292 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:30:38,294 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:30:41,261 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:30:41,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:30:42,597 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:30:44,600 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:30:44,719 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:30:47,941 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:30:48,004 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:30:48,005 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:30:54,693 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:31:06,186 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:31:07,192 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:31:07,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:31:07,708 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:31:22,794 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:31:31,186 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:31:31,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:31:31,261 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:31:31,262 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:31:31,339 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:31:32,588 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:31:32,799 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:31:35,022 - ispa_next.functions - DEBUG - Updated appointment (AB00014578) customer contact data.
2025-11-17 15:31:35,932 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:31:35,934 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:31:36,947 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:31:36,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:31:37,794 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:31:42,408 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:31:42,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:31:42,953 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:31:44,955 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:31:45,059 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:31:45,239 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:31:45,315 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:31:45,316 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:31:52,163 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:32:03,176 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:32:10,421 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:32:10,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:32:17,269 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:32:21,440 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:32:22,454 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:32:22,458 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:32:22,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:32:22,582 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:32:28,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:32:28,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:32:28,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:32:29,425 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:32:29,426 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:32:35,375 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:32:35,376 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:32:36,788 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:32:36,793 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:32:36,796 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 15:32:36,797 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:32:36,799 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:32:36,800 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:32:36,802 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:32:36,803 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:32:36,805 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:32:36,806 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:32:36,807 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:32:36,810 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:32:36,811 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:32:36,811 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:32:43,511 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:32:43,512 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:32:43,521 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:32:50,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:32:50,270 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:33:02,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:33:24,510 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:33:24,512 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:33:24,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:33:25,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:33:25,604 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:33:40,310 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:33:40,312 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:33:46,976 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:33:59,687 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:34:00,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:34:00,727 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:34:00,907 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:34:23,210 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:34:23,211 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:34:23,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:34:23,821 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:34:23,822 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:34:27,403 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:34:34,642 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:34:35,023 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 15:34:35,879 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:34:36,440 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 362
2025-11-17 15:34:36,441 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:34:39,736 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 75
2025-11-17 15:34:39,737 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:34:40,663 - ispa_next.appointments.models - DEBUG - Appointment Simone Dorth KK-D 66 WBA15BZ040N140864 ohne Termin.
2025-11-17 15:34:40,670 - ispa_next.main - DEBUG - 



2025-11-17 15:34:40,670 - ispa_next.main - DEBUG - starting with process 5 (GV-HS 23) of 7
2025-11-17 15:34:40,673 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:34:41,918 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:34:43,129 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 362
2025-11-17 15:34:43,130 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 75
2025-11-17 15:34:44,607 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:34:44,609 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:35:15,755 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:35:26,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:26,769 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:35:27,013 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:35:28,952 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:35:28,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:29,032 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:35:29,295 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:35:29,297 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:35:32,323 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:35:32,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:35:33,401 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:35:35,408 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:35:35,543 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:35:38,746 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:35:38,815 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:35:38,816 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:35:40,796 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:35:52,262 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:35:53,268 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:35:53,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:53,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:36:08,515 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:36:16,569 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:36:16,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:36:16,652 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:36:16,653 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:36:16,716 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:36:18,024 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:36:18,237 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:36:21,123 - ispa_next.functions - DEBUG - Updated appointment (AA00025081) customer contact data.
2025-11-17 15:36:22,007 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:36:22,008 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:36:22,746 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:36:22,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:36:23,483 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:36:27,159 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:36:27,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:36:27,736 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:36:29,742 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:36:29,852 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:36:29,967 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:36:30,042 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:36:30,044 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:32,037 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:36:43,450 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:37:43,453 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:37:54,296 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:38:01,494 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:38:01,495 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:38:03,562 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:38:07,782 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:38:08,801 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:38:08,804 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:38:08,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:38:08,903 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:38:15,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:38:16,125 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:38:16,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:38:16,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:38:16,832 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:38:18,708 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:38:18,710 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:38:19,811 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:38:19,812 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:38:19,819 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 15:38:19,822 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:38:19,825 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:38:19,829 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:38:19,830 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:38:19,832 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:38:19,833 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:38:19,835 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:38:19,837 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:38:19,839 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:38:19,840 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:38:19,841 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:38:21,740 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:38:21,741 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:38:21,743 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:38:23,637 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:38:23,638 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:38:23,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:38:24,508 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:38:24,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:38:33,148 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:38:33,150 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:38:35,049 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:38:46,966 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:38:47,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:38:48,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:38:48,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:39:07,116 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:39:11,311 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:39:11,313 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:39:11,314 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:39:11,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:39:11,905 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:39:11,906 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:39:13,551 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:39:21,333 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:39:21,709 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 15:39:22,351 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:39:23,074 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 362
2025-11-17 15:39:23,075 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:39:26,468 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 73
2025-11-17 15:39:26,469 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:39:27,633 - ispa_next.appointments.models - DEBUG - Appointment Simone Dorth KK-D 66 WBA15BZ040N140864 ohne Termin.
2025-11-17 15:39:27,636 - ispa_next.main - DEBUG - 



2025-11-17 15:39:27,636 - ispa_next.main - DEBUG - starting with process 6 (NE-WK 1959) of 7
2025-11-17 15:39:27,639 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:39:28,810 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:39:30,166 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 362
2025-11-17 15:39:30,167 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 73
2025-11-17 15:39:31,658 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:39:31,659 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:40:01,364 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:40:12,277 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:40:16,838 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:40:16,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:40:16,945 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:40:17,177 - ispa_next.functions - DEBUG - HU date already expired after 377 days.
2025-11-17 15:40:23,692 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:40:23,695 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:40:26,528 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:40:26,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:40:27,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:40:29,642 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:40:29,780 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:40:32,979 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:40:33,092 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:40:33,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:40:37,762 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:40:49,529 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:40:50,534 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:40:50,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:40:51,017 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:41:03,167 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:41:03,167 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:41:11,145 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:41:11,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:41:11,234 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:41:11,235 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:41:11,330 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:41:12,650 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:41:12,861 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:41:15,232 - ispa_next.functions - DEBUG - Updated appointment (AA00025067) customer contact data.
2025-11-17 15:41:16,151 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:41:16,152 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:41:17,009 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:41:17,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:41:17,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:41:21,377 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:41:21,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:41:21,860 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:41:23,863 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:41:23,997 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:41:24,104 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:41:24,202 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:41:24,203 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:41:28,870 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:41:40,456 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:42:40,460 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:42:51,624 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:43:01,626 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:43:13,078 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 15:43:21,433 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 15:43:22,440 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:43:22,443 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:43:22,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:43:22,552 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:43:22,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:43:23,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:43:23,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:43:24,320 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:43:24,321 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:43:28,494 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:43:28,496 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:43:29,573 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:43:29,576 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:43:29,578 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 15:43:29,579 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:43:29,580 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:43:29,582 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:43:29,583 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:43:29,584 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:43:29,586 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:43:29,587 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:43:29,589 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:43:29,591 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:43:29,592 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:43:29,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:43:34,213 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:43:34,215 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:43:34,216 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:43:38,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:43:38,978 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:43:50,541 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:43:50,542 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:43:50,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:43:51,255 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:43:51,308 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:43:51,310 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:43:55,927 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:44:06,751 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:44:07,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:44:07,705 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:44:07,898 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:44:53,471 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:44:58,378 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:45:03,247 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:45:08,027 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:45:13,006 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:45:18,284 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:45:24,880 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:45:24,882 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:45:25,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:45:25,632 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:45:25,634 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:45:28,894 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:45:36,359 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:45:36,781 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 15:45:37,969 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:45:38,546 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 362
2025-11-17 15:45:38,547 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:45:41,495 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 72
2025-11-17 15:45:41,496 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:45:42,412 - ispa_next.appointments.models - DEBUG - Appointment Simone Dorth KK-D 66 WBA15BZ040N140864 ohne Termin.
2025-11-17 15:45:42,414 - ispa_next.main - DEBUG - 



2025-11-17 15:45:42,414 - ispa_next.main - DEBUG - starting with process 7 (NE-RK 63) of 7
2025-11-17 15:45:42,417 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:45:43,329 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:45:44,365 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 362
2025-11-17 15:45:44,367 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 72
2025-11-17 15:45:45,709 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:45:45,710 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:46:12,045 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:46:22,032 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:46:23,946 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:46:23,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:46:24,026 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:46:24,209 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:46:24,211 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:46:27,211 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:46:27,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:46:27,455 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 15:46:28,209 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 15:46:28,226 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:46:28,227 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:46:29,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:46:29,694 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:46:29,694 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 15:46:29,717 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:46:32,353 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 15:46:32,356 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:46:32,957 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 362
2025-11-17 15:46:32,958 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:46:36,049 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 72
2025-11-17 15:46:36,050 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:46:36,919 - ispa_next.appointments.models - DEBUG - Appointment Simone Dorth KK-D 66 WBA15BZ040N140864 ohne Termin.
