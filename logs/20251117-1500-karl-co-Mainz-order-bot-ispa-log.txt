2025-11-17 15:00:39,508 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 15:00:39,514 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 15:00:52,462 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 15:01:03,050 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 15:01:18,659 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:03:17,368 - ispa_next.app_start.main - DEBUG - Operation already took 107.34 seconds (more than 80 seconds)
2025-11-17 15:03:19,453 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\fe53140834d931ea\\tess_9qr1mjjn_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\fe53140834d931ea\\tess_9qr1mjjn', 'txt']
2025-11-17 15:03:19,751 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 15:03:19,756 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 15:03:19,757 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:03:48,034 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 15:04:00,233 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 15:04:03,793 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:04:04,998 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1545
2025-11-17 15:04:05,000 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 350
2025-11-17 15:04:07,789 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 115
2025-11-17 15:04:07,790 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 15:04:07,791 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:04:08,741 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:04:09,787 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:04:26,855 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:04:26,886 - ispa_next.appointments.models - DEBUG - Appointment Firma Favorite Parkhotel GmbH MZ-FP 420 WBA11DT0909S93216 ohne Termin.
2025-11-17 15:04:26,905 - ispa_next.appointments.models - DEBUG - Appointment Firma HagMaler GmbH MZ-L 6612 WBAJT31010BJ17485 ohne Termin.
2025-11-17 15:04:26,911 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:04:26,932 - ispa_next.appointments.models - DEBUG - Appointment Hatidzhe Dhevdzhet Chaylyak GG-HI 889 WBAVJ11040LF60481 ohne Termin.
2025-11-17 15:04:26,945 - ispa_next.appointments.models - DEBUG - Appointment Ulas Korkmaz  WBAJM710X0B068176 ohne Termin.
2025-11-17 15:04:26,954 - ispa_next.appointments.models - DEBUG - Appointment Florian Goertz RPL 11-3 WBA2D310505C65769 ohne Termin.
2025-11-17 15:04:26,985 - ispa_next.main - DEBUG - Found 10 out of 57 appointments to process (configured limit: 15).
2025-11-17 15:04:26,985 - ispa_next.main - DEBUG - Processing 10 fresh appointments.
2025-11-17 15:04:26,985 - ispa_next.main - DEBUG - All appointments: WT-BO 1821, MZ-NP 777, B MW 3483 E, WI JF 719, WI FI 246, 0, MZ - AW 77E, KI-KI 0815, 0, KI-KI 0815
2025-11-17 15:04:26,988 - ispa_next.main - DEBUG - 



2025-11-17 15:04:26,988 - ispa_next.main - DEBUG - starting with process 1 (WT-BO 1821) of 10
2025-11-17 15:04:27,006 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:04:28,473 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:04:29,947 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1545
2025-11-17 15:04:29,949 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 115
2025-11-17 15:04:31,654 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:04:31,656 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:05:03,859 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:05:13,922 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:15,139 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:05:15,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:05:15,260 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:05:15,527 - ispa_next.functions - DEBUG - HU date already expired after 928 days.
2025-11-17 15:05:22,696 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:05:22,699 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:05:25,510 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:05:25,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:05:26,757 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:05:28,760 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:05:28,897 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:05:29,019 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:05:29,109 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:05:29,111 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:30,444 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:05:41,976 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:05:49,458 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:05:49,460 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:50,726 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:05:54,921 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:05:55,925 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:05:55,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:05:56,404 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:06:08,916 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:06:17,292 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:06:17,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:06:17,453 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:06:17,454 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:06:17,499 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:06:18,821 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:06:19,106 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:06:24,770 - ispa_next.functions - DEBUG - Updated appointment (AE00049907) customer contact data.
2025-11-17 15:06:25,674 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:06:25,677 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:06:26,739 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:06:26,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:06:27,490 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:06:31,582 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 15:06:31,582 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:06:31,582 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:06:31,586 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:06:31,587 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:06:31,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:06:32,120 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:06:36,358 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:06:36,363 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:06:36,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:06:36,438 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:06:40,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:06:41,177 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:06:41,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:06:41,886 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:06:41,887 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:06:43,268 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:06:43,271 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:06:44,382 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:06:44,384 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:06:44,386 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 15:06:44,391 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 15:06:44,394 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:06:44,415 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:06:44,417 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:06:44,418 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:06:44,421 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:06:44,423 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:06:44,437 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:06:44,442 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:06:45,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:06:45,825 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:06:59,694 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:06:59,696 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:06:59,697 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:06:59,698 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:01,669 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:07:01,671 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:07:01,672 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:07:01,673 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:07:01,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:07:02,126 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:07:02,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:11,504 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:07:11,505 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:13,423 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:07:25,649 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:07:26,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:07:26,727 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:07:26,919 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:45,792 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:07:50,498 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:07:50,500 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:07:50,501 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:07:51,128 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:07:51,225 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:07:51,226 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:07:53,123 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:08:06,770 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:08:07,162 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 15:08:08,231 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:08:09,504 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1545
2025-11-17 15:08:09,505 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:08:12,609 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 351
2025-11-17 15:08:12,609 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:08:13,508 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:08:13,515 - ispa_next.main - DEBUG - Found new Appointment: MZTO89E
2025-11-17 15:08:13,517 - ispa_next.main - DEBUG - 



2025-11-17 15:08:13,517 - ispa_next.main - DEBUG - starting with process 2 (MZTO89E) of 11
2025-11-17 15:08:13,521 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:08:14,994 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:08:16,118 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1545
2025-11-17 15:08:16,120 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 351
2025-11-17 15:08:17,752 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:08:17,754 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:08:48,693 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:08:59,667 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:09:02,901 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:09:02,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:09:03,001 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:09:03,149 - ispa_next.functions - DEBUG - HU date soon to be invalid in 29 days.
2025-11-17 15:09:10,669 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:09:10,673 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:09:13,484 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:09:13,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:09:14,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:09:16,718 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:09:16,864 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:09:20,071 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:09:20,136 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:09:20,138 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:09:23,504 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:09:34,806 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:09:35,810 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:09:35,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:09:36,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:09:39,821 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 15:09:39,825 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:09:39,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:09:39,904 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:09:39,905 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:09:40,011 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:09:41,269 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:09:41,492 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:09:46,284 - ispa_next.functions - DEBUG - Updated appointment (AS00013562) customer contact data.
2025-11-17 15:09:47,198 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:09:47,200 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:09:48,104 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:09:48,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:09:48,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:09:52,611 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:09:52,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:09:53,125 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:09:55,129 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:09:55,262 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:09:55,354 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:09:55,464 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:09:55,466 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:09:58,912 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:10:10,498 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:11:10,500 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:11:21,347 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:11:28,791 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:11:28,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:11:38,562 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 15:11:41,482 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 15:11:44,328 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 15:11:46,885 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Zündkerzen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 15:11:49,876 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 15:11:52,811 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Luftfiltereinsatz' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 15:11:55,010 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motoröl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 15:11:56,816 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:11:59,135 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:12:00,142 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:12:00,143 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:12:00,143 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:00,257 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:12:04,353 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 15:12:04,978 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 15:12:18,647 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:12:18,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:18,745 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:12:23,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:23,564 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:23,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:24,442 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:12:24,443 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:12:27,615 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:12:27,618 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:12:32,497 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:12:32,499 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:12:32,501 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 15:12:32,502 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 15:12:32,504 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:12:32,506 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:12:32,508 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:12:32,509 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:12:32,511 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:12:32,513 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:12:32,517 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:12:32,523 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:12:33,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:12:34,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:12:48,535 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:12:48,538 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:12:48,540 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:12:48,541 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:12:52,613 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:12:52,615 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:12:52,617 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:12:52,619 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:12:52,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:12:53,296 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:12:53,558 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:13:04,876 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:13:04,878 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:13:08,968 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:13:26,129 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:13:26,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:13:27,293 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:13:27,565 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:14:08,580 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:14:15,078 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:14:20,937 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:14:26,551 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:14:32,527 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:14:32,529 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:14:32,530 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:14:33,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:14:33,711 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:14:33,713 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:14:37,113 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:14:51,278 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:14:51,699 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 15:14:54,968 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:14:56,105 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1545
2025-11-17 15:14:56,107 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:15:01,153 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 352
2025-11-17 15:15:01,154 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:15:02,488 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:15:02,497 - ispa_next.main - DEBUG - 



2025-11-17 15:15:02,497 - ispa_next.main - DEBUG - starting with process 3 (MZ-NP 777) of 11
2025-11-17 15:15:02,501 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:15:04,522 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:15:06,628 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1545
2025-11-17 15:15:06,630 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 352
2025-11-17 15:15:10,168 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:15:10,170 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:15:57,989 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:16:10,660 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:16:12,628 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:16:12,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:12,730 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:16:13,102 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 15:16:23,447 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:16:23,449 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:16:26,540 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:16:26,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:16:28,566 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:16:30,569 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:16:30,737 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:16:34,059 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:16:34,200 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:16:34,201 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:16:36,205 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:16:48,731 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:16:49,736 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:16:49,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:50,300 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:05,466 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:17:15,347 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:17:15,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:15,451 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:15,451 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:17:15,497 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:17:16,753 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:17:17,955 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:17:18,216 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:17:23,895 - ispa_next.functions - DEBUG - Updated appointment (AE00049901) customer contact data.
2025-11-17 15:17:24,848 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:17:24,850 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:17:26,109 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:17:26,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:17:26,980 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:17:30,608 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:17:30,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:17:31,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:17:33,128 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:17:33,289 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:17:33,420 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:17:33,534 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:17:33,535 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:17:35,536 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:17:47,695 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:18:47,698 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:18:59,574 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:19:07,441 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:19:07,442 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:09,459 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:19:13,710 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:19:14,717 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:19:14,718 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:19:14,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:14,929 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:19:19,101 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:19:19,105 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:19:19,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:19,214 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:19:19,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:19:20,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:19:20,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:20,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:19:20,947 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:19:22,899 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:19:22,902 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:19:24,542 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:19:24,548 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:19:24,551 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 15:19:24,554 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 15:19:24,556 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:19:24,557 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:19:24,558 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:19:24,560 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:19:24,562 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:19:24,563 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:19:24,565 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:19:24,567 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:19:25,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:19:26,335 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:19:41,532 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:19:41,535 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:19:41,538 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:19:41,538 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:44,286 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:19:44,288 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:19:44,290 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:19:44,291 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:19:44,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:19:44,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:19:45,193 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:54,630 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:19:54,632 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:57,301 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:20:15,032 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:20:15,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:16,181 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:20:16,525 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:43,557 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:20:48,514 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:20:55,432 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:20:55,434 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:20:55,435 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:20:56,684 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:56,821 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:20:56,822 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:21:00,106 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:21:15,157 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:21:15,530 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 15:21:16,800 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:21:20,287 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1546
2025-11-17 15:21:20,289 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:21:25,490 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 353
2025-11-17 15:21:25,491 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:21:26,833 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:21:26,839 - ispa_next.main - DEBUG - Found new Appointment: MZ-EP 2010
2025-11-17 15:21:26,841 - ispa_next.main - DEBUG - 



2025-11-17 15:21:26,841 - ispa_next.main - DEBUG - starting with process 4 (MZ-EP 2010) of 12
2025-11-17 15:21:26,846 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:21:28,505 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:21:30,063 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1546
2025-11-17 15:21:30,065 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 353
2025-11-17 15:21:32,349 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:21:32,350 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:22:22,282 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:22:35,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:35,114 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:22:35,377 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:22:38,720 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:22:38,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:38,812 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:22:39,189 - ispa_next.functions - DEBUG - HU date already expired after 172 days.
2025-11-17 15:22:49,637 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:22:49,640 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:22:52,742 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:22:52,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:22:54,668 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:22:56,683 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:23:06,715 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 15:23:16,858 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 15:23:17,873 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:23:17,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:18,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:33,560 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:23:44,384 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:23:44,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:44,487 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:23:44,488 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:23:44,552 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:23:44,757 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:23:46,299 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:23:46,566 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:23:52,869 - ispa_next.functions - DEBUG - Updated appointment (AE00049919) customer contact data.
2025-11-17 15:23:53,794 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:23:53,825 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:23:54,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:23:55,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:23:57,138 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:23:57,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:23:57,269 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:24:00,915 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:24:00,915 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:24:00,918 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:24:00,919 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:24:00,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:01,453 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:24:05,633 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:24:05,637 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:24:05,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:05,725 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:24:06,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:06,658 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:06,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:07,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:24:07,445 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:24:11,260 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:24:11,262 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:24:12,434 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:24:12,435 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:24:12,437 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 15:24:12,438 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 15:24:12,439 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:24:12,441 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:24:12,442 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:24:12,443 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:24:12,449 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:24:12,452 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:24:12,456 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:24:12,463 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:24:13,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:24:13,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:24:28,090 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:24:28,092 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:24:28,094 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:24:28,094 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:24:32,765 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 15:24:37,031 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:24:37,060 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:24:37,063 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:24:37,065 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:24:37,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:24:37,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:24:37,822 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:24:37,828 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:24:42,611 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:24:59,725 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:25:00,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:25:00,721 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:25:01,051 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:28,736 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:25:28,737 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:25:29,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:25:29,722 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:25:29,723 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:25:36,648 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:25:48,534 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:25:48,934 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 15:25:49,875 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:25:53,447 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:25:53,448 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:25:58,072 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 355
2025-11-17 15:25:58,073 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:25:59,402 - ispa_next.appointments.models - DEBUG - Appointment Firma OTS On Time Shipping GmbH MZ-J 2313E WBY41CF090CV73791 ohne Termin.
2025-11-17 15:25:59,405 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:25:59,409 - ispa_next.main - DEBUG - 



2025-11-17 15:25:59,409 - ispa_next.main - DEBUG - starting with process 5 (B MW 3483 E) of 12
2025-11-17 15:25:59,414 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:01,081 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:26:03,102 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:26:03,104 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 355
2025-11-17 15:26:05,757 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:26:05,759 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:26:27,223 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 15:26:27,320 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 15:26:27,325 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:26:28,286 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:26:28,287 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:26:33,178 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 355
2025-11-17 15:26:33,179 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:26:34,663 - ispa_next.appointments.models - DEBUG - Appointment Firma OTS On Time Shipping GmbH MZ-J 2313E WBY41CF090CV73791 ohne Termin.
2025-11-17 15:26:34,666 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:26:34,672 - ispa_next.main - DEBUG - 



2025-11-17 15:26:34,672 - ispa_next.main - DEBUG - starting with process 6 (WI JF 719) of 12
2025-11-17 15:26:34,676 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:36,844 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:26:38,622 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:26:38,624 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 355
2025-11-17 15:26:40,731 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:26:40,732 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:27:00,473 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 15:27:00,483 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 15:27:00,487 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:27:01,551 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:27:01,553 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:27:06,473 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 355
2025-11-17 15:27:06,474 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:27:08,128 - ispa_next.appointments.models - DEBUG - Appointment Firma OTS On Time Shipping GmbH MZ-J 2313E WBY41CF090CV73791 ohne Termin.
2025-11-17 15:27:08,130 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:27:08,135 - ispa_next.main - DEBUG - 



2025-11-17 15:27:08,135 - ispa_next.main - DEBUG - starting with process 7 (WI FI 246) of 12
2025-11-17 15:27:08,138 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:27:10,238 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:27:12,401 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:27:12,404 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 355
2025-11-17 15:27:14,940 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:27:14,942 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:27:34,201 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 15:27:34,208 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 15:27:34,211 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:27:35,008 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:27:35,010 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:27:40,025 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 355
2025-11-17 15:27:40,026 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:27:41,374 - ispa_next.appointments.models - DEBUG - Appointment Firma OTS On Time Shipping GmbH MZ-J 2313E WBY41CF090CV73791 ohne Termin.
2025-11-17 15:27:41,376 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:27:41,381 - ispa_next.main - DEBUG - 



2025-11-17 15:27:41,381 - ispa_next.main - DEBUG - starting with process 8 (0) of 12
2025-11-17 15:27:41,391 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:27:43,467 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:27:45,491 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:27:45,493 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 355
2025-11-17 15:27:48,144 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:27:48,145 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:28:16,313 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 15:28:16,324 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 15:28:16,328 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:28:17,342 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:28:17,344 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:28:21,887 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 355
2025-11-17 15:28:21,888 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:28:23,139 - ispa_next.appointments.models - DEBUG - Appointment Firma OTS On Time Shipping GmbH MZ-J 2313E WBY41CF090CV73791 ohne Termin.
2025-11-17 15:28:23,141 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:28:23,146 - ispa_next.main - DEBUG - 



2025-11-17 15:28:23,146 - ispa_next.main - DEBUG - starting with process 9 (MZ - AW 77E) of 12
2025-11-17 15:28:23,150 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:28:25,109 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:28:27,259 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:28:27,260 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 355
2025-11-17 15:28:29,915 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:28:29,916 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:28:48,353 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 15:28:48,361 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 15:28:48,373 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:28:49,288 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:28:49,290 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:28:54,304 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 355
2025-11-17 15:28:54,305 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:28:55,921 - ispa_next.appointments.models - DEBUG - Appointment Firma OTS On Time Shipping GmbH MZ-J 2313E WBY41CF090CV73791 ohne Termin.
2025-11-17 15:28:55,923 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:28:55,928 - ispa_next.main - DEBUG - 



2025-11-17 15:28:55,928 - ispa_next.main - DEBUG - starting with process 10 (KI-KI 0815) of 12
2025-11-17 15:28:55,932 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:28:57,751 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:28:59,302 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:28:59,303 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 355
2025-11-17 15:29:01,463 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:29:01,465 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:29:31,380 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 15:29:31,392 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 15:29:31,396 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:29:32,459 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:29:32,460 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:29:37,692 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 355
2025-11-17 15:29:37,692 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:29:39,103 - ispa_next.appointments.models - DEBUG - Appointment Firma OTS On Time Shipping GmbH MZ-J 2313E WBY41CF090CV73791 ohne Termin.
2025-11-17 15:29:39,105 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:29:39,109 - ispa_next.main - DEBUG - 



2025-11-17 15:29:39,109 - ispa_next.main - DEBUG - starting with process 11 (0) of 12
2025-11-17 15:29:39,113 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:29:40,648 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:29:42,152 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:29:42,153 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 355
2025-11-17 15:29:44,345 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:29:44,347 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:30:14,319 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 15:30:14,329 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 15:30:14,333 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:30:15,345 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:30:15,347 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:30:20,252 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 355
2025-11-17 15:30:20,253 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:30:21,949 - ispa_next.appointments.models - DEBUG - Appointment Firma OTS On Time Shipping GmbH MZ-J 2313E WBY41CF090CV73791 ohne Termin.
2025-11-17 15:30:21,952 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:30:21,960 - ispa_next.main - DEBUG - 



2025-11-17 15:30:21,960 - ispa_next.main - DEBUG - starting with process 12 (KI-KI 0815) of 12
2025-11-17 15:30:21,966 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:30:24,047 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:30:26,087 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:30:26,089 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 355
2025-11-17 15:30:28,686 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:30:28,688 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:30:58,273 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 15:30:58,283 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 15:30:58,287 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:30:59,114 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1548
2025-11-17 15:30:59,115 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:31:03,988 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 355
2025-11-17 15:31:03,988 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:31:05,351 - ispa_next.appointments.models - DEBUG - Appointment Firma OTS On Time Shipping GmbH MZ-J 2313E WBY41CF090CV73791 ohne Termin.
2025-11-17 15:31:05,353 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
