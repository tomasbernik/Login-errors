2025-11-12 09:15:27,358 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 09:15:27,366 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 09:15:39,066 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:15:55,043 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:16:10,862 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:16:35,332 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 09:16:53,099 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 09:16:56,273 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:16:57,867 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 373
2025-11-12 09:16:57,868 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 09:17:01,310 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 133
2025-11-12 09:17:01,311 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 09:17:01,312 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:17:02,821 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:17:04,267 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:17:29,541 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:17:29,632 - ispa_next.appointments.models - DEBUG - Appointment Manuel Hermann Jaeger-Lenne GV-MJ 1989 WBAJG11030ED57177 ohne Termin.
2025-11-12 09:17:29,677 - ispa_next.appointments.models - DEBUG - Appointment Armaturen Vertrieb Alms GmbH ME-AA 340E WBY71AW020FT62013 ohne Termin.
2025-11-12 09:17:29,689 - ispa_next.appointments.models - DEBUG - Appointment   WBA11FZ090FR60998 ohne Termin.
2025-11-12 09:17:29,700 - ispa_next.appointments.models - DEBUG - Appointment Bianca Prins VIE-PE 881 WBA11AW010FL84234 ohne Termin.
2025-11-12 09:17:29,709 - ispa_next.appointments.models - DEBUG - Appointment Oliver Berndsen NE-JO 288E WBY31FK070CR63503 ohne Termin.
2025-11-12 09:17:29,722 - ispa_next.appointments.models - DEBUG - Appointment   WBY61EF0105W96493 ohne Termin.
2025-11-12 09:17:29,731 - ispa_next.appointments.models - DEBUG - Appointment Krajnc ME-VV 1979 WBA11EV0209W56488 ohne Termin.
2025-11-12 09:17:29,747 - ispa_next.main - DEBUG - Found 15 out of 26 appointments to process (configured limit: 15).
2025-11-12 09:17:29,747 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 09:17:29,748 - ispa_next.main - DEBUG - Processing 12 already visited appointments (w/ RKR not callable).
2025-11-12 09:17:29,748 - ispa_next.main - DEBUG - All appointments: F-S685E, NE-X 1660, NE-RK 63, NE-MS 2311, NE-EG 1989, NE-GB 2917, D-NE 397, NE-EY 9, NE-RI 1352, NE-IM 149, KR-HK 6000, NE-IK 4000, F-CG 723, NE-BN 2510, D-CM 3200E
2025-11-12 09:17:29,750 - ispa_next.main - DEBUG - 



2025-11-12 09:17:29,750 - ispa_next.main - DEBUG - starting with process 1 (F-S685E) of 15
2025-11-12 09:17:29,754 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:17:31,164 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:17:32,702 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 373
2025-11-12 09:17:32,703 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 133
2025-11-12 09:17:34,433 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:17:34,435 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:18:25,355 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:18:25,504 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 09:18:25,508 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:18:26,056 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 373
2025-11-12 09:18:26,058 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:18:29,178 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 09:18:29,179 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:18:30,296 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:18:30,301 - ispa_next.main - DEBUG - Found new Appointment: NE-KM 1932
2025-11-12 09:18:30,302 - ispa_next.main - DEBUG - 



2025-11-12 09:18:30,302 - ispa_next.main - DEBUG - starting with process 2 (NE-KM 1932) of 16
2025-11-12 09:18:30,305 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:18:31,753 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:18:33,538 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 373
2025-11-12 09:18:33,539 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 09:18:35,165 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:18:35,166 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:19:04,378 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:19:15,421 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:19:18,754 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:19:18,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:18,901 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:19:19,166 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:19:19,169 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:19:22,239 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:19:22,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:19:23,389 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:19:25,395 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:19:25,601 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:19:28,865 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:19:28,955 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:19:33,154 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:19:34,159 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:19:34,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:34,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:51,151 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:19:59,967 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:19:59,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:20:00,137 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:20:00,138 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:20:00,222 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:20:00,364 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:20:02,091 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:20:02,502 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:20:06,435 - ispa_next.functions - DEBUG - Updated appointment (AA00025025) customer contact data.
2025-11-12 09:20:07,413 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:20:07,415 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:20:07,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:20:08,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:20:09,985 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:20:09,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:20:10,230 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:20:13,931 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:20:13,931 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:20:13,934 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:20:13,937 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:20:13,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:20:14,466 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:20:18,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:20:18,875 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:20:18,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:20:19,593 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:20:19,595 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:20:23,476 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:20:23,478 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:20:24,504 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:20:24,507 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:20:24,511 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:20:24,514 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:20:24,517 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:20:24,522 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:20:24,523 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:20:24,525 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:20:24,527 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:20:24,529 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:20:24,531 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:20:24,534 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:20:24,536 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:20:24,537 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:28,693 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 09:20:31,876 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:20:31,883 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:20:31,909 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:36,051 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:20:36,052 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:20:36,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:20:36,867 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:20:37,265 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:48,533 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:20:48,537 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:52,669 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:21:06,083 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:21:06,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:21:07,249 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:21:07,490 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:21:46,545 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:21:51,476 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:21:55,951 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:22:01,004 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:22:06,003 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:22:06,009 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:22:06,010 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:22:06,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:22:06,982 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:22:06,984 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:22:09,420 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:22:20,872 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:22:21,277 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 09:22:22,318 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:22:23,137 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 373
2025-11-12 09:22:23,139 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:27,315 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 09:22:27,316 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:28,481 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:22:28,497 - ispa_next.main - DEBUG - 



2025-11-12 09:22:28,497 - ispa_next.main - DEBUG - starting with process 3 (NE-X 1660) of 16
2025-11-12 09:22:28,518 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:22:30,082 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:22:31,665 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 373
2025-11-12 09:22:31,667 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 09:22:33,493 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:33,495 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:23:16,937 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:23:28,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:28,732 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:23:28,945 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:36,506 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:23:36,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:36,629 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:23:36,993 - ispa_next.functions - DEBUG - HU date soon to be invalid in 4 days.
2025-11-12 09:23:45,397 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:23:45,400 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:23:48,332 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:23:48,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:49,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:51,743 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:23:51,906 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:23:52,086 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:23:52,173 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:23:52,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:59,970 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:24:12,033 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 09:24:17,932 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:24:17,934 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:27,959 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 09:24:31,324 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 09:24:33,678 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:24:36,463 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:24:37,469 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:24:37,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:24:37,983 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:24:55,362 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:25:04,750 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:25:04,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:04,975 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:25:04,976 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:25:05,062 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:25:05,279 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:25:07,143 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:25:07,522 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:25:11,199 - ispa_next.functions - DEBUG - Updated appointment (AC00010688) customer contact data.
2025-11-12 09:25:12,157 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:25:12,160 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:25:12,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:25:13,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:25:14,798 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:25:14,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:25:14,907 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:25:18,585 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:25:18,585 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:25:18,588 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:25:18,591 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:25:18,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:25:19,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:25:19,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:20,262 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:20,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:25:21,001 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:25:21,003 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:25:22,574 - ispa_next.package_manager.helper - DEBUG - couldn't retrieve pakage name in cart
2025-11-12 09:25:23,055 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 262, in run
    self._update_cart_content()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 36, in _update_cart_content
    self.containers[Container.CART] = self.ui_helper.get_cart_content(self.base_element)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 141, in get_cart_content
    name=cart_package_name,
         ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'cart_package_name' where it is not associated with a value

2025-11-12 09:25:23,078 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:25:23,079 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:25:24,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:25:24,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:25:24,762 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 09:25:24,791 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 09:25:28,667 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 09:25:28,671 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:25:29,456 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 373
2025-11-12 09:25:29,457 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:25:34,171 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 09:25:34,172 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:25:35,557 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:25:35,562 - ispa_next.main - DEBUG - 



2025-11-12 09:25:35,562 - ispa_next.main - DEBUG - starting with process 4 (NE-RK 63) of 16
2025-11-12 09:25:35,566 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:25:37,093 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:25:39,003 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 373
2025-11-12 09:25:39,004 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 09:25:40,830 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:25:40,832 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:26:07,841 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:26:18,499 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:26:20,509 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:26:20,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:20,610 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:26:20,858 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:26:20,861 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:26:23,658 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:26:23,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:26:23,935 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 09:26:24,384 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 09:26:24,413 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:26:24,413 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:26:25,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:26:25,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:26:25,959 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 09:26:26,004 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 09:26:29,159 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 09:26:29,162 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:26:29,752 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 373
2025-11-12 09:26:29,753 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:26:34,263 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 09:26:34,264 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:26:35,306 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:26:35,314 - ispa_next.main - DEBUG - 



2025-11-12 09:26:35,314 - ispa_next.main - DEBUG - starting with process 5 (NE-MS 2311) of 16
2025-11-12 09:26:35,319 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:26:36,919 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:26:39,051 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 373
2025-11-12 09:26:39,053 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 09:26:40,730 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:26:40,731 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:27:13,614 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:27:15,916 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:27:21,459 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:23,390 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:27:23,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:23,527 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:27:23,881 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:27:23,884 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:27:26,841 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:27:26,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:27:28,146 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:27:30,149 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:27:30,333 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:27:30,495 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:27:30,573 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:27:34,890 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:27:35,895 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:27:35,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:36,428 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:50,986 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:27:50,987 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:27:55,755 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:27:55,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:55,933 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:27:55,934 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:27:55,982 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:27:57,527 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:27:59,170 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:27:59,533 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:28:01,465 - ispa_next.functions - DEBUG - Updated appointment (AB00014473) customer contact data.
2025-11-12 09:28:02,435 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:28:02,438 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:28:03,339 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:28:03,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:28:04,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:28:08,481 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 09:28:08,482 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:28:08,482 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:28:08,485 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:28:08,488 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:28:08,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:28:09,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:28:12,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:13,158 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:13,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:28:13,971 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:28:13,973 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:28:16,059 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:28:16,062 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:28:17,793 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:28:17,799 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:28:17,802 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:28:17,805 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:28:17,806 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:28:17,808 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:28:17,810 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:28:17,811 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:28:17,813 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:28:17,815 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:28:17,817 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:28:17,820 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:28:17,822 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:28:17,823 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:28:19,939 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:28:19,941 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:28:19,944 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:28:21,972 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:28:21,974 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:28:21,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:28:23,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:28:23,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:28:32,667 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:28:32,669 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:28:34,719 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:28:47,973 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:28:48,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:28:49,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:28:49,309 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:29:09,367 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:29:16,016 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:29:16,019 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:29:16,020 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:29:16,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:29:17,019 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:29:17,021 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:29:19,313 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:29:28,522 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:29:28,965 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 09:29:30,101 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:29:30,979 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 373
2025-11-12 09:29:30,981 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:29:35,287 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 09:29:35,287 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:29:36,474 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:29:36,479 - ispa_next.main - DEBUG - 



2025-11-12 09:29:36,480 - ispa_next.main - DEBUG - starting with process 6 (NE-EG 1989) of 16
2025-11-12 09:29:36,483 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:29:37,985 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:29:39,863 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 373
2025-11-12 09:29:39,864 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 09:29:41,699 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:29:41,701 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:30:13,850 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:30:16,321 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:30:21,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:24,427 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:30:24,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:24,507 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:30:24,905 - ispa_next.functions - DEBUG - HU date already expired after 808 days.
2025-11-12 09:30:30,148 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:30:30,150 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:30:33,019 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:30:33,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:30:34,347 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:30:36,350 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:30:36,493 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:30:36,667 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:30:36,805 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:30:38,997 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:30:40,003 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:30:40,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:40,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:57,485 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:31:02,804 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:31:02,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:02,954 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:31:02,955 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:31:03,111 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:31:03,272 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:31:04,964 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:31:05,323 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:31:07,493 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:31:07,495 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:31:07,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:31:08,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:31:10,091 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:31:10,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:31:10,172 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:31:13,832 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:31:13,832 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:31:13,835 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:31:13,838 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:31:13,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:31:14,343 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:31:14,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:15,452 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:15,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:31:16,246 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:31:16,248 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:31:18,850 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:31:18,853 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:31:20,833 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:31:20,837 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:31:20,839 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:31:20,840 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:31:20,841 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:31:20,844 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:31:20,846 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:31:20,847 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:31:20,849 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:31:20,850 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:31:20,853 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:31:20,857 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:31:20,859 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:31:20,860 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:23,781 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:31:23,783 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:31:23,786 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:26,607 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:31:26,609 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:31:26,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:31:27,529 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:31:27,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:37,129 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:31:37,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:39,852 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:31:53,076 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:31:53,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:31:54,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:31:54,463 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:22,093 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:32:27,464 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:32:33,051 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:32:33,053 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:32:33,054 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:32:33,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:32:33,953 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:32:33,955 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:32:36,295 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:32:45,957 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:32:46,353 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 09:32:47,544 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:32:48,449 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 374
2025-11-12 09:32:48,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:32:53,095 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 09:32:53,096 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:32:54,176 - ispa_next.appointments.models - DEBUG - Appointment Kai Anton Martynenko GE-NR 777 WBA81DP0309M58413 ohne Termin.
2025-11-12 09:32:54,181 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:32:54,189 - ispa_next.main - DEBUG - 



2025-11-12 09:32:54,189 - ispa_next.main - DEBUG - starting with process 7 (NE-GB 2917) of 16
2025-11-12 09:32:54,194 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:32:55,700 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:32:57,347 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 374
2025-11-12 09:32:57,348 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 09:32:59,182 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:32:59,183 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:33,118 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:33:35,645 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:33:41,294 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:33:43,981 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:33:43,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:44,124 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:33:44,377 - ispa_next.functions - DEBUG - HU date already expired after 435 days.
2025-11-12 09:33:49,744 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:33:49,747 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:33:52,568 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:33:52,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:33:53,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:33:55,767 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:33:55,915 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:33:56,044 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:33:56,151 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:34:00,370 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:34:01,376 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:34:01,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:01,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:19,622 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:34:24,769 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:34:24,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:24,925 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:34:24,926 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:34:24,998 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:34:25,203 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:34:27,068 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:34:27,426 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:34:29,742 - ispa_next.functions - DEBUG - Updated appointment (AC00010673) customer contact data.
2025-11-12 09:34:30,673 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:34:30,675 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:34:30,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:34:31,823 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:34:33,092 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:34:33,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:34:33,207 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:34:37,307 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:34:37,307 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:34:37,310 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:34:37,313 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:34:37,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:37,899 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:34:38,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:38,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:38,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:39,712 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:34:39,713 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:34:42,273 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:34:42,276 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:34:43,843 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:34:43,846 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:34:43,850 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:34:43,853 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:34:43,857 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:34:43,860 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:34:43,861 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:34:43,862 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:34:43,865 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:34:43,866 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:34:43,869 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:34:43,871 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:34:43,874 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:34:43,874 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:34:46,704 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:34:46,706 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:34:46,708 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:34:49,688 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:34:49,690 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:34:49,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:34:50,550 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:34:50,738 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:34:57,485 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:34:57,487 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:00,273 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:35:13,263 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:35:13,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:35:14,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:35:14,485 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:41,958 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:35:47,272 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:35:53,033 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:35:53,035 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:35:53,035 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:35:53,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:35:53,918 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:35:53,919 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:35:56,175 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:36:05,881 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:36:06,275 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 09:36:07,306 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:36:08,125 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 374
2025-11-12 09:36:08,126 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:36:12,412 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 09:36:12,413 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:36:13,472 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:36:13,477 - ispa_next.main - DEBUG - Found new Appointment: GE-NR 777
2025-11-12 09:36:13,478 - ispa_next.main - DEBUG - 



2025-11-12 09:36:13,478 - ispa_next.main - DEBUG - starting with process 8 (GE-NR 777) of 17
2025-11-12 09:36:13,482 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:36:14,994 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:36:16,699 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 374
2025-11-12 09:36:16,700 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 09:36:18,416 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:36:18,418 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:36:52,875 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:37:04,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:04,352 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:37:04,562 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:37:06,640 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:37:06,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:06,718 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:37:07,111 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:37:07,114 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:37:10,149 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:37:10,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:37:11,608 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:37:13,614 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:37:14,006 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:37:17,696 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:37:17,777 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:37:17,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:37:19,881 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:37:28,555 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:37:29,559 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:37:29,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:30,132 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:44,838 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:37:53,961 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:37:53,964 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:54,103 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:37:54,104 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:37:54,185 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:37:55,634 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:37:57,488 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:37:57,896 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:38:02,326 - ispa_next.functions - DEBUG - Updated appointment (AA00025026) customer contact data.
2025-11-12 09:38:03,254 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:38:03,257 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:38:04,262 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:38:04,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:38:05,158 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:38:08,767 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:38:08,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:38:09,271 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:38:11,274 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:38:11,483 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:38:11,613 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:38:11,724 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:38:11,726 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:13,894 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:38:25,045 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 09:38:30,051 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:38:30,052 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:32,877 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:38:37,083 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:38:38,089 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:38:38,092 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:38:38,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:38:38,223 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:38:42,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:42,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:42,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:38:43,458 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:38:43,460 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:38:45,469 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:38:45,471 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:38:46,800 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:38:46,823 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:38:46,826 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:38:46,828 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:38:46,829 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:38:46,832 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:38:46,833 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:38:46,834 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:38:46,837 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:38:46,838 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:38:46,840 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:38:46,843 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:38:46,845 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:38:46,846 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:48,946 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:38:48,947 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:38:48,949 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:50,955 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:38:50,957 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:38:50,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:38:51,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:38:52,232 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:58,614 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:38:58,617 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:39:00,732 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:39:14,095 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:39:14,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:39:15,165 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:39:15,342 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:39:34,116 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:39:39,997 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:39:40,000 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:39:40,001 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:39:40,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:39:40,872 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:39:40,873 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:39:43,184 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:39:53,189 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:39:53,598 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 09:39:54,693 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:39:55,578 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 374
2025-11-12 09:39:55,579 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:39:59,646 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 09:39:59,647 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:40:00,779 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:40:00,786 - ispa_next.main - DEBUG - 



2025-11-12 09:40:00,786 - ispa_next.main - DEBUG - starting with process 9 (D-NE 397) of 17
2025-11-12 09:40:00,791 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:40:02,696 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:40:04,330 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 374
2025-11-12 09:40:04,332 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 09:40:06,256 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:40:06,257 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:40:41,019 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:40:44,688 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:40:50,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:56,593 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:40:56,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:56,700 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:40:56,980 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:40:56,983 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:41:00,063 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:41:00,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:01,252 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:41:03,255 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:41:03,409 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:41:03,518 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:41:03,654 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:41:07,896 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:41:08,900 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:41:08,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:09,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:24,827 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:41:30,328 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:41:30,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:30,483 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:41:30,484 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:41:30,524 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:41:30,765 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:41:32,353 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:41:32,709 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:41:34,750 - ispa_next.functions - DEBUG - Updated appointment (AA00024911) customer contact data.
2025-11-12 09:41:35,723 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:41:35,726 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:41:35,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:41:37,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:41:38,680 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:41:38,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:41:38,761 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:41:42,453 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:41:42,453 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:41:42,456 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:41:42,459 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:41:42,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:42,990 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:41:43,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:44,109 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:44,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:44,959 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:41:44,961 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:41:50,740 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:41:50,743 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:41:51,956 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:41:51,999 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:41:52,002 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:41:52,007 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:41:52,008 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:41:52,011 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:41:52,057 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:41:52,059 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:41:52,062 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:41:52,063 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:41:52,066 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:41:52,073 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:41:52,075 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:41:52,076 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:58,349 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:41:58,351 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:41:58,353 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:42:04,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:42:04,708 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:42:19,348 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:42:19,350 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:42:19,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:42:20,419 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:42:20,695 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:42:34,241 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:42:34,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:42:40,509 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:42:54,763 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:42:55,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:42:55,869 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:42:56,152 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:43:56,569 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:44:02,688 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:44:08,581 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:44:14,065 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:44:21,536 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:44:27,358 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:44:32,939 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:44:38,918 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:44:43,762 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:44:43,763 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:44:44,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:44:44,733 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:44:44,735 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:44:49,574 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:44:59,801 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:45:00,288 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 09:45:02,044 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:45:02,914 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 375
2025-11-12 09:45:02,915 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:45:07,659 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 138
2025-11-12 09:45:07,660 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:45:08,792 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:45:08,800 - ispa_next.main - DEBUG - Found new Appointment: D-HW 238
2025-11-12 09:45:08,802 - ispa_next.main - DEBUG - 



2025-11-12 09:45:08,802 - ispa_next.main - DEBUG - starting with process 10 (D-HW 238) of 18
2025-11-12 09:45:08,807 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:45:10,326 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:45:12,071 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 375
2025-11-12 09:45:12,072 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 138
2025-11-12 09:45:14,129 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:45:14,131 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:45:51,817 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:46:03,130 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:03,304 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:46:03,547 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:46:05,638 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:46:05,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:05,716 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:46:06,067 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:46:06,070 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:46:09,099 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:46:09,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:46:10,585 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:46:12,590 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:46:12,732 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:46:16,076 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:46:16,178 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:46:16,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:46:18,314 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:46:27,053 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:46:28,057 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:46:28,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:28,586 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:45,930 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:46:55,400 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:46:55,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:55,498 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:46:55,499 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:46:55,677 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:46:57,098 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:46:57,545 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:47:00,935 - ispa_next.functions - DEBUG - Updated appointment (AA00025027) customer contact data.
2025-11-12 09:47:01,992 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:47:01,994 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:47:02,981 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:47:02,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:47:03,970 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:47:07,608 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:47:07,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:47:08,134 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:47:10,137 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:47:10,322 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:47:10,482 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:47:10,564 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:47:10,566 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:12,765 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:47:22,333 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:48:22,335 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:48:30,899 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:48:51,902 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:49:00,432 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 09:49:09,305 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 09:49:10,311 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:49:10,314 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:49:10,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:49:10,470 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:49:16,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:49:16,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:49:16,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:49:17,438 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:49:17,440 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:49:19,512 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:49:19,514 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:49:21,303 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:49:21,305 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:49:21,309 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:49:21,311 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:49:21,315 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:49:21,320 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:49:21,321 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:49:21,322 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:49:21,325 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:49:21,326 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:49:21,328 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:49:21,331 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:49:21,333 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:49:21,334 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:23,420 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:49:23,422 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:49:23,445 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:25,510 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:49:25,512 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:49:25,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:49:26,425 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:49:26,484 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:49:26,486 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:28,454 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:49:41,240 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:49:41,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:49:42,297 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:49:42,516 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:50:01,903 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:50:07,716 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:50:07,718 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:50:07,719 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:50:08,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:50:08,570 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:50:08,580 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:50:10,891 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:50:24,304 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 09:50:24,305 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:50:24,306 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:50:27,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:50:27,499 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:50:27,501 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:50:29,750 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 09:50:33,028 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 09:50:33,032 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:50:33,683 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 376
2025-11-12 09:50:33,684 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:50:38,450 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 139
2025-11-12 09:50:38,451 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:50:39,585 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:50:39,592 - ispa_next.main - DEBUG - Found new Appointment: NE-K 765E
2025-11-12 09:50:39,594 - ispa_next.main - DEBUG - 



2025-11-12 09:50:39,594 - ispa_next.main - DEBUG - starting with process 11 (NE-K 765E) of 19
2025-11-12 09:50:39,599 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:50:41,164 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:50:42,981 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 376
2025-11-12 09:50:42,983 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 139
2025-11-12 09:50:45,064 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:50:45,065 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:51:18,672 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:51:30,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:51:30,830 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:51:31,042 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:51:33,123 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:51:33,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:51:33,277 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:51:33,565 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:51:33,568 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:51:36,843 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:51:36,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:51:38,397 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:51:40,400 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:51:40,567 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:51:43,824 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:51:43,975 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:51:43,977 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:51:46,464 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:51:55,030 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:51:56,035 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:51:56,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:51:56,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:52:12,225 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:52:21,641 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:52:21,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:52:21,723 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:52:21,724 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:52:21,810 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:52:23,343 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:52:23,724 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:52:28,431 - ispa_next.functions - DEBUG - Updated appointment (AA00025028) customer contact data.
2025-11-12 09:52:29,390 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:52:29,394 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:52:30,454 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:52:30,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:52:31,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:52:35,229 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:52:35,230 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:52:35,735 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:52:37,737 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:52:37,925 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:52:38,058 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:52:38,134 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:52:38,136 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:52:40,262 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:52:51,960 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 09:52:56,576 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:52:56,578 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:52:59,285 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:53:03,545 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:53:04,551 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:53:04,554 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:53:04,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:53:04,693 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:53:05,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:53:05,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:53:05,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:53:06,580 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:53:06,582 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:53:09,289 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:53:09,291 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:53:10,611 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:53:10,614 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:53:10,618 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:53:10,620 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:53:10,623 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:53:10,628 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 09:53:10,631 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:53:10,634 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:53:10,635 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:53:10,638 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:53:10,641 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 09:53:13,258 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:53:13,815 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:53:14,775 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 09:53:15,347 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:53:15,882 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:53:16,820 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 09:53:17,385 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:53:17,925 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:53:19,823 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 09:53:21,685 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:53:22,633 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 09:53:23,325 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:53:23,331 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:53:23,332 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:53:25,274 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:53:25,276 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:53:25,279 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:53:27,420 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:53:27,422 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:53:27,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:53:28,646 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:53:28,897 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:53:37,530 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:53:37,532 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:53:39,629 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:53:53,057 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:53:53,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:53:54,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:53:54,530 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:54:13,747 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:54:19,824 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:54:19,827 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:54:19,828 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:54:20,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:54:20,724 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:54:20,726 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:54:23,824 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:54:33,874 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:54:34,261 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 09:54:35,433 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:54:36,524 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 377
2025-11-12 09:54:36,525 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:54:41,271 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 140
2025-11-12 09:54:41,272 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:54:42,336 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 09:54:42,341 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:54:42,345 - ispa_next.main - DEBUG - 



2025-11-12 09:54:42,345 - ispa_next.main - DEBUG - starting with process 12 (NE-EY 9) of 19
2025-11-12 09:54:42,348 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:54:43,968 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:54:45,773 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 377
2025-11-12 09:54:45,775 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 140
2025-11-12 09:54:47,726 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:54:47,727 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:55:19,438 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:55:21,921 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:55:28,004 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:55:30,334 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:55:30,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:55:30,481 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:55:31,278 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:55:31,281 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:55:35,917 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:55:35,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:55:38,162 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:55:40,165 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:55:40,316 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:55:40,442 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:55:40,586 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:55:44,801 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:55:45,809 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:55:45,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:55:46,407 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:56:03,987 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:56:09,157 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:56:09,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:56:09,305 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:56:09,307 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:56:09,416 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:56:10,906 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:56:11,294 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:56:13,390 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:56:13,402 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:56:14,575 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:56:14,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:56:15,931 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:56:19,607 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:56:19,607 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:56:19,611 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:56:19,616 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:56:19,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:56:20,154 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:56:20,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:56:21,156 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:56:21,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:56:22,136 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:56:22,138 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:56:24,280 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:56:24,282 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:56:25,643 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:56:25,646 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:56:25,649 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:56:25,652 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:56:25,654 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:56:25,659 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:56:25,662 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:56:25,663 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:56:25,666 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:56:25,667 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:56:25,670 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:56:25,673 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:56:25,675 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:56:25,676 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:56:27,769 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:56:27,771 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:56:27,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:56:30,025 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:56:30,028 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:56:30,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:56:31,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:56:31,625 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:56:41,056 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:56:41,061 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:56:43,144 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:56:57,895 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:56:58,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:56:59,145 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:56:59,343 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:57:19,056 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:57:25,890 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:57:25,892 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:57:25,892 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:57:26,672 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:57:26,772 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:57:26,774 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:57:29,176 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:57:39,104 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:57:39,565 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 09:57:40,818 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:57:41,833 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 377
2025-11-12 09:57:41,834 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:57:46,738 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 140
2025-11-12 09:57:46,739 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:57:47,885 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 09:57:47,890 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:57:47,896 - ispa_next.main - DEBUG - 



2025-11-12 09:57:47,896 - ispa_next.main - DEBUG - starting with process 13 (NE-RI 1352) of 19
2025-11-12 09:57:47,899 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:57:49,458 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:57:51,321 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 377
2025-11-12 09:57:51,323 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 140
2025-11-12 09:57:53,425 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:57:53,427 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:58:29,827 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:58:32,764 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:58:38,475 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:58:40,384 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:58:40,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:58:40,565 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:58:40,909 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:58:40,912 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:58:43,951 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:58:43,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:58:45,478 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:58:47,482 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:58:47,678 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:58:47,780 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:58:47,897 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:58:52,135 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:58:53,141 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:58:53,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:58:53,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:59:11,303 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:59:17,296 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:59:17,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:59:17,513 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:59:17,515 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:59:17,561 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:59:19,121 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:59:19,488 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:59:22,491 - ispa_next.functions - DEBUG - Updated appointment (AC00010676) customer contact data.
2025-11-12 09:59:23,414 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:59:23,416 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:59:24,588 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:59:24,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:59:25,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:59:29,963 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 09:59:29,964 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:59:29,964 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:59:29,972 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:59:29,976 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:59:29,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:59:30,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:59:34,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:59:35,028 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:59:35,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:59:35,901 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:59:35,903 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:59:38,060 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:59:38,062 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:59:40,167 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:59:40,168 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:59:40,171 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 09:59:40,172 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:59:40,173 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:59:40,176 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:59:40,177 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:59:40,178 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:59:40,180 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:59:40,181 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:59:40,184 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:59:40,191 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:59:40,192 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:59:40,193 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:59:42,478 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:59:42,480 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:59:42,483 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:59:44,518 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:59:44,520 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:59:44,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:59:45,741 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:59:46,051 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:59:55,232 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:59:55,235 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:59:57,368 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:00:11,027 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:00:11,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:00:12,168 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:00:12,340 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:00:31,674 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:00:37,707 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:00:37,709 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:00:37,710 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:00:38,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:00:38,594 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:00:38,596 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:00:41,060 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:00:51,737 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:00:52,121 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 10:00:53,483 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:00:54,551 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 378
2025-11-12 10:00:54,553 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:00:58,845 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 140
2025-11-12 10:00:58,846 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:00:59,962 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 10:00:59,967 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:00:59,971 - ispa_next.main - DEBUG - 



2025-11-12 10:00:59,971 - ispa_next.main - DEBUG - starting with process 14 (NE-IM 149) of 19
2025-11-12 10:00:59,975 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:01:02,218 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:01:03,872 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 378
2025-11-12 10:01:03,874 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 140
2025-11-12 10:01:06,037 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:01:06,039 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:01:42,893 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:01:46,123 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:01:51,885 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:01:54,649 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:01:54,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:01:54,755 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:01:55,150 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:02:00,995 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:02:00,998 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:02:03,904 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:02:03,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:02:05,469 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:02:07,472 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:02:07,626 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:02:07,726 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:02:07,896 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:02:10,071 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:02:11,076 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:02:11,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:02:11,582 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:02:29,799 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:02:35,701 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:02:35,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:02:35,832 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:02:35,833 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:02:35,983 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:02:36,172 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:02:37,966 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:02:38,321 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:02:40,564 - ispa_next.functions - DEBUG - Updated appointment (AA00024982) customer contact data.
2025-11-12 10:02:41,519 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:02:41,670 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:02:41,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:02:43,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:02:45,084 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:02:45,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:02:45,220 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:02:49,270 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:02:49,271 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:02:49,273 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:02:49,276 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:02:49,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:02:49,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:02:50,308 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:02:50,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:02:50,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:02:51,698 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:02:51,700 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:02:54,358 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:02:54,362 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:02:57,289 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:02:57,297 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:02:57,300 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:02:57,301 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:02:57,302 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:02:57,304 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:02:57,305 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:02:57,306 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:02:57,309 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:02:57,310 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:02:57,317 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:02:57,320 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:02:57,323 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:02:57,323 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:03:00,412 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:03:00,414 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:03:00,417 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:03:03,181 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:03:03,188 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:03:03,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:03:04,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:03:04,973 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:03:20,264 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:03:20,268 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:03:23,118 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:03:36,564 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:03:37,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:03:37,849 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:03:38,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:04:04,854 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:04:10,714 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:04:16,232 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:04:16,234 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:04:16,235 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:04:17,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:04:17,171 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:04:17,173 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:04:19,443 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:04:30,540 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:04:30,931 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 10:04:32,222 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:04:33,521 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 378
2025-11-12 10:04:33,522 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:04:38,718 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 140
2025-11-12 10:04:38,719 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:04:39,844 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 10:04:39,853 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:39,858 - ispa_next.main - DEBUG - 



2025-11-12 10:04:39,858 - ispa_next.main - DEBUG - starting with process 15 (KR-HK 6000) of 19
2025-11-12 10:04:39,861 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:04:41,429 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:04:43,134 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 378
2025-11-12 10:04:43,136 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 140
2025-11-12 10:04:45,093 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:04:45,094 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:05:23,569 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:05:26,152 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:05:32,627 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:05:36,819 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:05:36,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:05:36,927 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:05:37,292 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:05:37,295 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:05:40,324 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:05:40,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:05:41,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:05:43,954 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:05:44,119 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:05:44,301 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:05:44,427 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:05:48,640 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:05:49,644 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:05:49,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:05:50,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:08,712 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:06:15,267 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:06:15,269 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:15,438 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:06:15,439 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:06:15,554 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:06:15,697 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:06:17,495 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:06:18,106 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:06:20,436 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:06:20,561 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:06:20,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:06:21,956 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:06:23,256 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:06:23,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:06:23,365 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:06:27,035 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:06:27,035 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:06:27,038 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:06:27,041 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:06:27,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:06:28,292 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:06:37,117 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 10:06:49,241 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:06:49,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:50,706 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:50,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:06:51,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:06:51,466 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:06:55,413 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:06:55,419 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:06:57,972 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:06:58,000 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:06:58,034 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:06:58,044 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:06:58,046 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:06:58,049 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:06:58,050 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:06:58,051 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:06:58,055 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:06:58,056 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:06:58,059 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:06:58,063 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:06:58,065 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:06:58,066 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:02,346 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:07:02,348 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:07:02,351 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:06,659 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:07:06,661 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:07:06,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:07:07,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:07:07,871 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:22,532 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:07:22,534 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:26,724 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:07:40,400 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:07:40,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:07:41,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:07:41,840 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:08:23,126 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:08:29,229 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:08:34,649 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:08:41,697 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:08:48,105 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:08:48,107 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:08:48,108 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:08:48,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:08:49,086 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:08:49,087 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:08:51,495 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:09:02,103 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:09:02,522 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 10:09:03,904 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:05,044 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 378
2025-11-12 10:09:05,045 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:09:10,219 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 140
2025-11-12 10:09:10,220 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:09:11,338 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 10:09:11,343 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:09:11,350 - ispa_next.main - DEBUG - 



2025-11-12 10:09:11,351 - ispa_next.main - DEBUG - starting with process 16 (NE-IK 4000) of 19
2025-11-12 10:09:11,355 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:09:12,975 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:14,718 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 378
2025-11-12 10:09:14,719 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 140
2025-11-12 10:09:17,032 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:09:17,033 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:09:51,502 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:09:54,671 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:10:00,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:10:03,975 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:10:03,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:04,104 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:10:04,440 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:10:04,444 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:10:07,352 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:10:07,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:10:08,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:10:10,976 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:10:11,757 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:10:11,928 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:10:12,054 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:10:16,317 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:10:17,323 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:10:17,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:17,896 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:36,109 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:10:42,471 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:10:42,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:42,551 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:10:42,552 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:10:42,691 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:10:42,853 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:10:44,494 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:10:45,147 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:10:47,333 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:10:47,337 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:10:47,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:10:48,891 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:10:50,186 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:10:50,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:10:50,334 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:10:54,003 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:10:54,003 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:10:54,007 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:10:54,012 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:10:54,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:10:55,273 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:10:59,269 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 10:11:09,772 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:11:10,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:11,733 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:11,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:11:12,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:11:12,697 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:11:16,030 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:11:16,032 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:11:17,171 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:11:17,173 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:11:17,178 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:11:17,181 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:11:17,184 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:11:17,188 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:11:17,191 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:11:17,199 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:11:17,202 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:11:17,203 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:11:17,206 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:11:17,209 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:11:17,211 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:11:17,212 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:11:20,917 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:11:20,919 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:11:20,922 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:11:24,445 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:11:24,447 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:11:24,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:11:25,735 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:11:25,955 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:11:35,238 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:11:35,242 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:11:38,697 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:11:52,659 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:11:53,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:11:53,970 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:11:54,157 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:28,138 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:12:34,250 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:12:40,029 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:12:46,614 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:12:46,618 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:12:46,618 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:12:47,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:12:47,520 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:12:47,522 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:12:49,726 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:13:01,710 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:13:02,173 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 10:13:03,482 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:13:04,525 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 378
2025-11-12 10:13:04,526 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:13:09,956 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 140
2025-11-12 10:13:09,957 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:13:11,108 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 10:13:11,114 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:13:11,119 - ispa_next.main - DEBUG - 



2025-11-12 10:13:11,119 - ispa_next.main - DEBUG - starting with process 17 (F-CG 723) of 19
2025-11-12 10:13:11,122 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:13:12,740 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:13:14,627 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 378
2025-11-12 10:13:14,628 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 140
2025-11-12 10:13:16,834 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:13:16,836 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:13:53,022 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:13:56,443 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:14:02,274 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:04,349 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:14:04,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:04,496 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:14:04,847 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:14:04,850 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:14:08,090 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:14:08,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:14:09,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:14:11,853 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:14:12,024 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:14:12,212 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:14:12,308 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:14:16,535 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:14:17,539 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:14:17,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:18,209 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:37,025 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:14:43,716 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:14:43,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:43,855 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:14:43,857 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:14:43,903 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:14:45,659 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:14:46,320 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:14:48,719 - ispa_next.functions - DEBUG - Updated appointment (AB00014549) customer contact data.
2025-11-12 10:14:49,686 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:14:49,713 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:14:50,879 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:14:50,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:14:52,314 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:14:55,937 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:14:55,937 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:14:55,940 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:14:55,943 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:14:55,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:14:56,513 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:15:05,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:05,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:05,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:06,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:15:06,929 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:15:09,063 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:15:09,065 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:15:10,677 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:15:10,678 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:15:10,681 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:15:10,683 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:15:10,684 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:15:10,687 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:15:10,688 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:15:10,689 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:15:10,692 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:15:10,693 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:15:10,696 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:15:10,699 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:15:10,701 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:15:10,702 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:12,730 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:15:12,732 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:15:12,735 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:14,755 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:15:14,757 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:15:14,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:15:16,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:15:16,485 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:31,964 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:15:31,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:34,078 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:15:47,826 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:15:48,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:15:49,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:15:49,445 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:09,648 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:16:16,072 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:16:16,074 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:16:16,075 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:16:16,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:16:16,964 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:16:16,966 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:16:19,144 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:16:30,774 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:16:31,252 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 10:16:32,663 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:33,970 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 378
2025-11-12 10:16:33,972 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:39,342 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 140
2025-11-12 10:16:39,343 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:40,521 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 10:16:40,526 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:40,530 - ispa_next.main - DEBUG - 



2025-11-12 10:16:40,530 - ispa_next.main - DEBUG - starting with process 18 (NE-BN 2510) of 19
2025-11-12 10:16:40,533 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:16:42,145 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:44,091 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 378
2025-11-12 10:16:44,092 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 140
2025-11-12 10:16:46,276 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:46,277 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:17:24,150 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:17:26,701 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:17:33,294 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:17:36,212 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:17:36,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:36,457 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:17:36,887 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:17:36,890 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:17:39,933 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:17:39,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:17:41,632 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:17:43,634 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:17:43,824 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:17:44,033 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:17:44,236 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:17:48,470 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:17:49,475 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:17:49,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:49,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:09,226 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:18:15,456 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:18:15,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:15,604 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:18:15,626 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:18:15,772 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:18:16,029 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:18:17,817 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:18:18,652 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:18:21,066 - ispa_next.functions - DEBUG - Updated appointment (AA00024791) customer contact data.
2025-11-12 10:18:22,006 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:18:22,010 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:18:22,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:18:23,824 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:18:25,016 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:18:25,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:18:25,148 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:18:28,842 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:18:28,842 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:18:28,845 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:18:28,849 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:18:28,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:29,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:29,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:30,242 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:30,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:31,171 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:31,173 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:18:34,017 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:18:34,019 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:18:35,321 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:18:35,324 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:18:35,328 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:18:35,331 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:18:35,334 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:18:35,340 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:18:35,342 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:18:35,343 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:18:35,346 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:18:35,347 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:18:35,349 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:18:35,352 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:18:35,355 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:18:35,355 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:38,435 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:18:38,437 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:18:38,465 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:41,246 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:18:41,247 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:18:41,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:18:42,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:18:42,889 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:53,169 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:18:53,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:56,022 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:19:10,047 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:19:10,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:19:11,432 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:19:11,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:38,241 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:19:44,308 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:19:50,354 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:19:50,357 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:19:50,358 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:19:51,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:19:51,325 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:19:51,326 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:19:53,647 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:20:04,479 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:20:04,904 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 10:20:07,770 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:09,020 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 379
2025-11-12 10:20:09,022 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:20:13,483 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 141
2025-11-12 10:20:13,484 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:20:15,610 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 10:20:15,618 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:20:15,623 - ispa_next.main - DEBUG - Found new Appointment: VIE-RJ 766
2025-11-12 10:20:15,626 - ispa_next.main - DEBUG - 



2025-11-12 10:20:15,626 - ispa_next.main - DEBUG - starting with process 19 (VIE-RJ 766) of 20
2025-11-12 10:20:15,630 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:20:17,207 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:19,045 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 379
2025-11-12 10:20:19,046 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 141
2025-11-12 10:20:21,156 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:20:21,158 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:00,267 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:21:15,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:15,479 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:21:15,691 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:17,840 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:21:17,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:18,002 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:21:18,365 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:21:18,372 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:21:21,486 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:21:21,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:21:23,394 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:21:25,397 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:21:25,556 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:21:28,897 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:21:29,007 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:21:29,009 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:31,124 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:21:40,093 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:21:41,098 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:21:41,099 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:41,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:21:58,358 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:22:08,876 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:22:08,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:08,957 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:22:08,958 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:22:09,090 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:22:09,237 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:22:11,239 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:22:11,616 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:22:17,085 - ispa_next.functions - DEBUG - Updated appointment (AA00025031) customer contact data.
2025-11-12 10:22:18,045 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:22:18,051 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:22:18,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:22:19,723 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:22:21,654 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:22:21,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:22:22,479 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:22:26,122 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:22:26,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:22:26,674 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:22:28,677 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:22:28,830 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:22:28,974 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:22:29,079 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:22:29,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:22:32,092 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:22:41,058 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:23:41,062 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:23:50,128 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:24:01,131 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:24:09,939 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:24:19,359 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 10:24:20,392 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:24:20,397 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:24:20,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:24:20,523 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:24:20,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:21,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:21,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:24:22,528 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:24:22,530 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:24:25,270 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:24:25,272 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:24:26,565 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:24:26,570 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:24:26,576 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:24:26,582 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:24:26,587 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:24:26,600 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:24:26,620 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:24:26,621 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:24:26,624 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:24:26,637 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:24:26,641 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:24:26,646 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:24:26,649 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:24:26,650 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:29,571 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:24:29,573 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:24:29,576 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:32,645 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:24:32,647 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:24:32,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:24:33,793 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:24:33,853 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:24:33,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:36,689 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:24:50,250 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:24:50,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:24:51,505 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:24:51,690 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:18,870 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:25:25,400 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:25:31,489 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:25:31,492 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:25:31,492 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:25:32,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:25:32,445 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:25:32,446 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:25:34,932 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:25:47,506 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:25:47,927 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 10:25:49,359 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:25:50,509 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 379
2025-11-12 10:25:50,510 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:25:55,306 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 141
2025-11-12 10:25:55,307 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:57,538 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 10:25:57,544 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:25:57,549 - ispa_next.main - DEBUG - 



2025-11-12 10:25:57,549 - ispa_next.main - DEBUG - starting with process 20 (D-CM 3200E) of 20
2025-11-12 10:25:57,553 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:25:59,238 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:26:01,266 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 379
2025-11-12 10:26:01,267 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 141
2025-11-12 10:26:03,622 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:26:03,624 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:26:44,907 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:26:47,584 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:26:54,328 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:57,760 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:26:57,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:57,969 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:26:58,347 - ispa_next.functions - DEBUG - HU date already expired after 9 days.
2025-11-12 10:27:03,877 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:27:03,879 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:27:06,867 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:27:06,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:27:08,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:27:10,756 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:27:10,920 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:27:11,117 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:27:11,304 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:27:15,563 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:27:16,569 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:27:16,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:17,134 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:36,772 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:27:43,993 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:27:43,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:44,129 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:27:44,130 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:27:44,246 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:27:44,439 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:27:46,288 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:27:46,895 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:27:49,419 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:27:49,422 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:27:49,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:27:51,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:27:52,484 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:27:52,485 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:27:52,586 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:27:56,276 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:27:56,276 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:27:56,280 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:27:56,283 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:27:56,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:27:56,855 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:28:05,812 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 10:28:21,919 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:28:22,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:23,666 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:23,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:28:24,556 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:28:24,559 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:28:27,846 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:28:27,850 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:28:31,401 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:28:31,403 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:28:31,406 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:28:31,408 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:28:31,409 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:28:31,414 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:28:31,415 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:28:31,419 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:28:31,420 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:28:31,424 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:28:31,429 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:28:31,431 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:28:31,432 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:35,228 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:28:35,230 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:28:35,234 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:38,826 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:28:38,827 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:28:38,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:28:40,278 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:28:40,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:51,590 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:28:51,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:55,222 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:29:09,351 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:29:09,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:29:10,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:29:10,829 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:46,560 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:29:52,930 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:29:58,740 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:30:06,162 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:30:06,165 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:30:06,166 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:30:07,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:30:07,104 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:30:07,105 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:30:09,695 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:30:21,147 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:30:21,545 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-12 10:30:23,256 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:30:24,502 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 380
2025-11-12 10:30:24,503 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:30:29,243 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 141
2025-11-12 10:30:29,244 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:30:30,556 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 10:30:30,563 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
