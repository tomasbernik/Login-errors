2025-11-12 10:14:34,599 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:14:34,607 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:14:43,042 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:14:54,474 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:15:10,411 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:17:09,530 - ispa_next.app_start.main - DEBUG - Operation already took 107.78 seconds (more than 80 seconds)
2025-11-12 10:17:11,619 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_90qztjb0_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_90qztjb0', 'txt']
2025-11-12 10:17:11,946 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:17:11,953 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:17:11,954 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:19:11,348 - ispa_next.app_start.main - DEBUG - Operation already took 107.05 seconds (more than 80 seconds)
2025-11-12 10:19:13,429 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_at4oe6cl_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_at4oe6cl', 'txt']
2025-11-12 10:19:13,649 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:19:13,654 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:19:21,889 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 10:19:34,897 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:19:45,239 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:20:00,939 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:21:58,983 - ispa_next.app_start.main - DEBUG - Operation already took 106.71 seconds (more than 80 seconds)
2025-11-12 10:22:01,053 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_gbqskal7_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_gbqskal7', 'txt']
2025-11-12 10:22:01,314 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:22:01,319 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:22:01,320 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:24:00,198 - ispa_next.app_start.main - DEBUG - Operation already took 106.63 seconds (more than 80 seconds)
2025-11-12 10:24:02,308 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_kgukd9sp_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_kgukd9sp', 'txt']
2025-11-12 10:24:02,530 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:24:02,535 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:24:09,883 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 10:24:18,332 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:24:29,332 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:24:44,790 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:26:42,743 - ispa_next.app_start.main - DEBUG - Operation already took 106.89 seconds (more than 80 seconds)
2025-11-12 10:26:44,800 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_98melweu_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_98melweu', 'txt']
2025-11-12 10:26:45,031 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:26:45,036 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:26:45,037 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:28:43,551 - ispa_next.app_start.main - DEBUG - Operation already took 106.24 seconds (more than 80 seconds)
2025-11-12 10:28:45,611 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_8e_t08m4_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_8e_t08m4', 'txt']
2025-11-12 10:28:45,846 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:28:45,851 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:28:52,958 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-12 10:29:00,662 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:29:12,099 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:29:27,735 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:31:25,331 - ispa_next.app_start.main - DEBUG - Operation already took 106.51 seconds (more than 80 seconds)
2025-11-12 10:31:27,390 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_wrp7u6pf_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e5531ef2ab615790\\tess_wrp7u6pf', 'txt']
2025-11-12 10:31:27,622 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:31:27,626 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:31:27,627 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:31:53,851 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:32:08,294 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:32:10,732 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:32:11,836 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 565
2025-11-12 10:32:11,837 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-12 10:32:14,226 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 67
2025-11-12 10:32:14,227 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:32:14,228 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:32:15,463 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:32:16,659 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:32:25,813 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:32:25,819 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:32:25,830 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:32:25,857 - ispa_next.appointments.models - DEBUG - Appointment Hiltrud Marx WI-XM 25 WMWWJ910003L15788 ohne Termin.
2025-11-12 10:32:25,875 - ispa_next.appointments.models - DEBUG - Appointment Masoumeh Rashvand Sardari GG-SH 141 WBA2V110009C09071 ohne Termin.
2025-11-12 10:32:25,902 - ispa_next.main - DEBUG - Found 15 out of 55 appointments to process (configured limit: 15).
2025-11-12 10:32:25,903 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-12 10:32:25,903 - ispa_next.main - DEBUG - Processing 0 already visited appointments (w/ RKR not callable).
2025-11-12 10:32:25,903 - ispa_next.main - DEBUG - All appointments: MTK-JJ 866, GG-ME 1501, GG-Z 596, F-RK 148, KEIN KENNZEICHEN, GG-KP 81, B-DL4900, GG-CD210E, gg rc 6262, GG XX 317E, GG HK 3011, GG-KF-31, GG-LA9617, HH-PA 1288, GG-MB 744
2025-11-12 10:32:25,905 - ispa_next.main - DEBUG - 



2025-11-12 10:32:25,905 - ispa_next.main - DEBUG - starting with process 1 (MTK-JJ 866) of 15
2025-11-12 10:32:25,927 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:32:26,994 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:32:28,112 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 565
2025-11-12 10:32:28,113 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 67
2025-11-12 10:32:29,376 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:32:29,378 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:32:53,229 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:33:03,151 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:33:04,376 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:33:04,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:04,454 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:33:04,644 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:33:04,647 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:33:04,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:04,799 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:33:14,642 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:33:14,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:33:15,501 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:33:17,524 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:33:17,614 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:33:20,833 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:33:20,909 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:33:25,092 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:33:26,098 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:33:26,099 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:26,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:37,882 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:33:37,882 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:33:45,010 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:33:45,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:45,096 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:33:45,097 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:33:45,155 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:33:45,249 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:33:46,594 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:33:46,882 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:33:52,168 - ispa_next.functions - DEBUG - Updated appointment (AK00021349) customer contact data.
2025-11-12 10:33:53,090 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:33:53,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:53,206 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:33:53,318 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 10:33:53,320 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:33:53,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:33:54,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:33:55,494 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:33:55,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:33:55,573 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:33:59,160 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:33:59,160 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:33:59,163 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:33:59,163 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:33:59,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:33:59,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:34:03,779 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:34:03,784 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:34:03,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:34:03,855 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:34:04,247 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:34:04,710 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:34:04,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:34:05,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:34:05,383 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:34:07,240 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:34:07,242 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:34:08,212 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:34:08,213 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:34:08,215 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:34:08,216 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 10:34:08,217 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:34:08,219 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:34:08,220 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:34:08,227 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:34:08,231 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:34:08,236 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:34:08,238 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:34:08,240 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:34:08,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:34:09,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:34:22,359 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:34:22,362 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:34:22,363 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:34:22,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:24,932 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:34:24,934 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:34:24,936 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:27,464 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:34:27,465 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:34:27,466 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:34:27,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:29,968 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:34:41,762 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:34:42,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:34:43,102 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:34:43,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:49,919 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:34:53,315 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:34:57,672 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:34:57,674 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:34:57,675 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:34:58,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:34:58,372 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:34:58,373 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:35:00,576 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:35:08,669 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:35:09,064 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:35:09,607 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:35:10,175 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 566
2025-11-12 10:35:10,176 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:35:13,172 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-12 10:35:13,173 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:35:13,962 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 10:35:13,972 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 10:35:13,977 - ispa_next.main - DEBUG - Found new Appointment: GG-YI 68
2025-11-12 10:35:13,978 - ispa_next.main - DEBUG - 



2025-11-12 10:35:13,979 - ispa_next.main - DEBUG - starting with process 2 (GG-YI 68) of 16
2025-11-12 10:35:13,982 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:35:15,204 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:35:16,152 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 566
2025-11-12 10:35:16,153 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 104
2025-11-12 10:35:17,452 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:35:17,453 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:35:39,017 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:35:48,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:48,441 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:35:48,639 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:50,548 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:35:50,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:50,621 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:35:50,808 - ispa_next.functions - DEBUG - HU date already expired after 426 days.
2025-11-12 10:35:57,410 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:35:57,413 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:35:57,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:57,547 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:36:06,854 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:36:06,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:36:07,749 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:36:09,753 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:36:09,840 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:36:13,124 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:36:13,231 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:36:13,231 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:36:21,391 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:36:22,396 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:36:22,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:22,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:36,174 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:36:43,640 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:36:43,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:43,744 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:36:43,745 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:36:43,780 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:36:44,017 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:36:45,186 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:36:45,407 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:36:48,077 - ispa_next.functions - DEBUG - Updated appointment (AK00021351) customer contact data.
2025-11-12 10:36:48,977 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:36:48,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:49,112 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:36:49,254 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 10:36:49,256 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:36:49,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:36:50,230 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:36:51,679 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:36:51,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:36:51,756 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:36:56,216 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:36:56,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:36:56,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:36:58,731 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:36:58,842 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:36:58,952 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:36:59,031 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:36:59,032 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:37:07,488 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:38:07,491 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:38:19,015 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:38:23,200 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:38:23,201 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:38:27,370 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:38:28,376 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:38:28,377 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:38:28,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:28,497 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:38:32,589 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:38:32,593 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:38:32,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:32,665 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:38:33,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:33,547 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:33,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:34,165 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:38:34,166 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:38:37,153 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:38:37,155 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:38:38,384 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:38:38,386 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:38:38,388 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:38:38,389 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 10:38:38,390 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:38:38,392 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:38:38,393 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:38:38,394 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:38:38,396 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:38:38,397 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:38:38,398 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:38:38,400 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:38:39,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:38:39,792 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:38:52,359 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:38:52,361 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:38:52,363 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:38:52,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:56,309 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:38:56,311 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:38:56,318 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:00,214 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:39:00,215 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:39:00,216 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:39:00,227 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:04,111 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:39:17,163 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:39:17,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:39:18,489 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:39:18,633 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:26,282 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:29,792 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:33,206 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:37,358 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:41,350 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:41,352 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:39:41,353 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:39:42,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:39:42,137 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:39:42,138 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:39:43,817 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:39:51,710 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:39:52,082 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:39:52,732 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:39:53,370 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 567
2025-11-12 10:39:53,371 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:39:56,258 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 106
2025-11-12 10:39:56,262 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:39:57,004 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 10:39:57,013 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 10:39:57,017 - ispa_next.main - DEBUG - Found new Appointment: F-ML 1777E
2025-11-12 10:39:57,019 - ispa_next.main - DEBUG - 



2025-11-12 10:39:57,019 - ispa_next.main - DEBUG - starting with process 3 (F-ML 1777E) of 17
2025-11-12 10:39:57,022 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:39:58,210 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:39:59,350 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 567
2025-11-12 10:39:59,351 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 106
2025-11-12 10:40:00,674 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:40:00,675 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:40:27,417 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:40:36,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:40:36,375 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:40:36,540 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:40:37,781 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:40:37,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:40:37,874 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:40:38,117 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:40:38,120 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:40:38,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:40:38,212 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:40:41,365 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:40:41,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:40:42,309 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:40:44,312 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:40:44,402 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:40:47,619 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:40:47,711 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:40:47,711 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:40:55,781 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:40:56,786 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:40:56,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:40:57,285 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:07,538 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:41:14,608 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:41:14,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:14,701 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:14,702 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:41:14,741 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:41:15,937 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:41:16,146 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:41:21,475 - ispa_next.functions - DEBUG - Updated appointment (AK00021352) customer contact data.
2025-11-12 10:41:22,426 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:41:22,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:22,590 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:22,759 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 10:41:22,761 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:41:23,474 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:41:23,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:41:24,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:41:27,780 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:41:27,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:41:28,278 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:41:30,289 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:41:30,410 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:41:30,529 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:41:30,613 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:41:30,613 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:41:38,823 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:42:38,826 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:42:49,974 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:42:54,097 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:42:54,098 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:42:58,242 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:42:59,280 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:42:59,281 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:42:59,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:42:59,347 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:43:03,461 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:43:03,464 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:43:03,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:43:03,542 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:43:12,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:43:13,356 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:43:13,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:43:14,284 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:43:14,285 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:43:15,559 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:43:15,562 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:43:16,408 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:43:16,410 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:43:16,412 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:43:16,414 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 10:43:16,415 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:43:16,417 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:43:16,418 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:43:16,419 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:43:16,420 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:43:16,421 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:43:16,422 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:43:16,423 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:43:17,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:43:17,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:43:29,824 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:43:29,826 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:43:29,828 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:43:29,828 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:31,785 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:43:34,247 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:43:34,250 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:43:34,261 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:36,367 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:43:36,369 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:43:36,371 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:43:36,374 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:38,305 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:43:50,311 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:43:50,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:43:51,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:43:51,821 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:57,533 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:44:01,567 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:44:01,570 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:44:01,570 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:44:02,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:44:02,297 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:44:02,298 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:44:04,087 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:44:11,242 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:44:11,610 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:44:12,297 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:44:12,884 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 10:44:12,886 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:44:15,981 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 107
2025-11-12 10:44:15,982 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:44:16,825 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 10:44:16,835 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 10:44:16,842 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 10:44:16,847 - ispa_next.main - DEBUG - 



2025-11-12 10:44:16,847 - ispa_next.main - DEBUG - starting with process 4 (GG-ME 1501) of 17
2025-11-12 10:44:16,850 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:44:17,955 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:44:19,191 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 10:44:19,192 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 107
2025-11-12 10:44:20,401 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:44:20,402 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:44:42,249 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:44:51,621 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:51,731 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:44:51,850 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:44:55,117 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:44:55,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:55,180 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:44:55,346 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:45:01,445 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:45:01,447 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:45:01,449 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:01,536 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:45:11,755 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:45:11,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:45:12,903 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:45:14,909 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:45:15,020 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:45:18,228 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:45:18,294 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:45:18,295 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:45:26,980 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:45:27,985 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:45:27,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:28,483 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:41,595 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:45:48,326 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:45:48,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:48,399 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:45:48,400 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:45:48,449 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:45:48,548 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:45:49,564 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:45:50,705 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:45:50,983 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:45:55,797 - ispa_next.functions - DEBUG - Updated appointment (AK00021347) customer contact data.
2025-11-12 10:45:56,706 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:45:56,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:56,773 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:45:56,949 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 10:45:56,951 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:45:57,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:45:57,748 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:45:59,300 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:45:59,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:45:59,373 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:46:03,805 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:46:03,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:46:04,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:46:06,332 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:46:06,460 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:46:06,552 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:46:06,618 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:46:06,619 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:46:15,016 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:47:15,019 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:47:23,027 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:47:43,031 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:47:51,062 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:47:59,203 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 10:48:00,211 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:48:00,212 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:48:00,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:48:00,352 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:48:04,491 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:48:04,496 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:48:04,496 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 10:48:04,497 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:48:08,674 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:48:08,675 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:48:09,777 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:48:09,779 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:48:09,781 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:48:09,783 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 10:48:09,785 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:48:09,789 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:48:09,790 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:48:09,791 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:48:09,792 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:48:09,793 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:48:09,795 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:48:09,796 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:48:10,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:48:11,231 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:48:23,801 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:48:23,803 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:48:23,804 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:48:23,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:48:29,038 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:48:29,040 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:48:29,041 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:48:34,302 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:48:34,303 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:48:34,305 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:48:34,308 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:48:39,541 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:48:52,913 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:48:53,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:48:54,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:48:54,361 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:49:03,613 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:49:07,688 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:49:11,534 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:49:15,660 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:49:19,538 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:49:23,694 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:49:28,006 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:49:28,007 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:49:28,008 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:49:28,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:49:28,545 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:49:28,546 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:49:29,866 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:49:37,506 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:49:37,889 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:49:38,605 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:49:39,270 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 10:49:39,272 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:49:41,790 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 107
2025-11-12 10:49:41,791 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:49:42,568 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 10:49:42,579 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 10:49:42,594 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 10:49:42,599 - ispa_next.main - DEBUG - 



2025-11-12 10:49:42,599 - ispa_next.main - DEBUG - starting with process 5 (GG-Z 596) of 17
2025-11-12 10:49:42,602 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:49:43,706 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:49:45,009 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 10:49:45,010 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 107
2025-11-12 10:49:46,450 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:49:46,451 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:50:10,507 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:50:20,225 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:50:21,476 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:50:21,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:50:21,721 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:50:22,205 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:50:28,654 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:50:28,656 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:50:28,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:50:28,753 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:50:38,868 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:50:38,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:50:39,896 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:50:41,908 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:50:42,013 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:50:45,288 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:50:45,366 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:50:45,366 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:50:53,685 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:50:54,690 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:50:54,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:50:55,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:51:08,212 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:51:15,671 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:51:15,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:51:15,766 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:51:15,767 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:51:15,802 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:51:17,054 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:51:17,287 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:51:21,920 - ispa_next.functions - DEBUG - Updated appointment (AI00026199) customer contact data.
2025-11-12 10:51:22,840 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:51:22,840 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:51:22,944 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:51:23,080 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 10:51:23,082 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:51:23,741 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:51:23,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:51:24,427 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:51:28,966 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:51:28,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:51:29,475 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:51:31,479 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:51:31,579 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:51:31,758 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:51:32,016 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:51:32,016 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:51:42,855 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:51:47,133 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:51:47,133 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:51:51,367 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:51:52,373 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:51:52,373 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:51:52,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:51:52,497 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:51:56,613 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:51:56,616 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:51:56,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:51:56,710 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:51:57,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:51:57,615 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:51:57,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:51:58,277 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:51:58,277 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:52:00,111 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:52:00,113 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:52:01,117 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:52:01,122 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:52:01,124 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:52:01,126 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 10:52:01,128 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:52:01,131 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:52:01,132 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:52:01,133 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:52:01,135 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:52:01,136 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:52:01,137 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:52:01,139 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:52:01,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:52:02,680 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:52:15,234 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:52:15,236 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:52:15,238 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:52:15,238 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:52:17,816 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:52:17,818 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:52:17,820 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:52:20,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:52:20,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:52:32,320 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:52:44,885 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:52:44,886 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:52:44,888 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:52:44,890 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:52:47,440 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:53:00,385 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:53:01,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:53:01,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:53:01,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:53:08,632 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:53:14,174 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:53:14,174 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:53:14,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:53:14,867 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:53:14,868 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:53:18,423 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:53:26,262 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:53:26,669 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:53:27,696 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:53:28,269 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 10:53:28,270 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:53:31,396 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 108
2025-11-12 10:53:31,396 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:53:32,162 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 10:53:32,173 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 10:53:32,180 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 10:53:32,184 - ispa_next.main - DEBUG - 



2025-11-12 10:53:32,184 - ispa_next.main - DEBUG - starting with process 6 (F-RK 148) of 17
2025-11-12 10:53:32,188 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:53:33,343 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:53:34,439 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 10:53:34,440 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 108
2025-11-12 10:53:35,808 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:53:35,810 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:53:57,820 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:54:07,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:54:07,189 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:54:07,393 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:54:08,628 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:54:08,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:54:08,737 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:54:08,894 - ispa_next.functions - DEBUG - HU date already expired after 7 days.
2025-11-12 10:54:15,829 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:54:15,831 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:54:15,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:54:15,911 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:54:19,181 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:54:19,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:54:20,098 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:54:22,101 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:54:22,228 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:54:25,509 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:54:25,575 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:54:25,575 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:54:33,964 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:54:34,968 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:54:34,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:54:35,482 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:54:47,009 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:54:54,045 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:54:54,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:54:54,141 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:54:54,141 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:54:54,187 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:54:55,388 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:54:56,795 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:54:57,950 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:54:58,367 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:55:03,205 - ispa_next.functions - DEBUG - Updated appointment (AK00021332) customer contact data.
2025-11-12 10:55:04,108 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:55:04,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:55:04,388 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:55:04,574 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 10:55:04,575 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:55:05,378 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:55:05,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:55:06,071 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:55:10,109 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:55:10,109 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:55:10,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:55:10,634 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:55:12,637 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:55:12,762 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:55:12,896 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:55:12,984 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:55:12,984 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:55:21,189 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:56:21,191 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:56:29,558 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:56:58,561 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:57:06,777 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:57:14,473 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 10:57:15,480 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:57:15,481 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:57:15,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:57:15,557 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:57:19,705 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:57:19,709 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:57:19,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:57:19,800 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:57:25,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:57:25,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:57:25,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:57:26,645 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:57:26,646 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:57:27,957 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:57:27,959 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:57:28,976 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:57:28,977 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:57:28,978 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:57:28,980 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 10:57:28,981 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:57:28,982 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:57:28,983 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:57:28,984 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:57:28,985 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:57:28,986 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:57:28,988 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:57:28,994 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:57:29,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:57:30,609 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:57:43,260 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:57:43,262 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:57:43,263 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:57:43,263 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:57:45,229 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:57:47,801 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:57:47,803 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:57:47,806 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:57:49,787 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:57:49,790 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:57:49,791 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:57:49,793 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:57:51,704 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:58:04,953 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:58:05,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:58:06,220 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:58:06,426 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:58:12,250 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:58:16,572 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:58:16,574 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:58:16,575 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:58:17,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:58:17,317 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:58:17,318 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:58:19,154 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:58:26,594 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:58:26,978 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:58:27,703 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:58:28,288 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 569
2025-11-12 10:58:28,289 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:58:31,316 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 109
2025-11-12 10:58:31,317 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:58:32,058 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 10:58:32,068 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 10:58:32,072 - ispa_next.main - DEBUG - Found new Appointment: D-SV 430 E
2025-11-12 10:58:32,073 - ispa_next.main - DEBUG - 



2025-11-12 10:58:32,073 - ispa_next.main - DEBUG - starting with process 7 (D-SV 430 E) of 18
2025-11-12 10:58:32,076 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:58:33,284 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:58:34,310 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 569
2025-11-12 10:58:34,311 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 109
2025-11-12 10:58:35,832 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:58:35,833 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:58:58,420 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:59:08,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:59:08,451 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:59:08,645 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:59:10,578 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:59:10,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:59:10,666 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:59:10,836 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:59:10,839 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:59:10,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:59:10,913 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:59:13,829 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:59:13,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:59:14,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:59:16,779 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:59:16,893 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:59:20,110 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:59:20,203 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:59:20,204 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:59:28,489 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:59:29,494 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:59:29,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:59:29,998 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:59:41,522 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:59:49,071 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:59:49,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:59:49,155 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:59:49,156 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:59:49,224 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:59:50,487 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:59:51,449 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:59:51,678 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:59:57,400 - ispa_next.functions - DEBUG - Updated appointment (AK00021362) customer contact data.
2025-11-12 10:59:58,295 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:59:58,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:59:58,392 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:00:00,199 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:00:01,206 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:00:01,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:00:01,907 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:00:05,520 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:00:05,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:00:06,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:00:08,005 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:00:08,184 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:00:08,331 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:00:08,442 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:00:08,442 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:00:19,457 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:00:23,487 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:00:23,487 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:00:27,717 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:00:28,724 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:00:28,725 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:00:28,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:00:28,795 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:00:32,952 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:00:32,967 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:00:32,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:00:33,155 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:00:37,433 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 11:00:46,571 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:00:46,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:00:47,611 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:00:47,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:00:48,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:00:48,318 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:00:50,197 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:00:50,198 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:00:51,114 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:00:51,116 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:00:51,118 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:00:51,120 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-12 11:00:51,123 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:00:51,127 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:00:51,127 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:00:51,128 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:00:51,130 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:00:51,131 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:00:51,132 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:00:51,134 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:00:51,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:00:52,520 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:01:26,677 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:01:26,729 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-12 11:01:32,313 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:01:32,315 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:01:32,316 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:01:35,583 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:01:35,584 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:01:35,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:01:39,002 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:01:39,004 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:01:39,005 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:01:39,007 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:01:42,289 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:01:54,177 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:01:54,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:01:55,543 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:01:55,677 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:02:03,670 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:02:08,019 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:02:11,814 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:02:16,553 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:02:22,312 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:02:22,313 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:02:23,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:02:23,137 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:02:23,138 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:02:26,834 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:02:35,868 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:02:36,257 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:02:37,170 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:37,914 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 569
2025-11-12 11:02:37,915 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:02:41,104 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 109
2025-11-12 11:02:41,105 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:02:41,841 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:02:41,861 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 11:02:41,867 - ispa_next.main - DEBUG - 



2025-11-12 11:02:41,867 - ispa_next.main - DEBUG - starting with process 8 (KEIN KENNZEICHEN) of 18
2025-11-12 11:02:41,870 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:02:43,001 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:44,099 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 569
2025-11-12 11:02:44,101 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 109
2025-11-12 11:02:45,610 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:02:45,611 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:03:06,204 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:03:15,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:15,375 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:15,488 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:03:16,689 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:03:16,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:16,754 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:16,911 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:03:23,112 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:03:23,114 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:03:23,115 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:23,202 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:26,228 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:03:26,230 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:03:27,293 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:03:29,296 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:03:29,442 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:03:29,546 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:03:29,643 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:03:29,643 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:03:40,942 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:03:45,130 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:03:45,130 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:03:49,356 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:03:50,362 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:03:50,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:50,867 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:01,980 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:04:08,679 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:04:08,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:08,744 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:04:08,744 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:04:08,776 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:04:09,976 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:04:10,200 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:04:16,133 - ispa_next.functions - DEBUG - Updated appointment (AK00021327) customer contact data.
2025-11-12 11:04:17,071 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:04:17,072 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:17,221 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:04:17,404 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:04:17,406 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:04:18,109 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:04:18,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:04:18,871 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:04:22,487 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:04:22,488 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:04:22,491 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:04:22,492 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:04:22,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:23,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:04:27,169 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:04:27,172 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:04:27,172 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 11:04:27,173 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:04:28,446 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:04:28,448 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:04:29,380 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:04:29,382 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:04:29,384 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:04:29,385 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 11:04:29,386 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:04:29,388 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:04:29,389 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:04:29,390 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:04:29,392 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:04:29,400 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:04:29,406 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:04:29,408 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:04:30,128 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:04:30,886 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:04:43,943 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:04:43,945 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:04:43,947 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:04:43,947 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:45,851 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:04:45,853 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:04:45,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:47,682 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:04:47,684 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:04:47,685 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:04:47,687 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:49,583 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:05:01,024 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:05:01,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:05:02,264 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:05:02,376 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:09,959 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:05:13,932 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:05:13,934 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:05:13,934 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:05:14,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:05:14,468 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:05:14,469 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:05:15,873 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:05:22,470 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:05:22,849 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:05:23,552 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:05:24,126 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:05:24,127 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:05:26,403 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 108
2025-11-12 11:05:26,403 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:05:27,083 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:05:27,092 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 11:05:27,099 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 11:05:27,102 - ispa_next.main - DEBUG - 



2025-11-12 11:05:27,102 - ispa_next.main - DEBUG - starting with process 9 (GG-KP 81) of 18
2025-11-12 11:05:27,106 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:05:27,984 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:05:28,946 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:05:28,947 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 108
2025-11-12 11:05:30,206 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:05:30,208 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:05:56,662 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:06:06,384 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:06:10,404 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:06:10,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:10,485 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:06:10,666 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:06:16,631 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:06:16,634 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:06:16,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:16,704 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:06:19,886 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:06:19,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:06:21,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:06:23,095 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:06:23,360 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:06:26,562 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:06:26,685 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:06:30,858 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:06:31,867 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:06:31,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:32,305 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:46,446 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:06:53,343 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:06:53,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:53,404 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:06:53,404 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:06:53,475 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:06:54,632 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:06:55,763 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:06:56,014 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:07:01,937 - ispa_next.functions - DEBUG - Updated appointment (AK00021326) customer contact data.
2025-11-12 11:07:02,882 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:07:02,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:02,957 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:07:03,087 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:07:03,089 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:07:03,894 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:07:03,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:07:04,691 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:07:08,299 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:07:08,299 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:07:08,303 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:07:08,303 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:07:08,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:07:08,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:07:12,949 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:07:13,733 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:07:30,627 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:07:30,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:07:30,810 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:07:38,909 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:39,454 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:39,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:07:40,362 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:07:40,363 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:07:44,002 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:07:44,004 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:07:45,203 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:07:45,206 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:07:45,208 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:07:45,211 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 11:07:45,213 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:07:45,215 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:07:45,216 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:07:45,217 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:07:45,219 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:07:45,220 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:07:45,222 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:07:45,224 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:07:45,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:07:46,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:08:01,004 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:08:01,007 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:08:01,011 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:08:01,012 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:05,792 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:08:08,843 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:08:08,953 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:08:08,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:14,001 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:08:14,003 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:08:14,004 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:08:14,006 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:18,931 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:08:37,468 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:08:38,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:08:39,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:08:39,344 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:49,216 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:08:54,916 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:09:04,044 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:09:04,045 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:09:05,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:09:05,214 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:09:05,216 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:09:10,324 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:09:21,850 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:09:22,255 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:09:24,211 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:25,208 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:09:25,209 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:30,298 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 108
2025-11-12 11:09:30,298 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:31,525 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:09:31,537 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 11:09:31,547 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 11:09:31,551 - ispa_next.main - DEBUG - 



2025-11-12 11:09:31,551 - ispa_next.main - DEBUG - starting with process 10 (B-DL4900) of 18
2025-11-12 11:09:31,556 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:09:33,211 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:34,674 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:09:34,675 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 108
2025-11-12 11:09:36,609 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:36,610 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:13,617 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:10:13,729 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 11:10:13,734 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:14,505 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:10:14,507 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:18,778 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 108
2025-11-12 11:10:18,779 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:20,008 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:10:20,018 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 11:10:20,028 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 11:10:20,033 - ispa_next.main - DEBUG - 



2025-11-12 11:10:20,034 - ispa_next.main - DEBUG - starting with process 11 (GG-CD210E) of 18
2025-11-12 11:10:20,047 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:10:21,881 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:23,904 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:10:23,905 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 108
2025-11-12 11:10:26,018 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-12 11:10:26,019 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:26,442 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 42, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 146, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-12 11:10:26,442 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 11:10:26,446 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:27,372 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:10:27,374 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-12 11:10:31,685 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 108
2025-11-12 11:10:31,686 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:32,756 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:10:32,764 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 11:10:32,772 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 11:10:32,775 - ispa_next.main - DEBUG - 



2025-11-12 11:10:32,775 - ispa_next.main - DEBUG - starting with process 12 (gg rc 6262) of 18
2025-11-12 11:10:32,779 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:10:34,106 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:36,281 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:10:36,283 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 108
2025-11-12 11:10:38,339 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:38,340 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:17,482 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:11:17,494 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 11:11:17,498 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:18,298 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:11:18,299 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:22,219 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 108
2025-11-12 11:11:22,220 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:23,997 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:11:24,008 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 11:11:24,016 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 11:11:24,024 - ispa_next.main - DEBUG - 



2025-11-12 11:11:24,024 - ispa_next.main - DEBUG - starting with process 13 (GG XX 317E) of 18
2025-11-12 11:11:24,029 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:25,922 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:27,796 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:11:27,797 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 108
2025-11-12 11:11:29,994 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:29,996 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:07,315 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:12:07,326 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 11:12:07,330 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:12:08,162 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:12:08,163 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:12:12,630 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 108
2025-11-12 11:12:12,631 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:13,860 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:12:13,871 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 11:12:13,880 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 11:12:13,884 - ispa_next.main - DEBUG - 



2025-11-12 11:12:13,884 - ispa_next.main - DEBUG - starting with process 14 (GG HK 3011) of 18
2025-11-12 11:12:13,890 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:12:15,689 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:12:17,320 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:12:17,321 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 108
2025-11-12 11:12:19,496 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:12:19,497 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:57,778 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:12:57,789 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 11:12:57,794 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:12:58,601 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:12:58,602 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:03,122 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 108
2025-11-12 11:13:03,123 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:04,323 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:13:04,334 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 11:13:04,343 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 11:13:04,347 - ispa_next.main - DEBUG - 



2025-11-12 11:13:04,347 - ispa_next.main - DEBUG - starting with process 15 (GG-KF-31) of 18
2025-11-12 11:13:04,351 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:06,158 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:07,958 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:13:07,959 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 108
2025-11-12 11:13:10,169 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:10,170 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:48,804 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:13:48,816 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 11:13:48,820 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:49,711 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:13:49,715 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:54,102 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 108
2025-11-12 11:13:54,103 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:55,297 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:13:55,307 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 11:13:55,316 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 11:13:55,320 - ispa_next.main - DEBUG - 



2025-11-12 11:13:55,320 - ispa_next.main - DEBUG - starting with process 16 (GG-LA9617) of 18
2025-11-12 11:13:55,324 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:56,857 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:58,303 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:13:58,305 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 108
2025-11-12 11:14:00,512 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:00,513 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:37,269 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:14:37,279 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 11:14:37,283 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:37,942 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:14:37,943 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:41,838 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 108
2025-11-12 11:14:41,840 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:42,843 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:14:42,853 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 11:14:42,862 - ispa_next.appointments.models - DEBUG - Appointment Heiko Kummich MTK-KM 127 WBAWZ510100L09503 ohne Termin.
2025-11-12 11:14:42,866 - ispa_next.main - DEBUG - 



2025-11-12 11:14:42,866 - ispa_next.main - DEBUG - starting with process 17 (HH-PA 1288) of 18
2025-11-12 11:14:42,870 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:44,251 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:45,855 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 568
2025-11-12 11:14:45,856 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 108
2025-11-12 11:14:47,595 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:47,596 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:22,786 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:15:36,438 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:44,897 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:15:44,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:44,994 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:15:45,410 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:15:45,413 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:15:45,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:45,526 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:15:49,114 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:15:49,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:15:50,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:15:52,945 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:15:53,091 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:15:56,333 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:15:56,451 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:15:56,451 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:16:05,772 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:16:06,777 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:16:06,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:07,307 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:23,103 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:16:34,303 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:16:34,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:34,400 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:16:34,401 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:16:34,470 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:16:35,784 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:16:37,009 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:16:37,262 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:16:43,026 - ispa_next.functions - DEBUG - Updated appointment (AN00017886) customer contact data.
2025-11-12 11:16:44,030 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:16:44,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:44,312 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:16:46,905 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:16:48,380 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:16:48,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:16:49,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:16:53,075 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:16:53,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:16:53,589 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:16:55,592 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:16:55,740 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:16:55,906 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:16:56,008 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:16:56,008 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:17:07,274 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:17:15,250 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:17:15,250 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:17:19,476 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:17:20,483 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:17:20,484 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:17:20,485 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:20,581 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:17:24,815 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:17:25,821 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:17:36,708 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:17:36,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:36,813 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:17:46,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:46,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:46,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:47,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:47,865 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:17:57,807 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:17:57,809 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:17:59,358 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:17:59,363 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:17:59,366 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:17:59,368 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 11:17:59,370 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:17:59,371 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:17:59,373 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:17:59,374 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:17:59,376 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:17:59,377 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:17:59,378 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:17:59,380 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:18:00,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:18:01,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:18:16,047 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:18:16,049 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:18:16,051 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:18:16,051 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:28,184 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:18:28,186 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:18:28,188 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:40,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:40,785 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:18:51,295 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:05,938 - ispa_next.common.utils - DEBUG - Attempt 1/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-12 11:19:05,938 - ispa_next.common.utils - DEBUG - Attempt 1/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 0.5s
2025-11-12 11:19:09,084 - ispa_next.common.utils - DEBUG - Attempt 2/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-12 11:19:09,084 - ispa_next.common.utils - DEBUG - Attempt 2/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 1.0s
2025-11-12 11:19:12,698 - ispa_next.common.utils - DEBUG - Attempt 3/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-12 11:19:12,698 - ispa_next.common.utils - DEBUG - Attempt 3/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 2.0s
2025-11-12 11:19:16,963 - ispa_next.common.utils - DEBUG - Attempt 4/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-12 11:19:16,963 - ispa_next.common.utils - DEBUG - Attempt 4/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 4.0s
2025-11-12 11:19:23,428 - ispa_next.common.utils - DEBUG - Attempt 5/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-12 11:19:23,428 - ispa_next.common.utils - DEBUG - Attempt 5/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 8.0s
2025-11-12 11:19:33,441 - ispa_next.common.utils - DEBUG - Attempt 6/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-12 11:19:33,726 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 118, in process_appointment
    f.verify_battery_in_motoroil_package(app, state)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\functions.py", line 1518, in verify_battery_in_motoroil_package
    insert_battery_to_motoroil_package(base_element, battery_no)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\functions.py", line 1537, in insert_battery_to_motoroil_package
    retry_ui_action(open_job_details_view, condition=job_details_view_exists, base_delay=0.5)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\utils.py", line 399, in retry_ui_action
    raise RetryUiActionError(f"UI action failed after {max_attempts} attempts: Condition never satisfied")
ispa_next.exceptions.RetryUiActionError: UI action failed after 6 attempts: Condition never satisfied

2025-11-12 11:19:33,750 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:19:33,752 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:19:35,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:19:36,209 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:19:36,211 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 11:19:36,234 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:19:41,118 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 11:19:41,122 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:19:41,936 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 569
2025-11-12 11:19:41,938 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:19:46,554 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 109
2025-11-12 11:19:46,555 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:47,821 - ispa_next.appointments.models - DEBUG - Appointment Peter Liebscher GG-BP 183 WMW51BR0003N61764 ohne Termin.
2025-11-12 11:19:47,830 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:19:47,844 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 11:19:47,849 - ispa_next.main - DEBUG - 



2025-11-12 11:19:47,849 - ispa_next.main - DEBUG - starting with process 18 (GG-MB 744) of 18
2025-11-12 11:19:47,853 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:19:49,528 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:19:51,169 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 569
2025-11-12 11:19:51,171 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 109
2025-11-12 11:19:53,420 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:19:53,421 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:20:22,406 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:20:35,080 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:37,041 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:20:37,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:37,174 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:37,495 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:20:37,499 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:20:37,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:37,584 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:54,370 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:20:54,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:54,656 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 11:20:54,957 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 11:20:54,973 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:20:54,974 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:20:55,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:20:56,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:20:56,704 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 11:20:56,730 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:21:00,611 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 11:21:00,614 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:21:01,406 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 569
2025-11-12 11:21:01,407 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:21:06,433 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 109
2025-11-12 11:21:06,434 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:21:07,647 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:21:07,657 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
2025-11-12 11:21:07,660 - ispa_next.main - DEBUG - Found new Appointment: GG-BP 183
2025-11-12 11:21:07,662 - ispa_next.main - DEBUG - 



2025-11-12 11:21:07,662 - ispa_next.main - DEBUG - starting with process 19 (GG-BP 183) of 19
2025-11-12 11:21:07,666 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:21:09,458 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:21:11,275 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 569
2025-11-12 11:21:11,276 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 109
2025-11-12 11:21:13,412 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:21:13,414 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:21:57,875 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:22:11,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:11,508 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:22:11,693 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:12,952 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:22:12,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:13,054 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:22:13,474 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:22:13,477 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:22:13,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:13,666 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:22:17,207 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:22:17,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:18,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:22:20,961 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:22:21,178 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:22:24,619 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:22:24,922 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:22:24,922 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:22:34,756 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:22:35,762 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:22:35,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:36,297 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:52,313 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:22:52,313 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:23:02,409 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:23:02,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:02,494 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:02,495 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:23:02,548 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:23:02,692 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:23:03,944 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:23:04,203 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:23:10,918 - ispa_next.functions - DEBUG - Updated appointment (AK00021370) customer contact data.
2025-11-12 11:23:11,904 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:23:11,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:12,145 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:12,368 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:23:12,370 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:23:12,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:23:13,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:23:15,352 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:23:15,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:23:15,633 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:23:20,215 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:23:20,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:23:21,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:23:23,115 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:23:23,340 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:23:23,518 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:23:23,693 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:23:23,693 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:23:33,063 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:24:33,065 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:24:44,355 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:24:49,239 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:24:49,239 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:24:53,471 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:24:54,482 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:24:54,483 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:24:54,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:54,578 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:24:58,753 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:24:58,758 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:24:58,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:58,852 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:25:07,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:07,579 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:07,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:08,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:25:08,400 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:25:11,006 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:25:11,008 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:25:12,114 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:25:12,115 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:25:12,117 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:25:12,118 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 11:25:12,120 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:25:12,122 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:25:12,123 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:25:12,123 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:25:12,125 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:25:12,126 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:25:12,128 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:25:12,129 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:25:12,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:25:13,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:25:27,881 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:25:27,883 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:25:27,885 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:25:27,886 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:31,395 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:25:31,396 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:25:31,398 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:34,798 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:25:34,800 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:25:34,802 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:25:34,804 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:38,225 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:25:56,341 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:25:56,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:25:57,743 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:25:57,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:08,725 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:26:14,581 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:26:20,387 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:26:26,356 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:26:26,358 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:26:26,359 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:26:27,143 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:26:27,223 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:26:27,225 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:26:29,647 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:26:39,519 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:26:39,949 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 11:26:41,555 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:26:42,470 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 569
2025-11-12 11:26:42,472 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:26:46,128 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 109
2025-11-12 11:26:46,129 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:26:47,372 - ispa_next.appointments.models - DEBUG - Appointment Tovilo Drago MTK-DD 550 WBA4E71040G549750 ohne Termin.
2025-11-12 11:26:47,383 - ispa_next.appointments.models - DEBUG - Appointment Jamila Jadran MTK-JJ 866 WBA71AA0705P47546 ohne Termin.
