2025-11-12 09:00:39,043 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 09:00:39,050 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 09:00:51,233 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:01:02,623 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:01:18,214 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:03:16,161 - ispa_next.app_start.main - DEBUG - Operation already took 106.58 seconds (more than 80 seconds)
2025-11-12 09:03:18,222 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_o_0_dn44_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_o_0_dn44', 'txt']
2025-11-12 09:03:18,500 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 09:03:18,505 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 09:03:18,506 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:05:17,437 - ispa_next.app_start.main - DEBUG - Operation already took 106.51 seconds (more than 80 seconds)
2025-11-12 09:05:19,501 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_huskq4r8_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_huskq4r8', 'txt']
2025-11-12 09:05:19,733 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 09:05:19,737 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 09:05:27,874 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 09:05:35,047 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:05:45,576 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:06:01,249 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:07:59,358 - ispa_next.app_start.main - DEBUG - Operation already took 107.03 seconds (more than 80 seconds)
2025-11-12 09:08:01,438 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_ggiveskq_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_ggiveskq', 'txt']
2025-11-12 09:08:01,674 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 09:08:01,680 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 09:08:01,681 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:10:01,012 - ispa_next.app_start.main - DEBUG - Operation already took 106.88 seconds (more than 80 seconds)
2025-11-12 09:10:03,094 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_g1odo0n4_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_g1odo0n4', 'txt']
2025-11-12 09:10:03,341 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 09:10:03,345 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 09:10:10,613 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 09:10:18,354 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:10:28,650 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:10:44,266 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:12:42,246 - ispa_next.app_start.main - DEBUG - Operation already took 106.92 seconds (more than 80 seconds)
2025-11-12 09:12:44,342 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_fc3amp8s_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_fc3amp8s', 'txt']
2025-11-12 09:12:44,600 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 09:12:44,605 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 09:12:44,606 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:14:43,746 - ispa_next.app_start.main - DEBUG - Operation already took 106.76 seconds (more than 80 seconds)
2025-11-12 09:14:45,841 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_zyo6lzk3_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_zyo6lzk3', 'txt']
2025-11-12 09:14:46,079 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 09:14:46,084 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 09:14:54,390 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-12 09:15:03,095 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:15:13,964 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:15:29,632 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:17:27,726 - ispa_next.app_start.main - DEBUG - Operation already took 107.06 seconds (more than 80 seconds)
2025-11-12 09:17:29,810 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_hjkmi0ao_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_hjkmi0ao', 'txt']
2025-11-12 09:17:30,041 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 09:17:30,046 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 09:17:30,047 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:19:29,637 - ispa_next.app_start.main - DEBUG - Operation already took 107.25 seconds (more than 80 seconds)
2025-11-12 09:19:31,714 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_uzuhukk3_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\792365d73188b9be\\tess_uzuhukk3', 'txt']
2025-11-12 09:19:31,956 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 09:19:31,961 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 09:19:39,823 - ispa_next.main - DEBUG - ISPA Next attempt (5 / 5)
2025-11-12 09:19:48,445 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:19:58,828 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:20:14,568 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:20:38,849 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 09:20:48,915 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 09:20:52,159 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:20:53,247 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:20:53,249 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 09:20:55,698 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 151
2025-11-12 09:20:55,699 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 09:20:55,700 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:20:56,905 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:20:58,101 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:21:19,757 - ispa_next.appointments.models - DEBUG - Appointment Mariya Aleksandrovna OS-UA 81 WBA4C11010G273031 ohne Termin.
2025-11-12 09:21:19,772 - ispa_next.appointments.models - DEBUG - Appointment Öezlem Cicek HF-OZ 84 WBA31AX010FP86133 ohne Termin.
2025-11-12 09:21:19,784 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-12 09:21:19,793 - ispa_next.appointments.models - DEBUG - Appointment Karlheinz Böttger HF-EK 2016 WBA2X71000V366813 ohne Termin.
2025-11-12 09:21:19,805 - ispa_next.main - DEBUG - Found 15 out of 36 appointments to process (configured limit: 15).
2025-11-12 09:21:19,806 - ispa_next.main - DEBUG - Processing 7 fresh appointments.
2025-11-12 09:21:19,806 - ispa_next.main - DEBUG - Processing 8 already visited appointments (w/ RKR not callable).
2025-11-12 09:21:19,806 - ispa_next.main - DEBUG - All appointments: BÜNDE, HF-LB-222, HF L 1612, OS-CW177, HF-BT 540, MI-JC 96 E, BÜNDE, HF-C 213, HF-C 213, HF-H 2227E, HF-AV 404, HF-GE 123, OS-BO 693, HF-EO 550E, HF-HB 922
2025-11-12 09:21:19,809 - ispa_next.main - DEBUG - 



2025-11-12 09:21:19,809 - ispa_next.main - DEBUG - starting with process 1 (BÜNDE) of 15
2025-11-12 09:21:19,813 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:21:20,872 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:21,967 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:21:21,968 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 151
2025-11-12 09:21:23,291 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:21:23,292 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:21:57,221 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:21:57,295 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 09:21:57,298 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:57,666 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:21:57,668 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:21:59,594 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 341
2025-11-12 09:21:59,595 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:00,291 - ispa_next.main - DEBUG - Found new Appointment: HF-D 2305
2025-11-12 09:22:00,291 - ispa_next.main - DEBUG - Found new Appointment: HF S 1105E
2025-11-12 09:22:00,293 - ispa_next.main - DEBUG - 



2025-11-12 09:22:00,293 - ispa_next.main - DEBUG - starting with process 2 (HF-D 2305) of 17
2025-11-12 09:22:00,296 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:22:01,153 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:22:02,068 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:22:02,069 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 09:22:03,134 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:03,135 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:24,407 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:22:33,158 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:22:35,017 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:22:35,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:22:35,085 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:22:35,272 - ispa_next.functions - DEBUG - HU date already expired after 383 days.
2025-11-12 09:22:42,148 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:22:42,151 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:22:42,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:22:42,241 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:22:52,707 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:22:52,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:22:53,598 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:22:55,600 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:22:55,699 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:22:58,929 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:22:59,002 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:23:03,194 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:23:04,200 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:23:04,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:04,665 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:16,497 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:23:24,034 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:23:24,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:24,103 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:23:24,105 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:23:24,227 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:23:24,327 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:23:25,603 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:23:25,863 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:23:29,212 - ispa_next.functions - DEBUG - Updated appointment (AA00044490) customer contact data.
2025-11-12 09:23:30,126 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:23:30,128 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:23:30,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:23:31,036 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:23:32,595 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:23:32,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:23:32,675 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:23:36,324 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:23:36,324 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:23:36,327 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:23:36,330 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:23:36,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:36,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:40,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:40,894 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:40,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:41,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:41,589 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:23:43,997 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:23:43,999 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:23:44,998 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:23:44,999 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:23:45,001 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:23:45,002 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart)}
2025-11-12 09:23:45,003 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:23:45,005 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:23:45,006 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:23:45,007 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:23:45,009 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:23:45,018 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:23:45,023 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:23:45,025 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 09:24:14,636 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 09:24:14,638 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:24:14,640 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:24:14,641 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:18,015 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 09:24:20,632 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:24:20,633 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:24:20,644 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:24,144 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:24:24,145 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:24:24,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:24:24,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:24:25,011 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:35,462 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:24:35,463 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:38,748 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:24:38,751 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:24:39,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:24:39,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:24:39,881 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:46,729 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:24:51,060 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:24:56,212 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:24:56,213 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:24:56,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:24:56,931 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:24:56,931 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:24:59,943 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:25:09,335 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:25:09,718 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 09:25:10,171 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:25:11,300 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:25:11,300 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:25:14,222 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 341
2025-11-12 09:25:14,223 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:25:15,123 - ispa_next.main - DEBUG - 



2025-11-12 09:25:15,123 - ispa_next.main - DEBUG - starting with process 3 (HF S 1105E) of 17
2025-11-12 09:25:15,127 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:25:16,256 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:25:17,372 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:25:17,373 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 09:25:18,714 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:25:18,716 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:25:49,436 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:25:49,447 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 09:25:49,450 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:25:49,928 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:25:49,929 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:25:52,424 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 341
2025-11-12 09:25:52,425 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:25:53,297 - ispa_next.main - DEBUG - 



2025-11-12 09:25:53,298 - ispa_next.main - DEBUG - starting with process 4 (HF-LB-222) of 17
2025-11-12 09:25:53,301 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:25:54,448 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:25:55,750 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:25:55,752 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 09:25:56,877 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:25:56,878 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:26:28,525 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:26:28,535 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 09:26:28,539 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:26:28,971 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:26:28,973 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:26:31,010 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 341
2025-11-12 09:26:31,011 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:26:31,702 - ispa_next.main - DEBUG - 



2025-11-12 09:26:31,702 - ispa_next.main - DEBUG - starting with process 5 (HF L 1612) of 17
2025-11-12 09:26:31,706 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:26:32,548 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:26:33,408 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:26:33,410 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 09:26:34,576 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:26:34,577 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:27:03,834 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:27:03,845 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 09:27:03,848 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:27:04,268 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:27:04,269 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:27:06,831 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 341
2025-11-12 09:27:06,832 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:27:07,637 - ispa_next.main - DEBUG - 



2025-11-12 09:27:07,637 - ispa_next.main - DEBUG - starting with process 6 (OS-CW177) of 17
2025-11-12 09:27:07,641 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:27:08,735 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:27:09,953 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:27:09,955 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 09:27:11,248 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:27:11,250 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:27:41,932 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:27:41,942 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 09:27:41,946 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:27:42,392 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:27:42,393 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:27:44,755 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 341
2025-11-12 09:27:44,757 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:27:45,527 - ispa_next.main - DEBUG - 



2025-11-12 09:27:45,527 - ispa_next.main - DEBUG - starting with process 7 (HF-BT 540) of 17
2025-11-12 09:27:45,530 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:27:46,590 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:27:47,773 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:27:47,774 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 09:27:49,135 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:27:49,136 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:28:13,433 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:28:23,674 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:28:27,643 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:28:27,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:27,723 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:28:28,005 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:28:28,008 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:28:28,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:28,097 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:28:31,298 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:28:31,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:28:32,472 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:28:34,477 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:28:34,596 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:28:37,837 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:28:37,899 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:28:37,900 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:28:46,192 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:28:47,196 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:28:47,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:47,689 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:58,139 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:28:58,139 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:29:05,106 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:29:05,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:05,210 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:29:05,211 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:29:05,252 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:29:06,448 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:29:06,659 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:29:09,772 - ispa_next.functions - DEBUG - Updated appointment (AE00024535) customer contact data.
2025-11-12 09:29:10,686 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:29:10,688 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:29:11,554 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:29:11,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:29:12,279 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:29:15,885 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:29:15,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:29:16,391 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:29:18,395 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:29:18,514 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:29:18,629 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:29:18,700 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:29:18,700 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:29:30,111 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 09:29:34,216 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:29:34,216 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:29:38,377 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:29:39,390 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:29:39,392 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:29:39,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:29:39,471 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:29:48,806 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 09:29:54,265 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 09:29:54,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:54,994 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:54,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:29:55,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:29:55,745 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:29:59,307 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:29:59,309 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:30:00,383 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:30:00,396 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:30:00,398 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:30:00,399 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:30:00,400 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 09:30:00,401 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:30:00,403 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:30:00,404 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:30:00,405 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:30:00,407 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:30:00,408 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:30:00,409 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:30:00,411 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 09:30:22,666 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-12 09:30:22,693 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:30:22,694 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:30:23,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:30:24,336 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:30:24,337 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 09:30:24,362 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 09:30:27,271 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 09:30:27,274 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:30:27,730 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:30:27,730 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:30:30,682 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 341
2025-11-12 09:30:30,683 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:30:31,524 - ispa_next.main - DEBUG - 



2025-11-12 09:30:31,524 - ispa_next.main - DEBUG - starting with process 8 (MI-JC 96 E) of 17
2025-11-12 09:30:31,531 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:30:32,705 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:30:33,895 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:30:33,896 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 09:30:35,193 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:30:35,195 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:31:10,682 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:31:10,692 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 09:31:10,695 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:11,136 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:31:11,137 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:13,111 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 341
2025-11-12 09:31:13,112 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:31:13,751 - ispa_next.main - DEBUG - 



2025-11-12 09:31:13,751 - ispa_next.main - DEBUG - starting with process 9 (BÜNDE) of 17
2025-11-12 09:31:13,754 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:31:14,599 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:15,500 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:31:15,501 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 09:31:16,537 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:16,538 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:31:46,111 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:31:46,122 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 09:31:46,125 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:46,634 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:31:46,635 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:49,320 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 341
2025-11-12 09:31:49,321 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:31:50,188 - ispa_next.main - DEBUG - 



2025-11-12 09:31:50,188 - ispa_next.main - DEBUG - starting with process 10 (HF-C 213) of 17
2025-11-12 09:31:50,191 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:31:51,040 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:51,960 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 09:31:51,961 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 09:31:53,112 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:53,114 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:32:15,860 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:32:17,880 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:32:22,662 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:24,610 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:32:24,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:24,688 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:32:24,910 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:32:24,912 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:32:24,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:25,034 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:32:31,539 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:32:31,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:32:32,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:32:34,520 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:32:34,638 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:32:34,766 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:32:34,832 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:32:39,032 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:32:40,037 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:32:40,038 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:40,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:50,407 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:32:54,063 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:32:54,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:54,144 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:32:54,145 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:32:54,220 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:32:54,354 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:32:55,504 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:32:55,727 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:32:57,031 - ispa_next.functions - DEBUG - Updated appointment (AI00015550) customer contact data.
2025-11-12 09:32:57,935 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:32:57,936 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:32:58,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:32:58,926 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:32:59,847 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:32:59,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:32:59,908 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:33:03,570 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:33:03,571 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:33:03,585 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:33:03,588 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:33:03,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:33:04,045 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:33:04,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:04,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:04,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:33:05,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:33:05,637 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:33:07,525 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:33:07,526 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:33:08,379 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:33:08,394 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:33:08,399 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:33:08,402 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:33:08,403 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:33:08,405 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:33:08,407 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:33:08,408 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:33:08,410 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:33:08,413 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:33:08,418 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:33:08,422 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:33:08,426 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:33:08,428 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:33:08,429 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:33:10,286 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:33:10,287 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:33:10,293 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:33:12,236 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:33:12,238 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:33:12,238 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:33:12,939 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:33:13,231 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:33:22,333 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:33:22,335 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:33:24,258 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:33:24,260 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:33:24,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:33:25,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:33:25,345 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:33:32,984 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:33:37,077 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:33:37,079 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:33:37,080 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:33:37,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:33:37,756 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:33:37,757 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:33:39,325 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:33:46,372 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:33:46,775 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 09:33:47,120 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:33:47,944 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:33:47,945 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:33:50,815 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 09:33:50,816 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:51,710 - ispa_next.main - DEBUG - Found new Appointment: HF-PB 318
2025-11-12 09:33:51,712 - ispa_next.main - DEBUG - 



2025-11-12 09:33:51,712 - ispa_next.main - DEBUG - starting with process 11 (HF-PB 318) of 18
2025-11-12 09:33:51,715 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:33:52,867 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:33:54,036 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:33:54,037 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 09:33:55,381 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:33:55,382 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:34:18,064 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:34:28,100 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:34:32,759 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:34:32,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:32,860 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:34:33,124 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:34:33,126 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:34:33,128 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:33,247 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:34:42,738 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:34:42,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:43,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:34:45,662 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:34:45,769 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:34:49,027 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:34:49,109 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:34:49,109 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:34:57,217 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:34:58,222 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:34:58,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:58,711 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:12,854 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:35:20,544 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:35:20,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:20,630 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:35:20,631 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:35:20,670 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:35:20,772 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:35:22,066 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:35:22,289 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:35:25,538 - ispa_next.functions - DEBUG - Updated appointment (AA00044499) customer contact data.
2025-11-12 09:35:26,479 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:35:26,480 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:35:26,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:35:27,467 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:35:28,911 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:35:28,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:35:29,028 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:35:32,600 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:35:32,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:35:33,114 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:35:35,118 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:35:35,230 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:35:35,315 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:35:35,454 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:35:35,454 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:35:43,685 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:36:43,687 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:36:56,270 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 09:37:00,573 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:37:00,573 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:37:04,780 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:37:05,790 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:37:05,793 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:37:05,794 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:37:05,870 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:37:06,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:06,805 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:06,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:37:07,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:37:07,512 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:37:12,974 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:37:12,984 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:37:14,084 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:37:14,086 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:37:14,087 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:37:14,089 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:37:14,090 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:37:14,091 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:37:14,094 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:37:14,095 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:37:14,096 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:37:14,097 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:37:14,104 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:37:14,108 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:37:14,112 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:37:14,113 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:37:14,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:37:20,076 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:37:20,077 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:37:20,079 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:37:26,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:37:26,110 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:37:37,458 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:37:37,460 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:37:37,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:37:38,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:37:38,444 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:37:50,950 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:37:50,953 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:37:56,941 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:37:56,942 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:37:57,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:37:57,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:37:58,115 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:07,866 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:38:12,214 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:38:18,419 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:38:18,420 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:38:18,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:38:19,055 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:38:19,056 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:38:21,906 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:38:29,812 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 09:38:29,813 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:38:29,814 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:38:30,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:38:30,552 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:38:30,553 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:38:32,482 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-12 09:38:32,507 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 09:38:37,470 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 09:38:37,474 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:38:37,933 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:38:37,935 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:38:40,763 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 09:38:40,764 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:38:41,633 - ispa_next.main - DEBUG - 



2025-11-12 09:38:41,633 - ispa_next.main - DEBUG - starting with process 12 (HF-C 213) of 18
2025-11-12 09:38:41,637 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:38:42,840 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:38:44,450 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:38:44,451 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 09:38:45,874 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:38:45,875 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:39:18,236 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:39:20,207 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:39:25,148 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:39:27,030 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:39:27,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:27,109 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:39:27,372 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:39:27,374 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:39:27,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:27,479 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:39:34,482 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:39:34,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:39:35,597 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:39:37,600 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:39:37,712 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:39:37,833 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:39:37,921 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:39:42,059 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:39:43,065 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:39:43,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:43,519 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:53,310 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:39:57,299 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:39:57,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:57,398 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:39:57,399 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:39:57,443 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:39:57,533 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:39:58,725 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:39:58,933 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:40:00,343 - ispa_next.functions - DEBUG - Updated appointment (AF00021378) customer contact data.
2025-11-12 09:40:01,275 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:40:01,276 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:40:01,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:40:02,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:40:03,223 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:40:03,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:40:03,298 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:40:06,910 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:40:06,910 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:40:06,913 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:40:06,915 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:40:06,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:07,499 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:40:07,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:08,430 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:08,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:09,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:40:09,238 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:40:11,143 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:40:11,145 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:40:12,009 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:40:12,011 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:40:12,014 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:40:12,015 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:40:12,016 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:40:12,016 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:40:12,018 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:40:12,019 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:40:12,019 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:40:12,021 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:40:12,022 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:40:12,023 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:40:12,026 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:40:12,029 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:40:12,030 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:13,936 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:40:13,937 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:40:13,961 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:15,825 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:40:15,826 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:40:15,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:40:16,501 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:40:16,714 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:25,783 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:40:25,789 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:27,693 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:40:27,694 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:40:28,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:40:28,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:40:28,847 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:34,253 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:40:37,723 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:40:37,724 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:40:37,724 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:40:38,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:40:38,238 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:40:38,239 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:40:39,713 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:40:47,827 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:40:48,210 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 09:40:48,601 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:40:49,554 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:40:49,556 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:40:52,465 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 09:40:52,466 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:40:53,250 - ispa_next.main - DEBUG - 



2025-11-12 09:40:53,250 - ispa_next.main - DEBUG - starting with process 13 (HF-H 2227E) of 18
2025-11-12 09:40:53,256 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:40:54,665 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:40:55,877 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:40:55,878 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 09:40:57,117 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:40:57,118 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:41:18,611 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:41:20,438 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:41:25,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:31,478 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:41:31,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:31,594 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:41:31,808 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:41:31,810 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:41:31,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:31,894 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:41:35,090 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:41:35,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:35,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:41:37,939 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:41:38,101 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:41:38,211 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:41:38,313 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:41:42,495 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:41:43,499 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:41:43,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:44,001 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:58,320 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:42:02,824 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:42:02,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:42:02,903 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:42:02,904 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:42:02,936 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:42:04,180 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:42:05,407 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:42:05,612 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:42:07,108 - ispa_next.functions - DEBUG - Updated appointment (AA00044450) customer contact data.
2025-11-12 09:42:08,110 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:42:08,112 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:42:08,815 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:42:08,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:42:09,613 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:42:13,221 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:42:13,221 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:42:13,224 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:42:13,227 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:42:13,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:42:13,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:42:17,211 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 09:42:26,396 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 09:42:26,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:42:27,091 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:42:27,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:42:27,900 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:42:27,902 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:42:33,216 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:42:33,218 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:42:34,472 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:42:34,477 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:42:34,480 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:42:34,481 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:42:34,482 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:42:34,483 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:42:34,486 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:42:34,487 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:42:34,488 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:42:34,489 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:42:34,491 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:42:34,494 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:42:34,495 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:42:34,496 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:42:40,499 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:42:40,500 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:42:40,511 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:42:46,521 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:42:46,523 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:42:46,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:42:47,246 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:42:47,440 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:43:00,631 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:43:00,634 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:43:06,498 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:43:06,499 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:43:06,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:43:07,486 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:43:07,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:43:16,828 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:21,278 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:25,283 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:29,612 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:32,988 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:43:32,989 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:43:33,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:43:33,682 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:43:33,684 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:43:36,455 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:43:43,935 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:43:44,334 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 09:43:44,810 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:43:45,887 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:43:45,890 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:43:48,595 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 09:43:48,595 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:43:49,578 - ispa_next.main - DEBUG - 



2025-11-12 09:43:49,578 - ispa_next.main - DEBUG - starting with process 14 (HF-AV 404) of 18
2025-11-12 09:43:49,588 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:43:50,642 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:43:51,960 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:43:51,961 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 09:43:53,330 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:43:53,331 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:44:18,372 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:44:19,993 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:44:25,125 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:44:29,078 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:44:29,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:44:29,185 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:44:29,401 - ispa_next.functions - DEBUG - HU date already expired after 9 days.
2025-11-12 09:44:33,315 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:44:33,318 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:44:33,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:44:33,393 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:44:40,481 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:44:40,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:44:41,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:44:43,528 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:44:43,654 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:44:43,765 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:44:43,823 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:44:47,995 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:44:48,999 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:44:49,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:44:49,441 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:44:57,492 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:45:00,707 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:45:00,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:45:00,810 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:45:00,811 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:45:00,889 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:45:02,178 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:45:03,441 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:45:03,666 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:45:05,135 - ispa_next.functions - DEBUG - Updated appointment (AB00040183) customer contact data.
2025-11-12 09:45:06,045 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:45:06,047 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:45:06,778 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:45:06,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:45:07,598 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:45:11,188 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:45:11,189 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:45:11,191 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:45:11,195 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:45:11,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:45:11,701 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:45:15,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:45:15,799 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:45:15,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:45:16,419 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:45:16,420 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:45:20,013 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:45:20,014 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:45:21,091 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:45:21,093 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:45:21,095 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:45:21,100 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:45:21,103 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:45:21,105 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:45:21,110 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:45:21,111 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:45:21,112 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:45:21,114 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:45:21,114 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:45:21,116 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:45:21,119 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:45:21,120 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:45:21,121 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:45:25,153 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:45:25,154 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:45:25,155 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:45:29,073 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:45:29,074 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:45:29,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:45:29,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:45:29,927 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:45:39,053 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:45:39,055 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:45:43,074 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:45:43,075 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:45:43,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:45:44,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:45:44,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:45:52,130 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:45:56,916 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:46:00,693 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:46:04,936 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:46:10,235 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:46:10,237 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:46:10,237 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:46:10,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:46:10,911 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:46:10,912 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:46:12,667 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:46:20,284 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:46:20,675 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 09:46:21,097 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:46:22,188 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:46:22,188 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:46:25,190 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 09:46:25,191 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:46:25,900 - ispa_next.main - DEBUG - 



2025-11-12 09:46:25,900 - ispa_next.main - DEBUG - starting with process 15 (HF-GE 123) of 18
2025-11-12 09:46:25,904 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:46:27,027 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:46:28,260 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:46:28,261 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 09:46:29,617 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:46:29,619 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:46:53,711 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:46:55,649 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:47:00,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:04,790 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:47:04,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:04,852 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:47:05,090 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:47:05,093 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:47:05,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:05,205 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:47:08,134 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:47:08,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:47:09,388 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:47:11,402 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:47:11,521 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:47:11,622 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:47:11,684 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:47:15,868 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:47:16,873 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:47:16,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:17,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:28,019 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:47:28,019 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:47:32,012 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:47:32,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:32,104 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:47:32,105 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:47:32,156 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:47:33,364 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:47:34,530 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:47:34,742 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:47:36,233 - ispa_next.functions - DEBUG - Updated appointment (AF00021355) customer contact data.
2025-11-12 09:47:37,151 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:47:37,152 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:47:37,922 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:47:37,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:47:38,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:47:42,828 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:47:42,828 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:47:42,834 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:47:42,837 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:47:42,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:47:43,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:47:49,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:49,513 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:49,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:47:50,239 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:47:50,240 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:47:54,480 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:47:54,481 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:47:55,686 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:47:55,692 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:47:55,695 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:47:55,697 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:47:55,698 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:47:55,699 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:47:55,701 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:47:55,703 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:47:55,704 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:47:55,706 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:47:55,707 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:47:55,708 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:47:55,711 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:47:55,712 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:47:55,713 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:48:00,398 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:48:00,399 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:48:00,401 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:48:05,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:48:05,073 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:48:14,432 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:48:28,256 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:48:28,258 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:48:28,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:48:29,248 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:48:29,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:48:42,791 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:48:42,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:48:47,426 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:48:47,428 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:48:47,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:48:48,423 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:48:48,537 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:48:57,337 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:49:02,059 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:49:05,155 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:49:05,156 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:49:05,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:49:05,868 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:49:05,869 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:49:08,840 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:49:16,317 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:49:16,706 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 09:49:17,701 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:49:18,300 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:49:18,301 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:49:21,083 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 09:49:21,084 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:49:21,894 - ispa_next.main - DEBUG - 



2025-11-12 09:49:21,894 - ispa_next.main - DEBUG - starting with process 16 (OS-BO 693) of 18
2025-11-12 09:49:21,897 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:49:23,214 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:49:24,284 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:49:24,290 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 09:49:25,730 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:49:25,732 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:49:53,196 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:49:55,231 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:50:00,293 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:50:08,999 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:50:08,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:50:09,072 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:50:09,289 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:50:09,292 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:50:09,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:50:09,372 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:50:12,491 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:50:12,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:50:13,713 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:50:15,720 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:50:15,835 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:50:15,982 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:50:16,061 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:50:18,181 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:50:19,189 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:50:19,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:50:19,644 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:50:33,589 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:50:37,729 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:50:37,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:50:37,839 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:50:37,840 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:50:37,872 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:50:37,999 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:50:39,088 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:50:39,294 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:50:40,911 - ispa_next.functions - DEBUG - Updated appointment (AB00040597) customer contact data.
2025-11-12 09:50:41,883 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:50:41,885 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:50:42,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:50:42,889 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:50:43,927 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:50:43,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:50:44,012 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:50:47,592 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:50:47,592 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:50:47,595 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:50:47,599 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:50:47,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:50:48,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:50:51,611 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 09:51:03,329 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 09:51:03,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:51:04,294 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:51:04,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:51:04,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:51:04,998 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:51:12,673 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:51:12,674 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:51:14,201 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:51:14,202 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:51:14,204 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:51:14,205 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:51:14,206 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:51:14,207 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:51:14,209 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:51:14,210 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:51:14,211 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:51:14,212 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:51:14,213 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:51:14,215 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:51:14,224 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:51:14,225 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:51:14,226 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:51:23,014 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:51:23,016 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:51:23,018 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:51:31,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:51:31,839 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:51:41,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:51:59,418 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:51:59,420 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:51:59,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:52:00,304 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:52:00,502 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:52:20,388 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:52:20,391 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:52:29,136 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:52:29,138 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:52:29,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:52:30,183 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:52:30,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:52:43,166 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:52:47,828 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:52:51,357 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:52:51,358 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:52:51,989 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:52:52,069 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:52:52,071 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:52:55,339 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:53:04,273 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:53:04,673 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 09:53:05,853 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:53:06,617 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:53:06,619 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:53:09,808 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 09:53:09,809 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:53:10,663 - ispa_next.main - DEBUG - 



2025-11-12 09:53:10,663 - ispa_next.main - DEBUG - starting with process 17 (HF-EO 550E) of 18
2025-11-12 09:53:10,667 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:53:11,903 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:53:13,103 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:53:13,104 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 09:53:14,613 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:53:14,615 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:53:38,767 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:53:40,636 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:53:45,678 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:53:48,931 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:53:48,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:53:49,057 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:53:49,327 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:53:49,330 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:53:49,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:53:49,442 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:53:52,474 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:53:52,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:53:53,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:53:55,723 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:53:55,863 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:53:55,955 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:53:56,029 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:54:00,240 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:54:01,244 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:54:01,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:54:01,730 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:54:11,403 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:54:15,424 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:54:15,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:54:15,509 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:54:15,509 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:54:15,581 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:54:16,846 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:54:17,068 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:54:18,671 - ispa_next.functions - DEBUG - Updated appointment (AB00040564) customer contact data.
2025-11-12 09:54:19,644 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:54:19,646 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:54:20,424 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:54:20,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:54:21,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:54:25,415 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:54:25,416 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:54:25,418 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:54:25,421 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:54:25,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:54:25,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:54:34,635 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 09:54:44,172 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 09:54:44,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:54:45,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:54:45,238 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:54:46,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:54:46,010 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:54:49,023 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:54:49,024 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:54:50,104 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:54:50,105 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:54:50,107 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:54:50,108 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:54:50,109 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:54:50,110 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:54:50,112 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:54:50,113 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:54:50,114 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:54:50,115 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:54:50,116 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:54:50,118 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:54:50,120 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:54:50,123 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:54:50,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:54:53,447 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:54:53,448 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:54:53,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:54:56,765 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:54:56,768 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:54:56,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:54:58,369 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:54:58,598 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:55:10,616 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:55:10,618 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:55:13,852 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:55:13,854 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:55:14,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:55:14,894 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:55:15,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:55:22,490 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:55:26,308 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:55:30,431 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:55:35,362 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:55:35,364 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:55:35,365 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:55:35,936 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:55:36,037 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:55:36,038 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:55:37,891 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:55:45,828 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:55:46,203 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 09:55:46,808 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:55:47,902 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:55:47,903 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:55:50,902 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 09:55:50,902 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:55:51,793 - ispa_next.main - DEBUG - 



2025-11-12 09:55:51,793 - ispa_next.main - DEBUG - starting with process 18 (HF-HB 922) of 18
2025-11-12 09:55:51,808 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:55:52,982 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:55:54,166 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:55:54,168 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 09:55:55,697 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:55:55,698 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:56:20,535 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:56:22,305 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:56:27,839 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:56:29,069 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:56:29,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:56:29,195 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:56:29,413 - ispa_next.functions - DEBUG - HU date already expired after 996 days.
2025-11-12 09:56:33,235 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:56:33,238 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:56:33,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:56:33,319 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:56:36,520 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:56:36,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:56:37,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:56:39,698 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:56:39,843 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:56:39,946 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:56:40,052 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:56:40,052 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:56:48,892 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:56:49,896 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:56:49,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:56:50,406 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:57:00,396 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:57:05,193 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:57:05,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:57:05,274 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:57:05,274 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:57:05,339 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:57:06,555 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:57:07,710 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:57:07,934 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:57:10,022 - ispa_next.functions - DEBUG - Updated appointment (AF00021367) customer contact data.
2025-11-12 09:57:11,099 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:57:11,101 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:57:11,897 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:57:11,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:57:12,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:57:16,402 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:57:16,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:57:16,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:57:18,884 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:57:19,057 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:57:19,196 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:57:19,263 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:57:19,263 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:57:30,175 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 09:57:34,348 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:57:34,349 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:57:38,518 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:57:39,571 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:57:39,573 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:57:39,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:57:39,639 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:57:44,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:57:44,639 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:57:44,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:57:45,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:57:45,328 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:57:46,745 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:57:46,756 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:57:48,193 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:57:48,194 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:57:48,196 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:57:48,197 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:57:48,198 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:57:48,199 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:57:48,201 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:57:48,202 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:57:48,203 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:57:48,205 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:57:48,206 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:57:48,207 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:57:48,209 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:57:48,211 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:57:48,211 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:57:49,407 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:57:49,408 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:57:49,412 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:57:50,590 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:57:50,591 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:57:50,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:57:51,587 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:57:51,863 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:58:04,007 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:58:04,008 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:58:05,216 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:58:05,217 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:58:05,764 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:58:06,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:58:06,477 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:58:12,338 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:58:12,339 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:58:12,340 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:58:12,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:58:12,977 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:58:12,979 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:58:14,594 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:58:21,880 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:58:22,263 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 09:58:22,821 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:58:23,922 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 612
2025-11-12 09:58:23,923 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:58:26,790 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 09:58:26,791 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
