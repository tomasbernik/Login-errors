2025-11-12 10:01:24,584 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:01:24,610 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:01:35,493 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:01:47,256 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:02:03,077 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:02:39,432 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:03:00,550 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:03:05,181 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:03:07,060 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1697
2025-11-12 10:03:07,062 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 487
2025-11-12 10:03:10,213 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 377
2025-11-12 10:03:10,214 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:03:10,215 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:03:11,790 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:03:13,280 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:04:28,234 - ispa_next.appointments.models - DEBUG - Appointment Frau Tanja Anita Stix BA-SL 340 WBA5U91000FL41650 ohne Termin.
2025-11-12 10:04:28,251 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,253 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,274 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,283 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,309 - ispa_next.appointments.models - DEBUG - Appointment Siegfried Geißler  WBA51EG0505W23667 ohne Termin.
2025-11-12 10:04:28,322 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,323 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,343 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,351 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,365 - ispa_next.appointments.models - DEBUG - Appointment Frau Alexandra Wolf BA-AW 555 WBY8P210607K30883 ohne Termin.
2025-11-12 10:04:28,367 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,367 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,368 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,369 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,371 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,372 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,424 - ispa_next.appointments.models - DEBUG - Appointment Gasthof Dinkel LIF-JD 555 WBSJF010X0G965188 ohne Termin.
2025-11-12 10:04:28,445 - ispa_next.appointments.models - DEBUG - Appointment Firma Minges Kaffeerösterei GmbH BA-MK 540 WBA11GR0409Y69237 ohne Termin.
2025-11-12 10:04:28,450 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,451 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,493 - ispa_next.appointments.models - DEBUG - Appointment Herr Bastian Stern HÖS-S 1312 WBA4J51020BN80220 ohne Termin.
2025-11-12 10:04:28,502 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,502 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,532 - ispa_next.appointments.models - DEBUG - Appointment Herr Stephan Nätscher BA-MN 1019 WBA7K310307J40556 ohne Termin.
2025-11-12 10:04:28,556 - ispa_next.appointments.models - DEBUG - Appointment Firma Kraftanlagen Energies & M-KA 2446 WBA41EG0905Z23353 ohne Termin.
2025-11-12 10:04:28,570 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,638 - ispa_next.appointments.models - DEBUG - Appointment Frau Franziska Berg BA-JP 1720 WMWLN710202E75045 ohne Termin.
2025-11-12 10:04:28,653 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,675 - ispa_next.appointments.models - DEBUG - Appointment Herr Jürgen Manfred Suppe BA-SU 380 WBY61EF0305W96365 ohne Termin.
2025-11-12 10:04:28,688 - ispa_next.appointments.models - DEBUG - Appointment Herr Gunter Kirsch BA-BK 746 WBA2E510205G50991 ohne Termin.
2025-11-12 10:04:28,690 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,704 - ispa_next.appointments.models - DEBUG - Appointment Firma Andreas Wagner Vertriebs GmbH HAS-W 3690 WBA15BZ070N298504 ohne Termin.
2025-11-12 10:04:28,709 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,741 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,786 - ispa_next.appointments.models - DEBUG - Appointment Firma Erlanger Treuhand GmbH ER-TR 70E WBA21GV020CU74535 ohne Termin.
2025-11-12 10:04:28,803 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,858 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,883 - ispa_next.appointments.models - DEBUG - Appointment Frau Aslihan Karaman NÖ-AK 5252 WBAHT710305K01893 ohne Termin.
2025-11-12 10:04:28,902 - ispa_next.appointments.models - DEBUG - Appointment Generalstaatsanwaltschaft BA-N 1017E WBA51BX0607T37782 ohne Termin.
2025-11-12 10:04:28,922 - ispa_next.appointments.models - DEBUG - Appointment Herr Josef Reuß KG-TR 899 WBA8H91030A719314 ohne Termin.
2025-11-12 10:04:28,938 - ispa_next.appointments.models - DEBUG - Appointment Firma Elektro Weis GmbH & Co. KG BA-XX 621 WMW61DL0503P86044 ohne Termin.
2025-11-12 10:04:28,960 - ispa_next.appointments.models - DEBUG - Appointment Frau Birgitta Helmstetter BA-A 607 WBA7K310507K49097 ohne Termin.
2025-11-12 10:04:28,966 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:28,990 - ispa_next.appointments.models - DEBUG - Appointment Herr Wolfgang Kießwetter BA-CL 16 WBA4A51060D408079 ohne Termin.
2025-11-12 10:04:29,021 - ispa_next.appointments.models - DEBUG - Appointment Firma bornheim GmbH & Co. KG BA-M 180 WBA11GF0107R40264 ohne Termin.
2025-11-12 10:04:29,041 - ispa_next.appointments.models - DEBUG - Appointment Herr Adam Jacek Kesminowicz BA-KA 91 WBAHT710505J98589 ohne Termin.
2025-11-12 10:04:29,057 - ispa_next.appointments.models - DEBUG - Appointment Frau Inge Kimbrough WUN-NY 111 WBA31AD0303L79467 ohne Termin.
2025-11-12 10:04:29,072 - ispa_next.appointments.models - DEBUG - Appointment Herr Peter Kupsch BA-PK 12 WBAHS910805H68893 ohne Termin.
2025-11-12 10:04:29,086 - ispa_next.appointments.models - DEBUG - Appointment Frau Jennifer Crayne ERH-JD 604 WMW51DK0102T47698 ohne Termin.
2025-11-12 10:04:29,087 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:04:29,101 - ispa_next.appointments.models - DEBUG - Appointment Herr Rainer Andreas Rebel BA-TR 2003 WBAPP11070E794980 ohne Termin.
2025-11-12 10:04:29,115 - ispa_next.appointments.models - DEBUG - Appointment Herr Mohammad Al Ahmad BA-SY 222 WBA8T31090BX94248 ohne Termin.
2025-11-12 10:04:29,129 - ispa_next.appointments.models - DEBUG - Appointment Herr Mario Kämpf ASL-MH 810 WBA11AB0005U74034 ohne Termin.
2025-11-12 10:04:29,143 - ispa_next.appointments.models - DEBUG - Appointment Frau Martina Zeißler EBS-MZ 181 WBA1S510605A79963 ohne Termin.
2025-11-12 10:04:29,169 - ispa_next.appointments.models - DEBUG - Appointment Frau Christine Roppelt BA-CR 4422 WBAJG110X03G84879 ohne Termin.
2025-11-12 10:04:29,199 - ispa_next.appointments.models - DEBUG - Appointment Frau Ulrike Starker BA-US 96 WBA8H71040K803544 ohne Termin.
2025-11-12 10:04:29,230 - ispa_next.appointments.models - DEBUG - Appointment Firma MG-Nährmittel Produktservice BA-M 8013 WBSAE01020CE87488 ohne Termin.
2025-11-12 10:04:29,254 - ispa_next.appointments.models - DEBUG - Appointment Herr Alexander Erdpohl BA-AE 779 WBA8H91000K868189 ohne Termin.
2025-11-12 10:04:29,312 - ispa_next.main - DEBUG - Found 15 out of 228 appointments to process (configured limit: 15).
2025-11-12 10:04:29,313 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-12 10:04:29,313 - ispa_next.main - DEBUG - Processing 11 already visited appointments (w/ RKR not callable).
2025-11-12 10:04:29,313 - ispa_next.main - DEBUG - All appointments: BA-GU 99, FO-MS 340, ER-BP 68, BA-ZZ 900, FO-MX 186, BA-CT 97, BA-PM 1007, BA-EK 33, BA-FS 2002, BA-PE 76, ER-S 2305E, BA-CR 4422, BA-L 938, BA-AR 4321, BA-A 1284
2025-11-12 10:04:29,316 - ispa_next.main - DEBUG - 



2025-11-12 10:04:29,316 - ispa_next.main - DEBUG - starting with process 1 (BA-GU 99) of 15
2025-11-12 10:04:29,323 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:04:30,714 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:04:32,456 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1697
2025-11-12 10:04:32,458 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 377
2025-11-12 10:04:34,349 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:04:34,350 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:05:20,924 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:05:32,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:05:32,817 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:05:33,027 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:05:34,364 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:05:34,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:05:34,502 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:05:34,762 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:05:34,770 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:05:34,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:05:34,915 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:05:38,327 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:05:38,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:05:39,784 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:05:41,789 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:05:41,952 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:05:45,256 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:05:45,380 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:05:45,382 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:05:46,819 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:05:55,844 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:05:56,850 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:05:56,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:05:57,372 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:16,498 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:06:25,534 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:06:25,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:25,697 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:06:25,698 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:06:25,774 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:06:27,420 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:06:27,854 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:06:33,197 - ispa_next.functions - DEBUG - Updated appointment (AC00041340) customer contact data.
2025-11-12 10:06:34,134 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:06:34,144 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:06:35,215 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:06:35,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:06:36,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:06:40,004 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:06:40,006 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:06:40,533 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:06:42,535 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:06:42,694 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:06:42,797 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:06:42,913 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:06:42,920 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:06:44,359 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:06:53,440 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:07:53,443 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:08:05,486 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:08:10,160 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:08:10,162 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:08:11,471 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:08:15,691 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:08:16,700 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:08:16,700 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:08:16,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:08:16,866 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:08:21,038 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:08:21,044 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:08:21,045 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:08:21,158 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:08:21,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:08:22,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:08:22,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:08:23,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:08:23,128 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:08:24,551 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:08:24,553 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:08:25,710 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:08:25,712 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:08:25,718 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:08:25,719 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:08:25,726 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:08:25,727 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 10:08:25,728 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:08:25,734 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:08:25,735 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:08:25,742 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:08:25,744 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 10:08:26,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:08:27,507 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:08:45,985 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:08:46,008 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:08:46,013 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:08:46,013 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:08:47,388 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:08:47,399 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:08:47,402 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:08:48,696 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:08:48,696 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:08:48,700 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:08:50,028 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:08:50,034 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:08:50,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:08:51,319 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:09:10,611 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:09:11,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:09:12,477 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:09:12,663 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:09:25,456 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:09:25,461 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:09:25,462 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:09:26,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:09:26,385 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:09:26,395 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:09:28,948 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:09:42,392 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:09:42,854 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:09:43,922 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:46,197 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1697
2025-11-12 10:09:46,199 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:09:49,772 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 487
2025-11-12 10:09:49,772 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:09:50,887 - ispa_next.appointments.models - DEBUG - Appointment Herr Karl Stölzel BA-KS 14 WBAEP51040PF08685 ohne Termin.
2025-11-12 10:09:50,899 - ispa_next.main - DEBUG - Found new Appointment: BA-SL 340
2025-11-12 10:09:50,901 - ispa_next.main - DEBUG - 



2025-11-12 10:09:50,901 - ispa_next.main - DEBUG - starting with process 2 (BA-SL 340) of 16
2025-11-12 10:09:50,909 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:09:52,403 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:54,288 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1697
2025-11-12 10:09:54,290 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 487
2025-11-12 10:09:56,316 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:09:56,317 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:26,920 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:10:38,448 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:10:39,756 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:10:39,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:39,906 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:10:40,201 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:10:40,208 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:10:40,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:40,351 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:10:43,509 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:10:43,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:10:44,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:10:46,843 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:10:46,993 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:10:50,240 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:10:50,319 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:10:54,596 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:10:55,603 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:10:55,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:56,155 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:12,121 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:11:12,121 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:11:20,984 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:11:20,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:21,142 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:11:21,143 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:11:21,225 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:11:22,735 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:11:24,354 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:11:24,722 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:11:30,237 - ispa_next.functions - DEBUG - Updated appointment (AC00041343) customer contact data.
2025-11-12 10:11:31,153 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:11:31,159 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:11:32,212 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:11:32,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:11:33,149 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:11:37,983 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:11:37,983 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:11:37,993 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:11:38,011 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:11:38,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:11:38,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:11:42,819 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:11:42,825 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:11:42,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:11:42,911 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:11:47,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:47,886 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:47,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:11:48,658 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:11:48,662 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:11:50,707 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:11:50,709 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:11:51,900 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:11:51,901 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:11:51,907 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:11:51,909 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:11:51,915 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:11:51,917 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 10:11:51,918 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:11:51,924 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:11:51,925 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:11:51,931 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:11:51,933 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 10:11:52,753 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:11:53,639 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:12:11,330 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:12:11,335 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:12:11,341 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:12:11,342 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:13,321 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:12:13,327 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:12:13,330 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:15,340 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:12:15,340 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:12:15,343 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:17,372 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:12:17,378 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:12:17,381 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:19,440 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:12:38,022 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:12:38,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:12:39,661 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:12:39,949 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:59,114 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:13:04,735 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:13:04,740 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:13:04,740 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:13:05,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:13:05,731 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:13:05,737 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:13:08,511 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:13:20,081 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:13:20,482 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:13:21,698 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:13:24,980 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1697
2025-11-12 10:13:24,982 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:13:28,812 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 487
2025-11-12 10:13:28,813 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:13:29,805 - ispa_next.appointments.models - DEBUG - Appointment Herr Karl Stölzel BA-KS 14 WBAEP51040PF08685 ohne Termin.
2025-11-12 10:13:29,823 - ispa_next.main - DEBUG - 



2025-11-12 10:13:29,823 - ispa_next.main - DEBUG - starting with process 3 (FO-MS 340) of 16
2025-11-12 10:13:29,832 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:13:31,323 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:13:32,877 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1697
2025-11-12 10:13:32,878 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 487
2025-11-12 10:13:34,859 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:13:34,860 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:14:04,290 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:14:15,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:16,146 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:14:16,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:17,807 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:14:17,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:17,948 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:14:18,288 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:14:18,295 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:14:18,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:18,383 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:14:21,679 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:14:21,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:14:23,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:14:25,285 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:14:25,495 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:14:28,844 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:14:28,934 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:14:28,936 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:30,321 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:14:39,279 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:14:40,285 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:14:40,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:40,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:55,795 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:15:04,840 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:15:04,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:04,952 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:15:04,953 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:15:05,057 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:15:06,736 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:15:07,127 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:15:12,869 - ispa_next.functions - DEBUG - Updated appointment (AC00041338) customer contact data.
2025-11-12 10:15:13,851 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:15:13,858 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:15:14,854 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:15:14,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:15:15,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:15:19,464 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:15:19,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:19,973 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:15:21,978 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:15:22,149 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:15:22,355 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:15:22,487 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:15:22,489 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:23,878 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:15:35,186 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:15:39,679 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:15:39,680 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:40,946 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:15:45,190 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:15:46,200 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:15:46,201 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:15:46,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:46,312 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:15:50,469 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:15:50,475 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:15:50,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:50,602 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:15:56,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:56,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:56,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:57,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:15:57,577 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:15:59,226 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:15:59,229 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:16:00,198 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:16:00,201 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:16:00,213 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:16:00,217 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:16:00,225 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:16:00,229 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 10:16:00,230 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:16:00,236 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:16:00,237 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:16:00,243 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:16:00,245 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 10:16:01,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:16:01,857 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:16:18,181 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:16:18,192 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:16:18,199 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:16:18,200 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:19,485 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:16:19,490 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:16:19,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:20,774 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:16:20,775 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:16:20,780 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:22,137 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:16:22,143 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:16:22,147 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:23,524 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:16:43,020 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:16:43,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:16:44,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:16:44,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:17:00,739 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:17:00,743 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:17:00,749 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:17:01,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:17:01,766 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:17:01,781 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:17:04,346 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:17:15,318 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:17:15,728 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:17:16,892 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:17:18,945 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1699
2025-11-12 10:17:18,946 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:17:22,903 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 489
2025-11-12 10:17:22,904 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:17:23,977 - ispa_next.appointments.models - DEBUG - Appointment Frau Sieglinde Helmreich BA-NW 101 WBA6S110807E36448 ohne Termin.
2025-11-12 10:17:24,007 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 10:17:24,034 - ispa_next.appointments.models - DEBUG - Appointment Herr Karl Stölzel BA-KS 14 WBAEP51040PF08685 ohne Termin.
2025-11-12 10:17:24,042 - ispa_next.main - DEBUG - 



2025-11-12 10:17:24,042 - ispa_next.main - DEBUG - starting with process 4 (ER-BP 68) of 16
2025-11-12 10:17:24,048 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:17:25,474 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:17:27,035 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1699
2025-11-12 10:17:27,036 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 489
2025-11-12 10:17:28,972 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:17:28,973 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:18:00,935 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:18:14,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:14,119 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:18:14,363 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:15,742 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:18:15,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:15,896 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:18:16,267 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:18:16,272 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:18:16,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:16,352 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:18:19,840 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:18:19,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:21,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:23,509 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:18:23,684 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:18:26,965 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:18:27,135 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:18:27,136 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:28,538 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:18:37,635 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:18:38,642 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:18:38,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:39,163 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:56,155 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:19:07,635 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:19:07,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:07,763 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:19:07,766 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:19:07,812 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:19:09,644 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:19:10,073 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:19:15,356 - ispa_next.functions - DEBUG - Updated appointment (AC00041333) customer contact data.
2025-11-12 10:19:16,315 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:19:16,325 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:19:17,366 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:19:17,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:19:18,743 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:19:22,418 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:19:22,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:22,962 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:19:24,964 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:19:25,129 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:19:25,379 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:19:25,523 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:19:25,525 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:26,880 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:19:37,795 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:19:42,359 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:19:42,361 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:43,683 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:19:47,939 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:19:48,948 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:19:48,949 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:19:48,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:49,108 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:19:53,282 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:19:53,289 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:19:53,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:53,424 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:20:02,896 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 10:20:08,889 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:20:08,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:20:09,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:20:09,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:20:10,359 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:20:10,364 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:20:11,884 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:20:11,887 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:20:13,159 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:20:13,162 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:20:13,169 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-12 10:20:13,172 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:20:13,185 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:20:13,190 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 10:20:13,193 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:20:13,202 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:20:13,204 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:20:13,210 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:20:13,212 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:20:37,177 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:20:37,179 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 10:20:37,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:20:38,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:20:55,166 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:20:55,167 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-12 10:21:02,882 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:21:02,889 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:21:02,890 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:04,841 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:21:04,847 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:21:04,850 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:06,930 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:21:06,930 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:21:06,932 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:08,960 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:21:08,964 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:21:08,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:10,946 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:21:30,040 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:21:30,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:21:31,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:21:32,020 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:52,408 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:58,888 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:22:06,586 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:22:06,587 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:22:07,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:22:07,578 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:22:07,585 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:22:14,825 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:22:26,590 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:22:26,998 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:22:28,290 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:22:30,516 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1701
2025-11-12 10:22:30,517 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:22:34,143 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 491
2025-11-12 10:22:34,144 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:22:35,218 - ispa_next.appointments.models - DEBUG - Appointment Herr Dorsten Rauch HBN-RS 520 WBAJP31030BT92151 ohne Termin.
2025-11-12 10:22:35,244 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 10:22:35,256 - ispa_next.main - DEBUG - Found new Appointment: SW-MD 50
2025-11-12 10:22:35,256 - ispa_next.main - DEBUG - Found new Appointment: SW-MD 56
2025-11-12 10:22:35,256 - ispa_next.main - DEBUG - Found new Appointment: BA-NW 101
2025-11-12 10:22:35,258 - ispa_next.main - DEBUG - 



2025-11-12 10:22:35,258 - ispa_next.main - DEBUG - starting with process 5 (SW-MD 50) of 19
2025-11-12 10:22:35,263 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:22:36,730 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:22:38,353 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1701
2025-11-12 10:22:38,354 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 491
2025-11-12 10:22:40,826 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:22:40,828 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:23:10,590 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:23:22,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:22,966 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:23:23,159 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:24,647 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:23:24,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:24,724 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:23:25,066 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:23:25,073 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:23:25,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:25,186 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:23:28,573 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:23:28,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:30,234 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:23:32,237 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:23:32,361 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:23:35,661 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:23:46,038 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 10:23:47,049 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:23:47,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:47,578 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:06,437 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:24:15,895 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:24:15,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:16,007 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:24:16,008 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:24:16,100 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:24:17,724 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:24:18,139 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:24:22,932 - ispa_next.functions - DEBUG - Updated appointment (AC00041348) customer contact data.
2025-11-12 10:24:23,928 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:24:23,938 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:24:25,008 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:24:25,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:24:25,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:24:29,625 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:24:29,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:24:30,127 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:24:32,131 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:24:32,359 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:24:32,486 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:24:32,565 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:24:32,567 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:34,069 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:24:43,142 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:25:43,147 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:25:54,088 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:25:58,642 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:25:58,643 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:00,876 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:26:05,166 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:26:06,177 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:26:06,182 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:26:06,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:06,304 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:26:10,472 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:26:10,479 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:26:10,479 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 10:26:10,483 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:26:11,872 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:26:11,874 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:26:13,090 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:26:13,092 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:26:13,098 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:26:13,099 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:26:13,105 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:26:13,107 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 10:26:13,108 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:26:13,114 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:26:13,115 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:26:13,121 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:26:13,124 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 10:26:13,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:26:14,887 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:26:31,113 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:26:31,118 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:26:31,123 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:26:31,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:32,456 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:26:32,463 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:26:32,467 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:33,767 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:26:33,767 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:26:33,771 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:35,098 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:26:35,104 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:26:35,107 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:36,367 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:26:55,643 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:26:56,491 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:26:57,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:26:57,519 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:27:11,356 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:11,361 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:27:11,362 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:27:12,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:27:12,367 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:27:12,373 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:27:15,138 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:27:26,609 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:27:27,008 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:27:28,179 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:27:30,261 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1703
2025-11-12 10:27:30,263 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:27:34,109 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 493
2025-11-12 10:27:34,110 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:27:35,181 - ispa_next.appointments.models - DEBUG - Appointment Herr Dorsten Rauch HBN-RS 520 WBAJP31030BT92151 ohne Termin.
2025-11-12 10:27:35,205 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 10:27:35,230 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 10:27:35,244 - ispa_next.main - DEBUG - 



2025-11-12 10:27:35,244 - ispa_next.main - DEBUG - starting with process 6 (SW-MD 56) of 19
2025-11-12 10:27:35,255 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:27:37,185 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:27:38,972 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1703
2025-11-12 10:27:38,974 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 493
2025-11-12 10:27:41,145 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:27:41,146 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:28:12,339 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:28:24,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:24,153 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:28:24,373 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:25,726 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:28:25,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:25,887 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:28:26,221 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:28:26,232 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:28:26,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:26,336 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:28:29,568 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:28:29,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:28:31,142 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:28:33,145 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:28:33,281 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:28:36,558 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:28:36,698 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:28:36,709 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:38,119 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:28:48,078 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:28:49,106 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:28:49,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:49,711 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:07,350 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:29:17,452 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:29:17,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:17,550 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:29:17,551 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:29:17,655 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:29:19,222 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:29:19,597 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:29:24,545 - ispa_next.functions - DEBUG - Updated appointment (AC00041347) customer contact data.
2025-11-12 10:29:25,538 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:29:25,595 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:29:26,614 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:29:26,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:29:27,546 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:29:31,220 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:29:31,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:29:31,757 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:29:33,762 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:29:33,970 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:29:34,128 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:29:34,219 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:29:34,221 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:35,564 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:29:46,687 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:29:53,105 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:29:53,107 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:54,427 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:29:58,640 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:29:59,648 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:29:59,648 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:29:59,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:29:59,741 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:30:03,913 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:30:03,919 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:30:03,919 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 10:30:03,923 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:30:05,313 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:30:05,315 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:30:06,299 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:30:06,301 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:30:06,307 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:30:06,309 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:30:06,316 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:30:06,318 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 10:30:06,319 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:30:06,325 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:30:06,326 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:30:06,332 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:30:06,334 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 10:30:07,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:30:07,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:30:24,632 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:30:24,638 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:30:24,644 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:30:24,645 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:25,894 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:30:25,901 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:30:25,904 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:27,189 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:30:27,190 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:30:27,192 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:28,593 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:30:28,599 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:30:28,605 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:29,976 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:30:49,238 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:30:50,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:30:50,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:30:51,171 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:05,332 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:31:05,337 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:31:05,338 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:31:06,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:31:06,328 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:31:06,334 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:31:09,084 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:31:21,269 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:31:21,646 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:31:22,800 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:31:25,255 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1704
2025-11-12 10:31:25,257 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:31:29,729 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 494
2025-11-12 10:31:29,730 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:31:30,785 - ispa_next.appointments.models - DEBUG - Appointment Herr Dorsten Rauch HBN-RS 520 WBAJP31030BT92151 ohne Termin.
2025-11-12 10:31:30,812 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 10:31:30,840 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 10:31:30,854 - ispa_next.main - DEBUG - 



2025-11-12 10:31:30,854 - ispa_next.main - DEBUG - starting with process 7 (BA-NW 101) of 19
2025-11-12 10:31:30,861 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:31:32,422 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:31:33,988 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1704
2025-11-12 10:31:33,990 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 494
2025-11-12 10:31:35,957 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:31:35,958 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:32:08,129 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:32:21,786 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:32:23,823 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:32:23,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:23,959 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:32:24,305 - ispa_next.functions - DEBUG - HU date already expired after 55 days.
2025-11-12 10:32:33,134 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:32:33,139 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:32:33,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:33,284 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:32:46,290 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:32:46,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:32:47,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:32:49,806 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:32:49,937 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:32:53,266 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:32:53,364 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:32:57,649 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:32:58,656 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:32:58,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:59,217 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:16,034 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:33:25,619 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:33:25,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:25,792 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:33:25,794 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:33:25,875 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:33:26,027 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:33:27,592 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:33:27,957 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:33:34,324 - ispa_next.functions - DEBUG - Updated appointment (AC00041345) customer contact data.
2025-11-12 10:33:35,296 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:33:35,305 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:33:35,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:33:36,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:33:38,573 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:33:38,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:33:38,869 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:33:43,406 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:33:43,406 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:33:43,656 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:33:43,657 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:33:43,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:33:44,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:33:48,476 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:33:48,482 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:33:48,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:33:48,563 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:33:52,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:53,385 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:53,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:33:54,228 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:33:54,232 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:33:57,479 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:33:57,482 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:33:58,616 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:33:58,619 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:33:58,628 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:33:58,631 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:33:58,637 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:33:58,638 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 10:33:58,640 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:33:58,645 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:33:58,646 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:33:58,652 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:33:58,655 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 10:33:59,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:34:00,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:34:17,169 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:34:17,177 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:34:17,221 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:34:17,222 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:20,640 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:34:20,644 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:34:20,646 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:24,097 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:34:24,097 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:34:24,099 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:27,492 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:34:27,498 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:34:27,500 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:30,990 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:34:53,008 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:34:53,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:34:54,741 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:34:54,995 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:29,118 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:35:35,290 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:35:40,714 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:35:49,697 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:35:49,701 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:35:49,702 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:35:50,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:35:50,705 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:35:50,711 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:35:53,435 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:36:05,278 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:36:05,730 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 10:36:06,936 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:36:09,319 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1704
2025-11-12 10:36:09,321 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:36:13,148 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 494
2025-11-12 10:36:13,149 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:36:14,173 - ispa_next.appointments.models - DEBUG - Appointment Herr Dorsten Rauch HBN-RS 520 WBAJP31030BT92151 ohne Termin.
2025-11-12 10:36:14,205 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 10:36:14,231 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 10:36:14,244 - ispa_next.main - DEBUG - 



2025-11-12 10:36:14,244 - ispa_next.main - DEBUG - starting with process 8 (BA-ZZ 900) of 19
2025-11-12 10:36:14,255 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:36:15,735 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:36:17,551 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1704
2025-11-12 10:36:17,553 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 494
2025-11-12 10:36:19,788 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:36:19,790 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:36:53,623 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:37:05,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:05,294 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:37:05,510 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:37:06,841 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:37:06,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:06,945 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:37:07,300 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:37:07,305 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:37:07,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:07,385 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:37:19,920 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:37:19,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:37:20,948 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:37:22,951 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:37:29,787 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 10:37:38,665 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 10:37:39,673 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:37:39,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:40,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:55,411 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:37:55,411 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:38:04,412 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:38:04,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:04,527 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:38:04,528 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:38:04,604 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:38:04,776 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:38:07,002 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:38:08,479 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:38:08,963 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:38:14,001 - ispa_next.functions - DEBUG - Updated appointment (AC00040265) customer contact data.
2025-11-12 10:38:14,919 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:38:14,929 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:38:15,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:38:16,767 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:38:18,692 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:38:18,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:38:18,822 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:38:22,930 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:38:22,931 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:38:22,931 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:38:22,938 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:38:22,939 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:38:22,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:23,557 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:38:24,687 - ispa_next.functions - DEBUG - check_service_requirement couldn't find CBS table, returning False
2025-11-12 10:38:24,695 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:38:24,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:24,775 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:38:25,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:25,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:25,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:26,762 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:38:26,767 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:38:28,840 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:38:28,842 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:38:29,705 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:38:29,707 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:38:29,715 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:38:29,718 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:38:29,725 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:38:29,727 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 10:38:29,729 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:38:29,735 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:38:29,736 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:38:29,741 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:38:29,743 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 10:38:30,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:38:31,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:38:51,125 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:38:51,130 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:38:51,134 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:38:51,134 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:53,294 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:38:53,301 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:38:53,303 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:55,283 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:38:55,283 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:38:55,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:57,250 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:38:57,255 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:38:57,257 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:59,238 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:39:19,587 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:39:20,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:39:21,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:39:21,503 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:41,391 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:47,342 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:47,349 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:39:47,350 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:39:48,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:39:48,342 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:39:48,356 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:39:50,889 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:40:04,572 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:40:05,003 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 10:40:06,211 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:40:08,715 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1705
2025-11-12 10:40:08,716 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:40:13,092 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 495
2025-11-12 10:40:13,093 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:40:15,038 - ispa_next.appointments.models - DEBUG - Appointment Herr Matthias Denzler BA-DZ 22 WBAUX31050A203051 ohne Termin.
2025-11-12 10:40:15,068 - ispa_next.appointments.models - DEBUG - Appointment Herr Dorsten Rauch HBN-RS 520 WBAJP31030BT92151 ohne Termin.
2025-11-12 10:40:15,085 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 10:40:15,101 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 10:40:15,108 - ispa_next.main - DEBUG - 



2025-11-12 10:40:15,108 - ispa_next.main - DEBUG - starting with process 9 (FO-MX 186) of 19
2025-11-12 10:40:15,114 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:40:16,673 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:40:18,531 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1705
2025-11-12 10:40:18,533 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 495
2025-11-12 10:40:20,750 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:40:20,752 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:40:56,481 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:40:59,227 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:41:05,555 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:07,705 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:41:07,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:07,784 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:08,158 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:41:13,843 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:41:13,851 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:41:13,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:13,973 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:22,892 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:41:22,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:41:24,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:41:26,669 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:41:26,876 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:41:26,972 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:41:27,097 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:41:31,354 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:41:32,361 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:41:32,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:33,014 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:51,113 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:41:57,440 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:41:57,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:57,704 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:57,705 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:41:57,747 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:41:59,152 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:42:00,073 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:42:03,670 - ispa_next.functions - DEBUG - Updated appointment (AC00040980) customer contact data.
2025-11-12 10:42:04,613 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:42:04,622 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:42:06,466 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:42:06,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:42:07,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:42:11,687 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:42:11,687 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:42:11,692 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:42:11,693 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:42:11,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:42:12,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:42:16,480 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:42:16,486 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:42:16,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:42:16,565 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:42:20,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:42:21,140 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:42:21,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:42:22,040 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:42:22,046 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:42:24,067 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:42:24,069 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:42:26,369 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:42:26,370 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:42:26,375 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:42:26,376 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:42:26,383 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:42:26,385 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:42:26,386 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:42:26,391 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:42:26,393 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:42:26,398 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:42:26,415 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:42:26,421 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:42:26,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:28,529 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:42:28,534 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:42:28,536 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:30,787 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:42:30,788 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:42:30,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:32,852 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:42:32,858 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:42:32,860 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:34,935 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:42:52,835 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:42:53,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:42:54,435 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:42:54,633 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:14,115 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:43:20,044 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:43:20,051 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:43:20,052 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:43:20,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:43:21,098 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:43:21,104 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:43:23,876 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:43:35,378 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:43:35,780 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 10:43:36,937 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:43:39,270 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1704
2025-11-12 10:43:39,272 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:43:43,343 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 494
2025-11-12 10:43:43,344 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:43:44,535 - ispa_next.appointments.models - DEBUG - Appointment Herr Matthias Denzler BA-DZ 22 WBAUX31050A203051 ohne Termin.
2025-11-12 10:43:44,552 - ispa_next.appointments.models - DEBUG - Appointment Herr Dorsten Rauch HBN-RS 520 WBAJP31030BT92151 ohne Termin.
2025-11-12 10:43:44,569 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 10:43:44,595 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 10:43:44,607 - ispa_next.main - DEBUG - 



2025-11-12 10:43:44,608 - ispa_next.main - DEBUG - starting with process 10 (BA-CT 97) of 19
2025-11-12 10:43:44,617 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:43:46,692 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:43:48,469 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1704
2025-11-12 10:43:48,471 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 494
2025-11-12 10:43:50,875 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:43:50,876 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:44:28,054 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:44:31,235 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:44:37,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:44:39,266 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:44:39,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:39,345 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:44:39,755 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:44:39,765 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:44:39,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:39,936 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:44:49,337 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:44:49,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:44:50,887 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:44:52,890 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:44:53,064 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:44:53,236 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:44:53,344 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:44:55,543 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:44:56,549 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:44:56,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:57,127 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:12,797 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:45:19,157 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:45:19,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:19,313 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:45:19,314 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:45:19,468 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:45:19,641 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:45:21,167 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:45:21,518 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:45:24,948 - ispa_next.functions - DEBUG - Updated appointment (AC00040950) customer contact data.
2025-11-12 10:45:25,999 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:45:26,006 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:45:26,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:45:27,546 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:45:29,509 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:45:29,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:45:29,584 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:45:33,289 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:45:33,289 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:45:33,294 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:45:33,295 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:45:33,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:45:33,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:45:38,050 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 10:45:43,022 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:45:43,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:45:43,155 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:45:43,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:44,325 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:44,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:45:45,091 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:45:45,095 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:45:47,267 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:45:47,270 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:45:50,922 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:45:50,925 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:45:50,932 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:45:50,935 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:45:50,943 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:45:50,944 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:45:50,950 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:45:50,951 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:45:50,957 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:45:50,964 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:45:50,971 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:45:50,972 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:45:53,341 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:45:53,345 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:45:53,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:45:55,389 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:45:55,389 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:45:55,391 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:45:57,458 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:45:57,464 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:45:57,473 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:45:59,529 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:46:16,827 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:46:17,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:46:18,386 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:46:18,615 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:46:39,348 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:46:45,174 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:46:45,182 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:46:45,183 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:46:46,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:46:46,235 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:46:46,242 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:46:49,018 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:47:00,333 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:47:00,752 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 10:47:01,721 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:47:05,471 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1704
2025-11-12 10:47:05,472 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:47:10,923 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 493
2025-11-12 10:47:10,924 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:47:12,040 - ispa_next.appointments.models - DEBUG - Appointment Herr Alois Schmid BA-AE 1999 WBAJF310X0WW14468 ohne Termin.
2025-11-12 10:47:12,058 - ispa_next.appointments.models - DEBUG - Appointment Herr Matthias Denzler BA-DZ 22 WBAUX31050A203051 ohne Termin.
2025-11-12 10:47:12,077 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 10:47:12,092 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 10:47:12,099 - ispa_next.main - DEBUG - 



2025-11-12 10:47:12,099 - ispa_next.main - DEBUG - starting with process 11 (BA-PM 1007) of 19
2025-11-12 10:47:12,107 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:47:13,646 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:47:15,359 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1704
2025-11-12 10:47:15,361 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 493
2025-11-12 10:47:17,765 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:47:17,767 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:47:54,382 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:47:57,831 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:48:03,803 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:48:05,239 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:48:05,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:48:05,364 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:48:05,683 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:48:05,691 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:48:05,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:48:05,844 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:48:09,271 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:48:09,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:48:10,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:48:12,795 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:48:12,961 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:48:13,105 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:48:13,209 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:48:17,512 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:48:18,519 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:48:18,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:48:19,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:48:34,979 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:48:34,983 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:48:41,531 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:48:41,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:48:41,672 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:48:41,673 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:48:41,768 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:48:43,234 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:48:43,606 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:48:47,723 - ispa_next.functions - DEBUG - Updated appointment (AC00041241) customer contact data.
2025-11-12 10:48:48,643 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:48:48,657 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:48:49,863 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:48:49,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:48:51,113 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:48:54,728 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:48:54,728 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:48:54,733 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:48:54,734 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:48:54,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:48:55,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:48:59,578 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:48:59,586 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:48:59,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:48:59,724 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:49:05,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:05,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:05,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:49:06,689 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:49:06,694 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:49:08,111 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:49:08,113 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:49:10,554 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:49:10,556 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:49:10,564 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:49:10,566 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:49:10,571 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:49:10,573 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:49:10,574 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:49:10,580 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:49:10,581 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:49:10,587 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:49:10,595 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:49:10,605 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:49:10,607 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:49:11,947 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:49:11,953 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:49:11,956 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:49:13,305 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:49:13,305 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:49:13,308 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:49:14,613 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:49:14,619 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:49:14,623 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:49:15,956 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:49:33,487 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:49:34,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:49:34,971 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:49:35,183 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:49:50,543 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:49:50,548 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:49:50,549 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:49:51,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:49:51,579 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:49:51,586 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:49:54,325 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:50:05,951 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:50:06,368 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 10:50:07,286 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:50:10,233 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1705
2025-11-12 10:50:10,234 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:50:14,680 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 492
2025-11-12 10:50:14,681 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:50:15,718 - ispa_next.appointments.models - DEBUG - Appointment Herr Matthias Denzler BA-DZ 22 WBAUX31050A203051 ohne Termin.
2025-11-12 10:50:15,737 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 10:50:15,752 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 10:50:15,758 - ispa_next.main - DEBUG - Found new Appointment: BA-JR 3333
2025-11-12 10:50:15,760 - ispa_next.main - DEBUG - 



2025-11-12 10:50:15,760 - ispa_next.main - DEBUG - starting with process 12 (BA-JR 3333) of 20
2025-11-12 10:50:15,769 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:50:17,357 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:50:19,263 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1705
2025-11-12 10:50:19,265 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 492
2025-11-12 10:50:21,491 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:50:21,492 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:50:53,871 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:51:07,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:51:07,122 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:51:07,320 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:51:08,711 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:51:08,712 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:51:08,848 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:51:09,173 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:51:09,181 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:51:09,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:51:09,307 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:51:12,766 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:51:12,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:51:14,585 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:51:16,590 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:51:16,775 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:51:20,127 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:51:20,206 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:51:20,208 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:51:22,377 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:51:31,678 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:51:32,685 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:51:32,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:51:33,223 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:51:50,638 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:52:00,443 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:52:00,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:52:00,635 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:52:00,636 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:52:00,717 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:52:00,890 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:52:02,590 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:52:02,947 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:52:09,641 - ispa_next.functions - DEBUG - Updated appointment (AC00041356) customer contact data.
2025-11-12 10:52:10,603 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:52:10,652 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:52:10,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:52:12,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:52:13,963 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:52:14,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:52:14,148 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:52:18,849 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:52:19,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:52:20,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:52:22,067 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:52:22,197 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:52:22,458 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:52:22,536 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:52:22,537 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:52:25,390 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:52:36,744 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:52:41,859 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:52:41,860 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:52:44,729 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:52:49,018 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:52:50,029 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:52:50,030 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:52:50,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:52:50,158 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:52:54,296 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:52:54,303 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:52:54,303 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 10:52:54,307 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:52:57,076 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:52:57,078 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:52:58,344 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:52:58,345 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:52:58,350 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:52:58,352 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:52:58,358 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:52:58,360 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 10:52:58,361 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:52:58,367 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:52:58,369 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:52:58,374 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:52:58,376 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 10:52:59,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:53:00,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:53:17,658 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:53:17,663 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:53:17,668 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:53:17,668 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:53:20,368 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:53:20,374 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:53:20,377 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:53:23,126 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:53:23,126 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:53:23,130 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:53:25,837 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:53:25,844 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:53:25,847 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:53:28,645 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:53:50,585 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:53:51,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:53:52,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:53:52,595 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:54:19,195 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:54:24,965 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:54:31,241 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:54:31,245 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:54:31,246 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:54:32,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:54:32,330 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:54:32,335 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:54:35,164 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:54:47,721 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:54:48,125 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 10:54:49,536 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:54:52,159 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1705
2025-11-12 10:54:52,160 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:54:56,378 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 491
2025-11-12 10:54:56,378 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:54:57,483 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 10:54:57,500 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 10:54:57,507 - ispa_next.main - DEBUG - 



2025-11-12 10:54:57,507 - ispa_next.main - DEBUG - starting with process 13 (BA-EK 33) of 20
2025-11-12 10:54:57,514 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:54:59,027 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:55:00,938 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1705
2025-11-12 10:55:00,939 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 491
2025-11-12 10:55:03,134 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:55:03,135 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:55:40,318 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:55:43,067 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:55:49,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:55:51,899 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:55:51,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:55:51,978 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:55:52,350 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:55:52,354 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:55:52,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:55:52,448 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:55:55,950 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:55:55,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:55:57,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:55:59,774 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:55:59,935 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:56:00,182 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:56:00,379 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:56:04,734 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:56:05,742 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:56:05,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:56:06,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:56:22,595 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:56:22,596 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:56:29,223 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:56:29,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:56:29,377 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:56:29,378 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:56:29,474 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:56:30,912 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:56:31,278 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:56:34,721 - ispa_next.functions - DEBUG - Updated appointment (AC00041222) customer contact data.
2025-11-12 10:56:35,785 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:56:35,791 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:56:37,607 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:56:37,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:56:38,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:56:42,450 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:56:42,450 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:56:42,455 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:56:42,456 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:56:42,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:56:43,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:56:47,244 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:56:47,250 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:56:47,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:56:47,338 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:56:56,687 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 10:57:05,736 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-12 10:57:12,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:57:12,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:57:12,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:57:14,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:57:14,133 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:57:16,352 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:57:16,354 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:57:18,816 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:57:18,821 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:57:18,828 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:57:18,831 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:57:18,838 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:57:18,839 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:57:18,840 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:57:18,845 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:57:18,847 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:57:18,853 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:57:18,861 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:57:18,867 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:57:18,868 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:57:21,104 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:57:21,110 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:57:21,115 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:57:23,395 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:57:23,395 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:57:23,397 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:57:25,526 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:57:25,533 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:57:25,537 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:57:27,679 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:57:45,581 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:57:46,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:57:47,174 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:57:47,396 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:58:08,274 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:58:14,649 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:58:14,653 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:58:14,654 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:58:15,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:58:15,647 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:58:15,654 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:58:18,380 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:58:30,190 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:58:30,600 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 10:58:31,676 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:58:34,493 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1705
2025-11-12 10:58:34,502 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:58:38,751 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 487
2025-11-12 10:58:38,751 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:58:39,780 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 10:58:39,800 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 10:58:39,814 - ispa_next.main - DEBUG - 



2025-11-12 10:58:39,814 - ispa_next.main - DEBUG - starting with process 14 (BA-FS 2002) of 20
2025-11-12 10:58:39,823 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:58:41,469 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:58:43,525 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1705
2025-11-12 10:58:43,527 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 487
2025-11-12 10:58:45,758 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:58:45,759 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:59:26,334 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:59:29,038 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:59:35,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:59:37,599 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:59:37,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:59:37,741 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:59:38,047 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:59:38,057 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:59:38,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:59:38,160 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:59:47,412 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:59:47,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:59:49,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:59:51,272 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:59:51,408 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:59:51,554 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:59:51,684 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:59:55,893 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:59:56,900 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:59:56,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:59:57,480 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:00:14,625 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:00:21,345 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:00:21,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:00:21,461 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:00:21,463 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:00:21,562 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:00:23,036 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:00:23,375 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:00:27,100 - ispa_next.functions - DEBUG - Updated appointment (AC00040970) customer contact data.
2025-11-12 11:00:28,043 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:00:28,088 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:00:30,151 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:00:30,152 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:00:31,637 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:00:35,295 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:00:35,295 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:00:35,300 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:00:35,301 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:00:35,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:00:35,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:00:39,989 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:00:39,998 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:00:39,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:00:40,111 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:00:40,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:00:41,133 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:00:41,134 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:00:42,099 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:00:42,102 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:00:44,291 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:00:44,293 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:00:46,910 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:00:46,911 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:00:46,916 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:00:46,917 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:00:46,924 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:00:46,925 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:00:46,926 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:00:46,932 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:00:46,933 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:00:46,939 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:00:46,947 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:00:46,954 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:00:46,955 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:00:49,126 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:00:49,132 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:00:49,136 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:00:51,289 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:00:51,289 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:00:51,291 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:00:53,369 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:00:53,375 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:00:53,377 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:00:55,541 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:01:17,318 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:01:18,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:01:19,090 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:01:19,298 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:01:40,276 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:01:46,729 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:01:46,734 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:01:46,734 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:01:47,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:01:47,746 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:01:47,752 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:01:50,497 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:02:02,225 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:02:03,616 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 11:02:04,806 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:07,729 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1705
2025-11-12 11:02:07,731 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:02:12,935 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 487
2025-11-12 11:02:12,936 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:02:14,011 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 11:02:14,033 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 11:02:14,069 - ispa_next.main - DEBUG - 



2025-11-12 11:02:14,069 - ispa_next.main - DEBUG - starting with process 15 (BA-PE 76) of 20
2025-11-12 11:02:14,091 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:02:15,663 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:18,371 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1705
2025-11-12 11:02:18,372 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 487
2025-11-12 11:02:20,816 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:02:20,818 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:03:00,267 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:03:03,732 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:03:11,939 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:03:15,499 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:03:15,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:15,640 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:16,119 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:03:16,124 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:03:16,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:16,273 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:19,779 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:03:19,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:03:21,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:03:23,740 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:03:23,907 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:03:24,017 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:03:24,163 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:03:28,479 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:03:29,490 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:03:29,491 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:30,025 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:46,708 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:03:53,555 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:03:53,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:53,710 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:53,711 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:03:53,819 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:03:55,256 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:03:56,784 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:03:57,148 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:04:00,816 - ispa_next.functions - DEBUG - Updated appointment (AC00040790) customer contact data.
2025-11-12 11:04:02,060 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:04:02,066 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:04:03,958 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:04:03,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:04:05,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:04:09,027 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:04:09,027 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:04:09,034 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:04:09,035 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:04:09,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:09,556 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:04:13,707 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:04:13,713 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:04:13,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:13,854 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:04:22,941 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:04:33,630 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:04:33,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:34,865 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:04:34,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:04:35,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:04:35,785 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:04:39,051 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:04:39,060 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:04:41,748 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:04:41,750 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:04:41,758 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:04:41,760 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:04:41,767 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:04:41,769 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:04:41,770 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:04:41,776 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:04:41,778 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:04:41,783 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:04:41,792 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:04:41,804 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:04:41,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:45,618 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:04:45,625 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:04:45,642 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:49,249 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:04:49,250 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:04:49,253 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:52,773 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:04:52,779 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:04:52,782 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:04:56,306 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:05:16,097 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:05:16,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:05:17,966 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:05:18,202 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:52,900 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:05:59,840 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:06:05,911 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:06:12,779 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:06:12,783 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:06:12,784 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:06:13,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:06:13,879 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:06:13,884 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:06:16,764 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:06:29,147 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:06:29,547 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 11:06:30,737 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:33,812 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1708
2025-11-12 11:06:33,814 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:38,185 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 490
2025-11-12 11:06:38,186 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:06:39,362 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:06:39,377 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 11:06:39,401 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 11:06:39,427 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 11:06:39,438 - ispa_next.main - DEBUG - Found new Appointment: EBN-ST 777
2025-11-12 11:06:39,439 - ispa_next.main - DEBUG - 



2025-11-12 11:06:39,439 - ispa_next.main - DEBUG - starting with process 16 (EBN-ST 777) of 21
2025-11-12 11:06:39,449 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:06:40,977 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:42,716 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1708
2025-11-12 11:06:42,718 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 490
2025-11-12 11:06:45,078 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:45,079 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:07:31,953 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:07:44,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:45,104 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:07:45,325 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:07:46,728 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:07:46,729 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:46,850 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:07:47,178 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:07:47,185 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:07:47,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:07:47,365 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:08:02,455 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:08:02,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:08:04,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:08:06,896 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:08:07,075 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:08:07,209 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:08:07,333 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:08:07,335 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:08,728 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:08:20,511 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:08:25,260 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:08:25,261 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:26,589 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:08:30,846 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:08:31,853 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:08:31,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:32,495 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:47,192 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:08:56,744 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:08:56,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:57,004 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:08:57,005 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:08:57,091 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:08:57,331 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:08:58,926 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:08:59,302 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:09:05,515 - ispa_next.functions - DEBUG - Updated appointment (AC00041359) customer contact data.
2025-11-12 11:09:06,477 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:09:06,486 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:09:06,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:09:08,324 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:09:10,501 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:09:10,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:09:10,721 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:09:14,425 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:09:14,425 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:09:14,435 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:09:14,436 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:09:14,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:09:14,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:09:19,115 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:09:19,122 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:09:19,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:09:19,353 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:09:23,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:24,196 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:24,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:09:24,996 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:09:25,001 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:09:27,361 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:09:27,364 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:09:28,704 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:09:28,705 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:09:28,712 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:09:28,713 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:09:28,719 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:09:28,720 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 11:09:28,722 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:09:28,727 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:09:28,728 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:09:28,735 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:09:28,737 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 11:09:29,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:09:30,573 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:09:49,208 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:09:49,216 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:09:49,220 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:09:49,221 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:51,296 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:09:51,300 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:09:51,303 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:53,328 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:09:53,328 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:09:53,331 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:55,380 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:09:55,386 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:09:55,390 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:57,540 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:10:18,876 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:10:19,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:10:21,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:10:21,339 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:42,583 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:10:49,229 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:10:49,237 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:10:49,238 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:10:50,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:10:50,345 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:10:50,352 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:10:53,149 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:11:05,639 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:11:06,044 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 11:11:07,629 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:10,590 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1709
2025-11-12 11:11:10,592 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:15,177 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 491
2025-11-12 11:11:15,178 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:16,316 - ispa_next.appointments.models - DEBUG - Appointment Firma Chumbos Schweinfurt GmbH & Co SW-S 123E WBA41EU0709U67575 ohne Termin.
2025-11-12 11:11:16,317 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:11:16,332 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 11:11:16,354 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 11:11:16,360 - ispa_next.main - DEBUG - 



2025-11-12 11:11:16,360 - ispa_next.main - DEBUG - starting with process 17 (ER-S 2305E) of 21
2025-11-12 11:11:16,366 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:17,987 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:19,867 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1709
2025-11-12 11:11:19,869 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 491
2025-11-12 11:11:22,285 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:22,286 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:01,115 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:12:03,923 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:12:11,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:13,938 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:12:13,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:14,119 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:14,566 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:12:14,575 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:12:14,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:14,738 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:18,299 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:12:18,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:20,099 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:22,101 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:12:22,272 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:12:22,426 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:12:22,533 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:12:26,741 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:12:27,748 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:12:27,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:28,405 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:47,710 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:12:56,300 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:12:56,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:56,380 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:56,381 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:12:56,473 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:12:57,948 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:12:58,322 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:13:02,966 - ispa_next.functions - DEBUG - Updated appointment (AC00041046) customer contact data.
2025-11-12 11:13:04,016 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:13:04,178 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:13:05,251 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:13:05,252 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:13:06,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:13:10,332 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:13:10,332 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:13:10,337 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:13:10,338 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:13:10,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:10,870 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:13:15,116 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:13:15,123 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:13:15,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:15,248 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:13:24,399 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:13:31,066 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:13:31,068 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:32,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:32,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:32,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:13:32,849 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:13:35,635 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:13:35,637 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:13:38,657 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:13:38,659 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:13:38,667 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:13:38,671 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:13:38,677 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:13:38,679 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:13:38,685 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:13:38,686 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:13:38,692 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:13:38,700 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:13:38,709 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:13:38,710 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:41,739 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:13:41,746 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:13:41,748 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:44,576 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:13:44,576 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:13:44,578 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:47,385 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:13:47,389 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:13:47,391 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:50,275 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:14:10,844 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:14:11,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:14:12,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:14:12,883 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:14:41,946 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:48,017 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:55,107 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:14:55,112 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:14:55,113 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:56,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:14:56,141 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:14:56,145 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:14:59,143 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:15:11,889 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:15:12,274 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 11:15:13,484 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:16,642 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1709
2025-11-12 11:15:16,644 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:21,404 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 491
2025-11-12 11:15:21,405 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:22,601 - ispa_next.appointments.models - DEBUG - Appointment Firma Chumbos Schweinfurt GmbH & Co SW-S 123E WBA41EU0709U67575 ohne Termin.
2025-11-12 11:15:22,602 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:15:22,629 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 11:15:22,657 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 11:15:22,663 - ispa_next.main - DEBUG - 



2025-11-12 11:15:22,664 - ispa_next.main - DEBUG - starting with process 18 (BA-CR 4422) of 21
2025-11-12 11:15:22,669 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:15:24,275 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:26,099 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1709
2025-11-12 11:15:26,100 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 491
2025-11-12 11:15:28,468 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:28,470 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:17,399 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:16:20,206 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:16:26,288 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:29,009 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:16:29,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:29,138 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:16:29,515 - ispa_next.functions - DEBUG - HU date already expired after 780 days.
2025-11-12 11:16:35,273 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:16:35,277 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:16:35,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:35,358 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:16:44,259 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:16:44,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:16:46,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:16:48,199 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:16:48,388 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:16:48,536 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:16:48,613 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:16:52,857 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:16:53,866 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:16:53,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:54,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:10,218 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:17:10,219 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:17:16,224 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:17:16,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:16,365 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:16,366 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:17:16,405 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:17:16,682 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:17:18,377 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:17:18,715 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:17:23,802 - ispa_next.functions - DEBUG - Updated appointment (AC00041239) customer contact data.
2025-11-12 11:17:24,757 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:17:24,764 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:17:25,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:17:26,586 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:17:28,068 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:17:28,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:17:28,188 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:17:31,834 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:17:31,834 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:17:31,843 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:17:31,844 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:17:31,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:32,481 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:36,623 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:17:36,632 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:17:36,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:36,829 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:17:40,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:41,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:41,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:42,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:42,366 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:17:45,093 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:17:45,096 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:17:47,607 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:17:47,612 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:17:47,619 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:17:47,620 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:17:47,627 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:17:47,628 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:17:47,629 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:17:47,635 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:17:47,636 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:17:47,642 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:17:47,650 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:17:47,656 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:17:47,657 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:50,686 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:17:50,693 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:17:50,695 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:53,517 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:17:53,518 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:17:53,520 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:56,337 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:17:56,344 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:17:56,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:59,251 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:18:18,004 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:18:18,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:19,756 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:18:20,000 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:50,138 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:56,341 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:19:02,891 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:19:02,896 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:19:02,897 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:19:03,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:19:03,952 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:19:03,976 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:19:06,860 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:19:21,417 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:19:21,795 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 11:19:22,829 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:19:25,878 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1709
2025-11-12 11:19:25,880 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:19:30,304 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 491
2025-11-12 11:19:30,305 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:31,376 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:19:31,392 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 11:19:31,422 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 11:19:31,433 - ispa_next.main - DEBUG - Found new Appointment: SW-S 123E
2025-11-12 11:19:31,435 - ispa_next.main - DEBUG - 



2025-11-12 11:19:31,435 - ispa_next.main - DEBUG - starting with process 19 (SW-S 123E) of 22
2025-11-12 11:19:31,445 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:19:33,037 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:19:34,736 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1709
2025-11-12 11:19:34,737 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 491
2025-11-12 11:19:37,406 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:19:37,408 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:20:22,202 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:20:36,494 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:42,808 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:20:42,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:42,936 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:43,253 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:20:53,174 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:20:53,180 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:20:53,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:53,288 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:56,543 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:20:56,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:58,672 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:21:00,675 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:21:00,836 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:21:01,016 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:21:01,137 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:21:05,408 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:21:06,418 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:21:06,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:07,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:25,814 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:21:38,558 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:21:38,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:21:38,715 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:21:38,716 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:21:38,801 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:21:40,388 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:21:40,769 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:21:46,985 - ispa_next.functions - DEBUG - Updated appointment (AC00041362) customer contact data.
2025-11-12 11:21:47,981 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:21:47,989 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:21:50,464 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:21:50,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:21:51,996 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:21:55,648 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:21:55,648 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:21:55,653 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:21:55,654 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:21:55,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:56,189 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:22:00,339 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:22:01,556 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:22:25,577 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:22:25,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:25,805 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:22:31,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:32,440 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:32,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:33,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:22:33,933 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:22:40,177 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:22:40,179 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:22:42,891 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:22:42,893 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:22:42,902 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:22:42,904 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:22:42,911 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 11:22:42,914 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:22:42,920 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:22:42,921 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:22:42,928 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:22:42,933 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 11:22:47,751 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:22:48,336 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:22:50,893 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:22:51,610 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:22:52,170 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:22:53,155 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:22:53,896 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:22:54,469 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:22:55,421 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:22:56,114 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:22:56,677 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:22:57,713 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:22:58,330 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:22:58,896 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:22:59,880 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:23:00,561 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:23:01,120 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:23:02,064 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:23:02,732 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:23:03,291 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:23:04,248 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:23:04,921 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:23:05,488 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:23:06,440 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:23:08,550 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:23:09,591 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:23:11,297 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 11:23:12,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:23:14,152 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:23:38,714 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:23:38,735 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:23:38,784 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:23:38,786 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:44,955 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:23:44,960 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:23:44,963 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:51,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:23:51,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:08,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:30,985 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:24:30,985 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:24:30,987 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:37,131 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:24:37,137 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:24:37,140 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:43,257 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:25:17,295 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:25:18,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:25:20,045 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:25:20,430 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:52,426 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:25:52,427 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:25:54,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:25:54,511 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:25:54,517 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:26:04,863 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:26:29,488 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:26:29,866 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 11:26:37,580 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:26:39,729 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1634
2025-11-12 11:26:39,731 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:26:48,751 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 476
2025-11-12 11:26:48,752 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:26:50,763 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:26:50,784 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 11:26:50,837 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 11:26:50,848 - ispa_next.main - DEBUG - 



2025-11-12 11:26:50,848 - ispa_next.main - DEBUG - starting with process 20 (BA-L 938) of 22
2025-11-12 11:26:50,861 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:26:53,882 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:26:57,333 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1634
2025-11-12 11:26:57,335 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 476
2025-11-12 11:27:01,895 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:27:01,897 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:28:01,723 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:28:06,762 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:28:16,989 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:19,927 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:28:19,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:20,134 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:28:20,604 - ispa_next.functions - DEBUG - HU date already expired after 322 days.
2025-11-12 11:28:33,054 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:28:33,064 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:28:33,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:33,170 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:28:48,070 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:28:48,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:28:50,779 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:28:52,782 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:28:53,022 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:28:53,264 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:28:53,496 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:28:57,814 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:28:58,835 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:28:58,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:00,231 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:26,134 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:29:39,173 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:29:39,177 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:40,543 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:29:40,546 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:29:40,936 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:29:41,198 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:29:42,933 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:29:43,599 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:29:48,334 - ispa_next.functions - DEBUG - Updated appointment (AC00041260) customer contact data.
2025-11-12 11:29:49,435 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:29:49,521 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:29:49,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:29:51,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:29:54,196 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:29:54,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:29:54,376 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:29:58,572 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:29:58,572 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:29:58,580 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:29:58,582 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:29:58,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:59,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:30:03,563 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:30:03,573 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:30:03,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:30:03,769 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:30:04,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:30:04,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:30:04,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:30:06,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:30:06,136 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:30:08,949 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:30:08,953 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:30:12,590 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:30:12,592 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:30:12,598 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:30:12,599 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:30:12,606 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:30:12,607 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:30:12,608 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:30:12,619 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:30:12,620 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:30:12,627 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:30:12,636 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:30:12,643 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:30:12,644 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:15,816 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:30:15,823 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:30:15,826 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:18,784 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:30:18,784 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:30:18,787 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:21,678 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:30:21,683 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:30:21,686 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:24,721 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:30:57,876 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:30:58,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:31:00,644 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:31:01,080 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:32,806 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:42,375 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:52,404 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:52,412 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:31:52,413 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:54,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:31:54,396 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:31:54,400 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:31:59,264 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:32:21,393 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:32:21,801 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-12 11:32:23,354 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:32:31,265 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:32:31,267 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:32:39,695 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 474
2025-11-12 11:32:39,696 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:32:41,620 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:32:41,654 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 11:32:41,676 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 11:32:41,683 - ispa_next.main - DEBUG - 



2025-11-12 11:32:41,683 - ispa_next.main - DEBUG - starting with process 21 (BA-AR 4321) of 22
2025-11-12 11:32:41,689 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:32:44,700 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:32:48,158 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1633
2025-11-12 11:32:48,160 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 474
2025-11-12 11:32:52,583 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:32:52,585 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:33:56,485 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:34:02,080 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:34:12,303 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:34:13,593 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:34:13,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:13,742 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:34:14,240 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:34:14,248 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:34:14,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:14,589 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:34:18,738 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:34:18,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:34:21,895 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:34:23,898 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:34:24,157 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:34:24,364 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:34:24,542 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:34:29,004 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:34:30,014 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:34:30,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:30,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:55,800 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:35:07,165 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:35:07,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:07,376 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:35:07,377 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:35:07,507 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:35:09,273 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:35:11,149 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:35:11,546 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:35:17,434 - ispa_next.functions - DEBUG - Updated appointment (AC00041090) customer contact data.
2025-11-12 11:35:18,571 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:35:18,657 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:35:20,816 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:35:20,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:35:23,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:35:26,748 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:35:26,748 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:35:26,757 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:35:26,758 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:35:26,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:35:28,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:35:32,443 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:35:32,453 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:35:32,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:35:32,666 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:35:36,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:37,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:37,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:35:38,815 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:35:38,821 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:35:40,475 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:35:40,477 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:35:44,352 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:35:44,355 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:35:44,362 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:35:44,364 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:35:44,372 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:35:44,375 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:35:44,376 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:35:44,381 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:35:44,383 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:35:44,389 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:35:44,397 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:35:44,404 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:35:44,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:46,139 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:35:46,146 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:35:46,148 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:47,569 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:35:47,569 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:35:47,572 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:48,998 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:35:49,005 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:35:49,008 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:50,514 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:36:22,822 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:36:24,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:36:25,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:36:26,127 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:43,523 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:36:43,528 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:36:43,529 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:36:45,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:36:45,514 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:36:45,520 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:36:50,437 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:37:13,222 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:37:13,652 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 21.
2025-11-12 11:37:15,270 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:37:23,406 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1634
2025-11-12 11:37:23,408 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:37:31,911 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 475
2025-11-12 11:37:31,913 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:37:33,852 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:37:33,882 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 11:37:33,903 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 11:37:33,909 - ispa_next.main - DEBUG - Found new Appointment: HAS-SG 136
2025-11-12 11:37:33,911 - ispa_next.main - DEBUG - 



2025-11-12 11:37:33,911 - ispa_next.main - DEBUG - starting with process 22 (HAS-SG 136) of 23
2025-11-12 11:37:33,917 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:37:36,931 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:37:40,510 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1634
2025-11-12 11:37:40,512 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 475
2025-11-12 11:37:45,171 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:37:45,172 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:38:45,816 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:39:06,356 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:09,994 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:39:09,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:39:10,148 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:39:10,667 - ispa_next.functions - DEBUG - HU date already expired after 209 days.
2025-11-12 11:39:26,253 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:39:26,261 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:39:26,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:39:26,391 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:39:45,752 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:39:45,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:39:48,176 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:39:50,180 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:39:50,417 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:39:53,777 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:39:53,993 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:39:53,997 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:58,040 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:40:09,080 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:40:10,088 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:40:10,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:10,759 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:37,248 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:40:54,597 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:40:54,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:54,709 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:40:54,710 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:40:54,912 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:40:56,679 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:40:58,265 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:40:58,610 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:41:07,331 - ispa_next.functions - DEBUG - Updated appointment (AC00041363) customer contact data.
2025-11-12 11:41:08,505 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:41:08,560 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:41:10,888 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:41:10,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:41:12,736 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:41:17,486 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:41:18,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:19,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:41:21,748 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:41:22,182 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:41:22,995 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:41:23,361 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:41:23,369 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:28,705 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:41:39,456 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:41:46,460 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:41:58,315 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 11:42:06,215 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:42:06,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:42:12,430 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 11:42:16,910 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:42:20,445 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:42:21,456 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:42:21,457 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:42:21,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:42:21,599 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:42:25,911 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:42:27,870 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:42:48,095 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:42:48,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:42:48,312 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:42:48,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:49,630 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:49,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:42:50,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:42:50,895 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:42:56,608 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:42:56,612 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:42:59,356 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:42:59,359 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:42:59,366 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:42:59,370 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:42:59,379 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:42:59,382 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 11:42:59,384 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:42:59,390 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:42:59,391 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:42:59,397 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:42:59,409 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 11:43:00,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:43:01,892 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:43:29,147 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:43:29,152 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:43:29,157 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:43:29,158 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:33,580 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:43:33,587 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:43:33,591 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:38,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:43:38,793 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:43:50,578 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:11,008 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:44:11,008 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:44:11,012 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:15,497 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:44:15,502 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:44:15,505 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:20,042 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:44:52,072 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:44:53,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:44:54,583 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:44:54,984 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:45:39,771 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:45:50,217 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:46:03,814 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:46:03,815 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:46:05,684 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:46:05,831 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:46:05,840 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:46:19,886 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:46:42,808 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:46:43,224 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 22.
2025-11-12 11:46:51,850 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:46:53,954 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1634
2025-11-12 11:46:53,956 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:47:03,426 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 475
2025-11-12 11:47:03,427 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:47:05,484 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 11:47:05,505 - ispa_next.appointments.models - DEBUG - Appointment Firma Automobile Hofmann  WBA21DN0409T24423 ohne Termin.
2025-11-12 11:47:05,514 - ispa_next.main - DEBUG - 



2025-11-12 11:47:05,514 - ispa_next.main - DEBUG - starting with process 23 (BA-A 1284) of 23
2025-11-12 11:47:05,520 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:47:08,533 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:47:12,288 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1634
2025-11-12 11:47:12,291 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 475
2025-11-12 11:47:16,694 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:47:16,696 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:48:15,141 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:48:21,584 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:48:33,481 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:48:34,904 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:48:34,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:48:35,040 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:48:35,551 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:48:35,560 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:48:35,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:48:35,760 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:48:50,006 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:48:50,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:48:52,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:48:54,776 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:48:55,546 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:48:55,770 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:48:55,966 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:49:00,320 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:49:01,327 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:49:01,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:49:02,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:49:27,146 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:49:37,304 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:49:37,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:49:37,439 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:49:37,441 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:49:37,601 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:49:39,341 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:49:41,021 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:49:41,683 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:49:46,343 - ispa_next.functions - DEBUG - Updated appointment (AE00025445) customer contact data.
2025-11-12 11:49:49,480 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:49:49,529 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:49:51,735 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:49:51,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:49:53,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:49:57,442 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:49:57,442 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:49:57,452 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:49:57,453 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:49:57,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:49:58,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:50:02,382 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:50:02,388 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:50:02,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:50:02,594 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:50:06,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:50:07,713 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:50:07,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:50:08,917 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:50:08,923 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:50:10,486 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:50:10,489 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:50:14,107 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:50:14,108 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:50:14,115 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:50:14,117 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:50:14,124 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:50:14,126 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:50:14,127 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:50:14,175 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:50:14,176 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:50:14,187 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:50:14,203 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:50:14,210 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:50:14,211 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:50:15,677 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:50:15,684 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:50:15,686 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:50:17,329 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:50:17,329 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:50:17,350 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:50:18,892 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:50:18,898 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:50:18,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:50:20,295 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:50:50,501 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:50:51,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:50:53,137 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:50:53,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:51:13,430 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:51:13,438 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:51:13,439 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:51:15,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:51:15,466 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:51:15,472 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:51:20,292 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:51:43,240 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:51:43,617 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 23.
2025-11-12 11:51:45,142 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:51:53,085 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1635
2025-11-12 11:51:53,087 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:52:01,683 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 476
2025-11-12 11:52:01,684 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:52:03,668 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 11:52:03,678 - ispa_next.main - DEBUG - Found new Appointment: BA-A 68E
2025-11-12 11:52:03,680 - ispa_next.main - DEBUG - 



2025-11-12 11:52:03,680 - ispa_next.main - DEBUG - starting with process 24 (BA-A 68E) of 24
2025-11-12 11:52:03,686 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:52:06,723 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:52:13,286 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1635
2025-11-12 11:52:13,288 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 476
2025-11-12 11:52:18,023 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:52:18,027 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:52:58,954 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:53:22,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:53:22,587 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:53:23,034 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:53:25,172 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:53:25,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:53:25,357 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:53:25,941 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:53:25,949 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:53:25,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:53:26,188 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:53:30,358 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:53:30,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:53:33,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:53:35,707 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:53:35,966 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:53:39,374 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:53:55,676 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 11:53:56,685 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:53:56,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:53:58,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:54:24,541 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:54:40,248 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:54:40,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:54:40,370 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:54:40,371 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:54:40,511 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:54:42,371 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:54:42,725 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:54:51,953 - ispa_next.functions - DEBUG - Updated appointment (AC00041365) customer contact data.
2025-11-12 11:54:53,148 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:54:53,215 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:54:55,560 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:54:55,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:54:57,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:55:01,193 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:55:01,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:55:01,931 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:55:03,934 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:55:04,128 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:55:04,430 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:55:04,614 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:55:04,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:55:06,954 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:55:18,324 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:55:59,327 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:56:11,228 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:56:20,472 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:56:20,475 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:56:22,738 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:56:27,015 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:56:28,029 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:56:28,034 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:56:28,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:56:28,499 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:56:33,949 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:56:33,956 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:56:33,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:56:34,111 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:56:44,142 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:56:54,970 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:56:55,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:56:56,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:56:56,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:56:57,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:56:57,929 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:57:00,113 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:57:00,117 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:57:02,392 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:57:02,395 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:57:02,402 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-12 11:57:02,407 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:57:02,416 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:57:02,418 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 11:57:02,420 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:57:02,427 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:57:02,428 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:57:02,435 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:57:02,437 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:57:29,275 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:57:29,703 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 11:57:31,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:57:33,209 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:58:00,661 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:58:00,750 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-12 11:58:18,020 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:58:18,091 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:58:18,094 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:58:21,016 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:58:21,023 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:58:21,026 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:58:24,005 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:58:24,005 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:58:24,008 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:58:27,018 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:58:27,025 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:58:27,028 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:58:30,023 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:59:03,868 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:59:05,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:59:07,050 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:59:07,473 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:59:39,310 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:59:50,737 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:00:01,697 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:00:01,705 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:00:01,706 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:00:03,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:00:03,749 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:00:03,754 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:00:08,811 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:00:30,985 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:00:31,442 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 24.
2025-11-12 12:00:34,440 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:00:40,985 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1636
2025-11-12 12:00:40,987 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:00:50,165 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 477
2025-11-12 12:00:50,166 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:00:52,129 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
