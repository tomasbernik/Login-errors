2025-11-17 14:21:40,939 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 14:21:40,945 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 14:21:49,096 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:21:59,600 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:22:15,104 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:24:13,416 - ispa_next.app_start.main - DEBUG - Operation already took 106.98 seconds (more than 80 seconds)
2025-11-17 14:24:15,495 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8647f83cb7950689\\tess__b9_zhr__input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8647f83cb7950689\\tess__b9_zhr_', 'txt']
2025-11-17 14:24:15,745 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 14:24:15,752 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 14:24:15,753 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:26:14,869 - ispa_next.app_start.main - DEBUG - Operation already took 106.80 seconds (more than 80 seconds)
2025-11-17 14:26:16,928 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8647f83cb7950689\\tess_3ksf0ato_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8647f83cb7950689\\tess_3ksf0ato', 'txt']
2025-11-17 14:26:17,177 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 14:26:17,185 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 14:26:26,025 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 14:26:35,644 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:26:46,283 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:27:01,794 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:28:59,755 - ispa_next.app_start.main - DEBUG - Operation already took 106.86 seconds (more than 80 seconds)
2025-11-17 14:29:01,833 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8647f83cb7950689\\tess_nm4swaio_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8647f83cb7950689\\tess_nm4swaio', 'txt']
2025-11-17 14:29:02,067 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 14:29:02,071 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 14:29:02,071 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:31:01,440 - ispa_next.app_start.main - DEBUG - Operation already took 107.08 seconds (more than 80 seconds)
2025-11-17 14:31:03,519 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8647f83cb7950689\\tess_yxaqcin7_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8647f83cb7950689\\tess_yxaqcin7', 'txt']
2025-11-17 14:31:03,783 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 14:31:03,787 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 14:31:12,496 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 14:31:21,470 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:31:31,936 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:31:47,354 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:32:11,144 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 14:32:24,509 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 14:32:27,027 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:32:28,211 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-17 14:32:28,213 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 106
2025-11-17 14:32:30,487 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 67
2025-11-17 14:32:30,488 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 14:32:30,488 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:32:31,508 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:32:32,625 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:32:41,983 - ispa_next.appointments.models - DEBUG - Appointment Serhii Saksonov AC-BQ 35 WBA3K11080F855468 ohne Termin.
2025-11-17 14:32:42,019 - ispa_next.appointments.models - DEBUG - Appointment Oliver-Thomas Brauwers RÜD-BB 989 WBA2V11000LE79050 ohne Termin.
2025-11-17 14:32:42,025 - ispa_next.appointments.models - DEBUG - Appointment Firma Aleksander Wozniczka SWA-K 848 WMWWJ510703G36271 ohne Termin.
2025-11-17 14:32:42,034 - ispa_next.appointments.models - DEBUG - Appointment Wilfried Muth SWA-WM 317 WBATY15040N035953 ohne Termin.
2025-11-17 14:32:42,041 - ispa_next.appointments.models - DEBUG - Appointment Jens Gebken RÜD-EU 190 WBA5V310X0FH69089 ohne Termin.
2025-11-17 14:32:42,050 - ispa_next.appointments.models - DEBUG - Appointment Marco Autor SWA-EA 611 WBATY15030N028721 ohne Termin.
2025-11-17 14:32:42,057 - ispa_next.appointments.models - DEBUG - Appointment Antje Rohrmus WI-AR 967 WBAHF11000WW48373 ohne Termin.
2025-11-17 14:32:42,067 - ispa_next.appointments.models - DEBUG - Appointment Christian Holderbaum RÜD-CH 149 WBA2D310205C64160 ohne Termin.
2025-11-17 14:32:42,071 - ispa_next.main - DEBUG - Found 1 out of 20 appointments to process (configured limit: 15).
2025-11-17 14:32:42,072 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-17 14:32:42,072 - ispa_next.main - DEBUG - All appointments: RÜD-M 799 E
2025-11-17 14:32:42,075 - ispa_next.main - DEBUG - 



2025-11-17 14:32:42,075 - ispa_next.main - DEBUG - starting with process 1 (RÜD-M 799 E) of 1
2025-11-17 14:32:42,079 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:32:43,231 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:32:44,341 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-17 14:32:44,343 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 67
2025-11-17 14:32:45,691 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:32:45,692 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:33:13,942 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:33:23,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:33:27,136 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:33:27,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:33:27,240 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:33:27,428 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:33:27,432 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:33:27,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:33:27,505 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:33:30,498 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:33:30,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:33:31,369 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:33:33,378 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:33:33,501 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:33:33,582 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:33:33,664 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:33:35,758 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:33:36,774 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:33:36,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:33:37,248 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:33:49,412 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:33:55,737 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:33:55,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:33:55,831 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:33:55,838 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:33:55,875 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:33:57,069 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:33:57,349 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:34:00,174 - ispa_next.functions - DEBUG - Updated appointment (AB00018901) customer contact data.
2025-11-17 14:34:01,077 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:34:01,079 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:34:01,614 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:34:01,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:34:02,222 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:34:06,671 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:34:06,671 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:34:06,673 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:34:06,675 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:34:06,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:34:07,184 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:34:11,381 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:34:11,891 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:34:22,149 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:34:22,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:34:22,239 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:34:27,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:34:28,467 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:34:28,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:34:29,442 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:34:29,445 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:34:33,025 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:34:33,026 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:34:34,459 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:34:34,459 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:34:34,463 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart), Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 14:34:34,463 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:34:34,465 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:34:34,465 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: active placement guards
2025-11-17 14:34:34,467 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:34:34,469 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:34:34,471 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:34:34,471 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:34:34,473 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:34:34,477 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:34:35,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:34:35,877 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:34:49,664 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:34:49,667 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:34:49,668 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:34:49,670 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:34:54,316 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:34:54,320 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:34:54,322 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:34:58,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:34:59,421 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:35:08,533 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:35:24,641 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:35:24,643 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:35:24,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:35:25,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:35:25,522 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:35:25,528 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:35:30,201 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:35:42,954 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:35:43,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:35:43,969 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:35:44,186 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:36:19,231 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:36:19,233 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:36:20,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:36:20,281 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:36:20,283 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:36:24,204 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:36:37,750 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:36:38,181 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 14:36:40,095 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:36:41,069 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-17 14:36:41,071 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:36:45,205 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 106
2025-11-17 14:36:45,206 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:36:46,393 - ispa_next.appointments.models - DEBUG - Appointment Serhii Saksonov AC-BQ 35 WBA3K11080F855468 ohne Termin.
