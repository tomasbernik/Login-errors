2025-11-17 09:07:37,002 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 09:07:37,023 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 09:07:45,377 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:07:56,193 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:08:11,713 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:08:43,383 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 09:09:01,056 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 09:09:03,826 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:09:05,091 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 881
2025-11-17 09:09:05,092 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 268
2025-11-17 09:09:07,794 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 67
2025-11-17 09:09:07,794 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 09:09:07,795 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:09:08,790 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:09:09,539 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:09:17,509 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:09:17,534 - ispa_next.appointments.models - DEBUG - Appointment Daniel Tin FD-T 115 WBAJP310X0BT73435 ohne Termin.
2025-11-17 09:09:17,535 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:09:17,543 - ispa_next.appointments.models - DEBUG - Appointment Edgar Blum VB-EB 903 WBA5V51090AE18702 ohne Termin.
2025-11-17 09:09:17,543 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:09:17,551 - ispa_next.appointments.models - DEBUG - Appointment Sarah Rockel VB-SR 4592 WBAJF31060WW33714 ohne Termin.
2025-11-17 09:09:17,561 - ispa_next.appointments.models - DEBUG - Appointment Edwin Schneider VB-CF 8691 WBATX31040LC42233 ohne Termin.
2025-11-17 09:09:17,568 - ispa_next.appointments.models - DEBUG - Appointment Rudolf Panzner FD-BR 42 WBAUJ710209C56237 ohne Termin.
2025-11-17 09:09:17,575 - ispa_next.appointments.models - DEBUG - Appointment Mahmut Odabasi FD-IL 1983 WBAJP31070BT73358 ohne Termin.
2025-11-17 09:09:17,582 - ispa_next.appointments.models - DEBUG - Appointment Elisabeth Jonas FD-M 100 WBAJF31050WW40413 ohne Termin.
2025-11-17 09:09:17,582 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:09:17,590 - ispa_next.appointments.models - DEBUG - Appointment Andreas Dumler FD-ED 2206 WBA6L51070FJ14696 ohne Termin.
2025-11-17 09:09:17,590 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:09:17,591 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:09:17,591 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:09:17,591 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:09:17,592 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:09:17,592 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:09:17,596 - ispa_next.main - DEBUG - Found 1 out of 11 appointments to process (configured limit: 15).
2025-11-17 09:09:17,596 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-17 09:09:17,596 - ispa_next.main - DEBUG - All appointments: FD:S 1110E
2025-11-17 09:09:17,598 - ispa_next.main - DEBUG - 



2025-11-17 09:09:17,599 - ispa_next.main - DEBUG - starting with process 1 (FD:S 1110E) of 1
2025-11-17 09:09:17,601 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:09:18,727 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:09:19,992 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 881
2025-11-17 09:09:19,994 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 67
2025-11-17 09:09:21,450 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:09:21,452 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:09:54,933 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:09:55,010 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 09:09:55,012 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:09:55,545 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 881
2025-11-17 09:09:55,545 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:09:58,122 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 268
2025-11-17 09:09:58,123 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:09:58,937 - ispa_next.appointments.models - DEBUG - Appointment Lothar Emil Franz Brehl FD-CB 4444 WBA1R510407B41585 ohne Termin.
2025-11-17 09:09:58,942 - ispa_next.appointments.models - DEBUG - Appointment Uta King FD-UK 1811 WBAWY710X00N41631 ohne Termin.
2025-11-17 09:09:58,947 - ispa_next.main - DEBUG - Found new Appointment: FD-CB 4444
2025-11-17 09:09:58,947 - ispa_next.main - DEBUG - Found new Appointment: FD-EX 20 E
2025-11-17 09:09:58,948 - ispa_next.main - DEBUG - 



2025-11-17 09:09:58,948 - ispa_next.main - DEBUG - starting with process 2 (FD-CB 4444) of 3
2025-11-17 09:09:58,951 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:09:59,779 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:10:00,858 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 881
2025-11-17 09:10:00,859 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 268
2025-11-17 09:10:02,146 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:10:02,147 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:10:23,971 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:10:34,276 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:10:36,858 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:10:36,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:10:36,921 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:10:37,096 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:10:37,098 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:10:39,844 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:10:39,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:10:40,591 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:10:42,595 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:10:42,723 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:10:45,936 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:10:46,003 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:10:46,005 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:10:48,630 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:10:59,887 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:11:00,892 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:11:00,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:11:01,370 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:11:11,293 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:11:11,293 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 09:11:17,475 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:11:17,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:11:17,547 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:11:17,547 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:11:17,589 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:11:18,814 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:11:19,978 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:11:20,261 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:11:23,134 - ispa_next.functions - DEBUG - Updated appointment (AB00060555) customer contact data.
2025-11-17 09:11:24,046 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:11:24,049 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:11:24,810 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:11:24,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:11:25,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:11:29,042 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:11:29,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:11:29,540 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:11:31,565 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:11:31,671 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:11:31,778 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:11:31,854 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:11:31,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:11:34,464 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:11:45,706 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:12:45,708 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:12:57,275 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 09:13:04,489 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:13:04,491 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:13:07,129 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:13:09,254 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:13:10,261 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:13:10,261 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:13:10,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:13:10,334 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:13:14,442 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:13:15,058 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 09:13:29,630 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:13:29,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:13:29,842 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:13:30,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:13:30,719 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:13:30,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:13:31,543 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:13:31,544 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:13:34,013 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:13:34,017 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:13:35,265 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:13:35,268 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:13:35,271 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 09:13:35,272 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:13:35,274 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:13:35,275 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:13:35,277 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:13:35,278 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:13:35,279 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:13:35,280 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:13:35,282 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:13:35,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:13:36,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:14:04,217 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:14:04,219 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:14:04,220 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:14:04,221 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:14:07,555 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 09:14:12,269 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:14:12,270 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:14:12,302 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:14:15,710 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:14:15,711 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:14:15,712 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:14:16,270 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:14:16,586 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:14:26,471 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:14:26,472 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:14:26,474 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:14:26,475 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:14:26,476 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:14:27,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:14:27,871 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:14:27,871 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:14:30,011 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:14:43,057 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:14:43,434 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 09:14:46,306 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:14:47,301 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 881
2025-11-17 09:14:47,302 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:14:51,598 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 269
2025-11-17 09:14:51,599 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:14:52,747 - ispa_next.appointments.models - DEBUG - Appointment Firma EDAG Engineering GmbH FD-ED 544 WBA51EG0305X45685 ohne Termin.
2025-11-17 09:14:52,753 - ispa_next.appointments.models - DEBUG - Appointment Lothar Emil Franz Brehl FD-CB 4444 WBA1R510407B41585 ohne Termin.
2025-11-17 09:14:52,759 - ispa_next.appointments.models - DEBUG - Appointment Uta King FD-UK 1811 WBAWY710X00N41631 ohne Termin.
2025-11-17 09:14:52,766 - ispa_next.main - DEBUG - 



2025-11-17 09:14:52,766 - ispa_next.main - DEBUG - starting with process 3 (FD-EX 20 E) of 3
2025-11-17 09:14:52,769 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:14:54,555 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:14:56,055 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 881
2025-11-17 09:14:56,056 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 269
2025-11-17 09:14:57,906 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:14:57,907 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:15:28,654 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:15:31,584 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-17 09:15:37,924 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:15:40,508 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:15:40,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:15:40,593 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:15:40,864 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:15:40,866 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:15:44,133 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:15:44,134 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:15:45,362 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:15:47,368 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:15:47,530 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:15:47,651 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:15:47,770 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:15:52,003 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:15:53,012 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:15:53,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:15:53,580 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:16:06,474 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:16:12,368 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:16:12,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:16:12,475 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:16:12,475 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:16:12,533 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:16:13,718 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:16:14,881 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:16:15,120 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:16:17,067 - ispa_next.functions - DEBUG - Updated appointment (AC00069333) customer contact data.
2025-11-17 09:16:17,973 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:16:17,974 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:16:19,288 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:16:19,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:16:20,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:16:23,853 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:16:23,853 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:16:23,858 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:16:23,860 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:16:23,861 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:16:24,576 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:16:28,752 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:16:28,756 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:16:28,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:16:28,863 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:16:38,017 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 09:16:43,956 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 09:16:43,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:16:44,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:16:44,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:16:45,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:16:45,404 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:16:48,091 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:16:48,093 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:16:50,278 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:16:50,279 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:16:50,280 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:16:50,281 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:16:50,283 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:16:50,284 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:16:50,285 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:16:50,286 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:16:50,287 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:16:50,290 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:16:50,291 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:16:50,292 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:16:52,901 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:16:52,902 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:16:52,904 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:16:55,448 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:16:55,449 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:16:55,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:16:56,335 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:16:56,649 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:17:12,678 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:17:12,679 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:17:12,681 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:17:12,682 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:17:12,683 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:17:13,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:17:14,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:17:14,329 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:17:17,013 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:17:27,702 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:17:28,103 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 09:17:28,748 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:17:31,372 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 881
2025-11-17 09:17:31,373 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:17:35,780 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 269
2025-11-17 09:17:35,781 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:17:36,908 - ispa_next.appointments.models - DEBUG - Appointment Firma EDAG Engineering GmbH FD-ED 544 WBA51EG0305X45685 ohne Termin.
2025-11-17 09:17:36,916 - ispa_next.appointments.models - DEBUG - Appointment Lothar Emil Franz Brehl FD-CB 4444 WBA1R510407B41585 ohne Termin.
2025-11-17 09:17:36,923 - ispa_next.appointments.models - DEBUG - Appointment Uta King FD-UK 1811 WBAWY710X00N41631 ohne Termin.
