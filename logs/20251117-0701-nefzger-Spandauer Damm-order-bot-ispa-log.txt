2025-11-17 07:08:24,670 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 07:08:24,676 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 07:08:37,322 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 07:08:49,442 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 07:09:05,336 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:11:06,336 - ispa_next.app_start.main - DEBUG - Operation already took 109.48 seconds (more than 80 seconds)
2025-11-17 07:11:08,422 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fb8dafb2a4a05418\\tess_o26o050y_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fb8dafb2a4a05418\\tess_o26o050y', 'txt']
2025-11-17 07:11:10,240 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:11:10,244 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:11:10,245 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:13:11,996 - ispa_next.app_start.main - DEBUG - Operation already took 109.28 seconds (more than 80 seconds)
2025-11-17 07:13:14,077 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fb8dafb2a4a05418\\tess_k0bxcddb_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fb8dafb2a4a05418\\tess_k0bxcddb', 'txt']
2025-11-17 07:13:14,404 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:13:14,410 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:13:18,458 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 07:13:28,497 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 07:13:39,967 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 07:13:55,971 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:15:55,883 - ispa_next.app_start.main - DEBUG - Operation already took 108.78 seconds (more than 80 seconds)
2025-11-17 07:15:57,984 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fb8dafb2a4a05418\\tess_s578w95i_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fb8dafb2a4a05418\\tess_s578w95i', 'txt']
2025-11-17 07:15:58,279 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:15:58,284 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:15:58,285 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:17:59,434 - ispa_next.app_start.main - DEBUG - Operation already took 108.65 seconds (more than 80 seconds)
2025-11-17 07:18:01,519 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fb8dafb2a4a05418\\tess_5pu4usrd_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fb8dafb2a4a05418\\tess_5pu4usrd', 'txt']
2025-11-17 07:18:01,838 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:18:01,842 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:18:05,883 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 07:18:17,959 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 07:18:28,643 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 07:18:44,543 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:19:09,858 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 07:19:29,133 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 07:19:32,342 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:19:34,002 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:19:34,003 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 235
2025-11-17 07:19:37,251 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 78
2025-11-17 07:19:37,252 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 07:19:37,253 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 07:19:38,706 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 07:19:40,160 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:19:55,418 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:19:55,460 - ispa_next.appointments.models - DEBUG - Appointment Rolf Kemper BO-B2807 WBAJP31030BT74765 ohne Termin.
2025-11-17 07:19:55,470 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA51BY0207S01258 ohne Termin.
2025-11-17 07:19:55,478 - ispa_next.appointments.models - DEBUG - Appointment Jachmann B-MW2950E WBA21EF0405Y88133 ohne Termin.
2025-11-17 07:19:55,487 - ispa_next.appointments.models - DEBUG - Appointment Rustem Ziyazetdinov B-RZ1988 WBATX35000NC12239 ohne Termin.
2025-11-17 07:19:55,505 - ispa_next.main - DEBUG - Found 12 out of 39 appointments to process (configured limit: 15).
2025-11-17 07:19:55,505 - ispa_next.main - DEBUG - Processing 12 fresh appointments.
2025-11-17 07:19:55,505 - ispa_next.main - DEBUG - All appointments: BRA7017, KO LP 17, BCN810, BCN810, M-FB6837, MHT2535E, B-DF1260, BRN2123, B-FK667, B-AF9248, KQ-C3314, B-T6680
2025-11-17 07:19:55,508 - ispa_next.main - DEBUG - 



2025-11-17 07:19:55,508 - ispa_next.main - DEBUG - starting with process 1 (BRA7017) of 12
2025-11-17 07:19:55,511 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:19:56,992 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:19:58,601 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:19:58,603 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 78
2025-11-17 07:20:00,277 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:20:00,278 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:20:36,399 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:20:36,514 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 07:20:36,521 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:20:37,218 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:20:37,220 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:20:40,595 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 235
2025-11-17 07:20:40,596 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:20:41,526 - ispa_next.appointments.models - DEBUG - Appointment Miri Varbitzky B-VF3012 WBATH410809P82956 ohne Termin.
2025-11-17 07:20:41,540 - ispa_next.appointments.models - DEBUG - Appointment Burghard Kapp B-KQ510 WBATX310X0LC40146 ohne Termin.
2025-11-17 07:20:41,551 - ispa_next.main - DEBUG - 



2025-11-17 07:20:41,552 - ispa_next.main - DEBUG - starting with process 2 (KO LP 17) of 12
2025-11-17 07:20:41,557 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:20:43,148 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:20:44,606 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:20:44,608 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 235
2025-11-17 07:20:46,425 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:20:46,427 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:21:20,893 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:21:20,904 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 07:21:20,908 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:21:21,626 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:21:21,627 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:21:24,827 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 235
2025-11-17 07:21:24,828 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:21:25,714 - ispa_next.appointments.models - DEBUG - Appointment Miri Varbitzky B-VF3012 WBATH410809P82956 ohne Termin.
2025-11-17 07:21:25,728 - ispa_next.appointments.models - DEBUG - Appointment Burghard Kapp B-KQ510 WBATX310X0LC40146 ohne Termin.
2025-11-17 07:21:25,739 - ispa_next.main - DEBUG - 



2025-11-17 07:21:25,739 - ispa_next.main - DEBUG - starting with process 3 (BCN810) of 12
2025-11-17 07:21:25,745 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:21:27,216 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:21:28,863 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:21:28,865 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 235
2025-11-17 07:21:30,565 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:21:30,567 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:22:05,635 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:22:05,647 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 07:22:05,650 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:22:06,364 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:22:06,366 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:22:09,507 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 235
2025-11-17 07:22:09,508 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:22:10,506 - ispa_next.appointments.models - DEBUG - Appointment Miri Varbitzky B-VF3012 WBATH410809P82956 ohne Termin.
2025-11-17 07:22:10,520 - ispa_next.appointments.models - DEBUG - Appointment Burghard Kapp B-KQ510 WBATX310X0LC40146 ohne Termin.
2025-11-17 07:22:10,526 - ispa_next.main - DEBUG - 



2025-11-17 07:22:10,526 - ispa_next.main - DEBUG - starting with process 4 (BCN810) of 12
2025-11-17 07:22:10,530 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:22:12,016 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:22:13,731 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:22:13,732 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 235
2025-11-17 07:22:15,311 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:22:15,313 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:22:51,417 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:22:51,428 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 07:22:51,432 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:22:52,044 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:22:52,045 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:22:55,200 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 235
2025-11-17 07:22:55,201 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:22:56,202 - ispa_next.appointments.models - DEBUG - Appointment Miri Varbitzky B-VF3012 WBATH410809P82956 ohne Termin.
2025-11-17 07:22:56,227 - ispa_next.appointments.models - DEBUG - Appointment Burghard Kapp B-KQ510 WBATX310X0LC40146 ohne Termin.
2025-11-17 07:22:56,235 - ispa_next.main - DEBUG - 



2025-11-17 07:22:56,235 - ispa_next.main - DEBUG - starting with process 5 (M-FB6837) of 12
2025-11-17 07:22:56,238 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:22:57,755 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:22:59,496 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:22:59,497 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 235
2025-11-17 07:23:01,184 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:23:01,186 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:23:39,188 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:23:39,199 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 07:23:39,202 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:23:39,858 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:23:39,859 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:23:43,140 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 235
2025-11-17 07:23:43,141 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:23:44,139 - ispa_next.appointments.models - DEBUG - Appointment Miri Varbitzky B-VF3012 WBATH410809P82956 ohne Termin.
2025-11-17 07:23:44,162 - ispa_next.appointments.models - DEBUG - Appointment Burghard Kapp B-KQ510 WBATX310X0LC40146 ohne Termin.
2025-11-17 07:23:44,173 - ispa_next.main - DEBUG - 



2025-11-17 07:23:44,173 - ispa_next.main - DEBUG - starting with process 6 (MHT2535E) of 12
2025-11-17 07:23:44,177 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:23:45,670 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:23:47,332 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:23:47,334 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 235
2025-11-17 07:23:49,124 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:23:49,125 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:24:22,756 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:24:22,772 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 07:24:22,778 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:24:23,462 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:24:23,463 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:24:26,551 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 235
2025-11-17 07:24:26,553 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:24:27,519 - ispa_next.appointments.models - DEBUG - Appointment Miri Varbitzky B-VF3012 WBATH410809P82956 ohne Termin.
2025-11-17 07:24:27,540 - ispa_next.appointments.models - DEBUG - Appointment Burghard Kapp B-KQ510 WBATX310X0LC40146 ohne Termin.
2025-11-17 07:24:27,551 - ispa_next.main - DEBUG - 



2025-11-17 07:24:27,552 - ispa_next.main - DEBUG - starting with process 7 (B-DF1260) of 12
2025-11-17 07:24:27,557 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:24:29,019 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:24:30,566 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:24:30,567 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 235
2025-11-17 07:24:32,094 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:24:32,096 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:25:07,240 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:25:07,252 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 07:25:07,255 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:25:07,776 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:25:07,778 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:25:11,630 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 235
2025-11-17 07:25:11,631 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:25:12,708 - ispa_next.appointments.models - DEBUG - Appointment Miri Varbitzky B-VF3012 WBATH410809P82956 ohne Termin.
2025-11-17 07:25:12,720 - ispa_next.appointments.models - DEBUG - Appointment Burghard Kapp B-KQ510 WBATX310X0LC40146 ohne Termin.
2025-11-17 07:25:12,731 - ispa_next.main - DEBUG - 



2025-11-17 07:25:12,731 - ispa_next.main - DEBUG - starting with process 8 (BRN2123) of 12
2025-11-17 07:25:12,735 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:25:14,220 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:25:16,081 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:25:16,083 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 235
2025-11-17 07:25:17,985 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:25:17,986 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:25:52,528 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:25:52,543 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 07:25:52,550 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:25:53,071 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:25:53,072 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:25:56,320 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 235
2025-11-17 07:25:56,320 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:25:57,453 - ispa_next.appointments.models - DEBUG - Appointment Miri Varbitzky B-VF3012 WBATH410809P82956 ohne Termin.
2025-11-17 07:25:57,471 - ispa_next.appointments.models - DEBUG - Appointment Burghard Kapp B-KQ510 WBATX310X0LC40146 ohne Termin.
2025-11-17 07:25:57,484 - ispa_next.main - DEBUG - 



2025-11-17 07:25:57,484 - ispa_next.main - DEBUG - starting with process 9 (B-FK667) of 12
2025-11-17 07:25:57,488 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:25:59,004 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:26:00,512 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 440
2025-11-17 07:26:00,513 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 235
2025-11-17 07:26:02,299 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:26:02,301 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:26:35,988 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:26:47,441 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:26:48,791 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:26:48,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:26:48,907 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:26:49,264 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:26:49,266 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:26:52,096 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:26:52,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:26:53,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:26:55,565 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:26:55,718 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:26:59,234 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:26:59,333 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 07:26:59,335 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:27:00,877 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 07:27:12,658 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 07:27:13,662 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:27:13,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:27:14,195 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:27:31,284 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 07:27:40,682 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:27:40,684 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:27:40,685 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list disabled in config
2025-11-17 07:27:40,687 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:27:40,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:27:42,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:27:47,129 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:27:47,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:27:48,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:27:50,122 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:27:51,018 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:27:51,642 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:27:51,967 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 07:27:51,969 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:27:53,909 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 07:28:06,488 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 07:28:14,082 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 07:28:14,084 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:28:15,430 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:28:17,633 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 07:28:18,639 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:28:18,640 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:28:18,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:28:18,765 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:28:22,920 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 07:28:23,951 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 07:28:43,808 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:28:43,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:28:43,983 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:28:44,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:28:45,011 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:28:45,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:28:46,137 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:28:46,143 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:28:47,920 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:28:47,924 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:28:50,602 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:28:50,624 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:28:50,630 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:28:50,655 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:28:50,661 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:28:50,663 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 07:28:50,686 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:28:50,693 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:28:50,721 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:28:50,728 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:28:50,731 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 07:28:51,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 07:28:53,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 07:28:55,839 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 07:28:55,841 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:28:55,843 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:28:55,844 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:28:57,156 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:28:57,160 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:28:57,165 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:28:58,518 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:28:58,521 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:28:58,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 07:28:59,669 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 07:29:00,191 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:29:09,530 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:29:09,538 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:29:11,741 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:29:40,313 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:29:43,329 - ispa_next.common.mail - INFO - Successfully sent an email to 3 recipients
2025-11-17 07:29:43,335 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:29:43,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:29:44,735 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:29:45,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:29:58,002 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:30:07,977 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:30:18,437 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:30:18,440 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:30:18,441 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:30:20,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:30:20,143 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:30:20,145 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:30:24,635 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:30:47,672 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:30:48,087 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 07:30:51,102 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:30:52,553 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 441
2025-11-17 07:30:52,556 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:30:59,887 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 235
2025-11-17 07:30:59,888 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:31:01,686 - ispa_next.appointments.models - DEBUG - Appointment Miri Varbitzky B-VF3012 WBATH410809P82956 ohne Termin.
2025-11-17 07:31:01,708 - ispa_next.appointments.models - DEBUG - Appointment Burghard Kapp B-KQ510 WBATX310X0LC40146 ohne Termin.
2025-11-17 07:31:01,724 - ispa_next.main - DEBUG - 



2025-11-17 07:31:01,724 - ispa_next.main - DEBUG - starting with process 10 (B-AF9248) of 12
2025-11-17 07:31:01,734 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:31:04,498 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:31:07,502 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 441
2025-11-17 07:31:07,504 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 235
2025-11-17 07:31:10,991 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:31:10,993 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:32:03,466 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:32:21,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:32:25,352 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:32:25,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:32:25,487 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:32:26,076 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:32:26,080 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:32:29,498 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:32:29,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:32:31,598 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:32:33,626 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:32:33,869 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:32:34,071 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:32:34,291 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:32:36,512 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 07:32:37,519 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:32:37,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:32:38,071 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:33:04,086 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 07:33:19,253 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:33:19,256 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:33:19,259 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list disabled in config
2025-11-17 07:33:19,261 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:33:19,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:33:20,818 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:33:25,538 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:33:25,539 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 07:33:25,653 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:33:25,654 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:33:25,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:33:26,334 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:33:30,633 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 07:33:32,484 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 07:33:48,531 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:33:48,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:33:48,773 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:33:52,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:33:53,081 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:33:53,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:33:54,284 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:33:54,289 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:33:57,662 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:33:57,666 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:34:00,030 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:34:00,032 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:34:00,038 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:34:00,040 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:34:00,045 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:34:00,047 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 07:34:00,048 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:34:00,053 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:34:00,054 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:34:00,060 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:34:00,063 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 07:34:01,015 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 07:34:02,318 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 07:34:15,902 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 07:34:15,904 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:34:15,906 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:34:15,907 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:34:19,438 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:34:19,440 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:34:19,443 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:34:23,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:34:23,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:34:34,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:34:52,880 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:34:52,882 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:34:52,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 07:34:54,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 07:34:54,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:35:06,015 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:35:06,019 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:35:09,674 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:35:32,940 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:35:33,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:35:34,305 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:35:34,689 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:35:49,229 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:36:01,145 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:36:01,147 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:36:02,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:36:02,935 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:36:02,937 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:36:11,357 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 07:36:30,446 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:36:30,849 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 07:36:34,927 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:36:36,325 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 441
2025-11-17 07:36:36,327 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:36:43,565 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 234
2025-11-17 07:36:43,566 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:36:45,319 - ispa_next.appointments.models - DEBUG - Appointment Miri Varbitzky B-VF3012 WBATH410809P82956 ohne Termin.
2025-11-17 07:36:45,339 - ispa_next.appointments.models - DEBUG - Appointment Burghard Kapp B-KQ510 WBATX310X0LC40146 ohne Termin.
2025-11-17 07:36:45,351 - ispa_next.main - DEBUG - 



2025-11-17 07:36:45,351 - ispa_next.main - DEBUG - starting with process 11 (KQ-C3314) of 12
2025-11-17 07:36:45,357 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:36:48,107 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:36:51,258 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 441
2025-11-17 07:36:51,261 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 234
2025-11-17 07:36:54,930 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:36:54,932 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:37:41,908 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:37:41,928 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 07:37:41,947 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:37:43,262 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 441
2025-11-17 07:37:43,264 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:37:50,021 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 234
2025-11-17 07:37:50,022 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:37:51,844 - ispa_next.appointments.models - DEBUG - Appointment Miri Varbitzky B-VF3012 WBATH410809P82956 ohne Termin.
2025-11-17 07:37:51,857 - ispa_next.appointments.models - DEBUG - Appointment Burghard Kapp B-KQ510 WBATX310X0LC40146 ohne Termin.
2025-11-17 07:37:51,864 - ispa_next.main - DEBUG - 



2025-11-17 07:37:51,864 - ispa_next.main - DEBUG - starting with process 12 (B-T6680) of 12
2025-11-17 07:37:51,867 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:37:54,717 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:37:57,973 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 441
2025-11-17 07:37:57,975 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 234
2025-11-17 07:38:01,397 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:38:01,399 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:38:42,624 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:39:00,221 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:39:01,795 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:39:01,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:39:01,934 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:39:02,422 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:39:02,427 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:39:05,894 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:39:05,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:39:06,504 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 07:39:07,090 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 07:39:07,124 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:39:07,125 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:39:09,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:39:10,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:39:10,212 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 07:39:10,278 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 07:39:18,550 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 07:39:18,554 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:39:19,897 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 441
2025-11-17 07:39:19,899 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:39:27,118 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 234
2025-11-17 07:39:27,120 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:39:28,966 - ispa_next.appointments.models - DEBUG - Appointment Miri Varbitzky B-VF3012 WBATH410809P82956 ohne Termin.
2025-11-17 07:39:28,984 - ispa_next.appointments.models - DEBUG - Appointment Burghard Kapp B-KQ510 WBATX310X0LC40146 ohne Termin.
