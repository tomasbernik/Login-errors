2025-11-12 07:14:34,289 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 07:14:34,332 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 07:14:42,376 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:14:54,035 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:15:09,503 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:17:07,396 - ispa_next.app_start.main - DEBUG - Operation already took 106.43 seconds (more than 80 seconds)
2025-11-12 07:17:09,454 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7322ea8ce2c40d4b\\tess_kv58m6vq_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7322ea8ce2c40d4b\\tess_kv58m6vq', 'txt']
2025-11-12 07:17:09,707 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:17:09,713 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:17:09,714 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:19:08,996 - ispa_next.app_start.main - DEBUG - Operation already took 107.04 seconds (more than 80 seconds)
2025-11-12 07:19:11,077 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7322ea8ce2c40d4b\\tess_bype_v_a_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7322ea8ce2c40d4b\\tess_bype_v_a', 'txt']
2025-11-12 07:19:11,317 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:19:11,322 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:19:18,470 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 07:19:26,343 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:19:36,668 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:19:52,188 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:21:49,568 - ispa_next.app_start.main - DEBUG - Operation already took 106.31 seconds (more than 80 seconds)
2025-11-12 07:21:51,638 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7322ea8ce2c40d4b\\tess_p48avkd7_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7322ea8ce2c40d4b\\tess_p48avkd7', 'txt']
2025-11-12 07:21:51,883 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:21:51,888 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:21:51,889 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:22:16,195 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 07:22:35,099 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 07:22:37,671 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:38,764 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-12 07:22:38,766 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 125
2025-11-12 07:22:41,095 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 91
2025-11-12 07:22:41,096 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 07:22:41,097 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:22:42,225 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:22:43,417 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:22:58,256 - ispa_next.main - DEBUG - Found 4 out of 36 appointments to process (configured limit: 15).
2025-11-12 07:22:58,256 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 07:22:58,257 - ispa_next.main - DEBUG - Processing 1 already visited appointments (w/ RKR not callable).
2025-11-12 07:22:58,257 - ispa_next.main - DEBUG - All appointments: ENS-MP-48, LM MM 585, SU-MS 996 E, LM-R 890
2025-11-12 07:22:58,260 - ispa_next.main - DEBUG - 



2025-11-12 07:22:58,260 - ispa_next.main - DEBUG - starting with process 1 (ENS-MP-48) of 4
2025-11-12 07:22:58,264 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:22:59,586 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:23:00,713 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-12 07:23:00,714 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 91
2025-11-12 07:23:02,095 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:23:02,096 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:23:37,865 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:23:37,957 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 07:23:37,961 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:23:38,359 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-12 07:23:38,360 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:23:40,883 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 125
2025-11-12 07:23:40,884 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:23:41,719 - ispa_next.main - DEBUG - 



2025-11-12 07:23:41,720 - ispa_next.main - DEBUG - starting with process 2 (LM MM 585) of 4
2025-11-12 07:23:41,732 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:23:42,919 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:23:44,074 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-12 07:23:44,075 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 125
2025-11-12 07:23:45,490 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:23:45,491 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:24:18,209 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:24:18,217 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 07:24:18,219 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:24:18,578 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-12 07:24:18,579 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:24:20,579 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 125
2025-11-12 07:24:20,580 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:24:21,235 - ispa_next.main - DEBUG - 



2025-11-12 07:24:21,235 - ispa_next.main - DEBUG - starting with process 3 (SU-MS 996 E) of 4
2025-11-12 07:24:21,239 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:24:22,094 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:24:22,964 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-12 07:24:22,965 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 125
2025-11-12 07:24:24,066 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:24:24,067 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:24:54,516 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:24:54,526 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 07:24:54,529 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:24:54,967 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-12 07:24:54,968 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:24:56,888 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 125
2025-11-12 07:24:56,889 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:24:57,562 - ispa_next.main - DEBUG - 



2025-11-12 07:24:57,562 - ispa_next.main - DEBUG - starting with process 4 (LM-R 890) of 4
2025-11-12 07:24:57,566 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:24:58,700 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:24:59,735 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 534
2025-11-12 07:24:59,737 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 125
2025-11-12 07:25:00,960 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:25:00,961 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:25:23,493 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:25:25,243 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:25:29,998 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:32,535 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:25:32,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:32,624 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:25:32,804 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:25:32,807 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:25:32,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:32,923 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:25:39,356 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:25:39,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:25:40,413 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:25:42,416 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:25:42,529 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:25:42,623 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:25:42,692 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:25:46,938 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:25:47,944 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:25:47,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:48,437 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:59,058 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:26:02,882 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:26:02,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:02,968 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:26:02,969 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:26:03,004 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:26:04,220 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:26:05,436 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:26:05,779 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:26:07,401 - ispa_next.functions - DEBUG - Updated appointment (AC00019071) customer contact data.
2025-11-12 07:26:08,306 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:26:08,308 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:26:09,033 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:26:09,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:26:09,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:26:13,377 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:26:13,377 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:26:13,381 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:26:13,382 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:26:13,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:13,907 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:26:18,001 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:26:18,006 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:26:18,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:18,083 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:26:18,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:19,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:19,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:19,727 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:26:19,729 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:26:22,175 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:26:22,177 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:26:23,599 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:26:23,602 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:26:23,606 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug Innenraum saugen: active placement guards
2025-11-12 07:26:23,607 - ispa_next.package_manager.main - DEBUG - Cannot place FAHRZEUGWÄSCHE BASIS: active placement guards
2025-11-12 07:26:23,608 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:26:23,609 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:26:23,611 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:26:23,613 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:26:23,614 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:26:23,616 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:26:23,617 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:26:23,620 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:26:23,622 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:26:23,624 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:26:23,625 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:26,180 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:26:26,182 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:26:26,183 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:28,812 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:26:28,814 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:26:28,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:26:29,547 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:26:29,758 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:43,116 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:26:43,119 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:45,746 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:26:56,076 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:26:56,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:26:57,165 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:26:57,363 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:27:03,727 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:27:07,819 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:27:07,821 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:27:07,822 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:27:08,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:27:08,499 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:27:08,500 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:27:10,251 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:27:18,515 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:27:18,896 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 07:27:19,496 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:27:20,043 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 536
2025-11-12 07:27:20,044 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:27:22,531 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 126
2025-11-12 07:27:22,531 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
