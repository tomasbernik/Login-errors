2025-11-17 14:00:35,216 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 14:00:35,224 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 14:00:48,899 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:01:00,584 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:01:16,072 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:03:14,408 - ispa_next.app_start.main - DEBUG - Operation already took 106.97 seconds (more than 80 seconds)
2025-11-17 14:03:16,504 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b5b0641b9467a70\\tess_zw1uaudm_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b5b0641b9467a70\\tess_zw1uaudm', 'txt']
2025-11-17 14:03:16,767 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 14:03:16,772 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 14:03:16,772 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:05:15,757 - ispa_next.app_start.main - DEBUG - Operation already took 106.59 seconds (more than 80 seconds)
2025-11-17 14:05:17,845 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b5b0641b9467a70\\tess_b1vbo8tz_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b5b0641b9467a70\\tess_b1vbo8tz', 'txt']
2025-11-17 14:05:18,060 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 14:05:18,065 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 14:05:24,487 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 14:05:34,341 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:05:44,592 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:06:00,227 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:06:25,703 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 14:06:43,157 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 14:06:46,181 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:06:47,297 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 483
2025-11-17 14:06:47,298 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 32
2025-11-17 14:06:48,906 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 11
2025-11-17 14:06:48,907 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 14:06:48,908 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:06:49,753 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:06:50,592 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:06:51,575 - ispa_next.appointments.models - DEBUG - Appointment Hermann Glaser CHA-HG 111 WBA4J51060BN79538 ohne Termin.
2025-11-17 14:06:51,582 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 14:06:51,590 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
2025-11-17 14:06:51,591 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:06:51,600 - ispa_next.appointments.models - DEBUG - Appointment Firma Dachbau Gradl BUL-GX 42 WBA11CM0308C43879 ohne Termin.
2025-11-17 14:06:51,605 - ispa_next.appointments.models - DEBUG - Appointment Gregor Berki SAD-BK 161 WBA5V51060FH45254 ohne Termin.
2025-11-17 14:06:51,607 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:06:51,610 - ispa_next.main - DEBUG - Found 1 out of 4 appointments to process (configured limit: 15).
2025-11-17 14:06:51,610 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-17 14:06:51,611 - ispa_next.main - DEBUG - All appointments: SAD-HN 606
2025-11-17 14:06:51,613 - ispa_next.main - DEBUG - 



2025-11-17 14:06:51,614 - ispa_next.main - DEBUG - starting with process 1 (SAD-HN 606) of 1
2025-11-17 14:06:51,632 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:06:52,473 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:06:53,348 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 483
2025-11-17 14:06:53,350 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 11
2025-11-17 14:06:54,734 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:06:54,736 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:07:25,741 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:07:34,801 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:38,001 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:07:38,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:07:38,080 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:07:38,348 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:07:38,350 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:07:38,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:07:38,484 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:07:41,555 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:07:41,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:07:42,669 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:07:44,675 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:07:44,826 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:07:48,054 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:07:48,131 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:07:48,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:51,417 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:08:02,780 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:08:03,783 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:08:03,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:04,285 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:15,917 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:08:23,148 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:08:23,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:23,217 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:08:23,219 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:08:23,293 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:08:24,603 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:08:25,797 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:08:26,068 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:08:28,901 - ispa_next.functions - DEBUG - Updated appointment (AG00013449) customer contact data.
2025-11-17 14:08:29,792 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:08:29,794 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:08:30,355 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:08:30,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:08:31,019 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:08:35,483 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:08:35,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:08:36,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:08:38,036 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:08:38,154 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:08:38,283 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:08:38,363 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:08:38,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:08:42,408 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:08:53,568 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:09:53,571 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:10:05,149 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:10:12,177 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:10:12,177 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:16,206 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:10:20,386 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:10:21,393 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:10:21,394 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:10:21,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:10:21,469 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:10:25,604 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:10:25,610 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:10:25,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:10:25,735 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:10:26,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:26,713 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:26,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:10:27,468 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:10:27,471 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:10:31,105 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:10:31,107 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:10:32,324 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:10:32,325 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:10:32,329 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Fzg Reinigung, source=from_tab, target=cart)}
2025-11-17 14:10:32,333 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:10:32,339 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:10:32,345 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:10:32,347 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:10:32,347 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:10:32,349 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:10:32,351 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:10:32,353 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:10:32,355 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:10:32,357 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:10:33,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:10:33,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:10:36,230 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:10:36,231 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:10:36,233 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:10:36,234 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:40,985 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:10:40,987 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:10:40,989 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:45,573 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:10:45,573 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 14:10:45,575 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:50,141 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:10:50,141 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:10:50,145 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:54,716 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:11:05,337 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:11:05,338 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:11:05,338 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:11:05,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:11:06,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:11:06,308 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:11:07,732 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:11:14,216 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:11:17,085 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 14:11:17,088 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:11:17,444 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 483
2025-11-17 14:11:17,445 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:11:19,756 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 32
2025-11-17 14:11:19,757 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:11:20,378 - ispa_next.appointments.models - DEBUG - Appointment Hermann Glaser CHA-HG 111 WBA4J51060BN79538 ohne Termin.
2025-11-17 14:11:20,383 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 14:11:20,388 - ispa_next.appointments.models - DEBUG - Appointment Firma Food-SB GmbH NEN-LB 400 WBA11AJ070CL74137 ohne Termin.
2025-11-17 14:11:20,398 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
2025-11-17 14:11:20,399 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:11:20,404 - ispa_next.appointments.models - DEBUG - Appointment Stephan Wiedmann SAD-QV 9 WBA2C11070V901631 ohne Termin.
2025-11-17 14:11:20,409 - ispa_next.appointments.models - DEBUG - Appointment Andrea Brings B-LE 1904 WBA3Y91010D397250 ohne Termin.
2025-11-17 14:11:20,414 - ispa_next.appointments.models - DEBUG - Appointment Firma Dachbau Gradl BUL-GX 42 WBA11CM0308C43879 ohne Termin.
