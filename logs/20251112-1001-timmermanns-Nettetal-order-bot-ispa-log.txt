2025-11-12 10:22:26,371 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:22:26,427 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:22:36,571 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:22:48,647 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:23:04,510 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:25:04,637 - ispa_next.app_start.main - DEBUG - Operation already took 108.74 seconds (more than 80 seconds)
2025-11-12 10:25:06,711 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fb693354d6d41492\\tess_bm30cvk2_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fb693354d6d41492\\tess_bm30cvk2', 'txt']
2025-11-12 10:25:06,729 - ispa_next.app_start.main - DEBUG - Exception occurred: tesseract is not installed or it's not in your PATH. See README file for more information.
2025-11-12 10:25:06,731 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:25:33,269 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:25:50,409 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:25:54,124 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:25:55,929 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-12 10:25:55,931 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 377
2025-11-12 10:25:59,222 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-12 10:25:59,223 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:25:59,223 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:26:00,774 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:26:02,245 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:26:23,344 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Jaffar Karimi KK.KK.210 WBA7M910905R43994, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='KK.KK.210', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-12 10:26:23,378 - ispa_next.appointments.models - DEBUG - Appointment Jens Melis VIE-EJ 109 WBA5J71080GZ77644 ohne Termin.
2025-11-12 10:26:23,397 - ispa_next.appointments.models - DEBUG - Appointment Frank Felscher VIE-F 815 WBA6L31010FJ48668 ohne Termin.
2025-11-12 10:26:23,413 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:26:23,417 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:26:23,429 - ispa_next.appointments.models - DEBUG - Appointment Herbert Trienekens & Partner VIE-T 1515 WBA15BZ040N231326 ohne Termin.
2025-11-12 10:26:23,436 - ispa_next.main - DEBUG - Found 7 out of 8 appointments to process (configured limit: 15).
2025-11-12 10:26:23,437 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-12 10:26:23,437 - ispa_next.main - DEBUG - Processing 3 already visited appointments (w/ RKR not callable).
2025-11-12 10:26:23,437 - ispa_next.main - DEBUG - All appointments: D-AS 5500, D-FV 9999, VIE ZK 440, kk-lt 6, VIE-TI 700, VIE-O 2414, KK-MP 56
2025-11-12 10:26:23,440 - ispa_next.main - DEBUG - 



2025-11-12 10:26:23,440 - ispa_next.main - DEBUG - starting with process 1 (D-AS 5500) of 7
2025-11-12 10:26:23,444 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:26:24,915 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:26:26,599 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-12 10:26:26,601 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-12 10:26:28,513 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:26:28,515 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:27:05,408 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:27:16,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:16,480 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:27:16,683 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:27:18,112 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:27:18,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:18,285 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:27:18,544 - ispa_next.functions - DEBUG - HU date soon to be invalid in 9 days.
2025-11-12 10:27:26,401 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:27:26,404 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:27:29,263 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:27:29,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:27:30,674 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:27:32,678 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:27:32,833 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:27:36,100 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:27:44,935 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 10:27:45,939 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:27:45,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:27:46,527 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:01,298 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:28:09,640 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:28:09,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:09,743 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:28:09,744 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:28:09,844 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:28:10,062 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:28:12,125 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:28:12,791 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:28:16,708 - ispa_next.functions - DEBUG - Updated appointment (AD00009242) customer contact data.
2025-11-12 10:28:17,681 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:28:17,683 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:28:17,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:28:18,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:28:20,402 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:28:20,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:28:20,510 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:28:24,191 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:28:24,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:28:24,735 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:28:26,739 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:28:26,904 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:28:27,037 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:28:27,130 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:28:27,131 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:29,184 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:28:37,648 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:29:37,650 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:29:46,220 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:30:06,223 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:30:14,640 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:30:23,280 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 10:30:24,286 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:30:24,289 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:30:24,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:30:24,452 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:30:24,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:25,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:25,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:30:26,389 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:30:26,390 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:30:28,433 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:30:28,436 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:30:29,542 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:30:29,544 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:30:29,546 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:30:29,548 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 10:30:29,549 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:30:29,552 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:30:29,554 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:30:29,555 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:30:29,558 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:30:29,560 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:30:29,562 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:30:29,565 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:30:30,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:30:31,278 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:30:41,623 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:30:41,625 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:30:41,626 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:30:41,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:44,424 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:30:44,426 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:30:44,430 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:47,073 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:30:47,074 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:30:47,076 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:30:47,079 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:49,704 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:31:03,860 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:31:04,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:31:05,155 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:31:05,315 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:31,414 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:31:35,915 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:31:41,559 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:31:41,561 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:31:41,562 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:31:42,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:31:42,476 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:31:42,478 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:31:44,626 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:31:56,153 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:31:56,627 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:31:57,492 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:31:58,917 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-12 10:31:58,919 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:32:02,541 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 377
2025-11-12 10:32:02,541 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:32:03,634 - ispa_next.appointments.models - DEBUG - Appointment NNR Global Logistics Germany GmbH ME-KD 247E WBA81CY020FS50663 ohne Termin.
2025-11-12 10:32:03,644 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Jaffar Karimi KK.KK.210 WBA7M910905R43994, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='KK.KK.210', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-12 10:32:03,652 - ispa_next.appointments.models - DEBUG - Appointment christoph Herzberg D-CH 704 WBA6L51020FH94901 ohne Termin.
2025-11-12 10:32:03,659 - ispa_next.appointments.models - DEBUG - Appointment Annelies Maas X-035-JR WMW21DH0602R35252 ohne Termin.
2025-11-12 10:32:03,663 - ispa_next.main - DEBUG - 



2025-11-12 10:32:03,663 - ispa_next.main - DEBUG - starting with process 2 (D-FV 9999) of 7
2025-11-12 10:32:03,666 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:32:05,159 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:32:07,107 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-12 10:32:07,109 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 377
2025-11-12 10:32:08,864 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:32:08,866 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:32:42,034 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:32:52,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:53,062 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:32:53,319 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:32:54,789 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:32:54,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:54,892 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:32:55,249 - ispa_next.functions - DEBUG - HU date already expired after 738 days.
2025-11-12 10:33:03,617 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:33:03,620 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:33:06,495 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:33:06,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:33:07,923 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:33:09,927 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:33:10,100 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:33:10,223 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:33:10,323 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:33:10,325 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:33:11,832 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:33:23,516 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:33:27,974 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:33:27,976 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:33:29,311 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:33:33,541 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:33:34,547 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:33:34,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:35,118 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:49,711 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:33:49,711 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:33:58,048 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:33:58,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:33:58,248 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:33:58,250 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:33:58,350 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:33:59,850 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:34:01,494 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:34:01,881 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:34:03,714 - ispa_next.functions - DEBUG - Updated appointment (AD00009241) customer contact data.
2025-11-12 10:34:04,700 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:34:04,702 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:34:05,764 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:34:05,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:34:06,638 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:34:10,252 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:34:10,252 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:34:10,255 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:34:10,258 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:34:10,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:34:10,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:34:11,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:34:11,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:34:11,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:34:12,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:34:12,721 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:34:14,256 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:34:14,258 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:34:15,494 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:34:15,495 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:34:15,498 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:34:15,499 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 10:34:15,501 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:34:15,503 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:34:15,504 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:34:15,505 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:34:15,507 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:34:15,508 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:34:15,510 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:34:15,512 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:34:16,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:34:17,081 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:34:26,929 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:34:26,931 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:34:26,932 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:34:26,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:28,851 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:34:28,852 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:34:28,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:30,906 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:34:30,908 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:34:30,910 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:34:30,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:33,137 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:34:47,328 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:34:47,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:34:48,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:34:48,817 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:07,423 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:35:13,188 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:35:13,191 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:35:13,191 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:35:13,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:35:14,101 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:35:14,102 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:35:16,293 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:35:26,153 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:35:26,636 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:35:27,456 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:35:28,934 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-12 10:35:28,935 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:35:32,833 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 377
2025-11-12 10:35:32,834 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:35:33,839 - ispa_next.appointments.models - DEBUG - Appointment NNR Global Logistics Germany GmbH ME-KD 247E WBA81CY020FS50663 ohne Termin.
2025-11-12 10:35:33,850 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Jaffar Karimi KK.KK.210 WBA7M910905R43994, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='KK.KK.210', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-12 10:35:33,857 - ispa_next.appointments.models - DEBUG - Appointment christoph Herzberg D-CH 704 WBA6L51020FH94901 ohne Termin.
2025-11-12 10:35:33,864 - ispa_next.appointments.models - DEBUG - Appointment Annelies Maas X-035-JR WMW21DH0602R35252 ohne Termin.
2025-11-12 10:35:33,868 - ispa_next.main - DEBUG - 



2025-11-12 10:35:33,868 - ispa_next.main - DEBUG - starting with process 3 (VIE ZK 440) of 7
2025-11-12 10:35:33,871 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:35:35,356 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:35:36,923 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-12 10:35:36,925 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 377
2025-11-12 10:35:38,892 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:35:38,893 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:36:16,871 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:36:17,024 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:36:17,030 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:36:17,613 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-12 10:36:17,615 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:36:21,136 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 377
2025-11-12 10:36:21,137 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:36:22,350 - ispa_next.appointments.models - DEBUG - Appointment NNR Global Logistics Germany GmbH ME-KD 247E WBA81CY020FS50663 ohne Termin.
2025-11-12 10:36:22,364 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Jaffar Karimi KK.KK.210 WBA7M910905R43994, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='KK.KK.210', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-12 10:36:22,375 - ispa_next.appointments.models - DEBUG - Appointment christoph Herzberg D-CH 704 WBA6L51020FH94901 ohne Termin.
2025-11-12 10:36:22,382 - ispa_next.appointments.models - DEBUG - Appointment Annelies Maas X-035-JR WMW21DH0602R35252 ohne Termin.
2025-11-12 10:36:22,385 - ispa_next.main - DEBUG - 



2025-11-12 10:36:22,385 - ispa_next.main - DEBUG - starting with process 4 (kk-lt 6) of 7
2025-11-12 10:36:22,388 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:36:23,891 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:36:25,839 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-12 10:36:25,841 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 377
2025-11-12 10:36:27,646 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:36:27,648 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:37:01,057 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:37:01,066 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:37:01,072 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:37:01,616 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-12 10:37:01,618 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:37:05,195 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 377
2025-11-12 10:37:05,196 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:37:06,668 - ispa_next.appointments.models - DEBUG - Appointment NNR Global Logistics Germany GmbH ME-KD 247E WBA81CY020FS50663 ohne Termin.
2025-11-12 10:37:06,680 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Jaffar Karimi KK.KK.210 WBA7M910905R43994, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='KK.KK.210', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-12 10:37:06,687 - ispa_next.appointments.models - DEBUG - Appointment christoph Herzberg D-CH 704 WBA6L51020FH94901 ohne Termin.
2025-11-12 10:37:06,694 - ispa_next.appointments.models - DEBUG - Appointment Annelies Maas X-035-JR WMW21DH0602R35252 ohne Termin.
2025-11-12 10:37:06,697 - ispa_next.main - DEBUG - 



2025-11-12 10:37:06,697 - ispa_next.main - DEBUG - starting with process 5 (VIE-TI 700) of 7
2025-11-12 10:37:06,700 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:37:08,221 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:37:09,896 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 766
2025-11-12 10:37:09,898 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 377
2025-11-12 10:37:11,619 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:37:11,621 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:37:41,860 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:37:44,082 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:37:49,589 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:37:51,564 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:37:51,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:51,796 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:37:52,217 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:37:52,219 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:37:55,116 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:37:55,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:37:56,437 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:37:58,462 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:37:58,648 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:37:58,830 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:37:58,907 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:38:03,254 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:38:04,258 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:38:04,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:04,765 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:19,668 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:38:19,668 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:38:24,849 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:38:24,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:25,050 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:38:25,051 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:38:25,115 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:38:26,663 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:38:28,374 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:38:28,780 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:38:30,519 - ispa_next.functions - DEBUG - Updated appointment (AA00025175) customer contact data.
2025-11-12 10:38:31,462 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:38:31,463 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:38:32,408 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:38:32,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:38:33,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:38:37,406 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:38:37,406 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:38:37,409 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:38:37,412 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:38:37,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:37,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:38:38,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:38,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:38,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:39,660 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:38:39,661 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:38:41,699 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:38:41,702 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:38:43,131 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:38:43,133 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:38:43,137 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:38:43,140 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:38:43,142 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:38:43,147 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:38:43,159 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:38:43,167 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:38:43,169 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:38:43,170 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:38:43,172 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:38:43,175 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:38:43,177 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:38:43,178 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:45,253 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:38:45,255 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:38:45,257 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:47,271 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:38:47,273 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:38:47,274 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:38:47,276 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:49,312 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:39:05,987 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:39:06,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:39:07,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:39:07,701 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:26,515 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:32,108 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:32,111 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:39:32,111 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:39:32,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:39:32,997 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:39:32,999 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:39:35,146 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:39:45,279 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:39:45,705 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:39:46,418 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:39:47,818 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 767
2025-11-12 10:39:47,820 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:39:51,832 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 378
2025-11-12 10:39:51,832 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:39:53,004 - ispa_next.appointments.models - DEBUG - Appointment Nitro Snowboards Entwicklungs GmbH GAP-N 600E WBY61EF0905037562 ohne Termin.
2025-11-12 10:39:53,012 - ispa_next.appointments.models - DEBUG - Appointment NNR Global Logistics Germany GmbH ME-KD 247E WBA81CY020FS50663 ohne Termin.
2025-11-12 10:39:53,021 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Jaffar Karimi KK.KK.210 WBA7M910905R43994, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='KK.KK.210', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-12 10:39:53,029 - ispa_next.appointments.models - DEBUG - Appointment christoph Herzberg D-CH 704 WBA6L51020FH94901 ohne Termin.
2025-11-12 10:39:53,032 - ispa_next.main - DEBUG - 



2025-11-12 10:39:53,032 - ispa_next.main - DEBUG - starting with process 6 (VIE-O 2414) of 7
2025-11-12 10:39:53,035 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:39:54,620 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:39:56,258 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 767
2025-11-12 10:39:56,260 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 378
2025-11-12 10:39:58,090 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:39:58,091 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:40:27,902 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:40:30,412 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:40:36,266 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:40:38,239 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:40:38,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:40:38,354 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:40:38,658 - ispa_next.functions - DEBUG - HU date already expired after 164 days.
2025-11-12 10:40:43,392 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:40:43,395 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:40:46,261 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:40:46,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:40:47,736 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:40:49,738 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:40:49,887 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:40:50,048 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:40:50,126 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:40:54,348 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:40:55,361 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:40:55,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:40:56,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:11,549 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:41:16,414 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:41:16,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:16,685 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:16,686 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:41:16,748 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:41:18,460 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:41:18,846 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:41:20,720 - ispa_next.functions - DEBUG - Updated appointment (AA00025176) customer contact data.
2025-11-12 10:41:21,671 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:41:21,673 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:41:22,568 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:41:22,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:41:23,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:41:27,373 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:41:27,373 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:41:27,376 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:41:27,379 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:41:27,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:41:27,895 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:41:28,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:28,934 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:28,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:41:30,224 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:41:30,225 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:41:32,225 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:41:32,228 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:41:33,336 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:41:33,339 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:41:33,342 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:41:33,344 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:41:33,345 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:41:33,348 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:41:33,349 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:41:33,350 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:41:33,352 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:41:33,353 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:41:33,355 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:41:33,358 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:41:33,359 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:41:33,360 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:35,463 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:41:35,464 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:41:35,466 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:37,485 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:41:37,486 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:41:37,487 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:41:37,489 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:39,516 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:41:56,119 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:41:56,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:41:57,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:41:57,903 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:16,812 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:42:22,468 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:42:22,471 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:42:22,472 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:42:23,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:42:23,315 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:42:23,317 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:42:25,692 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:42:35,081 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:42:35,456 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:42:36,283 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:42:38,178 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 767
2025-11-12 10:42:38,179 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:42:42,267 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 378
2025-11-12 10:42:42,268 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:42:43,454 - ispa_next.appointments.models - DEBUG - Appointment Nitro Snowboards Entwicklungs GmbH GAP-N 600E WBY61EF0905037562 ohne Termin.
2025-11-12 10:42:43,467 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Jaffar Karimi KK.KK.210 WBA7M910905R43994, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='KK.KK.210', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-12 10:42:43,476 - ispa_next.appointments.models - DEBUG - Appointment christoph Herzberg D-CH 704 WBA6L51020FH94901 ohne Termin.
2025-11-12 10:42:43,480 - ispa_next.main - DEBUG - Found new Appointment: ME-KD 247E
2025-11-12 10:42:43,482 - ispa_next.main - DEBUG - 



2025-11-12 10:42:43,482 - ispa_next.main - DEBUG - starting with process 7 (ME-KD 247E) of 8
2025-11-12 10:42:43,678 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:42:45,225 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:42:47,031 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 767
2025-11-12 10:42:47,032 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 378
2025-11-12 10:42:48,779 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:42:48,781 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:43:19,454 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:43:31,244 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:34,551 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:43:34,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:43:34,663 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:43:35,012 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:43:43,458 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:43:43,461 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:43:46,369 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:43:46,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:43:47,743 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:43:49,747 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:43:49,911 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:43:50,029 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:43:50,127 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:43:54,393 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:43:55,398 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:43:55,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:43:55,863 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:13,429 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:44:22,834 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:44:22,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:22,938 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:44:22,939 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:44:23,022 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:44:24,594 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:44:25,007 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:44:27,539 - ispa_next.functions - DEBUG - Updated appointment (AD00009243) customer contact data.
2025-11-12 10:44:28,496 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:44:28,498 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:44:29,425 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:44:29,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:44:30,534 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:44:35,182 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:44:35,182 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:44:35,299 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:44:35,302 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:44:35,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:44:36,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:44:44,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:45,356 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:45,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:44:46,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:44:46,204 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:44:50,202 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:44:50,205 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:44:51,442 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:44:51,444 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:44:51,447 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:44:51,450 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-12 10:44:51,453 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:44:51,457 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:44:51,461 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:44:51,463 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:44:51,466 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:44:51,467 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:44:51,469 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:44:51,471 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:44:52,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:44:53,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:45:03,818 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:45:03,820 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:45:03,821 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:45:03,822 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:45:08,563 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:45:08,565 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:45:08,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:45:13,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:45:13,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:45:26,606 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:45:41,694 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:45:41,695 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:45:41,696 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:45:41,698 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:45:46,536 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:46:08,371 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:46:09,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:46:10,623 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:46:10,822 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:46:57,083 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:47:04,648 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:47:11,577 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:47:17,390 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:47:22,580 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:47:29,224 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:47:36,444 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:47:36,444 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:47:37,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:47:37,324 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:47:37,326 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:47:41,976 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:47:52,657 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 10:47:52,659 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:47:52,659 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:47:53,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:47:53,513 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:47:53,515 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:47:55,794 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-12 10:47:55,831 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 10:47:58,524 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 10:47:58,528 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:48:01,878 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 767
2025-11-12 10:48:01,880 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:48:06,258 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 378
2025-11-12 10:48:06,259 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:48:07,454 - ispa_next.appointments.models - DEBUG - Appointment Nitro Snowboards Entwicklungs GmbH GAP-N 600E WBY61EF0905037562 ohne Termin.
2025-11-12 10:48:07,464 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Jaffar Karimi KK.KK.210 WBA7M910905R43994, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='KK.KK.210', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-12 10:48:07,472 - ispa_next.appointments.models - DEBUG - Appointment christoph Herzberg D-CH 704 WBA6L51020FH94901 ohne Termin.
2025-11-12 10:48:07,476 - ispa_next.main - DEBUG - 



2025-11-12 10:48:07,476 - ispa_next.main - DEBUG - starting with process 8 (KK-MP 56) of 8
2025-11-12 10:48:07,479 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:48:09,059 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:48:10,900 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 767
2025-11-12 10:48:10,901 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 378
2025-11-12 10:48:12,839 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:48:12,841 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:48:46,665 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:48:49,451 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:48:55,234 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:48:57,909 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:48:57,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:48:58,041 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:48:58,351 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:48:58,354 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:49:01,279 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:49:01,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:49:02,575 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:49:04,581 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:49:04,722 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:49:04,899 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:49:05,031 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:49:09,249 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:49:10,253 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:49:10,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:10,786 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:26,906 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:49:32,009 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:49:32,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:32,106 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:49:32,108 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:49:32,195 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:49:32,429 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:49:34,488 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:49:35,062 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:49:37,126 - ispa_next.functions - DEBUG - Updated appointment (AA00025090) customer contact data.
2025-11-12 10:49:38,111 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:49:38,112 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:49:38,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:49:39,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:49:40,605 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:49:40,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:49:40,698 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:49:44,370 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:49:44,370 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:49:44,373 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:49:44,376 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:49:44,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:49:44,930 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:49:45,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:45,994 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:45,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:49:46,860 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:49:46,861 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:49:49,655 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:49:49,657 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:49:50,825 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:49:50,828 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:49:50,832 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 10:49:50,835 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:49:50,837 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:49:50,840 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:49:50,841 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:49:50,843 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:49:50,845 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:49:50,846 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:49:50,848 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:49:50,851 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:49:50,852 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:49:50,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:49:53,681 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:49:53,683 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:49:53,685 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:49:56,449 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:49:56,451 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:49:56,453 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:49:56,457 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:49:59,188 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:50:15,239 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:50:15,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:50:16,725 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:50:16,902 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:50:43,338 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:50:48,233 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:50:54,447 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:50:54,450 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:50:54,451 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:50:55,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:50:55,306 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:50:55,331 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:50:57,674 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:51:07,918 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:51:08,297 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 10:51:09,050 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:51:10,455 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 768
2025-11-12 10:51:10,457 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:51:14,714 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 379
2025-11-12 10:51:14,715 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:51:15,956 - ispa_next.appointments.models - DEBUG - Appointment Nitro Snowboards Entwicklungs GmbH GAP-N 600E WBY61EF0905037562 ohne Termin.
2025-11-12 10:51:15,972 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Jaffar Karimi KK.KK.210 WBA7M910905R43994, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='KK.KK.210', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
