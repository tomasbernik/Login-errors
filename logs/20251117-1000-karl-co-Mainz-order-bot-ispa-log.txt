2025-11-17 10:00:35,398 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:00:35,405 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:00:49,485 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:00:59,859 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:01:15,443 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:02:05,994 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:02:18,148 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:02:21,415 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:02:22,879 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1510
2025-11-17 10:02:22,881 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 420
2025-11-17 10:02:25,504 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 181
2025-11-17 10:02:25,505 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:02:25,506 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:26,866 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:28,201 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:02:58,182 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:02:58,203 - ispa_next.appointments.models - DEBUG - Appointment Firma HagMaler GmbH MZ-L 6612 WBAJT31010BJ17485 ohne Termin.
2025-11-17 10:02:58,217 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:02:58,257 - ispa_next.appointments.models - DEBUG - Appointment Hatidzhe Dhevdzhet Chaylyak GG-HI 889 WBAVJ11040LF60481 ohne Termin.
2025-11-17 10:02:58,282 - ispa_next.appointments.models - DEBUG - Appointment Ulas Korkmaz  WBAJM710X0B068176 ohne Termin.
2025-11-17 10:02:58,293 - ispa_next.appointments.models - DEBUG - Appointment Florian Goertz RPL 11-3 WBA2D310505C65769 ohne Termin.
2025-11-17 10:02:58,326 - ispa_next.main - DEBUG - Found 15 out of 82 appointments to process (configured limit: 15).
2025-11-17 10:02:58,326 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 10:02:58,326 - ispa_next.main - DEBUG - All appointments: MZ-AE 40, B-FH 575, F-B 9394, WI JF 719, MZ S6995, MZ-JD 604, WI FI 246, F-JL-1820, M-ED 1182, M MS3583, KI-KI 0815, MZ-JM 217, MZ - AW 77E, KI-KI 0815, 0
2025-11-17 10:02:58,329 - ispa_next.main - DEBUG - 



2025-11-17 10:02:58,329 - ispa_next.main - DEBUG - starting with process 1 (MZ-AE 40) of 15
2025-11-17 10:02:58,334 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:02:59,522 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:03:00,775 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1510
2025-11-17 10:03:00,777 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 181
2025-11-17 10:03:02,259 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:03:02,261 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:03:43,389 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:03:54,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:54,134 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:03:54,309 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:03:56,865 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:03:56,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:56,957 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:03:57,193 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:03:57,196 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:03:59,976 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:03:59,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:04:01,168 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:04:03,173 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:04:10,128 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:04:17,690 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:04:18,702 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:04:18,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:19,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:31,911 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:04:39,334 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:04:39,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:39,418 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:04:39,423 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:04:39,477 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:04:39,607 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:04:40,822 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:04:41,119 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:04:46,462 - ispa_next.functions - DEBUG - Updated appointment (AE00049820) customer contact data.
2025-11-17 10:04:47,410 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:04:47,413 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:04:47,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:04:48,235 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:04:49,720 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:04:49,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:04:49,795 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:04:54,260 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:04:54,260 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:04:54,297 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:04:54,298 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:04:54,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:04:54,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:04:58,943 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:04:58,948 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:04:58,948 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 10:04:58,948 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:05:02,482 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:05:02,487 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:05:03,364 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:05:03,366 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:05:03,368 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:05:03,369 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:05:03,370 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:05:03,372 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:05:03,373 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:05:03,374 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:05:03,375 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:05:03,376 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:05:03,377 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:05:03,379 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:05:04,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:05:04,689 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:05:17,719 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:05:17,722 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:05:17,724 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:05:17,725 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:05:22,397 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:05:22,399 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:05:22,401 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:05:22,403 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:05:22,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:05:22,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:05:22,989 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:05:22,993 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:05:27,571 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:05:39,401 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:05:39,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:05:40,380 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:05:40,615 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:25,560 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:06:29,321 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:06:32,971 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:06:36,645 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:06:40,844 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:06:44,889 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:06:44,891 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:06:44,892 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:06:45,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:06:45,521 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:06:45,523 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:06:47,036 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:06:57,220 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 10:06:57,223 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:06:57,223 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:06:59,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:06:59,346 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:06:59,347 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:07:00,654 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 10:07:00,683 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:07:04,056 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:07:04,060 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:07:04,607 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1511
2025-11-17 10:07:04,608 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-17 10:07:07,350 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 419
2025-11-17 10:07:07,351 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:07:08,162 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:07:08,172 - ispa_next.appointments.models - DEBUG - Appointment Firma Barthelmann Group GmbH MZ-NO 440 WBA61AT040CJ33476 ohne Termin.
2025-11-17 10:07:08,182 - ispa_next.main - DEBUG - 



2025-11-17 10:07:08,182 - ispa_next.main - DEBUG - starting with process 2 (B-FH 575) of 15
2025-11-17 10:07:08,187 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:07:09,373 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:07:10,287 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1511
2025-11-17 10:07:10,288 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 419
2025-11-17 10:07:11,655 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-17 10:07:11,656 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:07:11,984 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 40, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 142, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-17 10:07:11,984 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:07:11,988 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:07:12,667 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1511
2025-11-17 10:07:12,668 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-17 10:07:15,243 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 419
2025-11-17 10:07:15,244 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:07:16,136 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:07:16,152 - ispa_next.appointments.models - DEBUG - Appointment Firma Barthelmann Group GmbH MZ-NO 440 WBA61AT040CJ33476 ohne Termin.
2025-11-17 10:07:16,162 - ispa_next.main - DEBUG - 



2025-11-17 10:07:16,162 - ispa_next.main - DEBUG - starting with process 3 (F-B 9394) of 15
2025-11-17 10:07:16,165 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:07:17,071 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:07:18,043 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1511
2025-11-17 10:07:18,044 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 419
2025-11-17 10:07:19,659 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:07:19,660 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:07:48,448 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:07:58,682 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:59,939 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:07:59,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:00,018 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:08:00,196 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:08:00,199 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:08:02,973 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:08:02,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:03,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:08:05,962 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:08:06,071 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:08:09,300 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:08:09,366 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:08:09,367 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:10,662 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:08:22,100 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:08:23,105 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:08:23,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:23,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:35,812 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:08:43,495 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:08:43,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:43,585 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:08:43,594 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:08:43,629 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:08:44,875 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:08:46,101 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:08:46,329 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:08:50,615 - ispa_next.functions - DEBUG - Updated appointment (AP00016310) customer contact data.
2025-11-17 10:08:51,531 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:08:51,533 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:08:52,446 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:08:52,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:08:53,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:08:56,822 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:08:56,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:57,343 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:08:59,347 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:08:59,525 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:08:59,602 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:08:59,727 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:08:59,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:00,971 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:09:12,311 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:10:12,313 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:10:23,759 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:10:31,039 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:10:31,040 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:10:34,454 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremse hinten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:10:36,755 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:10:41,066 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:10:42,085 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:10:42,086 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:10:42,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:42,160 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:10:46,289 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:10:47,221 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:11:02,439 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:11:02,440 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:11:02,592 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:11:12,212 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 10:11:20,340 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:11:20,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:21,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:21,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:11:22,024 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:11:22,025 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:11:23,332 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:11:23,334 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:11:25,307 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:11:25,308 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:11:25,311 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:11:25,312 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart), Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:11:25,313 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:11:25,316 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:11:25,318 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:11:25,319 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:11:25,330 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:11:25,332 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:11:25,335 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:11:25,337 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:11:26,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:11:26,991 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:12:02,415 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:12:02,416 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 10:12:11,354 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:12:11,358 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:12:11,359 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:13,984 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:12:17,746 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:12:17,779 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:12:17,781 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:12:17,783 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:12:17,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:12:18,441 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:12:18,712 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:28,718 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:12:28,720 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:31,396 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:12:48,409 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:12:48,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:12:49,596 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:12:49,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:16,883 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:13:23,113 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:13:30,114 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:13:30,117 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:13:30,118 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:13:31,252 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:13:31,378 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:13:31,379 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:13:34,631 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:13:45,209 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:13:45,588 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:13:46,741 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:13:50,239 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1510
2025-11-17 10:13:50,240 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:13:55,132 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 416
2025-11-17 10:13:55,133 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:13:56,385 - ispa_next.main - DEBUG - Found new Appointment: MZ-MC 905
2025-11-17 10:13:56,387 - ispa_next.main - DEBUG - 



2025-11-17 10:13:56,387 - ispa_next.main - DEBUG - starting with process 4 (MZ-MC 905) of 16
2025-11-17 10:13:56,391 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:13:58,301 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:14:00,332 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1510
2025-11-17 10:14:00,334 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 416
2025-11-17 10:14:02,591 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:14:02,592 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:14:39,648 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:14:53,032 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:54,315 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:14:54,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:54,409 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:14:54,804 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:14:54,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:54,895 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:03,428 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:15:06,606 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:15:06,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:15:09,182 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:15:11,185 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:15:11,331 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:15:14,574 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:15:14,684 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:15:14,685 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:15,951 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:15:28,069 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:15:29,085 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:15:29,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:29,615 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:43,958 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:15:54,140 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:15:54,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:54,236 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:54,237 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:15:54,330 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:15:54,526 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:15:55,879 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:15:56,161 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:16:00,852 - ispa_next.functions - DEBUG - Updated appointment (AS00013549) customer contact data.
2025-11-17 10:16:01,779 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:16:01,782 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:16:02,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:16:03,061 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:16:04,973 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:16:04,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:16:05,085 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:16:08,756 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:16:08,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:09,331 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:11,335 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:16:11,514 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:16:11,654 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:16:11,796 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:16:11,798 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:13,828 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:16:25,653 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:17:25,656 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:17:37,846 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:17:39,863 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:17:51,843 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:18:01,523 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:18:02,530 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:18:02,531 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:18:02,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:02,610 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:18:06,783 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:18:06,787 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:18:06,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:06,910 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:18:07,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:07,794 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:07,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:08,620 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:18:08,621 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:18:10,562 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:18:10,564 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:18:11,960 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:18:11,961 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:18:11,963 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:18:11,964 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:18:11,965 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:18:11,966 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:18:11,968 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:18:11,969 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:18:11,970 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:18:11,971 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:18:11,975 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:18:11,981 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:18:12,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:18:13,749 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:18:28,492 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:18:28,495 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:18:28,498 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:18:28,499 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:31,175 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:18:31,178 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:18:31,181 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:18:31,183 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:18:31,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:18:31,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:18:31,777 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:18:31,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:34,396 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:18:48,711 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:18:49,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:18:49,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:18:49,968 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:15,743 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:19:20,407 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:19:25,658 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:19:25,660 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:19:25,660 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:19:26,468 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:19:26,560 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:19:26,561 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:19:28,960 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:19:39,205 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 10:19:39,207 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:19:39,208 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:19:40,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:19:40,137 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:19:40,139 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:19:45,680 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 10:19:45,709 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:19:49,132 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:19:49,135 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:19:52,987 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1511
2025-11-17 10:19:52,989 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:19:58,529 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 412
2025-11-17 10:19:58,530 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:19:59,528 - ispa_next.main - DEBUG - Found new Appointment: PI-HT 231E
2025-11-17 10:19:59,529 - ispa_next.main - DEBUG - 



2025-11-17 10:19:59,529 - ispa_next.main - DEBUG - starting with process 5 (PI-HT 231E) of 17
2025-11-17 10:19:59,533 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:20:01,010 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:20:02,535 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1511
2025-11-17 10:20:02,537 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 412
2025-11-17 10:20:04,997 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:20:04,998 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:20:42,594 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:20:56,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:59,513 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:20:59,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:59,594 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:20:59,937 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:20:59,941 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:21:03,013 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:21:03,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:04,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:21:06,515 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:21:06,667 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:21:09,943 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:21:10,064 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:21:10,066 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:13,499 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:21:25,188 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:21:26,193 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:21:26,194 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:26,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:32,005 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:21:32,009 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:21:32,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:32,143 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:21:32,144 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:21:32,204 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:21:33,431 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:21:34,713 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:21:36,095 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:21:36,327 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:21:41,305 - ispa_next.functions - DEBUG - Updated appointment (AS00013550) customer contact data.
2025-11-17 10:21:42,226 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:21:42,231 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:21:43,333 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:21:43,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:21:44,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:21:47,722 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:21:47,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:48,392 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:21:50,406 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:21:50,603 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:21:50,741 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:21:50,894 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:21:50,897 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:54,293 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:22:05,402 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:22:13,245 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:22:13,246 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:21,072 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:22:24,622 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:22:28,684 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:22:32,497 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:22:35,964 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:22:38,498 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:22:39,518 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:22:39,519 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:22:39,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:22:39,626 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:22:43,779 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:22:45,171 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:22:57,570 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:22:57,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:22:57,721 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:23:07,149 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 10:23:16,584 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:23:16,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:17,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:17,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:18,307 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:23:18,309 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:23:21,409 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:23:21,413 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:23:24,658 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:23:24,663 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:23:24,671 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:23:24,675 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart), Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:23:24,677 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:23:24,680 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:23:24,684 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:23:24,686 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:23:24,691 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:23:24,718 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:23:24,737 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:23:24,743 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:23:25,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:23:26,359 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:23:55,537 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 366, in _add_to_container_from_aw
    raise RuntimeError("Button 'Warenkorb' and 'Beratungsliste' are disabled")
RuntimeError: Button 'Warenkorb' and 'Beratungsliste' are disabled

2025-11-17 10:23:55,634 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:23:55,634 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:23:56,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:23:57,694 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:23:57,696 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:23:57,721 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:24:03,877 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:24:03,880 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:24:04,581 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1511
2025-11-17 10:24:04,583 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:24:09,682 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 412
2025-11-17 10:24:09,683 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:24:10,782 - ispa_next.main - DEBUG - 



2025-11-17 10:24:10,782 - ispa_next.main - DEBUG - starting with process 6 (WI JF 719) of 17
2025-11-17 10:24:10,786 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:24:12,719 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:24:14,673 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1511
2025-11-17 10:24:14,680 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 412
2025-11-17 10:24:17,394 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:24:17,396 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:24:34,068 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:24:34,076 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:24:34,082 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:24:34,808 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1511
2025-11-17 10:24:34,810 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:24:39,438 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 412
2025-11-17 10:24:39,439 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:24:40,887 - ispa_next.main - DEBUG - 



2025-11-17 10:24:40,887 - ispa_next.main - DEBUG - starting with process 7 (MZ S6995) of 17
2025-11-17 10:24:40,904 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:24:42,808 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:24:44,822 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1511
2025-11-17 10:24:44,824 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 412
2025-11-17 10:24:47,367 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:24:47,368 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:25:28,080 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:25:41,055 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:42,986 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:25:42,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:43,075 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:25:43,391 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:25:43,393 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:25:46,400 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:25:46,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:25:48,106 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:25:50,110 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:25:50,295 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:25:53,544 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:25:53,623 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:25:53,625 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:55,575 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:26:08,228 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:26:09,234 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:26:09,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:09,795 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:15,225 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:26:15,229 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:26:15,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:15,337 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:26:15,338 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:26:15,391 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:26:16,708 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:26:16,999 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:26:18,993 - ispa_next.functions - DEBUG - Updated appointment (AA00053699) customer contact data.
2025-11-17 10:26:19,926 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:26:19,928 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:26:21,077 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:26:21,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:26:21,880 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:26:25,532 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:26:25,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:26:26,096 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:26:28,101 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:26:28,223 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:26:28,364 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:26:28,449 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:26:28,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:30,422 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:26:43,006 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:27:43,009 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:27:54,050 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:28:02,411 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:28:02,413 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:06,725 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremse hinten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:28:10,649 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:28:15,713 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:28:16,720 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:28:16,721 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:28:16,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:16,812 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:28:21,055 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:28:22,010 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:28:32,824 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:28:32,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:32,965 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:28:37,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:38,849 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:38,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:39,742 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:28:39,743 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:28:41,677 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:28:41,679 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:28:43,845 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:28:43,849 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:28:43,856 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:28:43,859 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:28:43,861 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:28:43,863 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:28:43,865 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:28:43,866 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:28:43,868 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:28:43,872 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:28:43,879 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:28:43,894 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:28:44,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:28:45,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:28:59,830 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:28:59,832 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:28:59,834 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:28:59,835 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:02,515 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:29:02,518 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:29:02,520 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:29:02,523 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:29:02,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:29:03,190 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:29:03,433 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:18,861 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:29:18,864 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:21,514 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:29:38,546 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:29:39,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:29:39,680 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:29:39,990 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:30:09,160 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:30:15,336 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:30:21,716 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:30:21,718 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:30:21,719 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:30:22,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:30:22,994 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:30:22,996 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:30:25,980 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:30:38,754 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:30:39,155 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:30:43,024 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:30:44,192 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1512
2025-11-17 10:30:44,193 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:30:49,411 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 411
2025-11-17 10:30:49,414 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:30:50,735 - ispa_next.main - DEBUG - 



2025-11-17 10:30:50,735 - ispa_next.main - DEBUG - starting with process 8 (MZ-JD 604) of 17
2025-11-17 10:30:50,739 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:30:52,713 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:30:54,849 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1512
2025-11-17 10:30:54,855 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 411
2025-11-17 10:30:57,398 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:30:57,399 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:31:37,065 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:31:50,126 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:52,003 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:31:52,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:52,113 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:31:52,413 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:31:52,416 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:31:55,473 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:31:55,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:31:57,042 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:31:59,045 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:31:59,211 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:32:02,573 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:32:02,679 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:32:02,680 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:32:04,640 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:32:16,931 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:32:17,936 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:32:17,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:18,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:34,399 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:32:45,346 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:32:45,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:45,446 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:32:45,447 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:32:45,540 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:32:47,175 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:32:48,494 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:32:48,767 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:32:53,913 - ispa_next.functions - DEBUG - Updated appointment (AB00061389) customer contact data.
2025-11-17 10:32:54,889 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:32:54,915 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:32:56,822 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:32:56,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:32:57,855 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:33:02,460 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:33:02,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:33:03,051 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:33:05,054 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:33:05,227 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:33:05,400 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:33:05,646 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:33:05,647 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:08,687 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:33:20,959 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:34:20,963 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:34:33,219 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:34:37,221 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:34:49,439 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:35:00,020 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:35:01,026 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:35:01,027 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:35:01,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:35:01,110 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:35:05,290 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:35:05,296 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:35:05,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:35:05,410 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:35:05,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:06,324 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:06,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:35:07,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:35:07,140 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:35:09,727 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:35:09,729 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:35:11,246 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:35:11,249 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:35:11,252 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:35:11,260 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:35:11,263 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:35:11,268 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:35:11,270 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:35:11,272 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:35:11,275 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:35:11,286 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:35:11,307 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:35:11,317 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:35:12,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:35:13,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:35:28,172 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:35:28,175 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:35:28,178 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:35:28,179 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:35:31,529 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:35:31,531 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:35:31,534 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:35:31,537 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:35:31,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:35:32,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:35:32,079 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:35:32,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:35:35,396 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:35:50,903 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:35:51,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:35:51,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:35:52,228 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:36:26,312 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:36:32,691 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:36:39,047 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:36:46,001 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:36:46,004 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:36:46,005 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:36:47,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:36:47,338 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:36:47,340 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:36:51,028 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:37:05,244 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:37:05,639 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:37:07,567 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:37:10,853 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1513
2025-11-17 10:37:10,857 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:37:16,009 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 411
2025-11-17 10:37:16,010 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:37:17,421 - ispa_next.main - DEBUG - 



2025-11-17 10:37:17,421 - ispa_next.main - DEBUG - starting with process 9 (WI FI 246) of 17
2025-11-17 10:37:17,426 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:37:19,300 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:37:21,234 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1513
2025-11-17 10:37:21,236 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 411
2025-11-17 10:37:23,886 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:37:23,888 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:37:41,386 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:37:41,416 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:37:41,442 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:37:42,407 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1513
2025-11-17 10:37:42,409 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:37:46,775 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 411
2025-11-17 10:37:46,776 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:37:48,156 - ispa_next.main - DEBUG - 



2025-11-17 10:37:48,156 - ispa_next.main - DEBUG - starting with process 10 (F-JL-1820) of 17
2025-11-17 10:37:48,161 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:37:50,227 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:37:52,336 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1513
2025-11-17 10:37:52,338 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 411
2025-11-17 10:37:54,964 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:37:54,965 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:38:37,152 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:38:51,591 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:54,166 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:38:54,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:38:54,257 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:38:54,613 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:38:54,616 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:38:57,802 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:38:57,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:38:59,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:39:01,563 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:39:01,724 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:39:01,881 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:39:02,017 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:39:06,253 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:39:07,289 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:39:07,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:07,842 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:23,012 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:39:33,306 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:39:33,308 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:33,409 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:39:33,410 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:39:33,483 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:39:34,796 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:39:35,110 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:39:40,517 - ispa_next.functions - DEBUG - Updated appointment (AB00061382) customer contact data.
2025-11-17 10:39:41,461 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:39:41,484 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:39:42,992 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:39:42,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:39:44,156 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:39:47,745 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:39:47,745 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:39:47,748 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:39:47,749 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:39:47,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:39:48,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:39:52,488 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:39:52,493 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:39:52,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:39:52,597 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:39:52,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:53,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:53,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:39:54,338 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:39:54,339 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:39:56,825 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:39:56,827 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:39:58,649 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:39:58,651 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:39:58,653 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:39:58,656 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:39:58,662 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:39:58,665 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:39:58,668 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:39:58,670 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:39:58,672 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:39:58,673 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:39:58,677 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:39:58,680 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:39:59,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:40:00,424 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:40:16,045 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:40:16,047 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:40:16,048 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:40:16,049 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:40:19,510 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:40:19,512 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:40:19,514 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:40:19,516 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:40:19,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:40:20,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:40:20,466 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:40:29,789 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:40:29,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:40:33,114 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:40:50,703 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:40:51,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:40:51,831 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:40:52,161 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:12,814 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:41:12,815 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:41:14,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:41:14,157 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:41:14,159 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:41:21,422 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:41:33,248 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:41:33,637 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 10:41:34,914 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:41:38,732 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 10:41:38,736 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:41:43,515 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 410
2025-11-17 10:41:43,516 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:41:45,237 - ispa_next.main - DEBUG - 



2025-11-17 10:41:45,238 - ispa_next.main - DEBUG - starting with process 11 (M-ED 1182) of 17
2025-11-17 10:41:45,242 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:41:47,197 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:41:49,045 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 10:41:49,047 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 410
2025-11-17 10:41:51,891 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:41:51,892 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:42:29,996 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:42:43,799 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:46,458 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:42:46,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:42:46,554 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:42:46,954 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:42:46,958 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:42:50,046 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:42:50,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:42:51,742 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:42:53,756 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:42:53,924 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:42:54,046 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:42:54,196 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:42:54,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:56,934 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:43:09,439 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:43:10,445 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:43:10,446 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:11,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:29,146 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:43:40,435 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:43:40,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:40,550 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:43:40,551 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:43:40,610 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:43:41,871 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:43:43,117 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:43:44,535 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 10:43:44,994 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:43:51,267 - ispa_next.functions - DEBUG - Updated appointment (AB00061364) customer contact data.
2025-11-17 10:43:52,175 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:43:52,177 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:43:53,428 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:43:53,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:43:55,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:43:58,742 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:43:58,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:43:59,234 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:44:01,238 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:44:01,424 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:44:01,566 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:44:01,734 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:44:01,736 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:04,452 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:44:15,819 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:44:24,080 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:44:24,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:26,854 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:44:31,111 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:44:32,119 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:44:32,120 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:44:32,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:32,209 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:44:36,393 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:44:36,397 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:44:36,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:36,505 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:44:46,250 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 10:44:56,042 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:44:56,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:56,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:56,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:57,829 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:44:57,831 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:45:00,356 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:45:00,358 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:45:01,724 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:45:01,725 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:45:01,728 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:45:01,729 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart), Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart)}
2025-11-17 10:45:01,732 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:45:01,734 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:45:01,736 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:45:01,737 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:45:01,739 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:45:01,745 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:45:01,753 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:45:01,757 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:45:02,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:45:03,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:46:03,062 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:46:03,066 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 10:46:11,840 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:46:11,843 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:46:11,843 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:46:16,564 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:46:16,567 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:46:16,569 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:46:16,571 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:46:16,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:46:17,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:46:17,591 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:46:29,722 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:46:29,725 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:46:34,537 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:46:51,455 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:46:52,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:46:52,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:46:53,015 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:41,257 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:47:49,343 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:47:56,164 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:03,515 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:10,543 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:17,519 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:17,522 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:48:17,523 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:48:18,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:48:18,638 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:48:18,640 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:48:21,428 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:48:33,617 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:48:34,010 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 10:48:37,547 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:48:38,917 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 10:48:38,919 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:48:43,916 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 402
2025-11-17 10:48:43,917 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:48:45,242 - ispa_next.main - DEBUG - 



2025-11-17 10:48:45,242 - ispa_next.main - DEBUG - starting with process 12 (M MS3583) of 17
2025-11-17 10:48:45,247 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:48:47,186 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:48:49,286 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 10:48:49,288 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 402
2025-11-17 10:48:51,825 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:48:51,827 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:49:37,132 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:49:51,007 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:49:52,302 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:49:52,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:52,404 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:49:52,825 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:49:52,829 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:49:56,008 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:49:56,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:49:57,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:49:59,921 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:50:00,110 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:50:03,401 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:50:03,534 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:50:03,536 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:04,797 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:50:17,158 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:50:18,163 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:50:18,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:18,700 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:23,205 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:50:23,209 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:50:23,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:23,310 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:23,311 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:50:23,357 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:50:24,604 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:50:24,852 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:50:26,844 - ispa_next.functions - DEBUG - Updated appointment (AH00031630) customer contact data.
2025-11-17 10:50:27,755 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:50:27,758 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:50:29,336 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:50:29,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:50:30,559 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:50:34,177 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:50:34,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:34,682 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:50:36,688 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:50:36,824 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:50:37,035 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:50:37,154 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:50:37,156 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:38,480 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:50:50,209 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:50:57,974 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:50:57,976 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:59,321 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:51:03,546 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:51:04,554 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:51:04,555 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:51:04,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:04,659 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:51:08,858 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:51:08,879 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:51:08,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:08,971 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:51:14,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:15,197 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:15,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:16,125 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:51:16,126 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:51:17,490 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:51:17,495 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:51:18,935 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:51:18,938 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:51:18,940 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:51:18,942 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:51:18,943 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:51:18,945 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:51:18,946 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:51:18,947 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:51:18,949 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:51:18,951 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:51:18,953 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:51:18,954 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:51:19,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:51:20,644 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:51:35,851 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:51:35,854 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:51:35,856 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:51:35,856 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:37,847 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:51:37,853 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:51:37,856 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:51:37,858 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:51:37,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:51:38,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:51:38,908 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:48,162 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:51:48,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:50,191 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:52:06,706 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:52:07,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:52:07,930 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:52:08,254 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:52:28,416 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:52:35,355 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:52:35,357 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:52:35,358 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:52:36,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:52:36,731 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:52:36,733 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:52:40,525 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:52:56,657 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 10:52:56,863 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:52:56,864 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:52:58,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:52:58,230 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:52:58,232 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:53:01,447 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 10:53:01,491 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:53:07,982 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 10:53:07,986 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:53:08,881 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 10:53:08,883 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:53:14,013 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-17 10:53:14,014 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:53:15,366 - ispa_next.main - DEBUG - 



2025-11-17 10:53:15,366 - ispa_next.main - DEBUG - starting with process 13 (KI-KI 0815) of 17
2025-11-17 10:53:15,371 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:53:16,978 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:53:18,844 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 10:53:18,846 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-17 10:53:21,244 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:53:21,250 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:53:52,353 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 167, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 10:53:52,377 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 10:53:52,390 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:53:53,325 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 10:53:53,326 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:53:58,541 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-17 10:53:58,542 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:53:59,604 - ispa_next.main - DEBUG - 



2025-11-17 10:53:59,604 - ispa_next.main - DEBUG - starting with process 14 (MZ-JM 217) of 17
2025-11-17 10:53:59,609 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:54:01,262 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:54:02,994 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 10:54:02,996 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-17 10:54:05,501 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:54:05,502 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:54:48,331 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:55:01,712 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:55:02,967 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:55:02,967 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:03,079 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:03,329 - ispa_next.functions - DEBUG - HU date soon to be invalid in 5 days.
2025-11-17 10:55:13,028 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:55:13,031 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:55:16,174 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:55:16,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:55:18,031 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:55:20,036 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:55:20,229 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:55:23,531 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:55:33,812 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 10:55:34,818 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:55:34,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:35,334 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:40,013 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:55:40,016 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:55:40,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:40,134 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:40,134 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:55:40,185 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:55:41,382 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:55:42,632 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:55:42,914 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:55:48,325 - ispa_next.functions - DEBUG - Updated appointment (AA00053672) customer contact data.
2025-11-17 10:55:49,311 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:55:49,314 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:55:50,940 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:55:50,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:55:52,147 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:55:55,767 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:55:55,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:55:56,280 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:55:58,284 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:55:58,447 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:55:58,578 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:55:58,709 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:55:58,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:55:59,953 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:56:12,808 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:57:12,811 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:57:24,930 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:57:48,933 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:58:01,095 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:58:12,547 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:58:13,555 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:58:13,556 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:58:13,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:58:13,641 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:58:17,838 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:58:17,842 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:58:17,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:58:17,940 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:58:18,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:58:18,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:58:18,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:58:19,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:58:19,778 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:58:21,211 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:58:21,216 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:58:22,726 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:58:22,727 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:58:22,729 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:58:22,731 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-17 10:58:22,732 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:58:22,734 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:58:22,740 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:58:22,744 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:58:22,746 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:58:22,747 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:58:22,749 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:58:22,751 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:58:23,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:58:24,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:58:40,356 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:58:40,360 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:58:40,361 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:58:40,362 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:42,314 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:58:42,318 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:58:42,322 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:58:42,325 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:58:42,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:58:42,900 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:58:42,956 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:58:42,959 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:44,958 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:59:00,911 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:59:01,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:59:02,062 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:59:02,384 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:59:23,724 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:59:30,505 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:59:30,507 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:59:30,508 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:59:31,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:59:31,842 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:59:31,844 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:59:34,730 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:59:48,621 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:59:49,003 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 10:59:53,004 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:59:54,201 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 10:59:54,203 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:59:59,436 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-17 10:59:59,437 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:00:00,892 - ispa_next.main - DEBUG - 



2025-11-17 11:00:00,893 - ispa_next.main - DEBUG - starting with process 15 (MZ - AW 77E) of 17
2025-11-17 11:00:00,898 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:00:02,855 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:00:04,828 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 11:00:04,829 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-17 11:00:12,791 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:00:12,793 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:00:33,178 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 11:00:33,194 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 11:00:33,203 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:00:34,407 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 11:00:34,408 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:00:40,397 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-17 11:00:40,397 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:00:41,827 - ispa_next.main - DEBUG - 



2025-11-17 11:00:41,828 - ispa_next.main - DEBUG - starting with process 16 (KI-KI 0815) of 17
2025-11-17 11:00:41,832 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:00:43,995 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:00:46,498 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 11:00:46,501 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-17 11:00:49,319 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:00:49,321 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:01:21,088 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 167, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 11:01:21,097 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 11:01:21,101 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:01:21,886 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 11:01:21,887 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:01:26,745 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-17 11:01:26,745 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:01:28,036 - ispa_next.main - DEBUG - 



2025-11-17 11:01:28,036 - ispa_next.main - DEBUG - starting with process 17 (0) of 17
2025-11-17 11:01:28,040 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:01:30,150 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:01:32,404 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 11:01:32,406 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-17 11:01:35,735 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:01:35,741 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:02:08,707 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 167, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 11:02:08,719 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 11:02:08,724 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:02:09,792 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1514
2025-11-17 11:02:09,794 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:02:15,097 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-17 11:02:15,097 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
