2025-11-17 05:00:33,729 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 05:00:33,736 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 05:00:55,364 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 05:01:05,883 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 05:01:21,179 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 05:01:47,131 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 05:02:00,351 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 05:02:02,948 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:02:04,185 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:02:04,186 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:02:06,243 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 159
2025-11-17 05:02:06,244 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 05:02:06,245 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 05:02:07,264 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 05:02:08,111 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:02:29,678 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 05:02:29,679 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:02:29,682 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:02:29,693 - ispa_next.appointments.models - DEBUG - Appointment Severin Stefanov Todorov HU-YS 2023 WBAVC31080VA19489 ohne Termin.
2025-11-17 05:02:29,727 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 05:02:29,771 - ispa_next.appointments.models - DEBUG - Appointment Ulrich Franz WW-SC 91 WBA5V71020FH87156 ohne Termin.
2025-11-17 05:02:29,797 - ispa_next.appointments.models - DEBUG - Appointment Firma AKC Angersbach & Kaiser  WBA65GP080N366928 ohne Termin.
2025-11-17 05:02:29,809 - ispa_next.appointments.models - DEBUG - Appointment   WBA11GV080CW64111 ohne Termin.
2025-11-17 05:02:29,819 - ispa_next.appointments.models - DEBUG - Appointment Marcel Werner Hohmann FD-MH 1306 WBAJN71050BS67908 ohne Termin.
2025-11-17 05:02:29,828 - ispa_next.appointments.models - DEBUG - Appointment   WBA32EE0805469799 ohne Termin.
2025-11-17 05:02:29,836 - ispa_next.appointments.models - DEBUG - Appointment Dino Keshishi HU-MD 1991 WBA8T31040GB33829 ohne Termin.
2025-11-17 05:02:29,847 - ispa_next.appointments.models - DEBUG - Appointment Edat Bayram GN-XM 1996 WBA7C41070BR92361 ohne Termin.
2025-11-17 05:02:29,856 - ispa_next.appointments.models - DEBUG - Appointment Firma MARL Seafood GmbH OF-AL 4545 WBA41EU0609Z08046 ohne Termin.
2025-11-17 05:02:29,890 - ispa_next.main - DEBUG - Found 15 out of 135 appointments to process (configured limit: 15).
2025-11-17 05:02:29,890 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 05:02:29,890 - ispa_next.main - DEBUG - All appointments: HU MJ 28, HU AC78E, HU KT 1402, HG-NN 50, HU-PW 667, FB-B 985, HU-KJ 81, FB-KU 786, HU-XS 108, MKK-KX 211, HU-AS 958, MKK-DN 180, OF-JF 333, FB-SR 1700, MKK-RM 157
2025-11-17 05:02:29,893 - ispa_next.main - DEBUG - 



2025-11-17 05:02:29,893 - ispa_next.main - DEBUG - starting with process 1 (HU MJ 28) of 15
2025-11-17 05:02:29,900 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:02:31,050 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:02:32,316 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:02:32,317 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 159
2025-11-17 05:02:33,656 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:02:33,658 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:03:07,036 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:03:07,157 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 05:03:07,162 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:03:07,700 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:03:07,704 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:03:10,342 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:03:10,343 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:03:11,229 - ispa_next.main - DEBUG - 



2025-11-17 05:03:11,229 - ispa_next.main - DEBUG - starting with process 2 (HU AC78E) of 15
2025-11-17 05:03:11,234 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:03:12,482 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:03:13,854 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:03:13,855 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:03:15,187 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:03:15,188 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:03:45,208 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:03:45,218 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 05:03:45,222 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:03:45,643 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:03:45,644 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:03:47,780 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:03:47,780 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:03:48,422 - ispa_next.main - DEBUG - 



2025-11-17 05:03:48,423 - ispa_next.main - DEBUG - starting with process 3 (HU KT 1402) of 15
2025-11-17 05:03:48,429 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:03:49,308 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:03:50,485 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:03:50,486 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:03:51,790 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:03:51,791 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:04:24,863 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:04:24,873 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 05:04:24,878 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:04:25,430 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:04:25,431 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:04:27,723 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:04:27,724 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:04:28,364 - ispa_next.main - DEBUG - 



2025-11-17 05:04:28,364 - ispa_next.main - DEBUG - starting with process 4 (HG-NN 50) of 15
2025-11-17 05:04:28,369 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:04:29,266 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:04:30,075 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:04:30,076 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:04:31,504 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:04:31,506 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:04:53,448 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:04:56,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:04:56,781 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:04:56,927 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:05:00,164 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:05:00,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:05:00,230 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:05:00,497 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:05:00,501 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:05:00,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:05:00,591 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:05:07,647 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:05:07,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:05:08,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:05:10,579 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:05:16,816 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 05:05:20,747 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 05:05:21,753 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:05:21,758 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:05:21,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:05:22,245 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:05:22,246 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:05:22,315 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:05:22,405 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 05:05:23,532 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:05:23,798 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:05:25,252 - ispa_next.functions - DEBUG - Updated appointment (AA00030019) customer contact data.
2025-11-17 05:05:26,160 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:05:26,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:05:26,244 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:05:26,441 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:05:26,443 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:05:26,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:05:27,144 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:05:27,994 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:05:27,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:05:28,057 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 05:05:32,059 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:05:32,059 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 05:05:32,062 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:05:32,063 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:05:32,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:05:32,556 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:05:36,663 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 05:05:36,668 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:05:36,668 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 05:05:36,669 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:05:39,623 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:05:39,625 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:05:40,692 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:05:40,695 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:05:40,696 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:05:40,697 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:05:40,699 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:05:40,716 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:05:40,718 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:05:40,721 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:05:40,723 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:05:40,724 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:05:40,730 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:05:40,732 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:05:40,733 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:05:44,003 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:05:44,006 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:05:44,008 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:05:47,197 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:05:47,199 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:05:47,202 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:05:47,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:05:50,388 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:05:50,390 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:05:51,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:05:51,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:05:52,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:06:23,698 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:06:28,580 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:06:32,198 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:06:36,583 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:06:36,586 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:06:36,586 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:06:37,247 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:06:37,325 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:06:37,327 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:06:39,190 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:06:47,736 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:06:48,126 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 05:06:48,331 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:06:49,190 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:06:49,191 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:06:51,369 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:06:51,369 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:06:52,049 - ispa_next.main - DEBUG - 



2025-11-17 05:06:52,049 - ispa_next.main - DEBUG - starting with process 5 (HU-PW 667) of 15
2025-11-17 05:06:52,055 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:06:53,199 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:06:54,450 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:06:54,451 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:06:55,837 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:06:55,839 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:07:21,615 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:07:24,889 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:07:26,793 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:07:26,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:07:26,867 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:07:27,192 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:07:27,195 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:07:27,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:07:27,260 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:07:30,260 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:07:30,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:07:31,178 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:07:33,183 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:07:33,315 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:07:33,401 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:07:33,512 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:07:33,513 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:07:35,501 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:07:46,839 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:07:47,843 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:07:47,851 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:07:47,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:07:48,428 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:07:48,429 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:07:48,470 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:07:49,626 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:07:49,850 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:07:51,364 - ispa_next.functions - DEBUG - Updated appointment (AA00030017) customer contact data.
2025-11-17 05:07:52,285 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:07:52,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:07:52,383 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:07:52,482 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:07:52,484 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:07:53,035 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:07:53,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:07:53,682 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:07:57,692 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:07:57,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:07:58,175 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:08:00,204 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:08:00,348 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:08:00,439 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:08:00,568 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:08:00,570 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:08:02,487 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:08:13,931 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:09:13,934 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:09:25,382 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:09:32,294 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:09:32,295 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:09:34,239 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:09:38,427 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:09:39,433 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:09:39,434 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:09:39,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:09:39,576 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:09:43,692 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 05:09:43,697 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:09:43,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:09:43,763 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:09:49,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:09:49,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:09:49,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:09:50,678 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:09:50,678 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:09:52,667 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:09:52,672 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:09:53,685 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:09:53,687 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:09:53,688 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:09:53,690 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:09:53,692 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:09:53,695 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:09:53,696 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:09:53,705 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:09:53,715 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:09:53,717 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:09:53,723 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:09:53,726 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:09:53,727 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:09:55,625 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:09:55,628 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:09:55,630 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:09:57,440 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:09:57,442 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:09:57,445 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:09:57,446 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:09:59,364 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:09:59,367 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:09:59,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:10:00,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:10:00,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:10:20,699 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:10:25,330 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:10:25,332 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:10:25,333 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:10:26,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:10:26,122 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:10:26,124 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:10:27,932 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:10:36,196 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:10:36,593 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 05:10:36,926 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:10:37,840 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:10:37,842 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:10:40,493 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:10:40,494 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:10:41,102 - ispa_next.main - DEBUG - 



2025-11-17 05:10:41,102 - ispa_next.main - DEBUG - starting with process 6 (FB-B 985) of 15
2025-11-17 05:10:41,118 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:10:41,956 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:10:43,029 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:10:43,030 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:10:44,599 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:10:44,601 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:11:07,545 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:11:11,080 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:11:12,357 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:11:12,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:11:12,437 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:11:12,693 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:11:12,697 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:11:12,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:11:12,783 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:11:16,031 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:11:16,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:11:16,990 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:11:18,996 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:11:19,103 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:11:19,213 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:11:19,296 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:11:19,298 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:11:20,565 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:11:31,964 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:11:32,970 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:11:32,975 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:11:32,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:11:33,462 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:11:33,462 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:11:33,555 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:11:34,751 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:11:34,958 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:11:36,615 - ispa_next.functions - DEBUG - Updated appointment (AA00030016) customer contact data.
2025-11-17 05:11:37,534 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:11:37,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:11:37,621 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:11:37,795 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:11:37,798 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:11:38,561 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:11:38,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:11:39,414 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:11:43,073 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:11:43,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:11:43,579 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:11:45,585 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:11:45,740 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:11:45,828 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:11:45,897 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:11:45,898 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:11:47,162 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:11:58,538 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:12:58,541 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:13:09,363 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:13:16,548 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:13:16,550 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:13:17,808 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:13:22,003 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:13:23,011 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:13:23,011 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:13:23,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:13:23,132 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:13:27,252 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 05:13:27,257 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:13:27,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:13:27,331 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:13:36,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:13:36,645 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:13:36,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:13:37,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:13:37,421 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:13:38,711 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:13:38,713 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:13:39,791 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:13:39,796 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:13:39,798 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:13:39,800 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:13:39,802 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:13:39,804 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:13:39,805 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:13:39,806 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:13:39,807 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:13:39,808 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:13:39,812 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:13:39,814 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:13:39,815 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:13:41,054 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:13:41,056 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:13:41,058 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:13:42,221 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:13:42,224 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:13:42,226 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:13:42,229 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:13:43,397 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:13:43,400 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:13:44,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:13:44,829 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:13:45,056 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:13:58,425 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:13:58,427 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:13:58,428 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:13:59,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:13:59,156 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:13:59,158 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:14:01,019 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:14:08,881 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:14:09,278 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 05:14:09,520 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:14:10,476 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:14:10,477 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:14:13,410 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:14:13,411 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:14:14,204 - ispa_next.main - DEBUG - 



2025-11-17 05:14:14,204 - ispa_next.main - DEBUG - starting with process 7 (HU-KJ 81) of 15
2025-11-17 05:14:14,208 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:14:15,436 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:14:16,770 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:14:16,770 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:14:18,210 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:14:18,211 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:14:48,582 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:14:51,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:14:53,742 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:14:53,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:14:53,804 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:14:53,972 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 05:14:56,966 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:14:56,969 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:14:56,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:14:57,035 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:14:59,961 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:14:59,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:15:00,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:15:02,896 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:15:03,021 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:15:03,119 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:15:03,200 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:15:03,201 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:15:05,134 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:15:17,307 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:15:18,324 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:15:18,328 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:15:18,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:15:18,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:15:18,838 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:15:18,878 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:15:20,092 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:15:20,365 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:15:21,978 - ispa_next.functions - DEBUG - Updated appointment (AA00030012) customer contact data.
2025-11-17 05:15:22,874 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:15:22,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:15:22,958 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:15:23,144 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:15:23,147 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:15:23,998 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:15:23,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:15:24,639 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:15:28,730 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:15:28,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:15:29,249 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:15:31,252 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:15:31,406 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:15:31,524 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:15:31,592 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:15:31,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:15:33,488 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:15:44,725 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:16:44,726 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:16:56,309 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:17:03,481 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:17:03,482 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:17:05,385 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:17:09,596 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:17:10,603 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:17:10,603 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:17:10,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:17:10,724 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:17:14,847 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 05:17:14,852 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:17:14,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:17:14,976 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:17:20,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:17:21,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:17:21,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:17:21,818 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:17:21,818 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:17:23,753 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:17:23,755 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:17:24,786 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:17:24,787 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:17:24,788 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:17:24,791 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:17:24,793 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:17:24,796 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:17:24,798 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:17:24,801 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:17:24,803 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:17:24,804 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:17:24,808 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:17:24,810 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:17:24,811 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:17:26,741 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:17:26,743 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:17:26,746 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:17:28,641 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:17:28,644 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:17:28,646 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:17:28,648 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:17:30,601 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:17:30,603 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:17:31,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:17:32,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:17:32,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:17:50,190 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:17:54,529 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:17:54,532 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:17:54,533 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:17:55,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:17:55,114 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:17:55,116 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:17:56,553 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:18:03,756 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:18:04,152 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 05:18:04,749 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:18:05,437 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:18:05,438 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:18:08,476 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:18:08,476 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:18:09,287 - ispa_next.main - DEBUG - 



2025-11-17 05:18:09,288 - ispa_next.main - DEBUG - starting with process 8 (FB-KU 786) of 15
2025-11-17 05:18:09,292 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:18:10,473 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:18:11,664 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:18:11,665 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:18:13,091 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:18:13,093 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:18:45,794 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:18:48,939 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:18:53,510 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:18:53,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:18:53,588 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:18:53,758 - ispa_next.functions - DEBUG - HU date already expired after 30 days.
2025-11-17 05:18:57,664 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:18:57,667 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:18:57,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:18:57,739 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:19:04,307 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:19:04,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:19:05,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:19:07,232 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:19:07,361 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:19:07,453 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:19:07,538 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:19:07,539 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:19:12,259 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:19:23,435 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:19:24,440 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:19:24,444 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:19:24,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:19:24,950 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:19:24,951 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:19:24,997 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:19:25,124 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 05:19:26,214 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:19:26,438 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:19:27,994 - ispa_next.functions - DEBUG - Updated appointment (AA00030005) customer contact data.
2025-11-17 05:19:28,930 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:19:28,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:19:29,018 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:19:29,151 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:19:29,154 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:19:29,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:19:30,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:19:31,100 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:19:31,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:19:31,192 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 05:19:35,160 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:19:35,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:19:35,742 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:19:37,745 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:19:37,849 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:19:37,957 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:19:38,022 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:19:38,024 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:19:42,727 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:19:54,066 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:20:54,081 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:21:05,085 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:21:12,065 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:21:12,066 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:21:18,151 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:21:19,528 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:21:21,998 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:21:23,008 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:21:23,009 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:21:23,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:21:23,116 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:21:27,217 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 05:21:30,586 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:21:30,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:21:30,663 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:21:31,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:21:31,799 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:21:31,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:21:32,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:21:32,465 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:21:36,723 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:21:36,725 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:21:37,976 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:21:37,978 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:21:37,980 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:21:37,982 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:21:37,985 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:21:37,986 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:21:37,987 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:21:37,989 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:21:37,990 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:21:37,991 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:21:37,994 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:21:37,997 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:21:37,998 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:21:42,646 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:21:42,649 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:21:42,651 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:21:47,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:21:47,313 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:21:58,922 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:21:58,924 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:21:58,926 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:21:58,941 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:22:03,615 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:22:03,617 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:22:04,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:22:05,004 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:22:05,170 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:22:50,848 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:22:55,664 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:23:00,269 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:23:04,854 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:23:09,205 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:23:13,294 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:23:13,296 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:23:13,297 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:23:13,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:23:13,879 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:23:13,882 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:23:15,363 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:23:23,330 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:23:23,721 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 05:23:24,575 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:23:25,200 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:23:25,201 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:23:28,074 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:23:28,075 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:23:28,904 - ispa_next.main - DEBUG - 



2025-11-17 05:23:28,904 - ispa_next.main - DEBUG - starting with process 9 (HU-XS 108) of 15
2025-11-17 05:23:28,909 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:23:30,171 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:23:31,264 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:23:31,265 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:23:32,711 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:23:32,713 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:24:03,402 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:24:06,672 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:24:08,565 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:24:08,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:24:08,636 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:24:08,824 - ispa_next.functions - DEBUG - HU date already expired after 323 days.
2025-11-17 05:24:11,804 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:24:11,807 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:24:11,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:24:11,872 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:24:18,641 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:24:18,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:24:19,534 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:24:21,542 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:24:21,645 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:24:21,747 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:24:21,826 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:24:21,827 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:24:23,807 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:24:34,957 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:24:35,961 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:24:35,965 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:24:35,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:24:36,478 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:24:36,478 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:24:36,531 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:24:36,614 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 05:24:37,711 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:24:37,935 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:24:39,559 - ispa_next.functions - DEBUG - Updated appointment (AA00030000) customer contact data.
2025-11-17 05:24:40,463 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:24:40,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:24:40,533 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:24:40,662 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:24:40,664 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:24:40,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:24:41,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:24:42,532 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:24:42,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:24:42,621 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 05:24:46,192 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:24:46,194 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:24:46,713 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:24:48,716 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:24:48,813 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:24:48,942 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:24:49,013 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:24:49,014 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:24:50,948 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:25:02,302 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:26:02,304 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:26:13,550 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:26:20,641 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:26:20,643 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:26:22,585 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:26:26,749 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:26:27,754 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:26:27,755 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:26:27,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:26:27,818 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:26:31,965 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 05:26:31,970 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:26:31,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:26:32,050 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:26:32,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:26:32,919 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:26:32,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:26:33,546 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:26:33,546 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:26:35,555 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:26:35,557 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:26:36,438 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:26:36,439 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:26:36,445 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:26:36,446 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:26:36,449 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:26:36,452 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:26:36,453 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:26:36,455 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:26:36,456 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:26:36,457 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:26:36,460 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:26:36,463 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:26:36,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:26:38,343 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:26:38,346 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:26:38,351 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:26:40,219 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:26:40,221 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:26:40,223 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:26:40,227 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:26:42,138 - ispa_next.functions - DEBUG - adding material to item=Package(name=Ölwechsel im Doppelkupplungsgetriebe (DKG), source=cart, target=unkown)
2025-11-17 05:26:51,096 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:26:51,098 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:26:51,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:26:52,321 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:26:52,461 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:27:11,024 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:27:15,757 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:27:15,760 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:27:15,761 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:27:16,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:27:16,564 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:27:16,566 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:27:18,221 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:27:25,819 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:27:26,209 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 05:27:26,665 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:27:27,425 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:27:27,427 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:27:30,759 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:27:30,759 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:27:31,700 - ispa_next.main - DEBUG - 



2025-11-17 05:27:31,700 - ispa_next.main - DEBUG - starting with process 10 (MKK-KX 211) of 15
2025-11-17 05:27:31,705 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:27:32,928 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:27:34,254 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:27:34,255 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:27:35,776 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:27:35,777 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:28:17,465 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 05:28:17,477 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 05:28:17,487 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:28:17,981 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:28:17,982 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:28:20,824 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:28:20,824 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:28:21,595 - ispa_next.main - DEBUG - 



2025-11-17 05:28:21,595 - ispa_next.main - DEBUG - starting with process 11 (HU-AS 958) of 15
2025-11-17 05:28:21,604 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:28:22,792 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:28:23,966 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:28:23,968 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:28:25,325 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:28:25,326 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:28:49,017 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:28:52,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:28:54,798 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:28:54,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:28:54,869 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:28:55,086 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 05:28:58,485 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:28:58,488 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:28:58,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:28:58,566 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:29:05,100 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:29:05,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:29:06,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:29:08,223 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:29:08,313 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:29:08,423 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:29:08,516 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:29:08,519 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:29:11,163 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:29:22,560 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:29:23,566 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:29:23,571 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:29:23,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:24,086 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:24,086 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:29:24,127 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:29:24,232 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 05:29:25,389 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:29:25,650 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:29:27,325 - ispa_next.functions - DEBUG - Updated appointment (AF00016210) customer contact data.
2025-11-17 05:29:28,247 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:29:28,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:29:28,323 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:29:28,520 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:29:28,522 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:29:28,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:29:29,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:29:30,642 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:29:30,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:29:30,734 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 05:29:34,767 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:29:34,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:29:35,238 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:29:37,242 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:29:37,346 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:29:37,470 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:29:37,572 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:29:37,573 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:29:40,182 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:29:51,427 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:30:51,429 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:31:03,038 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:31:49,041 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:31:59,827 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:32:07,081 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:32:07,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:32:12,608 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:32:15,136 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Standardumfang' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:32:17,534 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:32:18,988 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:32:21,400 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:32:22,406 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:32:22,407 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:32:22,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:32:22,530 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:32:26,649 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 05:32:30,058 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:32:30,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:32:30,154 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:32:30,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:32:31,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:32:31,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:32:31,752 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:32:31,752 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:32:34,158 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:32:34,164 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:32:36,308 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:32:36,325 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:32:36,332 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:32:36,338 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:32:36,340 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:32:36,341 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:32:36,342 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:32:36,352 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:32:36,354 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:32:36,356 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:32:36,359 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:32:36,362 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:32:36,363 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:32:38,983 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:32:38,986 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:32:38,987 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:32:41,633 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:32:41,636 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:32:41,639 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:32:41,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:32:44,231 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:32:44,233 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:32:44,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:32:45,620 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:32:45,737 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:33:10,820 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:33:14,507 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:33:19,190 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:33:19,193 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:33:19,194 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:33:19,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:33:19,905 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:33:19,906 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:33:21,737 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:33:29,586 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:33:29,965 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 05:33:30,632 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:33:31,346 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:33:31,347 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:33:34,460 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:33:34,461 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:33:35,208 - ispa_next.main - DEBUG - 



2025-11-17 05:33:35,208 - ispa_next.main - DEBUG - starting with process 12 (MKK-DN 180) of 15
2025-11-17 05:33:35,213 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:33:36,435 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:33:37,670 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:33:37,675 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:33:39,205 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:33:39,206 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:34:01,974 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:34:05,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:34:06,343 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:34:06,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:34:06,418 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:34:06,699 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:34:06,703 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:34:06,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:34:06,791 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:34:13,389 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:34:13,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:34:14,411 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:34:16,416 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:34:16,526 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:34:16,644 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:34:16,717 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:34:16,718 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:34:18,001 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:34:29,219 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:34:30,224 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:34:30,228 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:34:30,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:34:30,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:34:30,736 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:34:30,775 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:34:31,894 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:34:32,140 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:34:33,759 - ispa_next.functions - DEBUG - Updated appointment (AE00018300) customer contact data.
2025-11-17 05:34:34,677 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:34:34,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:34:34,778 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:34:34,923 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:34:34,925 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:34:35,488 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:34:35,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:34:36,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:34:39,781 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:34:39,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:34:40,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:34:42,238 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:34:42,385 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:34:42,493 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:34:42,598 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:34:42,600 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:34:43,842 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:34:55,161 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:35:55,163 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:36:06,365 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:36:13,684 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:36:13,685 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:36:14,966 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:36:19,148 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:36:20,156 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:36:20,157 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:36:20,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:36:20,226 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:36:24,397 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 05:36:24,401 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:36:24,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:36:24,520 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:36:24,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:36:25,433 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:36:25,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:36:26,159 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:36:26,159 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:36:27,422 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:36:27,423 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:36:28,352 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:36:28,353 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:36:28,354 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:36:28,355 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:36:28,356 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:36:28,357 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:36:28,358 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:36:28,359 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:36:28,360 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:36:28,361 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:36:28,364 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:36:28,367 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:36:28,368 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:36:29,570 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:36:29,572 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:36:29,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:36:30,789 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:36:30,792 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:36:30,794 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:36:30,796 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:36:32,090 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:36:32,093 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:36:32,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:36:33,363 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:36:33,552 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:36:45,309 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:36:45,311 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:36:45,312 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:36:45,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:36:46,024 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:36:46,026 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:36:47,954 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:36:55,447 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:36:55,830 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 05:36:56,126 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:36:57,193 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:36:57,194 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:37:00,414 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:37:00,415 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:37:01,269 - ispa_next.main - DEBUG - 



2025-11-17 05:37:01,269 - ispa_next.main - DEBUG - starting with process 13 (OF-JF 333) of 15
2025-11-17 05:37:01,273 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:37:02,593 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:37:03,795 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:37:03,796 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:37:05,376 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:37:05,377 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:37:38,608 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:37:41,815 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:37:47,090 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:37:47,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:37:47,166 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:37:47,372 - ispa_next.functions - DEBUG - HU date already expired after 24 days.
2025-11-17 05:37:51,420 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:37:51,423 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:37:51,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:37:51,525 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:37:58,397 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:37:58,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:37:59,367 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:38:01,374 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:38:01,466 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:38:01,570 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:38:01,661 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:38:01,662 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:38:07,172 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:38:18,677 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:38:19,683 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:38:19,688 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:38:19,693 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:38:20,206 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:38:20,207 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:38:20,302 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:38:20,420 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 05:38:21,720 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:38:21,962 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:38:23,703 - ispa_next.functions - DEBUG - Updated appointment (AE00018282) customer contact data.
2025-11-17 05:38:24,612 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:38:24,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:38:24,679 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:38:24,936 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:38:24,938 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:38:25,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:38:25,849 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:38:26,985 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:38:26,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:38:27,052 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 05:38:30,622 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:38:30,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:38:31,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:38:33,110 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:38:33,235 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:38:33,352 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:38:33,434 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:38:33,435 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:38:38,857 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:38:50,595 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:39:50,598 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:40:01,354 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:40:08,641 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:40:08,643 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:40:14,043 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:40:18,209 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:40:19,217 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:40:19,218 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:40:19,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:40:19,317 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:40:23,426 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 05:40:27,344 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:40:27,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:40:27,420 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:40:27,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:40:28,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:40:28,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:40:28,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:40:28,941 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:40:33,702 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:40:33,704 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:40:34,775 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:40:34,776 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:40:34,782 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:40:34,783 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:40:34,786 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:40:34,788 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:40:34,789 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:40:34,790 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:40:34,791 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:40:34,792 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:40:34,795 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:40:34,798 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:40:34,799 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:40:40,079 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:40:40,081 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:40:40,085 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:40:45,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:40:45,425 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:40:57,085 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:40:57,087 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:40:57,090 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:40:57,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:41:02,418 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:41:02,420 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:41:03,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:41:03,694 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:41:03,920 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:41:50,400 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:41:55,274 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:41:59,905 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:42:04,035 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:42:09,181 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:42:13,656 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:42:13,660 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:42:13,660 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:42:14,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:42:14,461 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:42:14,464 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:42:16,573 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:42:25,293 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:42:25,671 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 05:42:26,653 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:42:27,334 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:42:27,336 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:42:30,507 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:42:30,508 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:42:31,277 - ispa_next.main - DEBUG - 



2025-11-17 05:42:31,277 - ispa_next.main - DEBUG - starting with process 14 (FB-SR 1700) of 15
2025-11-17 05:42:31,285 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:42:32,536 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:42:33,768 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:42:33,769 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:42:35,239 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:42:35,241 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:43:02,062 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:43:05,343 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:43:07,848 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:43:07,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:43:07,929 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:43:08,210 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:43:08,213 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:43:08,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:43:08,323 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:43:15,339 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:43:15,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:43:16,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:43:18,566 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:43:18,659 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:43:18,786 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:43:18,854 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:43:18,856 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:43:21,436 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:43:32,868 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:43:33,878 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:43:33,883 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:43:33,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:43:34,430 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:43:34,432 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:43:34,489 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:43:34,597 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 05:43:35,747 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:43:36,009 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:43:37,728 - ispa_next.functions - DEBUG - Updated appointment (AR00006517) customer contact data.
2025-11-17 05:43:38,642 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:43:38,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:43:38,727 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:43:38,859 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:43:38,862 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:43:38,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:43:39,943 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:43:41,007 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:43:41,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:43:41,148 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 05:43:45,180 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 05:43:45,180 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:43:45,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:43:45,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:43:47,666 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:43:47,781 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:43:47,914 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:43:47,982 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:43:47,984 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:43:50,613 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:44:02,001 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:45:02,003 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:45:13,336 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 05:45:20,527 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:45:20,529 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:45:23,146 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:45:27,331 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:45:28,338 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:45:28,339 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:45:28,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:45:28,414 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:45:32,549 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 05:45:32,554 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:45:32,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:45:32,623 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:45:32,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:45:33,480 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:45:33,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:45:34,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:45:34,123 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:45:36,546 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:45:36,547 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:45:37,550 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:45:37,551 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:45:37,552 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:45:37,553 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:45:37,554 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:45:37,556 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:45:37,558 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:45:37,561 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:45:37,564 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:45:37,566 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:45:37,570 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:45:37,572 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:45:37,573 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:45:40,160 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:45:40,162 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:45:40,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:45:42,740 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:45:42,743 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:45:42,745 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:45:42,749 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:45:45,371 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:45:45,373 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:45:45,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:45:46,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:45:46,854 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:46:11,820 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:46:15,807 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:46:20,619 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:46:20,622 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:46:20,622 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:46:21,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:46:21,408 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:46:21,410 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:46:23,089 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:46:30,861 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:46:31,263 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 05:46:32,018 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:46:32,847 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:46:32,849 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:46:35,801 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:46:35,802 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:46:36,673 - ispa_next.main - DEBUG - 



2025-11-17 05:46:36,673 - ispa_next.main - DEBUG - starting with process 15 (MKK-RM 157) of 15
2025-11-17 05:46:36,677 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:46:37,949 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:46:39,087 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:46:39,088 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 05:46:40,581 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 05:46:40,582 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 05:47:14,493 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 05:47:17,698 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:47:19,586 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 05:47:19,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:47:19,660 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:47:19,825 - ispa_next.functions - DEBUG - HU date already expired after 84 days.
2025-11-17 05:47:24,309 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 05:47:24,313 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 05:47:24,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:47:24,377 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:47:31,563 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:47:31,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:47:32,615 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:47:34,618 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:47:34,708 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:47:34,783 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:47:34,866 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:47:34,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:47:36,780 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:47:48,202 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 05:47:49,206 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 05:47:49,211 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 05:47:49,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:47:49,715 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:47:49,716 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 05:47:49,745 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 05:47:51,201 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 05:47:52,270 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 05:47:52,537 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 05:47:54,239 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 05:47:54,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:47:54,315 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 05:47:54,494 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 05:47:54,496 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 05:47:55,244 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 05:47:55,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 05:47:56,092 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 05:48:00,085 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 05:48:00,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:48:00,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:48:02,574 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 05:48:02,674 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 05:48:02,786 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 05:48:02,869 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 05:48:02,870 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:48:04,804 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:48:16,003 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:49:16,005 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:49:27,514 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 05:50:14,516 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 05:50:25,380 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen' in nested popup
2025-11-17 05:50:34,626 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 05:50:34,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:50:43,624 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Abgasuntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:50:45,767 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:50:48,329 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:50:51,006 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Zündkerzen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:50:53,768 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Luftfiltereinsatz' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:50:56,377 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motoröl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:50:59,111 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:51:02,173 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Standardumfang' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:51:04,829 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 05:51:06,790 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 05:51:09,234 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 05:51:10,241 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 05:51:10,254 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 05:51:10,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:51:10,387 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:51:14,516 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 05:51:18,428 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 05:51:18,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:51:18,521 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 05:51:18,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 05:51:19,393 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 05:51:19,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 05:51:20,082 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 05:51:20,082 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 05:51:21,950 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 05:51:21,951 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 05:51:26,179 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 05:51:26,180 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:51:26,185 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 05:51:26,186 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 05:51:26,189 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 05:51:26,191 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 05:51:26,192 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 05:51:26,193 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 05:51:26,194 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 05:51:26,195 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 05:51:26,199 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 05:51:26,201 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 05:51:26,202 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:51:28,330 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 05:51:28,332 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 05:51:28,334 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:51:30,170 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 05:51:30,173 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 05:51:30,176 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 05:51:30,178 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:51:32,085 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 05:51:32,088 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 05:51:32,693 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:51:33,373 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 05:51:33,490 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 05:51:52,258 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:51:56,734 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 05:51:56,736 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 05:51:56,737 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 05:51:57,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 05:51:57,504 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 05:51:57,506 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 05:51:59,366 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 05:52:07,343 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 05:52:07,728 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 05:52:08,562 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 05:52:09,247 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 677
2025-11-17 05:52:09,248 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 05:52:12,387 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 05:52:12,388 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
